function AccessibleTable(id,alignmentSelector){ this.Id=id; this.AlignmentSelector=alignmentSelector; this.Table=null; this.HeadingRows=0; this.HeadingColumns=0; this.Caption=""; this.Summary=""; this.CaptionHalign=""; this.CaptionValign=""; this.SetCellID= false; this.TxtRows=document.getElementById("T\x58\x54_HEAD\x5fROWS_"+this.Id); this.TxtCols=document.getElementById("TX\x54_HEAD\x5f\x43OL\x53_"+this.Id); this.TxtSummary=document.getElementById("\x54XT_SUM\x4d\101\x52Y_"+this.Id); this.TxtCaption=document.getElementById("TXT_CA\x50TION_"+this.Id); this.ChbSetCellID=document.getElementById("SET_C\x45LL_ID_"+this.Id); this.MaxHeadRowsSpan=document.getElementById("\x4dAX_\x48\x45AD\x5fROWS_"+this.Id); this.MaxHeadColsSpan=document.getElementById("\x4dAX_H\x45\101\x44_COLS\x5f"+this.Id); this.IsIE=document.all? true : false; this.TableDocument=document; }AccessibleTable.prototype.Initialize= function (table,tableDocument){ this.Table=table; if (tableDocument)this.TableDocument=tableDocument; if (this.Table){if (this.Table.caption){if (this.IsIE){ this.Caption=this.Table.caption.innerText; }else { this.Caption=this.Table.caption.childNodes[0].nodeValue; } this.CaptionHalign="\x63ente\x72"; this.CaptionValign=this.Table.caption.align; }else { this.Caption=""; this.CaptionHalign=""; this.CaptionValign=""; } this.Summary=this.Table.summary; this.HeadingRows=this.Table.tHead?this.Table.tHead.rows.length: 0; this.HeadingColumns=this.CountHeadingColumns( ); this.SetCellID=this.CheckHeadersHasIds( ) || this.CheckCellsHasHeaders( ); this.UpdateData( false); }} ; AccessibleTable.prototype.CountHeadingColumns= function ( ){var count=0; if (this.Table){for (k=0; k<this.Table.tBodies.length; k++){var tBody=this.Table.tBodies[k]; for (i=0; i<tBody.rows.length; i++){var row=tBody.rows[i]; var cells=row.getElementsByTagName('\124\x48'); if (cells && cells.length>count)count=cells.length; }}}return count; } ; AccessibleTable.prototype.UpdateData= function (save){if (save){ this.HeadingRows=parseInt(this.TxtRows.value); this.HeadingColumns=parseInt(this.TxtCols.value); this.Caption=this.TxtCaption.value; this.Summary=this.TxtSummary.value; this.CaptionHalign=this.AlignmentSelector.GetAlign( ); this.CaptionValign=this.AlignmentSelector.GetVAlign( ); this.SetCellID=this.ChbSetCellID.checked; }else if (""==this.TxtRows.value){ this.TxtRows.value=this.HeadingRows; this.TxtCols.value=this.HeadingColumns; this.TxtCaption.value=this.Caption; this.TxtSummary.value=this.Summary; this.AlignmentSelector.SelectAlignment(this.CaptionHalign,this.CaptionValign); this.ChbSetCellID.checked=this.SetCellID; }if (this.Table && !save){var maxRows=this.Table.rows.length; var maxColumns=(this.Table.rows.length>0)?this.Table.rows[0].cells.length: 0; this.MaxHeadRowsSpan.innerText='(Max. '+maxRows+')'; this.MaxHeadColsSpan.innerText='\x28Ma\x78\x2e '+maxColumns+'\x29'; }} ; AccessibleTable.prototype.CheckCellsHasHeaders= function ( ){if (this.Table){for (k=0; k<this.Table.tBodies.length; k++){var tBody=this.Table.tBodies[k]; for (i=0; i<tBody.rows.length; i++){var row=tBody.rows[i]; for (j=0; j<row.cells.length; j++){var cell=row.cells[j]; if (cell.getAttribute('hea\x64ers')){return true; }}}}}return false; } ; AccessibleTable.prototype.CheckHeadersHasIds= function ( ){if (this.Table){for (i=0; i<this.Table.rows.length; i++){var row=this.Table.rows[i]; for (j=0; j<row.cells.length; j++){var cell=row.cells[j]; if ("\x54H"==cell.tagName.toUpperCase( ) && ""!=cell.id)return true; }}}return false; } ; AccessibleTable.prototype.GetTableColumns= function ( ){var numColumns=0; if (null!=this.Table && this.Table.rows.length>0){numColumns=this.Table.rows[0].cells.length; }return numColumns; } ; AccessibleTable.prototype.UpdateCaption= function ( ){var caption=this.Table.caption; if (this.IsIE){if (!caption && ""!=this.Caption){caption=this.Table.createCaption( ); }else if (""==this.Caption){ this.Table.deleteCaption( ); }if (caption){caption.innerText=this.Caption; caption.align=this.CaptionValign; }}else {if (caption){ this.Table.removeChild(caption); caption=null; }if (!caption && ""!=this.Caption){var caption=this.TableDocument.createElement("CAPTION"); caption.innerHTML=this.Caption; caption.setAttribute("al\x69gn",this.CaptionValign); var $firstChild=$ektron(this.Table,this.Table.ownerDocument).children("\x3afir\x73\164-\x63hild"); if (1==$firstChild.length){$firstChild.before(caption); }else { this.Table.appendChild(caption); }}}} ; AccessibleTable.prototype.UpdateThead= function ( ){var numColumns=this.GetTableColumns( ); var tHead=this.GetThead( ); if (!tHead){tHead=this.Table.createTHead( ); }var tBodyInsertPos=0; for (i=0; i<this.Table.rows.length; i++){var row=this.Table.rows[i]; var parent=row.parentNode; var parentTagName=parent.tagName.toUpperCase( ); if (i<this.HeadingRows){if ("THEA\x44"!=parentTagName){var newRow=tHead.insertRow(tHead.rows.length); for (j=0; j<row.cells.length; j++){var newCell=this.TableDocument.createElement("\x54H"); newCell.innerHTML=row.cells[j].innerHTML; this.l0(row.cells[j],newCell); newRow.insertBefore(newCell,null); } this.Table.deleteRow(i+1); }}else {if ("\x54HEAD"==parentTagName){var newRow=this.Table.tBodies[0].insertRow(tBodyInsertPos++); for (j=0; j<row.cells.length; j++){var newCell=newRow.insertBefore(this.TableDocument.createElement("\x54D"),null); newCell.innerHTML=row.cells[j].innerHTML; this.l0(row.cells[j],newCell); newCell.removeAttribute("id"); newCell.removeAttribute("\x73c\x6f\x70e"); }}else {for (j=0; j<row.cells.length; j++){if (j<this.HeadingColumns){if (row.cells[j].tagName!="\x54H"){var newCell=this.TableDocument.createElement("TH"); newCell.innerHTML=row.cells[j].innerHTML; this.l0(row.cells[j],newCell); row.replaceChild(newCell,row.cells[j]); }}else {if (row.cells[j].tagName!="\x54D"){var newCell=this.TableDocument.createElement("T\x44"); newCell.innerHTML=row.cells[j].innerHTML; this.l0(row.cells[j],newCell); newCell.removeAttribute("\x69d"); newCell.removeAttribute("\x73cope"); row.replaceChild(newCell,row.cells[j]); }}}}}}if (this.HeadingRows<tHead.rows.length){for (i=tHead.rows.length-1; i>=this.HeadingRows; i--){tHead.deleteRow(i); }}if (0==this.HeadingRows){ this.Table.deleteTHead( ); }} ; AccessibleTable.prototype.UpdateRows= function ( ){if (this.Table){for (k=0; k<this.Table.tBodies.length; k++){var tBody=this.Table.tBodies[k]; for (i=0; i<tBody.rows.length; i++){var row=tBody.rows[i]; for (j=0; j<row.cells.length; j++){var cellType=j<this.HeadingColumns?"TH": "TD"; this.ChangeCellType(row.cells[j],cellType); }}}}} ; AccessibleTable.prototype.UpdateCellIDs= function ( ){var haveIds=this.CheckHeadersHasIds( ); var haveHeaders=this.CheckCellsHasHeaders( ); if (this.Table && (this.SetCellID || haveIds || haveHeaders)){var tableID=this.Table.id?this.Table.id: this.Table.uniqueID; if (!tableID){tableID="\x74bl"+Math.floor(Math.random( )*1000)+"\x69d"; }var arrHeaders=null; var headingId=0; if (this.Table.tHead && (haveIds || this.SetCellID)){for (i=0; i<this.Table.tHead.rows.length; i++){var row=this.Table.tHead.rows[i]; if (!arrHeaders)arrHeaders=new Array(row.cells.length); for (j=0; j<row.cells.length; j++){var cell=row.cells[j]; if (this.SetCellID){var id=cell.id?cell.id: (tableID+"_hea\x64ing_"+headingId++); cell.id=id; cell.scope="co\x6c"; if (!arrHeaders[j])arrHeaders[j]=id; }else {cell.removeAttribute("id", false); cell.removeAttribute("sc\x6fpe", false); }}}}for (k=0; k<this.Table.tBodies.length; k++){var tBody=this.Table.tBodies[k]; for (i=0; i<tBody.rows.length; i++){var row=tBody.rows[i]; for (j=0; j<row.cells.length; j++){var cell=row.cells[j]; var cellTagName=cell.tagName.toUpperCase( ); if ("\x54H"==cellTagName){if (this.SetCellID){cell.id=cell.id?cell.id: (tableID+"_head\x69ng_"+headingId++); cell.scope="\x72ow"; }else {cell.removeAttribute("id", false); cell.removeAttribute("sc\x6fpe", false); }}else if ("T\x44"==cellTagName && (haveHeaders || this.SetCellID)){if (this.SetCellID){var headAttr=(arrHeaders?arrHeaders[j]: ""); if (row.cells[0].id){if (arrHeaders){headAttr+="\x20"; }headAttr+=row.cells[0].id; }if (headAttr.length>0){cell.setAttribute("hea\x64ers",headAttr); }else {cell.removeAttribute("\150\x65\141d\x65rs", false); }}else {cell.removeAttribute("headers", false); }}}}}}} ; AccessibleTable.prototype.UpdateTable= function ( ){if (null!=this.Table){ this.UpdateData( true); if (this.Summary==""){ this.Table.removeAttribute('summa\x72y', false); }else { this.Table.summary=this.Summary; } this.UpdateThead( ); this.UpdateRows( ); this.UpdateCellIDs( ); this.UpdateCaption( ); }} ; AccessibleTable.prototype.GetHeadingRows= function ( ){return this.HeadingRows; } ; AccessibleTable.prototype.SetHeadingRows= function (rows){ this.HeadingRows=rows; } ; AccessibleTable.prototype.GetHeadingColumns= function ( ){return this.HeadingColumns; } ; AccessibleTable.prototype.SetHeadingColumns= function (cols){ this.HeadingColumns=cols; } ; AccessibleTable.prototype.GetSummary= function ( ){return this.Summary; } ; AccessibleTable.prototype.SetSummary= function (summary){ this.Summary=summary; } ; AccessibleTable.prototype.GetCaption= function ( ){return this.Caption; } ; AccessibleTable.prototype.SetCaption= function (caption){ this.Caption=caption; } ; AccessibleTable.prototype.GetCaptionHalign= function ( ){return this.CaptionHalign; } ; AccessibleTable.prototype.SetCaptionHalign= function (hAlign){ this.CaptionHalign=hAlign; } ; AccessibleTable.prototype.GetCaptionValign= function ( ){return this.CaptionValign; } ; AccessibleTable.prototype.SetCaptionValign= function (vAlign){ this.CaptionValign=vAlign; } ; AccessibleTable.prototype.GetThead= function ( ){var arrElements=this.Table.getElementsByTagName('THEAD'); if (arrElements.length>0)return arrElements[0]; else return null; } ; AccessibleTable.prototype.ChangeCellType= function (cellToConvert,newType){var isChangeMade= false; if (cellToConvert.tagName.toUpperCase( )!=newType.toUpperCase( )){var newCell=this.TableDocument.createElement(newType.toUpperCase( )); for (var attrName in cellToConvert.attributes){cellToConvert.attrName=cellToConvert.attributes[attrName]; }newCell.colSpan=cellToConvert.colSpan; newCell.rowSpan=cellToConvert.rowSpan; newCell.innerHTML=cellToConvert.innerHTML; this.l0(cellToConvert,newCell); newCell.style.cssText=cellToConvert.style.cssText; cellToConvert.parentNode.replaceChild(newCell,cellToConvert); isChangeMade= true; }return isChangeMade; } ; AccessibleTable.prototype.l0= function (oTag,i0){var alwaysCopyAttrList= {abbr: true ,axis: true ,ch: true ,choff: true ,headers: true ,scope: true } ; var oAttribs=oTag.attributes; for (var i=0; i<oAttribs.length; i++){var oAttrib=oAttribs[i]; var attrName=oAttrib.nodeName; if (oAttrib.specified || alwaysCopyAttrList[attrName.toLowerCase( )]){if (document.all && "class"==attrName)attrName="\x63la\x73\163\x4eame"; var I0=oAttrib.nodeValue; if (!I0 || !isNaN(I0))I0=oTag.getAttribute(attrName); if (I0 && typeof I0!="objec\x74"){i0.setAttribute(attrName,I0); }}}return (i0); } ;
var ImgAlignment=[["",""],["\156on\x65",""],["",""],["",""],["\x74op",""],["",""],["le\x66t",""],["\x6diddl\x65",""],["\162\x69ght",""],["",""],["\x62ottom",""],["",""],["",""],["",""],["",""]]; var CellAlignment=[["",""],["\156\x6fne",""],["",""],["le\x66t","\x74op"],["c\x65\156t\x65\162","\x74op"],["ri\x67\150t","\x74op"],["left","mid\x64le"],["c\x65\156t\x65\162","\x6didd\x6c\145"],["righ\x74","\x6diddl\x65"],["l\x65ft","\x62ot\x74\x6fm"],["cent\x65\162","bott\x6f\155"],["right","\x62\157t\x74\157\x6d"],["",""],["",""],["",""]]; var TableAlignment=[["",""],["none",""],["",""],["\x6ceft",""],["ce\x6eter",""],["rig\x68\164",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]]; var CaptionIEAlignment=[["",""],["\x6eone",""],["",""],["\x6ceft","\x74op"],["c\x65\156t\x65\162","top"],["\x72ight","\x74\157p"],["",""],["",""],["",""],["\x6ceft","bo\x74\164o\x6d"],["cente\x72","\142\x6f\164t\x6fm"],["\x72ight","\x62ottom"],["",""],["",""],["",""]]; var CaptionNSAlignment=[["",""],["\x6eon\x65",""],["",""],["",""],["\x63ente\x72","top"],["",""],["",""],["",""],["",""],["",""],["\x63enter","bott\x6fm"],["",""],["",""],["",""],["",""]]; var AlignmentImages=["\x78.gif","x.gif","x.\x67\151f","AlignTo\x70Left.gi\x66","\x41lignTopC\x65nter.gif","\x41lignTop\x52\151g\x68t.gif","\x41li\x67\x6eMi\x64\144\x6c\145\x4ceft.g\x69\146","Al\x69\147n\x4d\151\x64\144\x6c\145\x43enter.g\x69f","\x41lignMidd\x6c\145\x52\151g\x68t.gif","\x41lign\x42\x6ftt\x6f\155\x4c\145\x66t.gif","AlignB\x6fttomCent\x65r.gif","\x41lignBot\x74\x6fmR\x69\147\x68t.gif","\x78.g\x69\146","x.\x67\151f","\x78.gif"]; function AlignmentSelector(id,skinPath,mode,dropDownMenu,clientClickString){ this.IsIE=document.all? true : false; this.ID=id; this.SkinPath=skinPath; this.Mode=""; this.ActiveLookup=null; this.Selection=null; this.NoAlignmentIndex=-1; this.ButtonImg=document.getElementById("MENU_\x42UTTON_I\x4dG_"+this.ID); this.DropDownMenu=dropDownMenu; this.DropDownMenu.MenuEventHandler=this ; this.SetMode(mode); this.ClientClickString=clientClickString; }AlignmentSelector.prototype.SetMode= function (mode){ this.Mode=mode; this.ActiveLookup=this.GetLookupTableByMode(this.Mode); this.SelectAlignmentByIndex(this.NoAlignmentIndex); } ; AlignmentSelector.prototype.GetLookupTableByMode= function (mode){switch (mode.toUpperCase( )){case "IMG":return ImgAlignment; case "\x54ABLE":return TableAlignment; case "TD":return CellAlignment; case "CAPTION":return CaptionNSAlignment; default:return null; }} ; AlignmentSelector.prototype.OnShowMenu= function (visible){ this.ShowMode(this.Mode,visible); } ; AlignmentSelector.prototype.ShowMode= function (mode,visible){var table=document.getElementById("\x4dENU_EL\x45\115\x45NT_TAB\x4cE_"+this.ID); var count=0; for (var i=0; i<table.rows.length; i++){var isRowVisible= false; for (var j=0; j<table.rows[i].cells.length; j++){var cell=table.rows[i].cells[j]; var isCellVisible=visible && this.IsAvailable(count++); cell.style.visibility=isCellVisible?"\x76is\x69\x62le": "\x68idden"; isRowVisible |= isCellVisible; }if (null!=document.all){table.rows[i].style.display=isRowVisible?"": "none"; }}} ; AlignmentSelector.prototype.IsAvailable= function (index){var isVisible= false; if (this.ActiveLookup){var alignment=this.ActiveLookup[index]; isVisible=((null!=alignment) && (""!=alignment[0] || ""!=alignment[1])); }return isVisible; } ; AlignmentSelector.prototype.GetFirstAlignmentIndex= function ( ){var index=-1; if (this.ActiveLookup){for (i=0; i<this.ActiveLookup.length; i++){if (this.IsAvailable(i)){index=i; break; }}}return index; } ; AlignmentSelector.prototype.SelectAlignmentByIndex= function (index){if (index==this.NoAlignmentIndex){ this.Selection=""; this.SetButtonImage("x\x2egif"); }else {if (this.ActiveLookup && 0<=index && index<this.ActiveLookup.length){ this.Selection=this.ActiveLookup[index]; this.SetButtonImage(AlignmentImages[index]); if (""!=this.ClientClickString)eval(this.ClientClickString); }}} ; AlignmentSelector.prototype.SetButtonImage= function (imgFileName){ this.ButtonImg.src=this.SkinPath+"\x49mg/"+imgFileName; if ("x.\x67if"==imgFileName){ this.ButtonImg.style.marginLeft="\x30px"; }else { this.ButtonImg.style.marginLeft="-2px"; }} ; AlignmentSelector.prototype.SelectAlignment= function (align,vAlign){if (""==align){align="none"; }if (!vAlign){vAlign=""; }if (this.ActiveLookup){align=align.toUpperCase( ); vAlign=vAlign.toUpperCase( ); var selIndex=-1; for (i=0; i<this.ActiveLookup.length; i++){if (this.IsAvailable(i)){var ha=this.ActiveLookup[i][0].toUpperCase( ); var va=this.ActiveLookup[i][1].toUpperCase( ); if (-1==selIndex){selIndex=i; }if ((align==ha || align==va) && (vAlign==ha || vAlign==va)){ this.SelectAlignmentByIndex(i); return; }}} this.SelectAlignmentByIndex(selIndex); }} ; AlignmentSelector.prototype.GetAlign= function ( ){var value=(this.Selection?this.Selection[0]: ""); if ("\x6eone"==value){value=""; }return value; } ; AlignmentSelector.prototype.GetVAlign= function ( ){var value=(this.Selection?this.Selection[1]: ""); if ("\x6eon\x65"==value){value=""; }return value; } ; AlignmentSelector.prototype.Toggle= function ( ){if (null!=this.DropDownMenu){ this.DropDownMenu.Toggle( ); if (window.event){window.event.cancelBubble= true; }}} ; AlignmentSelector.prototype.Enable= function (isEnabled){if (null!=this.DropDownMenu){ this.DropDownMenu.Enable(isEnabled); }} ;
function BrowserDialogBase(fileBrowser,previewer,tabHolder){ this.FolderPathBox=document.getElementById("\x46\x6flde\x72\120\x61thB\x6f\170"); this.FileBrowser=fileBrowser; this.Previewer=previewer; this.TabHolder=tabHolder; if (this.FileBrowser && this.Previewer){var thePreviewer=this.Previewer; var theTabHolder=this.TabHolder; var theManager=this ; this.FileBrowser.OnClientClick= function (browserItem){theManager.ShowPath(browserItem.GetPath( )); thePreviewer.ChangePreviewedObject(browserItem); };this.FileBrowser.OnFolderChange= function (browserItem){theManager.ShowPath(browserItem.GetPath( )); thePreviewer.Clear( ); theTabHolder.SetTabEnabled(1,browserItem.Permissions&this.UploadPermission); };if (this.FileBrowser.SelectedItem && this.FileBrowser.SelectedItem.Type=="F"){thePreviewer.ChangePreviewedObject(this.FileBrowser.SelectedItem); }}}BrowserDialogBase.prototype.ShowPath= function (path){ this.FolderPathBox.value=path; } ; BrowserDialogBase.prototype.Initialize= function ( ){ this.TabHolder.SetTabEnabled(1,this.FileBrowser.CurrentItem.Permissions&this.FileBrowser.UploadPermission); this.TabHolder.SelectCurrentTab( ); var itemToShow=this.FileBrowser.SelectedItem!=null?this.FileBrowser.SelectedItem: this.FileBrowser.CurrentItem; this.ShowPath(itemToShow.GetPath( )); } ;
function CellPropertiesControl(Id,CssClassSelector,CellAlignmentSelector,BackgroundColorPicker,BgImageDialogCaller,StyleBuilderCaller){ this.Id=Id; this.CssClassSelector=CssClassSelector; this.CellAlignmentSelector=CellAlignmentSelector; this.BackgroundColorPicker=BackgroundColorPicker; this.BgImageDialogCaller=BgImageDialogCaller; this.StyleBuilderCaller=StyleBuilderCaller; this.ColumnWidthHolder=document.getElementById(this.Id+"_\x63\x6flumnWid\x74h"); this.ColumnHeightHolder=document.getElementById(this.Id+"\x5fcolum\x6e\x48e\x69\147\x68t"); this.ColumnWidthBox=new PropertyTextBox(this.ColumnWidthHolder.id,"\104\x49MENSION",localization["\x49nva\x6c\x69dC\x65llWidth"]); this.ColumnHeightBox=new PropertyTextBox(this.ColumnHeightHolder.id,"DIM\x45NSION",localization["\x49nvalidC\x65\154\x6cHeigh\x74"]); this.ColumnWrapHolder=document.getElementById(this.Id+"\x5fco\x6c\x75mn\x57rap"); this.IdHolder=document.getElementById(this.Id+"_\x69\144\x48\157\x6cder"); this.IdHolder.onchange=this.o1; this.IdHolder.O1= false; this.EditorObject=null; this.Initialized= false; }CellPropertiesControl.prototype.Initialize= function (CellToModify,cssClasses,EditorObject,ColorsArray,AllowCustomColors){if (!this.Initialized){ this.EditorObject=EditorObject; this.CssClasses=cssClasses; this.CssClassSelector.Initialize(this.CssClasses); this.StyleBuilderCaller.Initialize(this.EditorObject); this.BgImageDialogCaller.Initialize(this.EditorObject); this.BackgroundColorPicker.CanAddCustomColor=AllowCustomColors; this.BackgroundColorPicker.CanAddHexColor=AllowCustomColors; if (ColorsArray)this.BackgroundColorPicker.SetColors(ColorsArray); this.Initialized= true; } this.LoadPropertyValues(CellToModify); } ; CellPropertiesControl.prototype.Clear= function ( ){var EmptyCell=document.createElement('\x54D'); this.LoadPropertyValues(EmptyCell); };CellPropertiesControl.prototype.LoadPropertyValues= function (cellToModify){ this.CellToModify=cellToModify; if (this.CellToModify.style.width==""){ this.ColumnWidthHolder.value=this.CellToModify.width; }else { this.ColumnWidthHolder.value=this.CellToModify.style.width; }if (this.CellToModify.style.height==""){ this.ColumnHeightHolder.value=this.CellToModify.height; }else { this.ColumnHeightHolder.value=this.CellToModify.style.height; } this.IdHolder.O1= false; var oId=this.CellToModify.getAttribute("id"); this.IdHolder.value=oId; this.CellAlignmentSelector.SelectAlignment(this.CellToModify.align,this.CellToModify.vAlign);this.ColumnWrapHolder.checked=this.CellToModify.noWrap; this.BackgroundColorPicker.SelectColor(this.CellToModify.bgColor); this.CssClassSelector.SelectCssClass(this.CellToModify.className); this.StyleBuilderCaller.SetStyledObject(this.CellToModify); if (this.BgImageDialogCaller && this.CellToModify){var imagePath=this.CellToModify.getAttribute("ba\x63kgro\x75\156\x64"); if (!imagePath)imagePath=""; this.BgImageDialogCaller.SetImagePath(imagePath); }} ; CellPropertiesControl.prototype.UpdateMultiple= function (Cells){for (var i=0; i<Cells.length; i++){if (!this.Update(Cells[i],(Cells.length>1))){return false; }}return true; };CellPropertiesControl.prototype.Update= function (Cell,l1){if (typeof(Cell)!='un\x64efined'){ this.CellToModify=Cell; }var oCell=this.CellToModify; oCell.style.cssText=this.StyleBuilderCaller.GetStyleText( ); if (oCell.style.cssText==''){oCell.removeAttribute('\x73tyle', false); }if (!this.ColumnWidthBox.IsValueValid( )){return false; }var theWidthValue=this.ColumnWidthBox.GetValue( ); oCell.removeAttribute("\x77idt\x68", false); oCell.style.width=theWidthValue?ConvertIntToPixel(theWidthValue): ""; if (!this.ColumnHeightBox.IsValueValid( )){return false; }var theHeightValue=this.ColumnHeightBox.GetValue( ); oCell.removeAttribute("\x68eig\x68\x74", false); oCell.style.height=theHeightValue?ConvertIntToPixel(theHeightValue): ""; if ( false ==l1 && true ==this.IdHolder.O1){ this.SetAttribValue("id",this.IdHolder.value); } this.SetAttribValue("al\x69gn",this.CellAlignmentSelector.GetAlign( )); this.SetAttribValue("\x76Alig\x6e",this.CellAlignmentSelector.GetVAlign( )); this.SetAttribValue("bgColor",this.BackgroundColorPicker.SelectedColor); this.SetAttribValue("backgrou\x6ed",this.BgImageDialogCaller.GetImagePath( )); var className=document.all?"c\x6cassNam\x65": "class"; this.SetAttribValue(className,this.CssClassSelector.GetSelectedClassName( )); oCell.noWrap=this.ColumnWrapHolder.checked; return true; } ; CellPropertiesControl.prototype.SetAttribValue= function (attribName,oVal,forceVal){if (oVal || ( true ==forceVal)){ this.CellToModify.setAttribute(attribName,oVal); }else { this.CellToModify.removeAttribute(attribName, false); }} ; CellPropertiesControl.prototype.o1= function (e){ this.O1= true; };
function ColorPicker(id,skinPath,dropDownMenu,defaultColors){ this.IsIE=document.all? true : false; this.ID=id; this.SkinPath=skinPath+"Dia\x6c\x6fgs/"; this.DropDownMenu=dropDownMenu; this.ColorSampleElement=document.getElementById('\x4dENU_BUTT\x4fN_SPAN_'+this.ID); this.DefaultColors=defaultColors; this.ItemsPerRow=6; this.CanAddCustomColor= true; this.CanAddHexColor= true; if (null!=this.DropDownMenu){ this.BuildColorTable( ); } this.SelectedColor=""; this.SelectColor(""); this.OnClientClick=null; }ColorPicker.prototype.SetColors= function (colorsArray){ this.DefaultColors=colorsArray; this.BuildColorTable( ); };ColorPicker.prototype.GetXImageUrl= function ( ){return "\x75r\x6c\050"+this.SkinPath+"\x78.gif)"; };ColorPicker.prototype.Enable= function (isEnabled){if (null!=this.DropDownMenu){ this.DropDownMenu.Enable(isEnabled); }} ; ColorPicker.prototype.Toggle= function ( ){if (null!=this.DropDownMenu){ this.DropDownMenu.Toggle( ); }} ; ColorPicker.prototype.SelectColor= function (color,hide){color=this.ValidateColor(color); this.SelectedColor=color; if (null==hide)hide= true; if (hide && null!=this.DropDownMenu && this.DropDownMenu.IsVisible( )){ this.DropDownMenu.SetVisible( false); } this.OnChangeSelection( ); } ; ColorPicker.prototype.OnChangeSelection= function ( ){if (null!=this.DropDownMenu && null!=this.ColorSampleElement){if (""==this.SelectedColor){ this.ColorSampleElement.style.background=this.SelectedColor; this.ColorSampleElement.style.backgroundImage=this.GetXImageUrl( ); this.ColorSampleElement.style.backgroundPosition="center"; this.ColorSampleElement.style.backgroundRepeat="no-repe\x61t"; }else { this.ColorSampleElement.style.backgroundImage=""; this.ColorSampleElement.style.background=this.SelectedColor; }if (this.OnClientClick){ this.OnClientClick( ); }}} ; ColorPicker.prototype.BuildColorTable= function ( ){var table=document.getElementById("\x43O\x4c\x4fR_\x54ABLE_"+this.ID); if (!table)return; var rowLength=table.rows.length; for (var i=0; i<rowLength; i++){table.deleteRow(0); }var oRow=null; var curRowItems=0; for (i=0; i<this.DefaultColors.length; i++){if (0==i%this.ItemsPerRow){oRow=table.insertRow(-1); curRowItems=0; }curRowItems++; var bgColor=this.DefaultColors[i]; this.AddColorCell(oRow,bgColor); }var cellsToAdd=this.ItemsPerRow-curRowItems-1; if (cellsToAdd>0){for (var i=0; i<=cellsToAdd; i++){var oCell=oRow.insertCell(oRow.cells.length); oCell.innerHTML="\x26nb\x73\x70;&\x6ebsp;"; }}if (this.CanAddCustomColor){if (this.IsIE)this.AddCustomColorIE(table); else this.AddHexColor(table,localization["Add\x43ustomC\x6flor"]); }if (this.IsIE && this.CanAddHexColor){var sAddHexColor=localization["Add\x48exColo\x72"]; if ("\x75ndefine\x64"==typeof sAddHexColor){sAddHexColor=localization["\101\x64dCusto\x6dHexColo\x72"]; } this.AddHexColor(table,sAddHexColor); }if (this.IsIE)this.DropDownMenu.SetMenuInnerHtml(table.outerHTML); } ; ColorPicker.prototype.AddCustomColorIE= function (table){var onClickHandler=this.ID+".\x4fnAddCusto\x6dColorIE\x28\051"; var i1="Add Cus\x74om Colo\x72\056\x2e."; if (localization){i1=localization["AddCusto\x6dColor"]; }var cellInnerHTML="\074span cla\x73s=\047\x4cabe\x6c\047\x3e"+i1+"\074\x2fspa\x6e\076"+"\074\x6fbj\x65\x63t \x69d=\047\x44LG_S\x45LECT_C\x4f\114\x4fR_"+this.ID+"\047\040\x43LASSID=\x27\x63ls\x69d:3050f\x3819-98b\x35\055\x311cf\x2dbb82\x2d00aa0\x30bdce0\x62\047\x20widt\x68=\047\x30px\x27 hei\x67ht=\0470px\047\x3e\x3c\057\x6fbje\x63t>"; this.AddCustomColor(table,onClickHandler,cellInnerHTML); } ; ColorPicker.prototype.AddHexColor= function (table,label){var onClickHandler=this.ID+"\x2eOnAd\x64\x48e\x78\103\x6flor()"; var cellInnerHTML="\074span c\x6cass=\047\x4cab\x65l\047\x3e"+label+"\x3c/sp\x61n>"; this.AddCustomColor(table,onClickHandler,cellInnerHTML); } ; ColorPicker.prototype.AddCustomColor= function (table,onClickHandler,cellInnerHtml){var row=table.insertRow(-1); var cell=row.insertCell(row.cells.length); cell.colSpan=this.ItemsPerRow; cell.noWrap= true; cell.setAttribute("onmo\x75seover","\x74his.cla\x73\163\x4eame = \x27Over\047"); cell.setAttribute("\x6fnmouse\x6f\165\x74","\x74his.c\x6c\141\x73\x73Na\x6de = \047\047"); if (""!=onClickHandler)cell.setAttribute("\x6fnclic\x6b",onClickHandler); cell.innerHTML=cellInnerHtml; } ; ColorPicker.prototype.OnAddCustomColorIE= function ( ){var dlg=document.all["\x44LG_\x53\x45L\x45\103\x54_COLO\x52_"+this.ID]; if (!dlg)return; var color=dlg.ChooseColorDlg( ); color=this.ConvertColor(color); this.OnAddCustomColor(color); } ; ColorPicker.prototype.ValidateColor= function (color){if (null==color)return ""; var re=/\x52\x47\x42\x28\s*(\d{1,3})\s*\x2c\s*(\d{1,3})\s*\x2c\s*(\d{1,3})\s*\x29.*/i; color=color.replace(re, function ($0_match,I1,o2,O2){return toHex(I1)+toHex(o2)+toHex(O2); } ); if (color.charAt(0)!="#"){color="\x23"+color; }re=new RegExp("#[\x30-9a-fA-F\x5d{6}","gi"); return re.exec(color)?color: ""; function toHex(l2){var i2=new Ektron.String(parseInt(l2,10).toString(16)); return i2.padLeft(2,"\x30"); }} ; ColorPicker.prototype.OnAddCustomColor= function (color){color=this.ValidateColor(color); this.SelectColor(color, true); } ; ColorPicker.prototype.AddCustomColorToColorTable= function (color){var table=document.getElementById("C\x4fLOR_TAB\x4cE_"+this.ID); if (!table)return; var custColorRow=null; var extraRowsCount=0; if (this.CanAddCustomColor)extraRowsCount++; if (this.CanAddHexColor)extraRowsCount++; if (table.rows.length>((this.DefaultColors.length/this.ItemsPerRow)+extraRowsCount)){var lastRow=table.rows[table.rows.length-1]; if (lastRow.cells.length<this.ItemsPerRow)custColorRow=lastRow; }if (!custColorRow)custColorRow=table.insertRow(-1); this.AddColorCell(custColorRow,color); if (this.IsIE)this.DropDownMenu.SetMenuInnerHtml(table.outerHTML); } ; ColorPicker.prototype.AddColorCell= function (row,color){var cell=row.insertCell(row.cells.length); cell.setAttribute("\x6fnmo\x75\x73eo\x76er","t\x68\151\x73.classNa\x6de = \047Over\047"); cell.setAttribute("onmo\x75seout","this.\x63\154\x61ssName =\x20\047\x27"); cell.setAttribute("onc\x6c\151\x63\x6b",this.ID+"\x2eSe\x6c\x65ct\x43olor(\047"+color+"\047\x29"); var colorBox=document.createElement("DIV"); colorBox.style.backgroundColor=color; if (""==color){cell.style.backgroundImage=this.GetXImageUrl( ); cell.style.backgroundRepeat="no-rep\x65at"; cell.style.backgroundPosition="\x63enter"; }cell.appendChild(colorBox); } ; ColorPicker.prototype.OnAddHexColor= function ( ){var color=prompt(localization["\x50romptCo\x6c\157\x72"],"#"); this.OnAddCustomColor(color); } ; ColorPicker.prototype.ConvertColor= function (color){color=parseInt(color); color=color.toString(16); if (color.length<6){var sTempString="\x30000\x30\x30".substring(0,(6-color.length)); color="\x23"+sTempString.concat(color).toUpperCase( ); }else {color="\x23"+color.toUpperCase( ); }return color; } ; ColorPicker.prototype.Toggle= function ( ){if (null!=this.DropDownMenu){ this.DropDownMenu.Toggle( ); if (window.event){window.event.cancelBubble= true; }}} ;
function ConvertIntToPixel(oVal){var oNew=""+oVal; if (oNew.indexOf("%")!=-1){return oNew; }else {oNew=parseInt(oNew); if (!isNaN(oNew)){oNew=oNew+"px"; return oNew; }}return oVal; }function GetCellIndex(oCell){var selCol=oCell?(oCell.cellIndex): 0; var detect=navigator.userAgent.toLowerCase( ); if (detect.indexOf("saf\x61\x72i")>-1){var oP=oCell.parentNode; for (var i=0; i<oP.cells.length; i++){if (oCell==oP.cells[i]){selCol=i; break; }}}return selCol; }function RadUtil_GetEventSource(e){if (null==e)return null; if (e.srcElement)return e.srcElement; else if (e.target)return e.target; else return null; }function buttonAction(action,e){if (window.event==null){e.preventDefault( ); if (e.stopPropagation)e.stopPropagation( ); }eval(action); }function showObject(id){try {document.getElementById(id).style.display="b\x6cock"; }catch (exc){}}function hideObject(id){try {document.getElementById(id).style.display="non\x65"; }catch (exc){}}function inArray(array,value){for (var i=0; i<array.length; i++){if (array[i]==value){return true; }}return false; }function addOption(obj,value,text){var hasValue= false; value=trim(value); text=trim(text); var options=obj.getElementsByTagName("OPTION"); for (var i=0; i<options.length; i++){if (value.toUpperCase( )==options[i].value.toUpperCase( )){hasValue= true; break; }}if ((!hasValue) && (text!="")){var option=document.createElement("OPTION"); option.innerHTML=text; option.value=value; obj.appendChild(option); }}function selectOption(control,value){var selectStatus= false; if ((value!="") && (value!=null)){var options=control.getElementsByTagName("OP\x54ION"); for (var i=0; i<options.length; i++){if (options[i].value.toString( ).toUpperCase( )==value.toString( ).toUpperCase( )){try {options[i].selected= true; }catch (exc){}selectStatus= true; break; }}}else {control.selectedIndex=0; }return selectStatus; }function changeColor(control,customValue,number){if (control.value==customValue){if (document.all){var newColor=document.getElementById("dlg\x48elper").ChooseColorDlg( ); if (newColor!=0){newColor=newColor.toString(16); if (newColor.length<6){var sTempString="00000\x30".substring(0,(6-newColor.length)); newColor="\x23"+sTempString.concat(newColor).toUpperCase( ); }else {newColor="#"+newColor.toUpperCase( ); }}else {newColor=null; }}else {newColor=prompt(localization["Pr\x6fmptColor"],"#"); }var option; var options=control.getElementsByTagName("\x4fPTIO\x4e"); if (newColor!=null){if (options.length==number){option=document.createElement("\x4fPTION"); control.insertBefore(option,options[number-1]); }else {option=options[number-1]; }option.style.backgroundColor=newColor; option.innerHTML=localization["Cust\x6fmh"]+newColor; option.value=newColor; }control.selectedIndex=options.length-2; }}function trim(str){return str.replace(/^\s{1,}/gi,"").replace(/\s{1,}$/gi,""); }function GetDialogArguments( ){if (window.radWindow){return window.radWindow.Argument; }else {return null; }}function AttachEvent(eventObject,eventName,fnPointer){if (eventObject.attachEvent){eventObject.attachEvent("on"+eventName,fnPointer); }else if (eventObject.addEventListener){eventObject.addEventListener(eventName,fnPointer, false); }}var radEditorGlobalStyleElements=null; function radEditorGetStyleElements( ){if (!radEditorGlobalStyleElements){radEditorGlobalStyleElements=new Array("backgro\x75nd-att\x61chment","backgro\x75\156\x64-colo\x72","\x62ackgroun\x64-image","\x62ackg\x72\x6fun\x64-posit\x69on-x","\142\x61\143\x6b\147\x72\157\x75nd-posi\x74ion-y","bac\x6b\147r\x6fund-re\x70\145a\x74","be\x68\141v\x69\157\x72","bord\x65\162-\x62ottom-co\x6cor","\x62order-b\x6f\x74to\x6d\055\x73tyle","borde\x72\055\x62ottom-w\x69\144\x74\150","\x62order-le\x66\164\x2d\143o\x6cor","bo\x72\144e\x72\x2dle\x66t-style","\x62\157r\x64\x65r-\x6c\145\x66\164\x2dwidth","bor\x64\145r\x2d\162\x69\x67ht\x2dcolor","borde\x72-right-s\x74yle","bor\x64\145r\x2dright-wi\x64\164\x68","\x62order-t\x6f\160\x2dcolor","bo\x72\144e\x72\055\x74op-styl\x65","\x62order-t\x6f\160\x2d\167i\x64th","\x62order\x2d\143\x6f\154\x6f\162","borde\x72-style","\142o\x72\144e\x72-width","\x63\154e\x61\162","\x63li\x70","\143\x6f\154o\x72","\x63urso\x72","directio\x6e","display","filt\x65r","fo\x6et-family","font\x2d\163\x69ze","\x66ont-\x73\164\x79\154e","\x66ont\x2d\166a\x72iant","font-we\x69\147h\x74","layout-\x66\154o\x77","\x6cayo\x75\x74-g\x72id-char","layout-\x67\162i\x64-line","l\x61\x79ou\x74\x2dgr\x69\144\x2dmode","\x6cay\x6f\x75t-\x67\162\x69\x64-t\x79pe","\x6cetter\x2d\163\x70\141\x63\x69ng","\154\x69\x6ee-b\x72eak","line\x2d\150\x65\x69gh\x74","\x6dargi\x6e\055\x62ottom","\x6darg\x69\156-\x6ceft","\x6dargi\x6e\x2dri\x67\150\x74","\x6dar\x67\x69n-\x74\x6fp","min\x2dheight","pa\x64\x64in\x67\055\x62ottom","pad\x64\151\x6e\x67-l\x65\146t","padding-\x72\151\x67\150\x74","padding-\x74\x6fp","\x70age-brea\x6b\055\x62efore","po\x73\x69ti\x6f\156","\x74ext-a\x6c\151\x67\x6e","\x74ext-au\x74\x6fsp\x61\143\x65","t\x65xt-decor\x61\164\x69\x6fn","\x74ext\x2d\151n\x64ent","\x74ext-jus\x74\151\x66\171","tex\x74\x2dtr\x61\156s\x66orm","text-un\x64\145\x72\154i\x6e\145\x2dpositio\x6e","\x75nicode-\x62\151\x64\151","vertical\x2d\141l\x69gn","\x76isibil\x69\x74y","\x77ord-br\x65\x61k","\x77ord-\x73\160a\x63ing","word-\x77\162a\x70","\x77rit\x69\156g\x2dmode","\x7a-i\x6e\x64ex","\x7aoom"); }return radEditorGlobalStyleElements; }
function CssClassSelector(id,radCssClassArray,strFilterTags,popupWidth,popupHeight,skinPath){ this.IsIE=(null!=document.all && !window.opera); this.ID=id; this.PopupWidth=parseInt(popupWidth); this.PopupHeight=parseInt(popupHeight); this.SkinPath=skinPath; this.SelectedIndex=-1; this.PopupWnd=null; this.Document=null; this.CssClassesHtmlTable=null; this.ArrCssClasses=[ ]; this.Table=document.getElementById("\x43\x73sCla\x73sSelecto\x72_Tabl\x65_"+this.ID); this.Label=document.getElementById("C\x73sClassS\x65lector_L\x61bel_"+this.ID); this.RadCssClassArray=null; this.ArrFilterTags=[ ]; this.Initialize(radCssClassArray,strFilterTags); this.SelectCssClassByIndex(-1); if (window.attachEvent){var oThis=this ; window.attachEvent("\157\x6eunlo\x61\144", function ( ){oThis.PopupWnd=null; oThis.Document=null; oThis.CssClassesHtmlTable=null; oThis.ArrCssClasses=null; } ); }}CssClassSelector.prototype.Initialize= function (radCssClassArray,strFilterTags){ this.ArrCssClasses=radCssClassArray; if (!this.PopupWnd){if (this.IsIE){ this.PopupWnd=window.createPopup( ); if (this.PopupWnd){ this.Document=this.PopupWnd.document; this.Document.body.style.border="0\x70x"; this.Document.body.style.backgroundColor="#FFFFFF"; }}else { this.PopupWnd=new PopupWindow( ); this.Document=document; }} this.InitPopupWnd( ); } ; CssClassSelector.prototype.InitPopupWnd= function ( ){if (this.IsIE){if (this.Document){ this.InitPopup(this.Document.body); }}else { this.InitPopup(this.PopupWnd.Popup); }} ; CssClassSelector.prototype.InitPopup= function (popupWndBody){if (this.Document && popupWndBody){popupWndBody.style.border="\x31px so\x6c\151\x64 #999\x39\071\x39"; this.BuildPopupHtml( ); if (this.CssClassesHtmlTable){while (popupWndBody.childNodes && 0<popupWndBody.childNodes.length){popupWndBody.removeChild(popupWndBody.childNodes[0]); }var div=this.Document.createElement("DIV"); div.className="\x52adEDrop\x44\x6fw\x6e\x54ab\x6ce"; div.style.overflow="\x61uto"; div.style.height=this.PopupHeight; div.style.width=this.PopupWidth; div.appendChild(this.CssClassesHtmlTable); popupWndBody.appendChild(div); }}} ; CssClassSelector.prototype.BuildPopupHtml= function ( ){ this.CssClassesHtmlTable=this.CreateCssClassesTable( ); try {var topTable=this.CssClassesHtmlTable; this.AddCssClass(topTable,"",null,localization["ClearSt\x79le"],-1); for (var index=0; index<this.ArrCssClasses.length; index++){ this.AddRadCssClass(topTable,this.ArrCssClasses[index],index); }}catch (ex){}};CssClassSelector.prototype.AddRadCssClass= function (table,radCssClass,cssIndex){if (radCssClass.Alias!="d\x65sign_se\x6cected_fi\x65ld"){ this.AddCssClass(table,radCssClass.Tag,radCssClass.Rule,radCssClass.Alias,cssIndex); }} ; CssClassSelector.prototype.AddCssClass= function (table,tag,rule,alias,cssIndex){if (tag){tag=tag.toUpperCase( ); }var row=table.insertRow(-1); var cell=row.insertCell(-1); cell.noWrap= true; cell.onmouseover=new Function("\x74his.sty\x6c\145\x2ebord\x65\162\x20= \047\061\x70x sol\x69d #c\x63cccc\x27;"); cell.onmouseout=new Function("this.s\x74yle.bo\x72\144\x65r= \0471px s\x6f\154\x69d #AAA\x41AA\047;"); cell.style.font="\x6eorma\x6c\040\x311px Tah\x6fma"; cell.style.border="1p\x78 solid #\x41\101\x41AAA"; cell.style.padding="2\x70x 2px 1p\x78\040\x32px"; var span=this.Document.createElement("\x53PAN"); var title=""; if (rule){title=rule.selectorText; }else {title=alias; }cell.setAttribute("t\x69tle",title); var img=this.Document.createElement("\x49MG"); img.src=this.GetCssClassImageSrcByTag(tag); img.align="mid\x64le";img.style.cssText="\x6dargin-\x6c\x65f\x74\072\x32px; m\x61rgin-ri\x67ht:4px"; cell.appendChild(img); switch (tag){case "\x41":var anchor=this.Document.createElement("A"); anchor.href="#"; anchor.onmouseover=new Function("w\x69ndow.st\x61\164\x75s = \x27\047\x3b retu\x72n fals\x65"); anchor.innerHTML=alias; this.ApplyRule(anchor,rule); anchor.style.cursor="def\x61ult"; span.appendChild(anchor); break; default:span.innerHTML=alias; span.style.font="icon"; this.ApplyRule(span,rule); span.style.marginTop="2px"; break; }cell.appendChild(span); var onClick=""; if (this.IsIE){cell.Parent=this ; cell.onclick=new Function("this\x2eParent\x2eSelectCs\x73ClassB\x79\111\x6edex("+cssIndex+");"); }else {onClick=this.ID+".Selec\x74CssClas\x73ByIndex("+cssIndex+");"; cell.setAttribute("\x6fnclick",onClick); }span.style.overflowX="hidden"; } ; CssClassSelector.prototype.GetCssClassImageSrcByTag= function (tag){var imgName=""; switch (tag){case "\x41LL":case "\x41":case "IMG":case "T\x41\102L\x45":case "\x50":imgName=tag; break; default:imgName="Custo\x6d"; break; }return this.SkinPath+"\x49mg\x2f\x63la\x73s"+imgName+".gif"; } ; CssClassSelector.prototype.ApplyRule= function (element,rule){if (!element){return; }if (!rule){return; }element.style.cssText=rule.style.cssText; var bgColor=element.style.backgroundColor.toLowerCase( ); var color=element.style.color.toLowerCase( ); if ((""==bgColor || "#ff\x66fff"==bgColor || "whi\x74\145"==bgColor) && ("\x23fffff\x66"==color || "\x77hit\x65"==color)){element.style.backgroundColor="\x23aaaa\x61\141"; }element.style.width=""; element.style.height=""; } ; CssClassSelector.prototype.CreateCssClassesTable= function ( ){var table=this.Document.createElement("\x54AB\x4c\105"); table.setAttribute("\x63ellSpaci\x6eg",3); table.setAttribute("\x63ellPad\x64\x69ng",3); table.style.width="100%"; table.style.cursor="defa\x75lt"; return table; } ; CssClassSelector.prototype.SelectCssClassByIndex= function (cssIndex){ this.SelectedIndex=cssIndex; var radCssClass=this.GetRadCssClass(this.SelectedIndex); if (this.Label){ this.Label.innerHTML=radCssClass?radCssClass.Alias:localization["Clear\x53tyle"]; }if (this.PopupWnd){ this.PopupWnd.hide( ); }} ; CssClassSelector.prototype.SelectCssClassByText= function (cssText){if (!cssText)cssText=""; for (var i=0; this.ArrCssClasses && i<this.ArrCssClasses.length; i++){var radCssClass=this.ArrCssClasses[i]; if (radCssClass && radCssClass.Rule && radCssClass.Rule.selectorText.toLowerCase( )==cssText.toLowerCase( )){break; }} this.SelectCssClassByIndex(i); } ; CssClassSelector.prototype.SelectCssClass= function (cssAlias){if (!cssAlias)cssAlias=""; for (var i=0; this.ArrCssClasses && i<this.ArrCssClasses.length; i++){var radCssClass=this.ArrCssClasses[i]; if (radCssClass && radCssClass.ClassName.toLowerCase( )==cssAlias.toLowerCase( )){break; }}if (""!=cssAlias && this.ArrCssClasses.length==i){var index=this.ArrCssClasses.length; var radCssClass= {Tag: "\101\x4cL",Rule:null,Alias:cssAlias,ClassName:cssAlias } ; this.ArrCssClasses[index]=radCssClass; i=index; }else if (""==cssAlias){i=-1; } this.SelectCssClassByIndex(i); } ; CssClassSelector.prototype.GetRadCssClass= function (index){var cssClass=null; if (this.ArrCssClasses && 0<=index && index<this.ArrCssClasses.length){cssClass=this.ArrCssClasses[index]; }return cssClass; } ; CssClassSelector.prototype.GetSelectedClassName= function ( ){var radCssClass=this.GetRadCssClass(this.SelectedIndex); return (radCssClass?radCssClass.ClassName: ""); } ; CssClassSelector.prototype.ShowPopup= function (bShow){if (null==bShow)bShow= true; if (this.IsIE){if (bShow){if (this.PopupWnd){ this.PopupWnd.show(0,this.Table.offsetHeight,this.PopupWidth,this.PopupHeight,this.Table); }}else {if (this.PopupWnd){ this.PopupWnd.hide( ); }}}else {if (bShow){if (this.PopupWnd){ this.PopupWnd.show(0,this.Table.offsetHeight,this.PopupWidth,this.PopupHeight,this.Table); }}else {if (this.PopupWnd){ this.PopupWnd.hide( ); }}}} ; CssClassSelector.prototype.TogglePopup= function ( ){if (this.PopupWnd){ this.ShowPopup(!this.PopupWnd.isOpen); }} ; function PopupWindow( ){ this.Popup=document.createElement("\x53PAN"); this.isOpen= false; if (this.Popup){ this.Popup.className="R\x61dEDropDo\x77nTable"; this.Popup.style.backgroundColor="#FFFFFF"; this.Popup.style.position="ab\x73olute"; this.Popup.style.zIndex=51200; this.Popup.style.overflow="hidden"; this.Popup.style.display="\x6eone"; document.body.appendChild(this.Popup); }}PopupWindow.prototype.show= function (x,y,width,height,relElement){ this.isOpen= true; if (this.Popup){var left=0; var top=0; var arrCoords=this.GetElementCoords(relElement); left+=arrCoords[0]+x; top+=arrCoords[1]+y; this.Popup.style.position="absolute"; this.Popup.style.left=left; this.Popup.style.top=top; this.Popup.style.width=parseInt(width)+"px"; this.Popup.style.height=parseInt(height)+"p\x78"; this.Popup.style.display="";document.body.addEventListener("click",PopupWindow_OnMouseDown, true); window.ActivePopupWindow=this ; }} ; PopupWindow.prototype.hide= function ( ){ this.isOpen= false; if (this.Popup){document.body.removeEventListener("cli\x63k",PopupWindow_OnMouseDown, true); this.Popup.style.display="none";}window.ActivePopupWindow=null; } ; PopupWindow.prototype.GetElementCoords= function (element){var coords=new Array(0,0); if (element && element.offsetParent){while (element.offsetParent){coords[0]+=element.offsetLeft; coords[1]+=element.offsetTop; element=element.offsetParent; if (element==document.body){coords[0]-=element.offsetLeft; coords[1]-=element.offsetTop; }}}return coords; } ; function PopupWindow_OnMouseDown(e){var bPopupClicked= false; var el=e.target; while (!bPopupClicked && el && el!=el.parentNode){bPopupClicked=(el==window.ActivePopupWindow.Popup); el=el.parentNode; }if (window.ActivePopupWindow && !bPopupClicked){window.ActivePopupWindow.hide( ); }}function CssClassSelectorNS(id,radCssClassArray,strFilterTags,popupWidth,popupHeight,skinPath){ this.ID=id; this.DropDown=document.getElementById("\x43\x73\163\x43lass\x53elector\x5f"+id); this.SelectedIndex=-1; this.SkinPath=skinPath; this.Document=null; this.Initialize(radCssClassArray,strFilterTags); }CssClassSelectorNS.prototype.Initialize= function (radCssClassArray,strFilterTags){ this.ArrCssClasses=radCssClassArray; this.Document=window.document; this.InitOptions( ); } ; CssClassSelectorNS.prototype.InitOptions= function ( ){while (this.DropDown.options.length>0){ this.DropDown.options[0]=null; }try { this.AddCssClass("",null,localization["\x43l\x65\141\x72Style"],-1); for (var i=0; this.ArrCssClasses && i<this.ArrCssClasses.length; i++){ this.AddRadCssClass(this.ArrCssClasses[i],i); }}catch (ex){}} ; CssClassSelectorNS.prototype.AddRadCssClass= function (radCssClass,cssIndex){ this.AddCssClass(radCssClass.Tag,radCssClass.Rule,radCssClass.Alias,cssIndex); } ; CssClassSelectorNS.prototype.AddCssClass= function (tag,rule,alias,cssIndex){var opt=this.Document.createElement("\x4fPTION"); opt.text=alias; opt.value=cssIndex; if (null!=rule){ this.ApplyRule(opt,rule); if (""==opt.style.backgroundImage){opt.style.backgroundImage="url("+this.GetCssClassImageSrcByTag(tag)+"\x29"; opt.style.backgroundRepeat="\x6eo-re\x70\x65a\x74"; }var title=""; if (rule){title=rule.selectorText; }else {title=alias; }opt.setAttribute("\x74itle",title); } this.DropDown.options.add(opt); } ; CssClassSelectorNS.prototype.ApplyRule= function (element,rule){if (!element || !rule){return; }element.style.cssText=rule.style.cssText; var bgColor=element.style.backgroundColor.toLowerCase( ); var color=element.style.color.toLowerCase( ); if ((""==bgColor || "\043\x66fffff"==bgColor || "w\x68ite"==bgColor) && ("\x23fff\x66\146\x66"==color || "\x77hite"==color)){element.style.backgroundColor="#aaa\x61aa"; }element.style.width=""; element.style.height=""; } ; CssClassSelectorNS.prototype.GetCssClassImageSrcByTag= function (tag){var imgName=""; if (tag){tag=tag.toUpperCase( ); }switch (tag){case "\x41LL":case "\x41":case "\111\x4d\107":case "\x54ABLE":case "P":imgName=tag; break; default:imgName="\x43ustom"; break; }return this.SkinPath+"\111\x6d\147/\x63lass"+imgName+"\x2egif"; } ; CssClassSelectorNS.prototype.SelectCssClass= function (cssAlias){var selOption=null; var opt=null; var className=null; var index=-1; for (var i=0; i<this.DropDown.options.length; i++){opt=this.DropDown.options[i]; index=parseInt(opt.value); if (0<=index && this.ArrCssClasses && index<this.ArrCssClasses.length){className=this.ArrCssClasses[opt.value].ClassName; if (className.toLowerCase( )==cssAlias.toLowerCase( )){selOption=opt; break; }}}if (null==selOption && ""!=cssAlias && this.ArrCssClasses){var index=this.ArrCssClasses.length; var radCssClass= {Tag: "\101\x4cL",Rule:null,Alias:cssAlias,ClassName:cssAlias } ; this.ArrCssClasses[index]=radCssClass; this.AddRadCssClass(this.ArrCssClasses[index],index); selOption=this.DropDown.options[this.DropDown.options.length-1]; }else if (""==cssAlias){selOption=this.DropDown.options[0]; }if (null!=selOption){selOption.selected= true; }} ; CssClassSelectorNS.prototype.GetSelectedClassName= function ( ){var selOption=null; if (this.DropDown.selectedIndex>-1){selOption=this.DropDown.options[this.DropDown.selectedIndex]; }var className=""; if (selOption){var index=parseInt(selOption.value); if (-1<index && this.ArrCssClasses && index<this.ArrCssClasses.length){className=this.ArrCssClasses[selOption.value].ClassName; }}return className; } ;
var fileName,pathName; var deletePath= false; var deleteCheck= false; var selection= false; var submitForUpload; function submitDocumentsFile(fileBrowser){submitForUpload= true; var documentFileControl=document.getElementById(FileUploadID); if (trim(documentFileControl.value)==""){alert(localization["\x41\x6certf\x69le"]); documentFileControl.focus( ); submitForUpload= false; }else {var valid= false; fileName=documentFileControl.value; if (fileName.lastIndexOf("/")>=0){fileName=fileName.substr(fileName.lastIndexOf("/")+1); }if (fileName.lastIndexOf("\134")>=0){fileName=fileName.substr(fileName.lastIndexOf("\x5c")+1); }for (var i=0; i<documentFilters.length; i++){if (fileName.match(new RegExp(documentFilters[i].replace(/\x2e/gi,"\x5c.").replace(/\x2a/gi,"\056\x2b").replace(/\x3f/gi,"\x2e")+"\x24","i"))){valid= true; break; }}if (!valid){alert(localization["\x41lertva\x6c\151\x64"]); submitForUpload= false; }else {document.getElementById(fileDirID).value=fileBrowser.CurrentItem.GetPath( ); document.getElementById("\x6coader").innerHTML=localization["\x55ploadin\x67"]; showObject("lo\x61der"); }}}function changeTarget(control){document.getElementById("\x6cinkTa\x72\147\x65t").value=control.value; control.selectedIndex=0; }function DocumentPreviewer( ){ this.DocumentPath=""; this.AltTextHolder=document.getElementById("t\x6foltip"); }DocumentPreviewer.prototype.Clear= function ( ){};DocumentPreviewer.prototype.GetHtml= function ( ){if (this.DocumentPath){return "\x3cimg \x73\162\x63=\042"+this.DocumentPath+"\042\x20borde\x72\075\x220\042\x3e"; }else {return ""; }};DocumentPreviewer.prototype.LoadObjectFromPath= function (path){if (path){ this.DocumentPath=path; }} ; DocumentPreviewer.prototype.GetAltText= function ( ){return this.AltTextHolder.value; } ; DocumentPreviewer.prototype.SetAltText= function (altText){ this.AltTextHolder.value=altText; } ;
if (typeof window.RadControlsNamespace=="u\x6edef\x69\156\x65d"){window.RadControlsNamespace= {} ; }RadControlsNamespace.DomEventsMixin= function ( ){} ; RadControlsNamespace.DomEventsMixin.Initialize= function (obj){obj.AttachDomEvent=this.AttachDomEvent; obj.DetachDomEvent=this.DetachDomEvent; obj.DisposeDomEvents=this.DisposeDomEvents; obj.ClearEventPointers=this.ClearEventPointers; obj.RegisterForAutomaticDisposal=this.RegisterForAutomaticDisposal; obj.AutomaticDispose=this.AutomaticDispose; obj.CreateEventHandler=this.CreateEventHandler; obj.private_AttachDomEvent=this.private_AttachDomEvent; obj.ClearEventPointers( ); } ; RadControlsNamespace.DomEventsMixin.CreateEventHandler= function (methodName){var instance=this ; return function (e){if (!e)e=window.event; return instance[methodName](e); };} ; RadControlsNamespace.DomEventsMixin.AttachDomEvent= function (domElement,eventName,eventHandlerName){var eventHandler=this.CreateEventHandler(eventHandlerName); this._eventPointers[this._eventPointers.length]=[domElement,eventName,eventHandler]; this.private_AttachDomEvent(domElement,eventName,eventHandler); } ; RadControlsNamespace.DomEventsMixin.private_AttachDomEvent= function (domElement,eventName,eventHandler){if (domElement.attachEvent){domElement.attachEvent("on"+eventName,eventHandler); }else if (domElement.addEventListener){domElement.addEventListener(eventName,eventHandler, false); }} ; RadControlsNamespace.DomEventsMixin.DetachDomEvent= function (domElement,eventName,eventHandler){if (domElement.detachEvent){domElement.detachEvent("\x6fn"+eventName,eventHandler); }} ; RadControlsNamespace.DomEventsMixin.DisposeDomEvents= function ( ){for (var i=0; i<this._eventPointers.length; i++){ this.DetachDomEvent(this._eventPointers[i][0],this._eventPointers[i][1],this._eventPointers[i][2]); } this.ClearEventPointers( ); } ; RadControlsNamespace.DomEventsMixin.RegisterForAutomaticDisposal= function (customDisposeFunctionName){var me=this ; var customDisposeFunction=this.CreateEventHandler(customDisposeFunctionName); var automaticDispose= function ( ){customDisposeFunction( ); me.DisposeDomEvents( ); me=null; } ; this.private_AttachDomEvent(window,"unlo\x61d",automaticDispose); } ; RadControlsNamespace.DomEventsMixin.ClearEventPointers= function ( ){ this._eventPointers=[ ]; } ;
if (!activeDropDown)var activeDropDown=null; if (!onClickHandlerAttached)var onClickHandlerAttached= false; function DropDownMenu(menuButton,menuElement){ this.MenuButton=menuButton; this.MenuElement=menuElement; this.MenuEventHandler=null; var theDropDown=this ; if (!onClickHandlerAttached){if (document.all){document.attachEvent("\x6f\x6ecli\x63\x6b",theDropDown.BodyClickHandler); }else {document.addEventListener('clic\x6b',theDropDown.BodyClickHandler, true); }}}DropDownMenu.prototype.BodyClickHandler= function (e){if (!e){var e=window.event; }if (null!=activeDropDown){activeDropDown.SetVisible( false); }};DropDownMenu.prototype.Enable= function (isEnabled){if (this.IsValid( )){ this.MenuButton.disabled=isEnabled? false : true; }};DropDownMenu.prototype.IsValid= function ( ){return (null!=this.MenuButton) && (null!=this.MenuElement); };DropDownMenu.prototype.IsVisible= function ( ){return this.IsValid( ) && '\x76i\x73ible'==this.MenuElement.style.visibility; };DropDownMenu.prototype.Toggle= function ( ){ this.SetVisible(!this.IsVisible( )); };DropDownMenu.prototype.GetCoords= function (node){var coords=new Array(0,0); if (node.offsetParent){while (node.offsetParent){coords[0]+=node.offsetLeft; coords[1]+=node.offsetTop; node=node.offsetParent; if (node==document.body){coords[0]-=node.offsetLeft; coords[1]-=node.offsetTop; }}}return coords; };DropDownMenu.prototype.SetVisible= function (visible){if (this.IsValid( )){if (visible){if (activeDropDown){activeDropDown.SetVisible( false); }var coords=this.GetCoords(this.MenuButton); this.MenuElement.style.left=coords[0]+"\x70x"; this.MenuElement.style.top=(coords[1]+this.MenuButton.offsetHeight)+"\x70x"; this.MenuElement.style.zIndex=51200; this.MenuElement.style.overflow="\x68idden"; this.MenuElement.style.position="absol\x75te"; this.MenuElement.style.visibility="\x76isib\x6c\145"; }else { this.MenuElement.style.visibility='hidd\x65n'; }activeDropDown=visible?this :null; if (null!=this.MenuEventHandler && null!=this.MenuEventHandler.OnShowMenu){ this.MenuEventHandler.OnShowMenu(visible); }}};DropDownMenu.prototype.SetMenuInnerHtml= function (innerHtml){ this.MenuElement.innerHTML=innerHtml; };
var Rect_Fields=['\x72\x65ct_\x78','\x72ect_y','r\x65\143\x74_widt\x68','\x72ect_heig\x68\164']; function ShowRectPropsDlg(RectProps){var Form=document.forms[0]; for (var i=0; i<Rect_Fields.length; i++){Form[Rect_Fields[i]].disabled= false; }Form['\x72ect_x'].value=RectProps.x; Form['\x72ect_y'].value=RectProps.y; Form['rect_w\x69dth'].value=RectProps.width; if (CurrentArea.Shape.Type==AREA_SHAPE_CONSTANTS.RECTANGLE_TYPE){Form['r\x65ct_heig\x68t'].value=RectProps.height; }else if (CurrentArea.Shape.Type==AREA_SHAPE_CONSTANTS.CIRCLE_TYPE){Form['\x72ect_hei\x67\150\x74'].value=RectProps.width; Form['\x72ect\x5f\150\x65ight'].disabled= true; }}function CloseRectPropsDlg( ){var Form=document.forms[0]; for (var i=0; i<Rect_Fields.length; i++){Form[Rect_Fields[i]].value=''; Form[Rect_Fields[i]].disabled= true; }}function UpdateRectPropsDlg( ){var Form=document.forms[0]; var RectProps= {x:Form['re\x63t_x'].value,y:Form['r\x65ct_y'].value,width:Form['\x72ect_\x77\151\x64th'].value,height:Form['rect_hei\x67ht'].value } ; if (!UpdateRectProps(RectProps)){alert(localization.getText('AlertI\x6evalidPr\x6fperties')); ShowRectProps( ); return false; } ; return true; }var Area_Fields=['\x61re\x61\x5fli\x6ek','\x61rea_targ\x65\164','\x61\162\x65\x61_c\x6fmment','\x61rea_targ\x65\164\x5fselecto\x72']; var Area_Buttons=['\141\x72\145a\x5fupdate_\x62\165\x74ton','\x61rea\x5f\162e\x6dove_butt\x6fn']; function ShowAreaPropsDlg(AreaProps){var Form=document.forms[0]; for (var i=0; i<Area_Fields.length; i++){Form[Area_Fields[i]].disabled= false; }for (var i=0; i<Area_Buttons.length; i++){Form[Area_Buttons[i]].disabled= false; }if (AreaProps.Link){Form['\141\x72ea_lin\x6b'].value=AreaProps.Link; }else {Form['area\x5flink'].value='\x68tt\x70\072\x2f/'; }Form['area_ta\x72get'].value=AreaProps.Target; Form['ar\x65a_target\x5f\163\x65lecto\x72'].value=AreaProps.Target; Form['are\x61_comme\x6e\164'].value=AreaProps.Comment; ShowMapProps( ); }function UpdateAreaPropsDlg( ){var Form=document.forms[0]; if (Form['a\x72ea_upd\x61\164\x65_butt\x6fn'].disabled){return true; }if (!UpdateRectPropsDlg( )){return false; }var AreaProps= {Link:Form['a\x72ea_lin\x6b'].value,Comment:Form['\141\x72ea_c\x6fmment'].value,Target:Form['\x61rea_tar\x67\145\x74'].value } ; UpdateAreaProps(AreaProps); return true; }function CloseAreaPropsDlg( ){var Form=document.forms[0]; for (var i=0; i<Area_Fields.length; i++){Form[Area_Fields[i]].value=''; Form[Area_Fields[i]].disabled= true; }for (var i=0; i<Area_Buttons.length; i++){Form[Area_Buttons[i]].disabled= true; }CloseRectPropsDlg( ); DeselectCurrentArea( ); }function RemoveAreaDlg(RemoveAll){if (RemoveAll){if (!window.confirm(localization.getText('Alert\x44eleteAl\x6cAreas'))){return; }RemoveAllAreas( ); }else {if (!window.confirm(localization.getText('Alert\x44\145\x6ceteAre\x61'))){return; }RemoveArea( ); }}function ReturnNewImageMap( ){var ImageSrc=GetMapImageSrc( ); if (ImageSrc){if (UpdateAreaPropsDlg( )){var _props= {} ; _props.MapHtml=GetImageMapHTML( ); _props.ImageSrc=ImageSrc; CloseDlg(_props); }}else {CloseDlg( ); }}function GetMapImageSrc( ){var IMFrame=document.getElementById("ImageM\x61pFrame"); var IMDoc=IMFrame.contentWindow.document; var mappedImage=IMDoc.getElementById('mapp\x65dImage'); if (mappedImage!=null){return mappedImage.src; }return null; }function GetImageMapInitialProperties( ){return GetDialogArguments( ); ; }function InsertNewMapAreaDlg( ){InsertNewMapArea( ); }function InitImageMapFrame( ){var IMHTML=document.getElementById("Im\x61geMapHTM\x4c"); var IMFrame=document.getElementById("Imag\x65MapFrame"); var IMDoc=IMFrame.contentWindow.document; IMDoc.open( ); IMDoc.write('\074\x68tml>\x3c\150\x65\141d\x3e\074\x2fhead\x3e\074\x62ody s\x74yle\x20= \042\x6da\x72gin:0\x70x 0px\x200px 0p\x78;font\x3a11px\x20Aria\x6c; col\x6fr:red\x3bbackg\x72ound\x2dcolor\x3awhite\x3b\042\x20on\x63onte\x78tmen\x75=\042\x72e\x74urn f\x61lse\x22\040unse\x6cec\x74able\x3d\042\x6fn\x22>'+IMHTML.value+'\074\057\x62ody>\074\x2fht\x6dl>'); IMDoc.close( ); }
if (typeof(RadEditorNamespace)=="u\x6e\x64efin\x65d"){var RadEditorNamespace=new Object( ); }RadEditorNamespace.FileBrowserStaticPreloadedImages=['aif','\x61ifc','\x61iff','asf','a\x73\170','\x61u','avi','bmp','\x64oc','file','fla','fo\x6cder','gif','jpg','\x6d\061\x76','m3\x75','m\x69\144','mi\x64\151','\x6dp2','mp2v','mp\x33','\x6dpa','mpe','mpeg','mpg','\x6dpv2','pdf','p\x6e\147','\x72mi','snd','swf','\x74\151f','t\x69\146\x66','\x76m','\167\x61\166','wax','\x77ma','wmp','wm\x76','\x77mx','wv\x78']; RadEditorNamespace.FileBrowserDisplayMode= {} ; RadEditorNamespace.FileBrowserDisplayMode.Tree=0; RadEditorNamespace.FileBrowserDisplayMode.List=1; RadEditorNamespace.FileBrowser= function (id,fileListTable,skinPath,selectedItemParentPathHolder,selectedItemTypeHolder,selectedItemNameHolder,selectedItemTagHolder,newFolderDiv,newFolderNameHolder,newFolderButton,deleteButton,sortExtensionDirection,sortNameDirection,sortSizeDirection,refreshButtonLink,uniqueID,form){RadControlsNamespace.DomEventsMixin.Initialize(this ); this.SelectedItemParentPathHolder=selectedItemParentPathHolder; this.SelectedItemTypeHolder=selectedItemTypeHolder; this.SelectedItemNameHolder=selectedItemNameHolder; this.SelectedItemTagHolder=selectedItemTagHolder; this.FileListTable=fileListTable; this.FileListTableBody=fileListTable.tBodies[0]; this.SkinPath=skinPath; this.DisplayMode=RadEditorNamespace.FileBrowserDisplayMode.Tree; this.RootItem=null; this.CurrentItem=null; this.SelectedItem=null; this.private_BrowserTableElements=[ ]; this.private_PreloadedImages=[ ]; this.SortExpression="Name"; this.SortDirection="\x41SC"; this.SelectedRow=null; this.PreloadImages( ); this.OnClientClick=null; this.OnFolderChange=null; this.OnItemsRendered=null; this.XmlRequest=null; this.CurrentlyPolling= false; this.NewFolderDiv=newFolderDiv; this.NewFolderNameHolder=newFolderNameHolder; this.NewFolderButton=newFolderButton; this.DeleteButton=deleteButton; this.RefreshButtonLink=refreshButtonLink; this.SortDirectionButtons=[ ]; this.SortDirectionButtons["Exten\x73ion"]=sortExtensionDirection; this.SortDirectionButtons["\x4eame"]=sortNameDirection; this.SortDirectionButtons["\x53i\x7a\x65"]=sortSizeDirection; this.Form=form; this.UniqueID=uniqueID; this.ReadPermission=1; this.UploadPermission=2; this.DeletePermission=4; this.RegisterForAutomaticDisposal("Dispo\x73e"); };RadEditorNamespace.FileBrowser.prototype= {Dispose:function ( ){ this.DisposeElements(this.SortDirectionButtons); this.DisposeElements(this ); this.SkinPath=null; this.RootItem=null; this.CurrentItem=null; this.SelectedItem=null; this.private_BrowserTableElements=null; this.private_PreloadedImages=null; this.SortExpression=null; this.SortDirection=null; this.SelectedRow=null; this.OnClientClick=null; this.OnFolderChange=null; this.XmlRequest=null; this.CurrentlyPolling=null; this.SortDirectionButtons=null; this.UniqueID=null; this.ReadPermission=null; this.UploadPermission=null; this.DeletePermission=null; } ,DisposeElements:function (container){for (var property in container){if (container[property] && container[property].tagName){container[property]=null; }}} ,InitializeFileList:function (serializedRootItem,displayMode){ this.DisplayMode=displayMode; this.RootItem=new RadEditorNamespace.FileBrowserItem(serializedRootItem); this.CurrentItem=this.GetItem(this.RootItem.Children,this.SelectedItemParentPathHolder.value); if (this.CurrentItem==null){if (this.RootItem.Children.length==1){ this.CurrentItem=this.RootItem.Children[0]; }else { this.CurrentItem=this.RootItem; }} this.InitSelectedItem( ); var initiallySelectedItem=this.SelectedItem; this.SetCurrentDirectory( ); if (initiallySelectedItem!=null){ this.SetSelectedItemData(initiallySelectedItem); } this.RenderOnFolderChange( false); if (this.SelectedItem){ this.SelectItem(this.SelectedItem); }} ,GetItem:function (children,path){var currentItem=this.RootItem; for (var i=0; i<children.length; i++){var currentChild=children[i]; var currentChildPath=currentChild.GetPath( ); if (this.DisplayMode==RadEditorNamespace.FileBrowserDisplayMode.Tree){if (path.indexOf(currentChildPath)==0){if (path==currentChildPath){return currentChild; }else {return this.GetItem(currentChild.Children,path); }}}else {if (path==currentChildPath){return currentChild; }}}return null; } ,Render:function ( ){ this.Clear( ); if (this.CurrentItem.Parent!=null){ this.CreateRow("","..",this.private_PreloadedImages["F\x6flderUp"].cloneNode( true),"&nbsp;","\x47oUp",null); } this.SortItems( ); this.SetSortDirectionImage( ); for (var i=0; i<this.CurrentItem.Children.length; i++){ this.CreateBrowserItem(this.CurrentItem.Children[i]); }} ,GoUp:function (e){ this.CurrentItem=this.CurrentItem.Parent; this.SetCurrentDirectory( ); this.RenderOnFolderChange( true); } ,ChangeDirectory:function (e){var clickedRow=this.FindEventSender(e,"tr"); this.AddLoadingMessage(clickedRow.cells[1]); this.CurrentItem=clickedRow.browserItem; var me=this ; var changeDirectory= function ( ){me.SetCurrentDirectory( ); if (me.CurrentItem.Children.length==0){me.DoCallback( ); }else {me.RenderOnFolderChange( true); }} ; window.setTimeout(changeDirectory,1); } ,OnSelectItem:function (e){var clickedRow=this.FindEventSender(e,"tr"); this.SelectRow(clickedRow); var browserItem=clickedRow.browserItem; this.SetSelectedItemData(browserItem); this.SetButtonPermission(this.DeleteButton,this.DeletePermission,browserItem); if (this.OnClientClick){ this.OnClientClick(browserItem); }} ,SelectItem:function (browserItem){var selectedRow=this.GetItemRow(browserItem); if (selectedRow){ this.SelectRow(selectedRow); }} ,GetItemRow:function (browserItem){for (var i=0; i<this.FileListTableBody.rows.length; i++){var currentRow=this.FileListTableBody.rows[i]; if (currentRow.browserItem==browserItem){return currentRow; }}return null; } ,SelectRow:function (row){if (this.SelectedRow){ this.SelectedRow.className="\x54reeN\x6f\x64e\x44\145\x66ault"; }row.className="TreeNode\x53electe\x64"; this.SelectedRow=row; } ,InitSelectedItem:function ( ){if (this.SelectedItem==null && this.SelectedItemNameHolder.value!=""){ this.SelectedItem=this.GetChild(this.SelectedItemNameHolder.value); }return this.SelectedItem; } ,GetChild:function (name){for (var i=0; i<this.CurrentItem.Children.length; i++){var currentChild=this.CurrentItem.Children[i]; if (currentChild.Name==name){return currentChild; }}return null; } ,SetSortDirectionImage:function ( ){ this.SetElementBackgroundImage(this.SortDirectionButtons["Exte\x6esion"],this.SkinPath+"D\x69\141\x6cogs/emp\x74y.gif"); this.SetElementBackgroundImage(this.SortDirectionButtons["\x4ea\x6d\x65"],this.SkinPath+"Dialo\x67\163/\x65mpty.gi\x66"); this.SetElementBackgroundImage(this.SortDirectionButtons["Size"],this.SkinPath+"\x44ia\x6c\x6fgs\x2f\145\x6dpty.gi\x66"); this.SetElementBackgroundImage(this.SortDirectionButtons[this.SortExpression],this.SkinPath+"\x44ial\x6f\147s\x2f"+this.SortDirection+"\x2egif"); } ,SetElementBackgroundImage:function (element,imageUrl){element.style.backgroundImage="url("+imageUrl+")"; } ,SetSelectedItemData:function (browserItem){ this.SelectedItem=browserItem; this.SelectedItemTypeHolder.value=browserItem.Type; this.SelectedItemNameHolder.value=browserItem.Name; this.SelectedItemTagHolder.value=browserItem.Tag; } ,SetCurrentDirectory:function ( ){ this.SelectedItemParentPathHolder.value=this.CurrentItem.GetPath( ); this.SelectedItemTagHolder.value=this.CurrentItem.Tag; this.SelectedItem=this.CurrentItem; this.SelectedItemTypeHolder.value=''; this.SelectedItemNameHolder.value=''; } ,FindEventSender:function (e,senderTagName){var sender=e.srcElement?e.srcElement:e.target; while (sender){if (sender.tagName && sender.tagName.toLowerCase( )==senderTagName.toLowerCase( )){return sender; }sender=sender.parentNode; }return sender; } ,CreateBrowserItem:function (browserItem){if (browserItem.Type=='D'){if (window.RadControlsNamespace.Browser.IsSafari){ this.CreateBrowserItemRow(browserItem,"\x43h\x61\156\x67eDirect\x6f\162\x79",null); return; } this.CreateBrowserItemRow(browserItem,"\x4fn\x53\x65le\x63\164\x49\164\x65m","Chan\x67\145\x44irector\x79"); }else { this.CreateBrowserItemRow(browserItem,"\x4fnSelect\x49\164\x65m",null); }} ,CreateNewFolder:function ( ){if (this.CurrentItem.Permissions&this.UploadPermission){if (this.NewFolderDiv.style.display!="\156\x6fne"){ this.CancelNewFolderCreation( ); }else { this.NewFolderDiv.style.position="\x72elati\x76\145"; if (!this.NewFolderDiv.style.top)this.NewFolderDiv.style.top-=26; this.FileListTable.style.position="rel\x61tive"; this.FileListTable.style.top-=26; if (this.NewFolderDiv.style.filter!=null && this.NewFolderDiv.filters){ this.NewFolderDiv.style.filter="pr\x6fgid:DX\x49mageTra\x6e\163\x66orm.M\x69crosof\x74.Stret\x63h(st\x72etch\x73tyle=\x50USH)"; if (this.NewFolderDiv.filters[0]){ this.NewFolderDiv.filters[0].duration=.2; this.NewFolderDiv.filters[0].apply( ); this.NewFolderDiv.style.display="block"; this.NewFolderDiv.filters[0].play( ); }} this.NewFolderDiv.style.display="\x62lock"; this.NewFolderNameHolder.value=""; this.NewFolderNameHolder.focus( ); }}else {alert(localization["CREATE_\x4eOT_ALL\x4fWED_ALE\x52T"]); }return false; } ,CancelNewFolderCreation:function ( ){ this.NewFolderNameHolder.value=""; if (this.NewFolderDiv.style.display!="none"){ this.NewFolderDiv.style.display="n\x6fne"; this.FileListTable.style.top=""; }return false; } ,AddLoadingMessage:function (containerCell){containerCell.innerHTML+="\x26\x6e\x62sp;\x26nbsp;&n\x62\163\x70;&n\x62sp;&nb\x73p;\074\163\x70an s\x74yle=\047backg\x72ound-c\x6flor:\x23ffffcc\x3bborde\x72:1px\x20soli\x64 blac\x6b;\047\x3e L\x6fadin\x67...\074/span\x3e"; } ,SetButtonPermission:function (button,requiredPermission,comparisonItem){if (comparisonItem.Permissions&requiredPermission){button.disabled= false; button.parentNode.className=""; }else {button.disabled= true; button.parentNode.className="Disab\x6ced"; }} ,ConfirmDeletion:function ( ){if (this.SelectedItem){if (!(this.CurrentItem.Permissions && this.DeletePermission)){alert(localization["\x44ELET\x45\x5fN\x4f\124\x5fALLO\x57ED_ALER\x54"]); return false; }if (this.CurrentItem.Parent==null){alert(localization["ROOT_\x43ANNOT_\x42E_DELET\x45\104\x5fALER\x54"]); return false; }if (this.OnDelete!=null && !this.OnDelete(this.SelectedItem)){return false; }return confirm(localization[(this.SelectedItem.Type=="\x46")?"\x44ELETE_FI\x4cE_ALERT": "DELETE\x5f\106\x4fLDER_AL\x45\122\x54"]); }else {alert(localization["DE\x4cETE_NON\x45_ALERT"]); return false; }} ,RenderOnFolderChange:function (raiseOnFolderChange){ this.Render( ); this.SetButtonPermission(this.DeleteButton,this.DeletePermission,this.CurrentItem); this.SetButtonPermission(this.NewFolderButton,this.UploadPermission,this.CurrentItem); if (raiseOnFolderChange && this.OnFolderChange){ this.OnFolderChange(this.CurrentItem); }if (this.OnItemsRendered){ this.OnItemsRendered(this.CurrentItem); }} ,GetBrowserItemImage:function (browserItem){var preloadedImage=null; if (browserItem.Type=='D'){preloadedImage=this.private_PreloadedImages["fold\x65r"]; }else {var imageExtension=browserItem.Extension; imageExtension=imageExtension.substring(imageExtension.lastIndexOf(".")+1).toLowerCase( ); if (this.private_PreloadedImages[imageExtension]){preloadedImage=this.private_PreloadedImages[imageExtension]; }else {preloadedImage=this.private_PreloadedImages["file"]; }}return preloadedImage.cloneNode( true); } ,CreateBrowserItemRow:function (browserItem,click,dblClick){var theRow=this.CreateRow(browserItem.GetPath( ),browserItem.Name,this.GetBrowserItemImage(browserItem),browserItem.ShortSize,click,dblClick); theRow.browserItem=browserItem; } ,CreateRow:function (title,name,image,size,clickName,dblclickName){var row=this.FileListTableBody.insertRow(this.FileListTableBody.rows.length); row.className="Tre\x65NodeDef\x61ult"; row.title=title; if (clickName)this.AttachDomEvent(row,"\x63lick",clickName); if (dblclickName)this.AttachDomEvent(row,"db\x6c\143\x6c\x69c\x6b",dblclickName); var cell1=row.insertCell(row.cells.length); cell1.align="\x6diddle"; cell1.appendChild(image); var cell2=row.insertCell(row.cells.length); cell2.innerHTML=name; cell2.setAttribute("\x75ns\x65\x6cec\x74able","\x6fn"); var cell3=row.insertCell(row.cells.length); cell3.noWrap= true; cell3.innerHTML=size; return row; } ,Clear:function ( ){ this.DisposeDomEvents( ); var rowsCount=this.FileListTableBody.rows.length; for (var i=0; i<rowsCount; i++){var row=this.FileListTableBody.rows[0]; row.parentNode.removeChild(row); }} ,PreloadImages:function ( ){var originalImage=document.createElement("img"); var imageNames=RadEditorNamespace.FileBrowserStaticPreloadedImages; for (var i=0; i<imageNames.length; i++){ this.private_PreloadedImages[imageNames[i]]=this.FormatImage(originalImage.cloneNode( true),16,16,"\x44ialo\x67\x73/\x49mgExt/"+imageNames[i]+"\x2egif"); } this.private_PreloadedImages["\106\x6flderUp"]=this.FormatImage(originalImage.cloneNode( true),16,9,"Dialogs\x2fFolderU\x70\056\x67if"); } ,FormatImage:function (image,width,height,relativeSrc){image.width=width; image.height=height; image.src=this.SkinPath+relativeSrc; return image; } ,Sort:function (sortExpression){if (sortExpression==this.SortExpression){ this.SortDirection=(this.SortDirection=="D\x45SC")?"A\x53\103": "DESC"; }else { this.SortDirection="\x41SC"; this.SortExpression=sortExpression; } this.Render( ); } ,SortItems:function ( ){var me=this ; var comparer= function (item1,item2){return me.Compare(item1,item2,me.SortDirection,me.SortExpression); };this.CurrentItem.Children.sort(comparer); } ,Compare:function (item1,item2,compareDirection,compareExpression){var item1TypeNum=item1.Type=='\104'?1: 0; var item2TypeNum=item2.Type=='\x44'?1: 0; var result=item2TypeNum-item1TypeNum; if (result==0){var expression=(item1TypeNum==1 && item2TypeNum==1)?"\x4eame":compareExpression; var item1Field=(typeof(item1[expression])=="string")?item1[expression].toLowerCase( ):item1[expression]; var item2Field=(typeof(item2[expression])=="\x73trin\x67")?item2[expression].toLowerCase( ):item2[expression]; if (item1Field>item2Field)result=1; else if (item1Field<item2Field)result=-1; else result=0; }return compareDirection=="\x41SC"?result: -result; } ,DoCallback:function ( ){if (!this.CurrentlyPolling){ this.CurrentlyPolling= true; var xmlRequest=this.GetXmlRequest( ); if (xmlRequest){var url=document.location.href; xmlRequest.open("POST",url, true); xmlRequest.setRequestHeader("Cont\x65nt-Type","applica\x74\151\x6fn/x-www\x2dform-u\x72lencod\x65d"); var me=this ; xmlRequest.onreadystatechange= function ( ){if (xmlRequest.readyState!=4)return; var html=xmlRequest.responseText; if (html){var messageTokenLabel="MES\x53AGETOKEN\x3d"; var messageTokenIndex=html.indexOf(messageTokenLabel); if (messageTokenIndex>-1){var messageToken=html.substring(messageTokenIndex+messageTokenLabel.length); alert(localization[messageToken]); me.RefreshButtonLink.click( ); }else {me.LoadChildNodes(eval(html)); me.CurrentlyPolling= false; me.RenderOnFolderChange( true); }}} ; xmlRequest.send(this.GetPostData( )); }}} ,GetXmlRequest:function ( ){if (this.XmlRequest){}else {if (typeof(XMLHttpRequest)!="u\x6edefined"){ this.XmlRequest=new XMLHttpRequest( ); }if (typeof(ActiveXObject)!="undefi\x6eed"){ this.XmlRequest=new ActiveXObject("Mi\x63rosoft.\x58MLHTTP"); }}return this.XmlRequest; } ,GetPostData:function ( ){var postData=new RadEditorNamespace.PostData(this.Form); return postData.Get( )+"\x26file\x42\x72o\x77\163\x65\x72A\x6aaxLoad=\x74rue"; } ,LoadChildNodes:function (items){for (var i=0; i<items.length; i++){ this.CurrentItem.Children[this.CurrentItem.Children.length]=new RadEditorNamespace.FileBrowserItem(items[i],this.CurrentItem); }}};RadEditorNamespace.PostData= function (form){ this.Form=form; this.PostData=""; };RadEditorNamespace.PostData.prototype= {Get:function ( ){if (this.PostData==""){ this.BuildPostData( ); }return this.PostData; } ,private_AddToData:function (elementName,elementValue){if (this.PostData!=""){ this.PostData+="\x26";} this.PostData+=elementName+"="+this.EncodeData(elementValue); } ,BuildPostData:function ( ){try {for (var i=0; i<this.Form.elements.length; i++){var currentElement=this.Form.elements[i]; var tagName=currentElement.tagName.toLowerCase( ); switch (tagName){case "input":var type=currentElement.type; if ((type=="\x74ext" || type=="\x68idden" || type=="\x70asswo\x72\144" || ((type=="che\x63kbox" || type=="\x72adio") && currentElement.checked))){ this.private_AddToData(currentElement.name,currentElement.value); }break; case "\x73elect":for (var j=0; j<currentElement.childNodes.length; j++){var currentChild=currentElement.childNodes[j]; if (!currentChild.tagName)continue; if ((currentChild.tagName.toLowerCase( )=="optio\x6e") && (currentChild.selected== true)){ this.private_AddToData(currentElement.name,currentChild.value); }}break; case "t\x65xtarea": this.private_AddToData(currentElement.name,currentChild.value); break; }}}catch (e){}} ,EncodeData:function (value){return (encodeURIComponent)?encodeURIComponent(value):escape(value); }};
if (typeof(RadEditorNamespace)=="un\x64\x65fined"){var RadEditorNamespace=new Object( ); }RadEditorNamespace.FileBrowserItem= function (serializedItem,parent){ this.Parent=parent; this.Type=serializedItem[0]; this.Permissions=serializedItem[1]; this.Name=serializedItem[2]; this.Path=serializedItem[3]; this._url=serializedItem[4]?serializedItem[4]:null; this.Extension=serializedItem[5]; this.Size=serializedItem[6]; this.Tag=serializedItem[7]; this.ShortSize=(this.Type=="D")?"&\x6ebsp;": this.private_GetShortSize(this.Size); this.private_CombinedPath=null; this.private_CombinedPath=serializedItem[7]?serializedItem[7]:null; this.Attributes=serializedItem[8]; this.Children=[ ]; var children=serializedItem[9]; for (var i=0; i<children.length; i++){ this.Children[this.Children.length]=new RadEditorNamespace.FileBrowserItem(children[i],this ); }};RadEditorNamespace.FileBrowserItem.prototype= {GetPath:function ( ){if (this.private_CombinedPath==null){var combinedPath=this.Path+((this.Type=="D")?this.EndWithSlash(this.Name): this.Name); var currentParent=this.Parent; while (currentParent && currentParent.Parent!=null){combinedPath=currentParent.Path+this.EndWithSlash(currentParent.Name)+combinedPath; currentParent=currentParent.Parent; } this.private_CombinedPath=combinedPath; }return this.private_CombinedPath; } ,EndWithSlash:function (string){if (string.lastIndexOf("/")==(string.length-1)){return string; }return string+"\x2f"; } ,GetUrl:function ( ){if (this._url==null){return this.GetPath( ); }else {return this._url; }} ,IsThumbnail:function (suffix){return (this.GetOriginalImage(suffix)!=null); } ,GetOriginalImage:function (suffix){if (this.Parent){for (var i=0; i<this.Parent.Children.length; i++){var checkedItem=this.Parent.Children[i]; if (this.Name.toLowerCase( )==checkedItem.GetThumbnailName(suffix).toLowerCase( )){return checkedItem; }}}return null; } ,GetThumbnailName:function (suffix){return this.Name.substring(0,this.Name.lastIndexOf(this.Extension))+suffix+this.Extension; } ,private_GetShortSize:function (bytes){var kiloBytes=bytes/1024; var megaBytes=kiloBytes/1024; if (megaBytes>.8){return ""+Math.round(megaBytes*100)/100+" "+localization["Megabyt\x65s"]; }else if (kiloBytes>.8){return ""+Math.round(kiloBytes*100)/100+"\040"+localization["Kilobyte\x73"]; }else {return ""+bytes+"\x20"+localization["by\x74es"]; }}} ;
function FindAndReplaceControl(id,areaToSearch,selectionToSearch){ this.SearchWord=""; this.ReplaceWord=""; var oDoc=areaToSearch.ownerDocument; this.Window=oDoc.parentWindow?oDoc.parentWindow:oDoc.defaultView; this.SearchUp= false; this.SelectionOnly= false; this.WholeWord= false; this.CaseSensitive= false; this._replaceOccurrences=0; this._replace= false; this._initSearchExecuted= false; this._initRange=selectionToSearch; this._endRange=selectionToSearch; var loc=localization; this._messageReplaceComplete=loc["\106inis\x68edSear\x63hing"]+" "+loc["\x41ndHasMa\x64\145"]+" "; this._messageReplacements=" "+loc["\x52eplace\x6d\145\x6ets"]; this._messageSearchComplete=loc["Finishe\x64Search\x69ng"]; this._messageNothingToSearch=loc["\x53ea\x72\x63hC\x72iteriaNo\x74Spec\x69fied"]; this._messageSearchNotSupported="\x54his\x20\142r\x6fwser do\x65\163\x20not su\x70port s\x65archi\x6eg."; this.ResetEngine= function ( ){ this._replace= false; this._initSearchExecuted= false; this._replaceOccurrences=0; this._flippedOverEnd= false; } ; this.FinishSearch= function ( ){if (this._replace){alert(this._messageReplaceComplete+this._replaceOccurrences+this._messageReplacements); }else {alert(this._messageSearchComplete); } this.ResetEngine( ); } ; this.InitSearch= function ( ){if (this._initSearchExecuted)return; this._initSearchExecuted= true; if (!this.SearchWord){alert(this._messageNothingToSearch); return false; }var oR=this.GetRange( ); if (!this.Window.find && (oR && !oR.findText)){alert(this._messageSearchNotSupported); return false; }if (!(this.SelectionOnly && document.all)){ this._endRange=this.GetRange( ); } this.CollapseSelection(!this.SearchUp); } ; this.Replace= function ( ){if (!this.ReplaceNext( ))this.FinishSearch( ); } ; this.Find= function ( ){if (!this.FindNext( )){ this.FinishSearch( ); }} ; this.ReplaceAll= function ( ){ this._replaceOccurrences=0; var initOK=this.InitSearch( ); if ( false ==initOK)return initOK; while (this.ReplaceNext( )); this.CollapseSelection( ); this.FinishSearch( ); } ; this.ReplaceNext= function ( ){ this._replace= true; var toReplace= false; var matchFound= false; if (this.ReplaceWord==this.SearchWord){return false; }var range=this.GetRange( ); if (range){var oContent=this.GetHtmlText(range); if (oContent==this.SearchWord){toReplace= true; matchFound= true; }}if (!toReplace){matchFound=this.FindNext( ); }if (!matchFound)return false; this.DoReplace( ); this._replaceOccurrences++; return true; } ; this.SelectRange= function (oRange){if (oRange.select)oRange.select( ); else if (this.Window.getSelection){theSelection=this.Window.getSelection( ); theSelection.addRange(oRange); }} ; this.ResetSelectionRange= function ( ){ this._endRange=this._initRange; if (this._endRange)this.SelectRange(this._endRange); } ; }if (document.all && !window.opera){FindAndReplaceControl.prototype= {GetHtmlText:function (rng){return rng.htmlText; } ,GetRange:function ( ){if (this.Window.document.body.setActive)this.Window.document.body.setActive( ); var range=this.Window.document.selection.createRange( ); return range; } ,DoReplace:function ( ){var range=this.GetRange( ); var startRange=range.duplicate( ); var endRange=range.duplicate( ); startRange.collapse( true); endRange.collapse( false); range.pasteHTML($ektron.htmlEncode(this.ReplaceWord)); range.setEndPoint("Start\x54oStart",startRange); range.setEndPoint("En\x64ToEnd",endRange); range.select( ); } ,FindNext:function ( ){var initOK=this.InitSearch( ); if ( false ==initOK)return initOK; if (this.Window.document.body.setActive)this.Window.document.body.setActive( ); var rng=this._endRange.duplicate( ); if (!this.SelectionOnly){rng.collapse(this.SearchUp); }var flags=(this.WholeWord?2: 0)+(this.CaseSensitive?4: 0); var match=rng.findText(this.SearchWord,this.SearchUp?-1: 1,flags); if (match)rng.select( ); var curRange=this.GetRange( ); var outOfRange=this.SearchUp?-1: 1; if (this.SelectionOnly){var compareE2E=curRange.compareEndPoints("\x45nd\x54\157\x45nd",this._endRange); var compareS2S=curRange.compareEndPoints("\x53tartT\x6f\x53ta\x72t",this._endRange); if (compareE2E==compareS2S && compareE2E!=0){ this.CollapseSelection( ); return false; }}if (!match){if (this._flippedOverEnd){return match; }curRange=this.GetRange( ); curRange.moveToElementText(this.Window.document.body); curRange.collapse(!this.SearchUp); curRange.select( ); this._flippedOverEnd= true; match=curRange.findText(this.SearchWord,this.SearchUp?-1: 1,flags); }var dir=this.SearchUp?"\x45ndToSta\x72\164": "StartTo\x45\156d"; var compare=curRange.compareEndPoints(dir,this._endRange); if (compare==outOfRange && this._flippedOverEnd){match= false; }if (match && curRange){curRange.select( ); var newRange=curRange.duplicate( ); if (this.SearchUp){newRange.collapse( true); newRange.setEndPoint("\x53tar\x74\x54oS\x74art",this._endRange); }else {newRange.collapse( false); newRange.setEndPoint("\x45ndTo\x45\156\x64",this._endRange); } this._endRange=newRange; }return match; } ,CollapseSelection:function (dir){var range=this.Window.document.selection.createRange( ); range.collapse(dir); range.select( ); }} ; }else if (window.find){FindAndReplaceControl.prototype= {GetHtmlText:function (rng){var myDiv=this.Window.document.createElement("div"); var clonedFragment=rng.cloneContents( ); myDiv.appendChild(clonedFragment); return myDiv.innerHTML; } ,GetRange:function ( ){var theSelection=this.Window.getSelection( ); var range=null; if (theSelection.getRangeAt){try {range=theSelection.getRangeAt(0); }catch (e){} ; }return range; } ,DoReplace:function ( ){var range=this.GetRange( ); if (range)range.deleteContents( ); var insertNode=this.Window.document.createTextNode(this.ReplaceWord); var container=range.startContainer; var startPosition=range.startOffset; if (container.insertData){container.insertData(startPosition,insertNode.nodeValue); range.setEnd(container,startPosition+insertNode.length); range.setStart(container,startPosition); var theSelection=this.Window.getSelection( ); theSelection.removeAllRanges( ); theSelection.addRange(range); }} ,FindNext:function ( ){var initOK=this.InitSearch( ); if ( false ==initOK)return initOK; var outOfRange=this.SearchUp?-1: 1; var beforeRange=this.SearchUp?1: -1; var range1=this.GetRange( ); this.CollapseSelection(this.SearchUp); var match=this.Window.find(this.SearchWord,this.CaseSensitive,this.SearchUp, true , false , true , false); var match2= false; if (match){match2=this.CheckWholeWord( ); var range2=this.GetRange( ); var dir=this.SearchUp?Range.END_TO_END:Range.START_TO_START; var compare=range2.compareBoundaryPoints(dir,this._endRange); if (this.SelectionOnly){var compareE2E=range2.compareBoundaryPoints(Range.END_TO_END,this._endRange); var compareS2S=range2.compareBoundaryPoints(Range.START_TO_START,this._endRange); if (compareE2E==compareS2S && compareE2E!=0){ this.CollapseSelection( ); return false; }}if (!this._flippedOverEnd){var dir2=this.SearchUp?Range.END_TO_START:Range.START_TO_END; var compare2=range2.compareBoundaryPoints(dir2,range1); if (beforeRange==compare2 || 0==compare2){ this._flippedOverEnd= true; }}if (beforeRange==compare){ this._flippedOverEnd= true; }else if (this._flippedOverEnd && (0==compare || outOfRange==compare)){ this.CollapseSelection( ); return false; }var oStart=range1.compareBoundaryPoints(Range.START_TO_START,range2); var oEnd=range1.compareBoundaryPoints(Range.END_TO_END,range2); if ((oStart==0 && oEnd==0)){return false; }}if (match && !match2){return this.FindNext( ); }var curRange=this.GetRange( ); if (this.SelectionOnly){var dir=this.SearchUp?Range.START_TO_START:Range.END_TO_END; var compare=curRange.compareBoundaryPoints(dir,this._endRange); if (compare==outOfRange){ this.CollapseSelection( ); return false; }}return match; } ,CollapseSelection:function (dir){var selection=this.Window.getSelection( ); try {if ( true ==dir)selection.collapseToStart( ); else selection.collapseToEnd( ); }catch (e){} ; } ,CheckWholeWord:function ( ){if (!this.WholeWord)return true; var range=this.GetRange( ); if (!range)return false; var container=range.startContainer; var startPosition=range.startOffset; var endPosition=range.endOffset; var before=container.nodeValue.charAt(startPosition-1); var after=container.nodeValue.charAt(endPosition); var success=((0==before.length ||/\W/.test(before)) && (0==after.length ||/\W/.test(after))); if (!success){ this.CollapseSelection( ); }return success; }} ; }
function submitFlashFile(fleBrowser){submitForUpload= true; var flashFileControl=document.getElementById(FileUploadID); if (trim(flashFileControl.value)==""){alert(localization["\x41\x6certf\x69le"]); flashFileControl.focus( ); submitForUpload= false; }else {document.getElementById(fileDirID).value=fileBrowser.CurrentItem.GetPath( ); document.getElementById("\x6coader").innerHTML=localization["\x55pload\x69\x6eg"]; showObject("\x6coader"); }}var fileName,pathName; var deletePath= false; var selection= true; var dropDownFlash; var submitForUpload; function additionalColor(color){var control=document.getElementById("\x62ack\x67roundCo\x6cor"); var options=control.getElementsByTagName("OPTION"); option=document.createElement("OPTION"); option.innerHTML=localization["Cust\x6fmh"]+color; option.value=color; option.selected= true; option.style.backgroundColor=color; control.insertBefore(option,options[8]); }function getParameterValue(object,name){for (var i=0; i<object.childNodes.length; i++){if ((object.childNodes[i].tagName.toUpperCase( )=="PA\x52AM") && (object.childNodes[i].name.toUpperCase( )==name.toUpperCase( ))){return object.childNodes[i].value; }}return null; }function enableClass(enable){document.getElementById("\x63lassID").disabled=!enable; document.getElementById("v\x65rsion").disabled=!enable; if (enable){showObject("classI\x44Row1"); showObject("\x63la\x73\163\x49DRow2"); }else {document.getElementById("classID").value=""; hideObject("\x63lassID\x52\157\x771"); hideObject("cl\x61ssIDRow2"); }}var isPreviewerInPreviewMode= false; function FlashPreviewer( ){ this.FlashPath=""; this.StripAbsolutePath= true; }FlashPreviewer.prototype.CreateParam= function (name,value,asText){var paramText="\074param na\x6de=\042"+name+"\x22 value=\x22"+value+"\x22>"; return asText?paramText:document.createElement(paramText); };FlashPreviewer.prototype.CreateFlashEmbed= function (asText,oParams){if (asText){var oText="\074\145\x6dbed "; for (var member in oParams){oText+="\x20"+member+"\x3d\042"+oParams[member]+"\042"; }oText+="\x3e\074/embed>"; return oText; }else {var object=document.createElement("\x45MBED"); for (var member in oParams){object.setAttribute(member,oParams[member]); }return object; }};FlashPreviewer.prototype.Clear= function ( ){ this.SetDefaultValues(document.getElementById("P\x72opertie\x73Pane")); };FlashPreviewer.prototype.GetHtml= function ( ){var browserItem=fileBrowser.SelectedItem; var movieSrc=browserItem!=null?browserItem.GetUrl( ):null; if (movieSrc){if (document.all && ( false ==this.StripAbsolutePath)){var oImg=document.createElement("I\x4dG"); oImg.setAttribute("\x73rc",movieSrc); movieSrc=oImg.src; }var oEmbedParams= {} ; oEmbedParams["src"]=movieSrc; var currentPropertyHolder=null; currentPropertyHolder=document.getElementById("loop\x59es"); oEmbedParams["loo\x70"]=currentPropertyHolder.checked.toString( ); currentPropertyHolder=document.getElementById("me\x6euYes");oEmbedParams["menu"]=currentPropertyHolder.checked.toString( ); oEmbedParams["qual\x69ty"]=document.getElementById("qu\x61lity").value; oEmbedParams["sa\x6cign"]=document.getElementById("fla\x73hAlign").value; oEmbedParams["ali\x67n"]=document.getElementById("\x68tmlA\x6c\151\x67n").value; oEmbedParams["\x62gcolor"]=document.getElementById("ba\x63kground\x43olor").value; oEmbedParams["\167\x69dth"]=document.getElementById("f\x6cashWidt\x68").value; oEmbedParams["\x68eigh\x74"]=document.getElementById("fla\x73hHeigh\x74").value; oEmbedParams["\x74ype"]="applic\x61\164i\x6fn/x-shoc\x6bwave\x2dflash"; oEmbedParams["pluginsp\x61ge"]="\x68tt\x70\x3a//\x77ww.macr\x6f\155\x65dia.co\x6d/go/ge\x74flash\x70lay\x65\162"; if (document.getElementById("\x74ra\x6e\163\x70arentYe\x73").checked){oEmbedParams["wmo\x64e"]="tr\x61nsparent"; }if ((document.all) && (document.getElementById("\143\x6cassYe\x73").checked)){var oObjectAttributes= {} ; var oObjectParams= {} ; oObjectAttributes["\x63la\x73\x73id"]=document.getElementById("\143\x6cassID").value; oObjectAttributes["\x63od\x65\x62as\x65"]="\x68ttp\x3a\x2f/d\x6fwnload.\x6dacromed\x69a.com/\x70\165\x62/sho\x63kwav\x65/cabs\x2fflash/\x73wflas\x68.cab\x23versio\x6e="+document.getElementById("\x76ersi\x6f\156").value+"\x2c0,0\x2c\060\x22 "; oObjectAttributes["\x77id\x74\x68"]=document.getElementById("\x66la\x73\150\x57idth").value; oObjectAttributes["\x68eight"]=document.getElementById("\x66lashHeig\x68t").value; oObjectAttributes["\141\x6cign"]=document.getElementById("html\x41lign").value; oObjectParams["\x6dovie"]=movieSrc; oObjectParams["src"]=movieSrc; currentPropertyHolder=document.getElementById("\x70layYes"); oObjectParams["p\x6cay"]=currentPropertyHolder.checked.toString( ); currentPropertyHolder=document.getElementById("\154\x6fopYes"); oObjectParams["loo\x70"]=currentPropertyHolder.checked.toString( ); currentPropertyHolder=document.getElementById("\x6denuYes"); oObjectParams["menu"]=currentPropertyHolder.checked.toString( ); oObjectParams["quality"]=document.getElementById("qual\x69ty").value; oObjectParams["\x73alig\x6e"]=document.getElementById("\146\x6cashAl\x69gn").value; oObjectParams["\x62gco\x6c\157\x72"]=document.getElementById("\x62ackgroun\x64Color").value; if (document.getElementById("tr\x61nspare\x6etYes").checked){oObjectParams["w\x6dode"]="t\x72ansparen\x74"; }var oText="\x3cobje\x63\x74 "; for (var member in oObjectAttributes){oText+=" "+member+"=\x22"+oObjectAttributes[member]+"\x22"; }oText+=">"; for (var member in oObjectParams){oText+="\x20"+this.CreateParam(member,oObjectParams[member], true); }oText+=this.CreateFlashEmbed( true ,oEmbedParams)+"\x3c/o\x62\152\x65ct>"; return oText; }return this.CreateFlashEmbed( true ,oEmbedParams); }return null; } ; FlashPreviewer.prototype.LoadObjectFromPath= function (path){} ; FlashPreviewer.prototype.SetDefaultValues= function (elem){if (!elem)return; if (elem.attributes && elem.attributes["\x64efau\x6c\164\x76alue"]){var attr=elem.attributes["defa\x75ltvalue"].value; if (elem.tagName=="\x49NPUT"){var elemType=elem.getAttribute("\164\x79pe",0).toLowerCase( ); if (elemType=="che\x63\153b\x6fx"){elem.checked=eval(attr); }else if (elemType=="text"){elem.setAttribute("v\x61lue",attr); }}else if (elem.tagName && (elem.tagName=="DIV" || elem.tagName=="\x54D")){elem.innerHTML=attr; }else if (elem.tagName && elem.tagName=="SELE\x43T"){selectOption(elem,attr); }}if (elem.childNodes && elem.childNodes.length>0){for (var broi=0; broi<elem.childNodes.length; broi++){ this.SetDefaultValues(elem.childNodes[broi]); }}} ; FlashPreviewer.prototype.SwitchPreviewMode= function (browserItem,fileFullName,dialogArgs){isPreviewerInPreviewMode=!isPreviewerInPreviewMode; this.Preview(browserItem,fileFullName,dialogArgs); } ; FlashPreviewer.prototype.Preview= function (browserItem,defaultlyPreviewedFileFullName,dialogArgs){if ((browserItem!=null) && (browserItem.Type!="D")){if (defaultlyPreviewedFileFullName==browserItem.GetUrl( )){ this.PreviewCurrentMode( true ,dialogArgs); }else { this.PreviewCurrentMode( false ,dialogArgs); }}else { this.Clear( ); document.getElementById("\x50rev\x69\145\x77Objec\x74\110\x6flder").innerHTML=""; document.getElementById("\x50ropert\x69\145\x73Pane").style.display="n\x6f\156e"; document.getElementById("Preview\x50ane").style.display="\x6eone"; document.getElementById("\x45mp\x74\171\x50ane").style.display="\151\x6e\x6cin\x65"; }} ; FlashPreviewer.prototype.PreviewCurrentMode= function (isLoadingNeeded,dialogArgs){document.getElementById("\x45mpt\x79\x50an\x65").style.display="none"; var divPropertiesPane=document.getElementById("Pr\x6fperties\x50ane"); var divPreviewPane=document.getElementById("Previ\x65wPane"); var previewObjectHolder=document.getElementById("\x50re\x76\151\x65wObjec\x74Holder"); if (isLoadingNeeded){LoadFlashProperties(dialogArgs); }else { this.Clear( ); }previewObjectHolder.innerHTML=""; if (isPreviewerInPreviewMode){divPropertiesPane.style.display="\x6eone"; divPreviewPane.style.display="inline"; previewObjectHolder.innerHTML=this.GetHtml( ); }else {divPreviewPane.style.display="\x6eone"; divPropertiesPane.style.display="\x69nl\x69\x6ee"; }} ; function LoadFlashProperties(dialogArgs){var flashObject=dialogArgs.Flash; var isObject=flashObject.tagName.toUpperCase( )=="\x4fBJEC\x54"; if (!isObject && !flashObject.tagName.toUpperCase( )=="EMB\x45D")return; var oParams= {} ; oParams["loop"]=isObject?getParameterValue(flashObject.Flash,"\x6coop"):flashObject.getAttribute("loo\x70"); oParams["\x6denu"]=isObject?getParameterValue(flashObject,"me\x6eu"):flashObject.getAttribute("\x6denu"); oParams["\x71uali\x74\171"]=isObject?getParameterValue(flashObject,"q\x75\141\x6c\151\x74\171"):flashObject.getAttribute("\x71uality"); oParams["\x73al\x69\x67n"]=isObject?getParameterValue(flashObject,"\x73align"):flashObject.getAttribute("salign"); oParams["bgcolor"]=isObject?getParameterValue(flashObject,"\x62gcolor"):flashObject.getAttribute("bgcol\x6fr"); oParams["\x77mode"]=isObject?getParameterValue(flashObject,"\x77mode"):flashObject.getAttribute("wmode"); oParams["\x77idth"]=flashObject.width; oParams["heigh\x74"]=flashObject.height; oParams["\x61li\x67\x6e"]=flashObject.align; if (flashObject.tagName.toUpperCase( )=="OB\x4aECT"){document.getElementById("class\x59es").checked= true; document.getElementById("class\x49D").disabled= false; document.getElementById("vers\x69on").disabled= false; document.getElementById("classID").value=flashObject.classid; if (flashObject.codeBase.match(/(\x36\x2c\x30\x2c\x30\x2c\x30)$/gi)){document.getElementById("\x76\x65\162\x73ion").selectedIndex=1; }showObject("cla\x73\163I\x44Row"); }document.getElementById("\146\x6c\x61sh\x57\151\x64\164h").value=oParams["\167\x69\x64th"]; document.getElementById("fl\x61shHeigh\x74").value=oParams["\x68eight"]; selectOption(document.getElementById("\150\x74mlAli\x67n"),oParams["\x61lign"]); if (oParams["\x71uality"]){selectOption(document.getElementById("\x71uality"),oParams["\x71ua\x6c\x69ty"]); }if (oParams["\x70lay"]){document.getElementById("\x70layYe\x73").checked=eval(oParams["play"]); }if (oParams["\x6coop"]){document.getElementById("\x6coopYes").checked=eval(oParams["\x6coop"]); }if (oParams["menu"]){document.getElementById("me\x6euYes").checked=eval(oParams["menu"]); }if (oParams["wmode"]){document.getElementById("\164\x72ansparen\x74Yes").checked=(oParams["w\x6dode"]=="tran\x73parent"? true : false); }if (oParams["a\x6cign"]){selectOption(document.getElementById("\146\x6cashAlig\x6e"),oParams["\x61lign"]); }if (oParams["bgc\x6flor"] && (!selectOption(document.getElementById("\142\x61ckgrou\x6edColor"),oParams["\x62gcol\x6f\162"]))){additionalColor(oParams["b\x67\143\x6f\x6cor"]); }}
var SyntaxHighlighter= {Brushes:{} ,Version: '1\x2e\x33.0' };var sh=SyntaxHighlighter; sh.Match= function (value,index,cssStyle){ this.value=value; this.index=index; this.length=value.length; this.cssStyle=cssStyle; };sh.Highlighter= function ( ){ this.showLineNumbers= true; this.tabsToSpaces= true; };sh.Highlighter.prototype.GetMatches= function (regex,cssStyle){var index=0; var match=null; while ((match=regex.exec(this.code))!=null){ this.matches[this.matches.length]=new sh.Match(match[0],match.index,cssStyle); }};sh.Highlighter.prototype.FormatChunk= function (str,cssStyle){var font=document.createElement('font'); str=str.replace(/\x26/g,'&am\x70;'); str=str.replace(/\x20/g,'\x26nbsp;'); str=str.replace(/\x3c/g,'&lt;'); str=str.replace(/\x0a/gm,'\x26nbsp;\x3c\142\x72>'); if (cssStyle!=null){var regex=new RegExp('\x3cbr>','\x67\151'); if (regex.test(str)){var lines=str.split('\x26nbsp;\074br>'); str=''; for (var i=0; i<lines.length; i++){ this.container.innerHTML+='\x3cfont \x73\164\x79le = \x22'+cssStyle+'\x22>'+lines[i]+'\x3c/font>'; if (i+1<lines.length)this.container.appendChild(document.createElement('\x42R')); }}else {font.style.cssText=cssStyle; font.innerHTML=str; this.container.appendChild(font); }}else {font.style.cssText='fo\x6et-size: \x311px'; font.innerHTML=str; this.container.appendChild(font); }};sh.Highlighter.prototype.IsInside= function (match){if (match==null || match.length==0)return; for (var i=0; i<this.matches.length; i++){var c=this.matches[i]; if (c==null)continue; if ((match.index>c.index) && (match.index<=c.index+c.length))return true; }return false; };sh.Highlighter.prototype.ProcessRegexList= function ( ){for (var i=0; i<this.regexList.length; i++)this.GetMatches(this.regexList[i].regex,this.regexList[i].cssStyle); };sh.Highlighter.prototype.ProcessSmartTabs= function (code){var lines=code.split('\x0a'); var result=''; var tabSize=4; var tab='\x09'; function InsertSpaces(line,pos,count){var left=line.substr(0,pos); var right=line.substr(pos+1,line.length); var spaces=''; for (var i=0; i<count; i++)spaces+=' '; return left+spaces+right; }function ProcessLine(line,tabSize){if (line.indexOf(tab)==-1)return line; var pos=0; while ((pos=line.indexOf(tab))!=-1){var spaces=tabSize-pos%tabSize; line=InsertSpaces(line,pos,spaces); }return line; }for (var i=0; i<lines.length; i++)result+=ProcessLine(lines[i],tabSize)+'\012'; return result; };sh.Highlighter.prototype.SwitchToTable= function ( ){var html=this.container.innerHTML.replace(/\x3c(\x62\x72)\x2f?\x3e/gi,'\012'); var lines=html.split('\x0a'); var arrhtml=[ ]; arrhtml.push('\x3ctable c\x65\154\x6cpadding\x3d0 cel\x6cspaci\x6eg=0 st\x79le=\042widt\x68: 99%;\x09marg\x69n: 2p\x78 0px 2\x70x 0px\x3bborde\x72-co\x6clapse\x3a coll\x61pse;b\x6frder\x2dbotto\x6d: 2px\x20soli\x64 #ee\x65;back\x67roun\x64-col\x6fr: #\x66ff;\011bord\x65r\x2dwi\x64th:0\x70x;\042>'); if (this.showLineNumbers){arrhtml.push('\x3ccol sty\x6c\145\x3d\042\x66ont-f\x61mily: C\x6furier \x4eew;f\x6fnt-si\x7ae: 11\x70x;back\x67round\x2dcolor\x3a #eee\x3bpaddi\x6eg-ri\x67ht: 5\x70x; pa\x64ding\x2dleft:\x2010px;\x20widt\x68: 5p\x78; bo\x72der-r\x69ght:\x201px \x73olid\x20gray\x3b col\x6fr: \x67ray\x3btext\x2dalig\x6e: r\x69ght;\x76erti\x63al-\x61lign\x3a to\x70;\042\057\x3e'); }arrhtml.push('\074col styl\x65=\042\x66ont-f\x61mily: \x43ourier\x20New;fo\x6et-si\x7ae: 11\x70x;pad\x64ing-l\x65ft: 1\x30px;bo\x72der-b\x6fttom:\x201px \x73olid \x23F7F7\x467;wh\x69te-sp\x61ce:n\x6fwrap\x3b\042\x2f>'); for (var i=0,lineIndex=1; i<lines.length-1; i++,lineIndex++){arrhtml.push('\x3ctr>'); if (this.showLineNumbers){arrhtml.push('\x3ctd>\074nobr>'+lineIndex+'\x3c/nobr>\x3c\x2ftd\x3e'); }var styleAddon=''; if ((i%2+1)==2){styleAddon='\x20st\x79\x6ce=\x22backgro\x75\156\x64-color\x3a #F7F7\x46\067\x3b\042'; }arrhtml.push('\074\x74d '+styleAddon+'\x3e'+lines[i]+'\x3c/td>'); arrhtml.push('\074\x2ftr>'); }arrhtml.push('\074\x2fta\x62\x6ce\x3e'); return arrhtml.join(''); };sh.Highlighter.prototype.Highlight= function (code){function Trim(str){return str.replace(/^\s*(.*?)[\s\x0a]*$/g,'\x241'); }function Chop(str){return str.replace(/\x0a*$/,'').replace(/^\x0a*/,''); }function Unindent(str){var lines=str.split('\x0a'); var indents=new Array( ); var regex=new RegExp('^\134\163*','\x67'); var min=1000; for (var i=0; i<lines.length && min>0; i++){if (Trim(lines[i]).length==0)continue; var matches=regex.exec(lines[i]); if (matches!=null && matches.length>0)min=Math.min(matches[0].length,min); }if (min>0)for (var i=0; i<lines.length; i++)lines[i]=lines[i].substr(min); return lines.join('\012'); }function Copy(string,pos1,pos2){return string.substr(pos1,pos2-pos1); }var pos=0; this.originalCode=code; this.code=Chop(Unindent(code)); this.code=code; this.container=document.createElement('DIV'); this.matches=new Array( ); if (this.tabsToSpaces== true)this.code=this.ProcessSmartTabs(this.code); this.ProcessRegexList( ); if (this.matches.length==0){ this.FormatChunk(this.code,null); return this.SwitchToTable( ); }function SortCallback(m1,m2){if (m1.index<m2.index)return -1; else if (m1.index>m2.index)return 1; else {if (m1.length<m2.length)return -1; else if (m1.length>m2.length)return 1; }return 0; } this.matches=this.matches.sort(SortCallback); for (var i=0; i<this.matches.length; i++)if (this.IsInside(this.matches[i]))this.matches[i]=null; for (var i=0; i<this.matches.length; i++){var match=this.matches[i]; if (match==null || match.length==0)continue; this.FormatChunk(Copy(this.code,pos,match.index),null); this.FormatChunk(match.value,match.cssStyle); pos=match.index+match.length; } this.FormatChunk(this.code.substr(pos),null); return this.SwitchToTable( ); };sh.Highlighter.prototype.GetKeywords= function (str){return '\x5cb'+str.replace(/\x20/g,'\x5cb|\x5c\142')+'\134\x62'; };sh.HighlightAll= function (code,langID,showLineNumbers){if (!sh.Brushes[langID]){return code; }var highlighter=new sh.Brushes[langID]( ); highlighter.showLineNumbers=(showLineNumbers)? true : false; return highlighter.Highlight(code); };sh.Brushes.CSharp= function ( ){var keywords='\x61bstrac\x74\x20a\x73\040\x62ase bo\x6fl brea\x6b\040\x62yte c\x61se \x63atch c\x68ar ch\x65cked \x63lass \x63onst '+'cont\x69\156u\x65 decimal\x20default\x20delega\x74\145\x20do dou\x62le \x65\154\x73e enu\x6d event\x20expl\x69cit '+'\x65xte\x72\156 \x66alse fi\x6eally fi\x78ed flo\x61\164\x20\146\x6fr f\x6freach \x67et go\x74o if i\x6dplic\x69t in i\x6et '+'\x69nterf\x61\143\x65\040\x69nternal\x20is loc\x6b\040\x6cong n\x61mesp\x61ce ne\x77 null \x6fbject\x20opera\x74or ou\x74 '+'override\x20\160\x61\162a\x6ds priva\x74e prote\x63ted pu\x62lic \x72eadon\x6cy ref \x72eturn\x20sbyte\x20sealed\x20set '+'s\x68\x6frt \x73izeof st\x61ckalloc\x20static \x73tring \x73\164\x72uc\x74 switc\x68 this\x20throw\x20true \x74ry '+'\x74yp\x65\x6ff \x75int ulo\x6eg unche\x63ked un\x73\141\x66e ush\x6frt \x75\163\x69ng vi\x72tual \x76oid w\x68ile'; this.regexList=[ {regex:new RegExp('\x2f/.*$','gm'),cssStyle: '\x63olo\x72\x3a g\x72een;' } , {regex:new RegExp('\x2f\134\x2a[\134\x73\134\x53]*?\x5c*/','\x67'),cssStyle: 'color:\x20\147\x72een;' } , {regex:new RegExp('\x22(\x3f\072\x5c.|\x5b\136\x5c\x22\x22\x5d)*\x22','\x67'),cssStyle: '\x63olo\x72\072\x20blue;' } , {regex:new RegExp('^\134\x73*#.\x2a','gm'),cssStyle: 'colo\x72: gray;' } , {regex:new RegExp(this.GetKeywords(keywords),'gm'),cssStyle: 'co\x6cor: blue\x3b' } ]; };sh.Brushes.CSharp.prototype=new sh.Highlighter( ); sh.Brushes.CSharp.Aliases=['c#','c-sha\x72p','\143\x73\150a\x72p']; sh.Brushes.Delphi= function ( ){var keywords='a\x62s addr a\x6ed ansic\x68ar ans\x69string\x20array \x61\163\x20asm\x20begin\x20boolea\x6e byte\x20card\x69nal '+'\143\x61\x73e \x63\150\x61\x72 c\x6cass co\x6d\160\x20\143\x6fnst \x63onstr\x75ctor c\x75rrenc\x79 dest\x72uctor \x64iv d\x6f doub\x6ce '+'downto \x65\x6cse\x20end exc\x65pt exp\x6frts ex\x74ended \x66alse\x20file \x66inali\x7a\141\x74ion f\x69nall\x79 '+'f\x6f\162 \x66\165\x6e\143t\x69on got\x6f\040\x69f impl\x65menta\x74ion \x69n inhe\x72ited \x69nt64 \x69nitia\x6cizatio\x6e '+'\x69nteg\x65\162 \x69nterfac\x65 is lab\x65l libr\x61\162\x79 long\x69nt l\x6fngword\x20mod n\x69l not\x20object\x20'+'of on\x20\157\x72\040\x70acked p\x61nsicha\x72\040\x70ansist\x72ing \x70char \x70curren\x63y pda\x74etime\x20pexten\x64ed '+'pint6\x34\040\x70\157\x69\156t\x65r priv\x61\164\x65\040\x70roce\x64ure p\x72ogram \x70roper\x74y psh\x6frtstr\x69ng pst\x72ing '+'pv\x61\162i\x61\156\x74\040\x70widech\x61\162\x20pwides\x74ring \x70rote\x63ted p\x75blic \x70ublis\x68ed ra\x69se re\x61l re\x61l48 '+'\x72ecord re\x70eat set \x73\150\x6c short\x69\156\x74\040\x73hor\x74strin\x67 shr s\x69ngle \x73malli\x6et str\x69ng th\x65n '+'thread\x76ar to tr\x75e try t\x79pe unit\x20until u\x73es val\x20var \x76arirn\x74 whil\x65 widec\x68ar '+'\x77idestrin\x67 with wo\x72d write\x20writeln\x20xor'; this.regexList=[ {regex:new RegExp('\134(\134\x2a[\134\x73\134\x53]*?\134*\134\x29','\x67m'),cssStyle: 'co\x6cor: #008\x32\060\x30; font\x2dstyle: \x69talic;' } , {regex:new RegExp('{(\x3f!\134\x24)[\134\x73\134\x53]*?\x7d','g\x6d'),cssStyle: 'colo\x72: #00820\x30; font-s\x74yle: i\x74\141\x6c\151\x63\073' } , {regex:new RegExp('\x2f/.\x2a\044','gm'),cssStyle: 'color: #\x30\060\x38200; f\x6f\156\x74-style\x3a\040\x69talic\x3b' } , {regex:new RegExp('\047\x28?:\134\x2e|\x5b\136\x5c\047\x27])*\047','\x67'),cssStyle: '\x63olor: \x62\154\x75\145\x3b' } , {regex:new RegExp('\134{\134\x24[a-zA-Z\x5d\053\x20.+\134\x7d','\x67'),cssStyle: '\x63olor\x3a\x20#0\x308284;' } , {regex:new RegExp('\x5cb[\134\x64\134\x2e]+\134\142','g'),cssStyle: 'color: b\x6cue;' } , {regex:new RegExp('\134\x24[a-z\x41\055\x5a0-9]+\134\142','\x67'),cssStyle: '\x63olor: b\x6c\165\x65\073' } , {regex:new RegExp(this.GetKeywords(keywords),'\x67m'),cssStyle: 'font-w\x65ight: bo\x6cd; color\x3a navy;' } ]; };sh.Brushes.Delphi.prototype=new sh.Highlighter( ); sh.Brushes.Delphi.Aliases=['\x64elphi','\x70ascal']; sh.Brushes.JScript= function ( ){var keywords='abst\x72act bool\x65an brea\x6b byte c\x61se cat\x63h char\x20clas\x73 cons\x74 cont\x69nue de\x62ugger\x20inner\x48TML c\x6cassN\x61me d\x6fcumen\x74 wind\x6fw ge\x74Eleme\x6etById'+'\x64efa\x75\x6ct \x64\145\x6c\145\x74e do do\x75ble el\x73e enum\x20expo\x72t ext\x65\156\x64s fal\x73e fin\x61l fin\x61lly f\x6coat '+'\x66or funct\x69on goto\x20\151\x66 implem\x65nts im\x70ort in\x20insta\x6eceof \x69nt int\x65rface\x20long \x6eative\x20'+'\x6eew null\x20\160\x61\143\x6b\141\x67\145\x20\160\x72\151v\x61te p\x72otec\x74\145\x64 publ\x69c ret\x75rn sho\x72t sta\x74ic su\x70er s\x77itch '+'\x73ynch\x72\x6fni\x7aed this\x20throw t\x68rows t\x72ansien\x74 tru\x65 try \x74ypeof\x20var v\x6fid vo\x6catile\x20while\x20with'; this.regexList=[ {regex:new RegExp('\x2f/.*\x24','gm'),cssStyle: 'color\x3a\040\x67reen;' } , {regex:new RegExp('/\134*[\134\x73\134\x53]*?\134\x2a/','\x67'),cssStyle: 'color: \x67reen;' } , {regex:new RegExp('\042\x28?:[^\042\012\x5d|[\042\x5d)*\x3f\042','g'),cssStyle: 'col\x6fr: blue;' } , {regex:new RegExp("\047(?:[^\047\012\x5d|[\047\x5d)*\x3f\047",'\x67'),cssStyle: 'color: b\x6c\165\x65;' } , {regex:new RegExp('\136\x5cs*#.*','\x67m'),cssStyle: 'color:\x20gray;' } , {regex:new RegExp(this.GetKeywords(keywords),'gm'),cssStyle: '\143\x6flor: blu\x65;' } ]; };sh.Brushes.JScript.prototype=new sh.Highlighter( ); sh.Brushes.JScript.Aliases=['\x6as','jscript','javasc\x72ipt']; sh.Brushes.CSS= function ( ){var keywords='\141\x73cent azi\x6duth bac\x6b\147\x72ound-at\x74achmen\x74 back\x67roun\x64-color\x20backg\x72ound-\x69mage b\x61ckgro\x75nd-p\x6fsitio\x6e '+'backgr\x6f\165n\x64-repeat\x20backgro\x75nd bas\x65\154\x69ne bb\x6fx bor\x64er-col\x6capse \x62order\x2dcolor \x62order\x2dspaci\x6eg bo\x72der-s\x74yle b\x6frder-\x74op '+'border-\x72\151g\x68t borde\x72-botto\x6d borde\x72\055\x6ceft b\x6frde\x72-top-c\x6flor b\x6frder-\x72ight-\x63olor \x62order\x2dbott\x6fm-co\x6cor bo\x72der-l\x65ft-c\x6flor '+'\x62order-t\x6f\160\x2d\163\x74\171\x6c\145\x20\142\x6f\162\x64er-r\x69ght-s\x74yle bo\x72der-b\x6fttom-\x73tyle b\x6frder\x2dleft-\x73tyle\x20borde\x72-top-\x77idth\x20borde\x72-righ\x74-wid\x74h '+'border-\x62ottom-w\x69\144\x74\x68 \x62order-\x6c\145\x66t-widt\x68 bor\x64er-wi\x64th bo\x72der b\x6fttom \x63ap-he\x69ght c\x61ptio\x6e-side\x20cente\x72line\x20clear\x20clip\x20color\x20'+'content \x63\157\x75\156t\x65r-incre\x6dent co\x75nter-r\x65\163\x65t c\x75e-afte\x72 cue-b\x65fore \x63ue cur\x73or de\x66initi\x6fn-sr\x63 desce\x6et di\x72ectio\x6e disp\x6cay '+'\x65le\x76\x61ti\x6f\156\x20\x65m\x70\164\x79\x2dce\x6cls flo\x61t fo\x6et-siz\x65-adju\x73t fon\x74-fami\x6cy font\x2dsize \x66ont-s\x74retc\x68 font-\x73tyle\x20font-\x76arian\x74 font\x2dweig\x68t fo\x6et '+'\x68eight l\x65\x74te\x72-spacin\x67 line-h\x65ight l\x69\163\x74-sty\x6ce-ima\x67e lis\x74-styl\x65-posi\x74ion l\x69st-sty\x6ce-ty\x70e li\x73t-sty\x6ce mar\x67in-t\x6fp '+'m\x61\162g\x69\156\x2d\162i\x67ht mar\x67\151\x6e\055\x62ottom\x20margi\x6e-lef\x74\040\x6dargi\x6e mark\x65r-offs\x65t mar\x6bs ma\x74hline\x20max-h\x65ight \x6dax-wi\x64th mi\x6e-heig\x68t mi\x6e-wid\x74h orp\x68ans '+'\x6futli\x6e\145\x2d\x63ol\x6f\162\x20outlin\x65\055\x73tyle \x6futlin\x65-widt\x68 outl\x69ne ove\x72flow\x20paddin\x67-top \x70addi\x6eg-rig\x68t pad\x64ing-\x62ottom\x20paddi\x6eg-le\x66t pad\x64ing \x70age '+'pa\x67\145-\x62\162e\x61k-after\x20page-br\x65ak-bef\x6fre pag\x65-bre\x61k-ins\x69de pa\x75se pa\x75se-af\x74er pa\x75se-be\x66ore \x70itch \x70itch-\x72ange \x70lay-\x64uring\x20posit\x69on '+'\x71uo\x74\x65s \x72\x69ch\x6eess rig\x68t size\x20slope \x73\162\x63 sp\x65ak-he\x61der sp\x65ak-nu\x6deral\x20speak-\x70unctu\x61tion\x20speak\x20speec\x68-rat\x65 stem\x68 ste\x6dv str\x65ss '+'\x74\141b\x6c\145\x2dlay\x6f\165\x74 text-a\x6cign te\x78t-deco\x72atio\x6e \x74ext-i\x6edent \x74ext-sh\x61dow t\x65xt-tr\x61nsfo\x72m uni\x63ode-b\x69di u\x6eicode\x2drange\x20unit\x73-per-\x65m '+'vertica\x6c\055\x61lign \x76isibi\x6city v\x6fice-fa\x6dily vo\x6cume \x77hite-\x73pace w\x69dows \x77idth \x77idths\x20word-\x73pacin\x67 x-h\x65ight \x7a-inde\x78'; var values='above a\x62solute \x61ll alway\x73 aqua \x61\162\x6denian \x61ttr au\x72al a\x75to avo\x69d bas\x65line \x62ehind \x62elow \x62idi-\x6fverri\x64e bla\x63k bli\x6ek bl\x6fck bl\x75e bol\x64 bol\x64er '+'\x62oth bo\x74\164o\x6d braill\x65 capita\x6cize ca\x70tion c\x65nter c\x65nter-\x6ceft ce\x6eter-r\x69ght c\x69\162\x63le c\x6cose-q\x75ote \x63ode c\x6fllaps\x65 com\x70act c\x6fndens\x65d '+'co\x6e\164i\x6e\165\x6f\165s\x20counte\x72\040\x63ounter\x73 crop\x20cro\x73s cros\x73hair c\x75rsive\x20dashe\x64 deci\x6dal de\x63imal\x2dleadi\x6eg-zer\x6f defa\x75lt d\x69gits \x64isc d\x6ftted\x20doubl\x65 '+'e\x6d\142e\x64\040\x65mbossed\x20e-resiz\x65 expan\x64ed ext\x72a-con\x64ensed\x20extra\x2d\145\x78pande\x64 fant\x61sy f\x61r-lef\x74 far\x2dright\x20fast \x66aste\x72 fix\x65d for\x6dat fu\x63hsia\x20'+'\x67ra\x79\x20gr\x65\145\x6e\x20g\x72\157\x6f\166\x65\040\x68andh\x65ld h\x65brew h\x65lp hi\x64den h\x69de hig\x68 high\x65r ic\x6fn inl\x69ne-ta\x62le in\x6cine \x69nset \x69nside\x20inver\x74 ita\x6cic '+'j\x75\163t\x69\146y\x20landsca\x70e large\x20larger\x20left-s\x69de l\x65ft le\x66tward\x73 leve\x6c ligh\x74er lim\x65 line\x2dthro\x75gh l\x69st-it\x65m loc\x61l lou\x64 lowe\x72-alp\x68a '+'\x6cowe\x72\143a\x73e lower\x2dgreek l\x6fwer-la\x74\151\x6e low\x65r-ro\x6d\141\x6e lowe\x72 low l\x74r ma\x72\153\x65r mar\x6fon m\x65dium \x6dessag\x65-box \x6diddl\x65 mix \x6dove n\x61rrowe\x72 '+'navy \x6e\145-\x72\145\x73\x69ze\x20no-clo\x73e-quot\x65\040\x6eone\x20no-op\x65\156\x2dquote\x20no-re\x70eat n\x6frmal \x6eowrap\x20n-res\x69ze nw\x2dresiz\x65 obl\x69que o\x6cive o\x6ece o\x70en-qu\x6fte o\x75tset '+'\x6futsid\x65\x20ov\x65rline po\x69nter p\x6f\162\x74rait p\x72e pr\x69nt pr\x6fjectio\x6e purp\x6ce red\x20relat\x69ve re\x70eat r\x65peat\x2dx rep\x65at-y \x72gb ri\x64ge ri\x67ht r\x69ght-s\x69de '+'right\x77\141r\x64s rtl r\x75\156\x2din scre\x65n scro\x6cl semi\x2dcond\x65nsed \x73\145\x6di-exp\x61nded \x73epara\x74e se-\x72esize\x20show \x73ilent\x20silve\x72 slo\x77er sl\x6fw '+'\x73\155a\x6c\154\x20\x73ma\x6cl-caps \x73mall-c\x61ption \x73malle\x72 sof\x74 solid\x20speec\x68 spel\x6c-out s\x71uare \x73-res\x69ze st\x61tic s\x74atus-\x62ar su\x62 sup\x65r sw-\x72esize\x20'+'table-ca\x70\164\x69\x6fn \x74\141\x62le-cel\x6c\040\x74able-\x63olum\x6e tab\x6c\145\x2dcolum\x6e-gro\x75p tabl\x65-foot\x65r-gr\x6fup ta\x62le-he\x61der-g\x72oup t\x61ble-\x72ow ta\x62le-ro\x77-gro\x75p tea\x6c '+'text-b\x6fttom tex\x74-top th\x69ck thin\x20top tr\x61\156\x73pare\x6et tt\x79 tv ul\x74ra-co\x6edensed\x20ultra\x2dexpan\x64ed un\x64erli\x6ee upp\x65r-alp\x68a up\x70ercas\x65 upp\x65r-lat\x69n '+'\x75ppe\x72\055\x72oman ur\x6c\040\x76isible\x20wait w\x68ite wi\x64er \x77\055\x72esize\x20x-fas\x74 x-hi\x67h x-l\x61rge x-\x6coud \x78-low\x20\170\x2dslow\x20x-sm\x61ll x-\x73oft x\x78-lar\x67e xx-\x73mall\x20yello\x77'; var fonts='\x5bmM]onos\x70\141\x63\145 \x5btT]aho\x6d\141\x20[vV]er\x64\141\x6ea [\x61A]rial\x20[hH]e\x6cvetic\x61 [sS]\x61ns-se\x72if [s\x53]erif'; this.regexList=[ {regex:new RegExp('\x2f\134\x2a[\134\x73\134\x53]*\x3f\134\x2a/','g'),cssStyle: '\x63olor: gr\x65\145\x6e\073' } , {regex:new RegExp('\042\050\x3f:[^\042\x0a]|[\x22\135\x29*?\042','\x67'),cssStyle: 'colo\x72: blue;' } , {regex:new RegExp("\x27(?:[^\047\012\x5d|[\047\x5d)*?\x27",'g'),cssStyle: '\x63ol\x6f\162:\x20blue;' } , {regex:new RegExp('\134\x23[a-zA-\x5a0-9]{3,6\x7d','g'),cssStyle: '\x63olor: \x62\154\x75\145;' } , {regex:new RegExp('(\134d+)(px|p\x74|:)','g'),cssStyle: 'c\x6flor: blu\x65;' } , {regex:new RegExp(this.GetKeywords(keywords),'\x67m'),cssStyle: '\x63ol\x6f\x72: \x72\145\x64\073' } , {regex:new RegExp(this.GetKeywords(values),'g'),cssStyle: 'c\x6flor: blu\x65;' } , {regex:new RegExp(this.GetKeywords(fonts),'\x67'),cssStyle: '\x63olor: \x62\x6cue\x3b' } ]; };sh.Brushes.CSS.prototype=new sh.Highlighter( ); sh.Brushes.CSS.Aliases=['css']; sh.Brushes.Php= function ( ){var keywords='and o\x72 xor __F\x49LE__ __\x4cINE__ a\x72ray as\x20\142\x72eak \x63ase '+'c\x66\165n\x63\164\x69\x6fn \x63lass co\x6est con\x74inue d\x65clar\x65 def\x61\165\x6ct die\x20do ec\x68o els\x65 '+'elsei\x66\040\x65mpty en\x64\144\x65clare e\x6edfor e\x6edforea\x63h en\x64if en\x64switc\x68 endw\x68ile e\x76al exi\x74 '+'\x65xtends \x66\157\x72\040\x66oreach\x20functi\x6fn glob\x61l if\x20inclu\x64e inc\x6cude_o\x6ece is\x73et li\x73t '+'\x6e\x65w \x6f\x6cd_\x66unction\x20\160\x72int re\x71\165\x69re r\x65quire\x5fonce \x72\145\x74urn s\x74atic \x73witch\x20unset\x20use '+'\x76ar while\x20__FUNCTI\x4fN__ __C\x4cASS__'; this.regexList=[ {regex:new RegExp('//.*\x24','\147\x6d'),cssStyle: '\x63olo\x72\072\x20green;' } , {regex:new RegExp('/\134\x2a[\134\x73\134\x53]*?\134\052\x2f','g'),cssStyle: '\x63ol\x6f\162:\x20green;' } , {regex:new RegExp('\x22(?:[^\042\012\x5d|[\042])*?\042','\x67'),cssStyle: 'co\x6cor: blue\x3b' } , {regex:new RegExp("\047\x28?:[^\x27\012\x5d|[\047\x5d)*?\x27",'g'),cssStyle: 'color:\x20blue;' } , {regex:new RegExp('\134\x24\134\x77+','\x67'),cssStyle: 'col\x6f\162:\x20#d00;' } , {regex:new RegExp(this.GetKeywords(keywords),'gm'),cssStyle: '\143\x6f\154o\x72: blue;' } ]; };sh.Brushes.Php.prototype=new sh.Highlighter( ); sh.Brushes.Php.Aliases=['php']; sh.Brushes.Python= function ( ){var keywords='\x61nd asse\x72\164\x20break c\x6cass con\x74inue d\x65\146\x20del \x65lif e\x6cse exc\x65pt ex\x65c '+'finally\x20\146o\x72 from g\x6c\157\x62al if \x69\155\x70\157\x72t in\x20is la\x6dbda no\x74 or o\x62ject \x70ass p\x72int '+'\x72aise \x72\145t\x75rn try \x79ield wh\x69le'; var builtins='\x73el\x66\040\x5f_builti\x6e\137\x5f __dic\x74\137\x5f __fut\x75re_\x5f __me\x74hods_\x5f __me\x6dbers_\x5f __au\x74hor__\x20__em\x61il__\x20__ver\x73ion__'+'\x5f_cla\x73\163_\x5f _\x5fbases_\x5f __imp\x6f\162\x74\137\x5f\040\x5f_ma\x69\156\x5f_ __n\x61me__ \x5f_doc_\x5f\040\x5f_sel\x66__ _\x5fdebug\x5f_ __s\x6cots__\x20'+'a\x62\163 \x61\160\x70end app\x6cy bases\x74ring b\x6fol buf\x66er \x63allab\x6ce chr \x63lassm\x65thod \x63lear \x63lose \x63mp co\x65rce \x63ompil\x65 comp\x6cex '+'c\x6f\156j\x75\147\x61te copy\x20count d\x65lattr \x64ict di\x72 div\x6dod en\x75merat\x65 Ellip\x73is ev\x61l exe\x63file \x65xtend\x20Fals\x65 file\x20filen\x6f filt\x65r flo\x61t fl\x75sh '+'ge\x74\040\x67\145t\x61ttr glo\x62als has\x5fkey ha\x73\141\x72ttr h\x61sh he\x78 id in\x64ex in\x70ut in\x73ert i\x6et int\x65rn is\x61tty \x69sinst\x61nce i\x73ubcla\x73s '+'\x69tems ite\x72 keys le\x6e list l\x6fcals l\x6f\156\x67 map m\x61x min\x20mode \x6fct ope\x6e ord \x70op po\x77\040\x70rop\x65rty r\x61nge '+'\x72aw_inp\x75\x74 r\x65\141\x64 readli\x6ee read\x6cines r\x65duce\x20reloa\x64 remov\x65 repr\x20rever\x73e roun\x64 seek\x20seta\x74tr sl\x69ce su\x6d '+'\x73tatic\x6d\x65th\x6f\144\x20\163\x74r supe\x72\040\x74ell Tr\x75e tr\x75ncate\x20tuple \x74ype u\x6eichr\x20unicod\x65 upda\x74e va\x6cues w\x72ite w\x72iteli\x6ees xr\x61nge z\x69p'; var magicmethods='\x5f\137\x61\x62s_\x5f __add__\x20__and_\x5f __cal\x6c\137\x5f\040\x5f_\x63mp__ _\x5fcoerc\x65__ __\x63omple\x78\137\x5f __co\x6ecat_\x5f __co\x6etains\x5f_ __d\x65l__ _\x5fdela\x74tr__ \x5f_deli\x74em__\x20'+'__delsl\x69ce__ __\x64\151\x76\137\x5f\040\x5f_divmo\x64__ __f\x6coat_\x5f __ge\x74attr_\x5f __ge\x74item_\x5f __get\x73lice\x5f_ __h\x61sh__\x20__hex\x5f_ __e\x71__ __\x6ce__ _\x5flt__\x20__gt_\x5f __g\x65__ '+'\x5f_iadd\x5f\x5f _\x5f\151\x73\165\x62__ __i\x6d\157\x64__ __i\x64iv_\x5f __ip\x6fw__ __\x69and__\x20__ior\x5f_ __i\x78or__ _\x5filsh\x69ft__\x20__irs\x68ift__\x20'+'\137_\x69\156v\x65rt__ __i\x6eit__ _\x5f\151\x6e\164\x5f\137\x20__in\x76__ __\x69ter__ \x5f_len_\x5f __lo\x6eg__ _\x5flshift\x5f_ __\x6dod__ \x5f_mul_\x5f __ne\x77__ __\x6eeg__ \x5f_nonz\x65ro__\x20__oc\x74__ __\x6fr__ '+'__pos__ \x5f\137\x70\157w\x5f_ __rad\x64__ __r\x61nd__ _\x5frcmp_\x5f __r\x64iv__ _\x5frdivm\x6fd__ _\x5frepeat\x5f_ __r\x65pr__ \x5f_rls\x68ift__\x20__rmo\x64__ __\x72mul_\x5f '+'\x5f_ror\x5f\137\x20\137_\x72\160\x6fw__ __\x72\162\x73\150\x69ft__\x20__rs\x68ift__ \x5f_rsub\x5f_ __r\x78or__ _\x5fsetat\x74r__ _\x5fseti\x74em__ _\x5fsetsl\x69ce__\x20__str\x5f_ __s\x75b__ \x5f_xor_\x5f'; var exceptions='\x45xcep\x74\151\x6f\156\x20\x53t\x61\156\x64\141\x72dError\x20Arit\x68meti\x63Error \x4cookup\x45rror \x45nviro\x6ementE\x72ror A\x73sert\x69onErr\x6fr At\x74ribut\x65Erro\x72 EOFE\x72ror '+'FutureW\x61\162n\x69ng Inde\x6e\164\x61tionEr\x72\157\x72\040\x4fver\x66lowWa\x72\156\x69ng Pe\x6edingD\x65preca\x74ionWar\x6eing \x52efer\x65nceEr\x72or Ru\x6etimeW\x61rning\x20'+'S\x79ntaxWarn\x69\156\x67\040\x54abErro\x72 Unico\x64\145\x44ecod\x65Erro\x72 Unico\x64eEnco\x64eErro\x72 Unic\x6fdeTra\x6eslate\x45rror \x55serWa\x72ning \x57arni\x6eg '+'IOEr\x72\157r\x20ImportE\x72ror Ind\x65xError\x20\113\x65yError\x20Key\x62oardI\x6eterrup\x74 Memo\x72yErro\x72 NameE\x72ror N\x6ftImp\x6cement\x65dErro\x72 OSE\x72ror '+'\x52untimeE\x72\x72or\x20StopIte\x72ation S\x79ntaxEr\x72\157\x72 Sys\x74emErr\x6fr Syst\x65mExit\x20TypeE\x72ror Un\x62ound\x4cocalE\x72ror \x55nicod\x65Error\x20Value\x45rror '+'\x46loating\x50\x6fin\x74Error O\x76erflowE\x72ror Wi\x6e\144\x6fwsEr\x72or Ze\x72oDivis\x69onErr\x6fr'; var types='NoneTy\x70e TypeTy\x70e IntTyp\x65 LongT\x79\160\x65 Float\x54ype C\x6fmple\x78Type S\x74ringT\x79pe Uni\x63odeTy\x70e Buf\x66erTyp\x65 Tup\x6ceType\x20ListT\x79pe '+'Dic\x74\124y\x70e Functi\x6fnType L\x61mbdaTy\x70\145\x20CodeTy\x70e Cla\x73sType\x20Unboun\x64Metho\x64Type \x49nstan\x63eType \x4detho\x64Type \x42uilt\x69nFunc\x74ionTy\x70e Bui\x6ctinM\x65thodT\x79pe '+'\x4d\157d\x75\x6ceT\x79pe File\x54ype XRa\x6egeType\x20Traceb\x61ckTy\x70e Fra\x6d\145\x54ype S\x6ciceTy\x70e Elli\x70sisTy\x70e'; var commonlibs='\x61ny\x64\142m\x20array as\x79nchat \x61syncor\x65\040\x41ST ba\x73e64 \x62inasci\x69 binh\x65x bis\x65ct bsd\x64b bui\x6cdtoo\x6cs bz2\x20'+'BaseHT\x54\120S\x65rver Ba\x73\164\x69on cale\x6edar cg\x69 cmat\x68 cmd\x20codecs\x20codeo\x70 comm\x61nds c\x6fmpiler\x20copy\x20copy_\x72eg '+'\143\x50\x69ck\x6c\145\x20\x63ry\x70t cStr\x69ngIO c\x73v curs\x65s Ca\x72bon \x43GIHTTP\x53erver\x20Confi\x67Parse\x72 Cook\x69e da\x74etim\x65 dbha\x73h '+'d\x62m diffli\x62\040\x64ircache\x20distut\x69\154\x73 docte\x73t Do\x63XMLRP\x43Serve\x72 email\x20encod\x69ngs e\x72rno e\x78cepti\x6fns f\x63ntl '+'\x66ilecmp\x20\146\x69leinput\x20ftplib \x67c gdbm\x20getopt\x20getp\x61ss gl\x6fb goph\x65rlib \x67zip h\x65apq h\x74mlent\x69tydef\x73 '+'htmll\x69\142 \x68ttplib H\x54MLParse\x72 image\x6fp imapl\x69b i\x6dgfile\x20imghd\x72\040\x69mp i\x6espect\x20iterto\x6fls jp\x65g ke\x79word '+'\x6cinecach\x65\040\x6cocale l\x6fgging m\x61ilbox \x6dailcap\x20marsh\x61l mat\x68 md5 \x6dhlib \x6dimeto\x6fls mim\x65types\x20mim\x69fy mm\x61p '+'mpz mult\x69\x66il\x65 mutex M\x69meWrit\x65\162\x20netrc \x6e\145\x77 ni\x73 nntpl\x69b nsr\x65mote \x6fperat\x6fr opt\x70arse \x6fs pa\x72ser p\x69ckle \x70ipes '+'pope\x6e\x32 p\x6f\160\x6c\x69b \x70osix p\x6f\163\x69\170\x66ile \x70print\x20prefer\x65nces p\x72ofil\x65 pstat\x73 pwd \x70ydoc\x20pytho\x6eprefs\x20quiet\x63onsol\x65 '+'\x71uopri Qu\x65\165\x65\x20ra\x6edom re\x20readlin\x65 resou\x72ce r\x65xec r\x66\143\x3822 rg\x62img s\x63hed se\x6cect s\x65ts s\x67mlli\x62 sha \x73helve\x20shuti\x6c '+'sig\x6e\141l\x20site smt\x70lib soc\x6bet sta\x74\040\x73tatca\x63he \x73tring\x20struc\x74 symbo\x6c sys \x73yslog\x20Simpl\x65HTTP\x53erver\x20'+'S\x69\155p\x6c\145X\x4dLRPCSer\x76er Soc\x6b\145\x74Server\x20Stri\x6egIO \x74abnan\x6ey tarf\x69le t\x65lnetl\x69b tem\x70file \x74ermi\x6fs tex\x74wrap\x20'+'t\x68\x72ead\x20threadin\x67 time t\x69meit t\x6f\153\x65\156\x20toke\x6eize t\x72acebac\x6b tty \x74ypes \x54kinte\x72 unic\x6fdedat\x61 uni\x74test '+'urllib u\x72llib2 u\x72\154\x70\141\x72se use\x72\040\x55serDi\x63t Us\x65rList\x20UserS\x74ring \x77arnin\x67s wea\x6bref w\x65bbro\x77ser w\x68ichdb\x20'+'\x78ml xmll\x69\142\x20\170\x6d\154\x72\160\x63lib xr\x65\141\x64lines\x20zipfi\x6ce\x20zlib'; this.regexList=[ {regex:new RegExp('#.*$','gm'),cssStyle: '\x63olo\x72\072\x20green;' } , {regex:new RegExp('^\134\x73*\042\042\x22(.|\012\x29*\x3f\042\x22\042\x5cs*$','gm'),cssStyle: 'c\x6flor: bro\x77\156\x3b' } , {regex:new RegExp('^\x5cs*\047\x27\047\x28.|\x0a\051\x2a?\047\x27\047\x5cs*\x24','\x67\155'),cssStyle: 'color: b\x72own;' } , {regex:new RegExp('\x22\x22\042\050\x2e|\012\x29*?\042\042\x22','\x67'),cssStyle: 'co\x6cor: red;' } , {regex:new RegExp('\047\047\x27(.|\012\x29*?\047\047\x27','g'),cssStyle: '\x63olor\x3a\040\x72ed;' } , {regex:new RegExp('\x22\x28?:\x5c\x2e|[\x5e\134\x22\042\x5d)*\042','g'),cssStyle: 'c\x6flor: red\x3b' } , {regex:new RegExp('\x27\050\x3f:\134\x2e|[^\134\x27\047])*\047','g'),cssStyle: 'colo\x72: red;' } , {regex:new RegExp(this.GetKeywords(keywords),'\x67m'),cssStyle: '\x63olor:\x20\142\x6cue; fon\x74-weight\x3a bold;' } , {regex:new RegExp(this.GetKeywords(builtins),'g\x6d'),cssStyle: '\x63\157l\x6f\162\x3a\040\x23ff1493\x3b' } , {regex:new RegExp(this.GetKeywords(magicmethods),'g\x6d'),cssStyle: 'color: #\x38\060\x38080;' } , {regex:new RegExp(this.GetKeywords(exceptions),'gm'),cssStyle: '\x63olor: b\x72\157\x77\156;' } , {regex:new RegExp(this.GetKeywords(types),'gm'),cssStyle: 'co\x6c\157r\x3a\040\x62rown; f\x6fnt-sty\x6ce: ital\x69c;' } , {regex:new RegExp(this.GetKeywords(commonlibs),'gm'),cssStyle: '\x63olo\x72\x3a #\x38A2BE2; \x66ont-sty\x6c\145\x3a\040\x69talic\x3b' } ]; };sh.Brushes.Python.prototype=new sh.Highlighter( ); sh.Brushes.Python.Aliases=['\x70y','\x70yt\x68\x6fn']; sh.Brushes.Sql= function ( ){var funcs='\x61bs avg c\x61\163\x65\040\x63ast co\x61lesce \x63\157\x6e\166\x65rt \x63\157\x75nt cu\x72rent_t\x69mest\x61mp '+'\x63urrent\x5f\165\x73\145\x72\040\x64ay isn\x75\154\x6c left \x6cower\x20month\x20nulli\x66 repl\x61ce ri\x67ht '+'sessi\x6f\156_\x75ser spa\x63\145\x20\163\x75\142\x73\164\x72\151\x6eg s\x75m syst\x65m_use\x72 uppe\x72 user\x20year'; var keywords='absolu\x74e action\x20add aft\x65\162\x20alter \x61\163\x20\141\x73c at\x20autho\x72izati\x6f\156\x20begin\x20bigin\x74 '+'\142\x69\156a\x72\171\x20\142i\x74 by ca\x73\143\x61\144\x65 cha\x72 char\x61cter \x63heck c\x68eckpo\x69nt cl\x6fse col\x6cate '+'column c\x6fmmit c\x6fmmitted\x20connect\x20connec\x74ion co\x6estrai\x6et con\x74ains c\x6fntinu\x65 '+'creat\x65\040\x63ube cur\x72\145\x6e\164\x20\143u\x72rent_d\x61te \x63urren\x74_time \x63ursor\x20datab\x61se da\x74e '+'\x64ealloc\x61\164e\x20dec dec\x69mal dec\x6care de\x66\141\x75lt d\x65lete \x64esc di\x73tinct\x20doubl\x65 drop\x20'+'dynami\x63\040\x65lse end \x65nd-exec\x20escape\x20\145\x78cept \x65xec \x65xecute\x20false \x66etch \x66irst '+'\x66lo\x61\x74 f\x6f\162\x20\x66or\x63e forei\x67n forw\x61rd fr\x65e fr\x6f\155\x20full \x66unctio\x6e glo\x62\141\x6c goto\x20gran\x74 '+'gro\x75\160 \x67\162\x6f\165p\x69ng hav\x69\156\x67 hour \x69\147\x6eore \x69ndex i\x6ener i\x6esensi\x74ive i\x6esert i\x6estea\x64 '+'\x69nt int\x65\147\x65\162\x20\x69n\x74\145\x72\163\x65\143\x74 int\x6f is i\x73olatio\x6e key \x6cast l\x65vel l\x6fad lo\x63al ma\x78 min\x20'+'minute\x20\155o\x64ify move\x20name n\x61tional \x6echar n\x65xt n\x6f nume\x72ic of \x6fff on\x20only '+'ope\x6e\040\x6f\160\x74\151o\x6e order \x6fut out\x70ut par\x74ial p\x61sswor\x64 prec\x69sion p\x72epare\x20prima\x72y '+'\x70\162i\x6f\x72 \x70\x72iv\x69leges p\x72ocedur\x65\040\x70ubli\x63 rea\x64 real\x20\162\x65fere\x6eces r\x65lativ\x65 repea\x74able\x20'+'\x72estric\x74\040\x72eturn r\x65turns r\x65voke r\x6fllback\x20roll\x75p row\x73 rule\x20schema\x20scrol\x6c '+'second\x20\x73ec\x74\151\x6f\156\x20\163\x65\154e\x63t sequ\x65nce \x73erial\x69zable\x20set si\x7ae sma\x6clint \x73tatic\x20'+'sta\x74\x69st\x69\143\x73\x20ta\x62le temp\x20tempor\x61ry the\x6e tim\x65 time\x73tamp t\x6f top \x74ransa\x63tion '+'\x74ransla\x74\x69on\x20\164\x72igger t\x72\165\x65\040\x74runca\x74e un\x63ommit\x74ed un\x69on uni\x71ue u\x70date v\x61lues '+'varch\x61\162\x20\166a\x72ying vi\x65w when \x77here wi\x74h wor\x6b'; var operators='al\x6c and any\x20\142\x65\164w\x65en cro\x73\163\x20in joi\x6e like\x20not \x6eull or\x20outer\x20some'; this.regexList=[ {regex:new RegExp('--(.*)$','\x67m'),cssStyle: 'c\x6f\154\x6f\x72: \x67reen;' } , {regex:new RegExp('\x22(?:\134.|[^\134\x22\042\x5d)*\x22','g'),cssStyle: 'col\x6f\162\x3a\x20re\x64;' } , {regex:new RegExp('\047\x28?:\134\x2e|[\x5e\134\x27\047\x5d)*\047','g'),cssStyle: '\x63olor\x3a\040\x72ed;' } , {regex:new RegExp(this.GetKeywords(funcs),'gmi'),cssStyle: 'co\x6cor: #ff1\x34\071\x33;' } , {regex:new RegExp(this.GetKeywords(operators),'\x67mi'),cssStyle: '\x63\157\x6c\x6fr:\x20\043\x3808080;' } , {regex:new RegExp(this.GetKeywords(keywords),'gmi'),cssStyle: '\x63olor\x3a blue;\x20' } ]; this.CssClass='dp-sql'; };sh.Brushes.Sql.prototype=new sh.Highlighter( ); sh.Brushes.Sql.Aliases=['s\x71l']; sh.Brushes.Vb= function ( ){var keywords='AddHandle\x72 Addres\x73Of AndAl\x73o Ali\x61\163\x20\101\x6ed An\x73i As \x41ssembl\x79 Auto\x20'+'Boo\x6c\x65an\x20\102\x79\122e\x66 Byte \x42yVal C\x61\154\x6c Case\x20Catch\x20CBool\x20CByte \x43Char \x43Date '+'\x43Dec CD\x62\154\x20\103h\x61r CInt\x20Class C\x4cng COb\x6a Cons\x74 CSh\x6f\162\x74 CSng\x20CStr C\x54ype '+'\x44\141t\x65\040\x44ecimal \x44eclare \x44efault\x20\104\x65legat\x65 Dim\x20Direct\x43ast Do\x20Doubl\x65 Each\x20'+'\x45\154s\x65\x20El\x73eIf End\x20\105\x6e\165\x6d\040\x45rase \x45rror\x20Event\x20Exit \x46alse F\x69nall\x79 For F\x72iend '+'Funct\x69\x6fn G\x65t GetTy\x70e GoSub\x20GoTo H\x61\156\x64les I\x66 Imp\x6cements\x20Impor\x74s In '+'Inheri\x74\x73 I\x6e\164\x65\147\x65\162\x20\111n\x74erface\x20Is L\x65t Lib\x20Like L\x6fng Lo\x6fp Me \x4dod Mo\x64ule '+'\x4dustInh\x65\x72it\x20MustOver\x72ide My\x42\141\x73e MyCl\x61ss N\x61mespac\x65 New \x4eext N\x6ft Not\x68ing '+'\x4eotInh\x65\162\x69\164\x61\x62l\x65\040\x4eotOver\x72\151\x64able\x20Objec\x74 On Op\x74ion O\x70tion\x61l Or O\x72E\x6cse '+'\x4fverloads\x20\117\x76\x65rr\x69dable O\x76erride\x73\040\x50ara\x6dArray\x20Prese\x72\166\x65 Priv\x61te Pr\x6fperty\x20'+'\x50rotected\x20\120\x75\x62li\x63 RaiseE\x76ent Re\x61\144\x4fnly \x52eDim \x52EM Re\x6doveHa\x6edler R\x65sume '+'\x52eturn Se\x6cect Set \x53hadows\x20\123\x68ared S\x68ort Si\x6egle \x53tatic\x20Step \x53top S\x74ring '+'Str\x75\143\x74\x75re\x20Sub Syn\x63Lock Th\x65\156\x20Throw \x54o Tr\x75e Try\x20\124\x79peOf \x55nicod\x65 Unti\x6c '+'V\x61\162i\x61\156\x74\040\x57\150\x65n Whil\x65\040\x57ith W\x69thEv\x65nts W\x72iteOn\x6cy Xor'; this.regexList=[ {regex:new RegExp('\x27.\x2a\x24','\x67m'),cssStyle: 'col\x6fr: green\x3b' } , {regex:new RegExp('\x22(?\x3a\134\x2e|[^\134\x22\042\x5d)*\x22','g'),cssStyle: '\x63ol\x6f\x72: \x62lue;' } , {regex:new RegExp('^\134s*#.*','gm'),cssStyle: '\x63ol\x6f\x72: \x67ray;' } , {regex:new RegExp(this.GetKeywords(keywords),'gm'),cssStyle: 'color: \x62lue;' } ]; };sh.Brushes.Vb.prototype=new sh.Highlighter( ); sh.Brushes.Vb.Aliases=['\x76b','vb.net']; sh.Brushes.Xml= function ( ){};sh.Brushes.Xml.prototype=new sh.Highlighter( ); sh.Brushes.Xml.Aliases=['\x78ml','\x78ht\x6d\x6c','\x78\163l\x74','html','xhtml']; sh.Brushes.Xml.prototype.ProcessRegexList= function ( ){function push(array,value){array[array.length]=value; }var index=0; var match=null; var regex=null; this.GetMatches(new RegExp('\074\134\x21\134\133\x5b\134w\x5cs]*?\134\x5b(.\x7c\134\x73)*?\134\x5d\134\x5d>','gm'),'\x63olor: #\x66\146\x31493;'); this.GetMatches(new RegExp('\x3c!--\134\x73*.*\x5c\163\x2a\077\x2d->','\147\x6d'),'\x63olor: gr\x65en;'); regex=new RegExp('\x28\133\x5c\x77-.\x5d+)\134\x73*=\134\x73*(\x22\x2e*\x3f\042\x7c\047.*?\047\174\x5cw+)*','\x67m'); while ((match=regex.exec(this.code))!=null){push(this.matches,new sh.Match(match[1],match.index,'\x63olo\x72\072\x20red;')); if (match[2]!=undefined){push(this.matches,new sh.Match(match[2],match.index+match[0].indexOf(match[2]),'col\x6fr: blue\x3b')); }} this.GetMatches(new RegExp('\x3c/*\134\x3f*(?!\x5c\x21)|\x2f*\134\x3f*>','gm'),'col\x6f\162:\x20blue;'); regex=new RegExp('\074\x2f*\134\x3f*\134\x73*([\134\x77-.]\x2b)','g\x6d'); while ((match=regex.exec(this.code))!=null){push(this.matches,new sh.Match(match[1],match.index+match[0].indexOf(match[1]),'\143\x6flor: bla\x63k; font\x2d\167\x65ight: \x62old;')); }};
function ImageDialogCaller(id,additionalArguments){ this.Id=id; this.AdditionalArguments=additionalArguments; if (this.AdditionalArguments.length>0 && this.AdditionalArguments.indexOf("&")!=0){ this.AdditionalArguments="\046"+this.AdditionalArguments; } this.resultHolderTextBox=document.getElementById(this.Id+'_resultT\x65xtBox'); this.dialogOpenerButton=document.getElementById(this.Id+'_dialo\x67OpenerB\x75tton'); this.AltText=document.getElementById('\x64ialogLo\x61\144\x65r_dia\x6cogCont\x72ol_th\x65\111\x6dagePr\x6fpert\x69esCon\x74rol_al\x74'); this.EditorObject=null; this.onSrcChangeCallback=null; this.thumbParent=null; }ImageDialogCaller.prototype.Initialize= function (editorObject,textBoxSize,onSrcChangeCallback){ this.EditorObject=editorObject; if (textBoxSize){ this.resultHolderTextBox.size=textBoxSize; }var I2=EkUtil_parseQuery( ); if ("\x75ndefin\x65\144"!=typeof I2.LibraryAllowed && "False"==I2.LibraryAllowed){ this.dialogOpenerButton.style.display="non\x65"; }if (onSrcChangeCallback){ this.onSrcChangeCallback=onSrcChangeCallback; }} ; ImageDialogCaller.prototype.SetThumbParent= function (anchorTag){ this.thumbParent=anchorTag; } ; ImageDialogCaller.prototype.GetThumbParent= function ( ){return this.thumbParent; } ; ImageDialogCaller.prototype.EnableImageSrc= function (bEnable){try { this.resultHolderTextBox.disabled=(!bEnable); }catch (ex){}} ; ImageDialogCaller.prototype.SetImagePath= function (imagePath){ this.resultHolderTextBox.value=imagePath; try { this.resultHolderTextBox.focus( ); }catch (ex){}} ; ImageDialogCaller.prototype.GetImagePath= function ( ){return this.resultHolderTextBox.value; } ; ImageDialogCaller.prototype.CallImageDialog= function ( ){var callBackParams= {imageDialogCaller: this,thumbParent:null } ; var args=GetDialogArguments( ); var folderId=0; var oEditor=null; var sFromDlg=""; if (args){folderId=args.folderId; oEditor=args.EditorObj; commandType=args.commandType; }if (oEditor){var argument= {InternalParameters:oEditor.GetDialogInternalParameters("\x53\x65\x74Im\x61gePrope\x72ties")};oEditor.ShowDialog(oEditor.workareaPath+"\x6dedia\x6d\141\x6eager.a\x73\160\x78?acti\x6fntype=\x6cibrary\x26scop\x65=all&\x74ext="+commandType+"\x26autonav="+folderId,argument,790,550,SetImageCallerValue,callBackParams); return false; }} ; function SetImageCallerValue(retValue,params){if (retValue && retValue.sFilename){var retString=retValue.sFilename; if (retString.indexOf("\074/a>")>-1){params.imageDialogCaller.SetThumbParent(retString); retString=$ektron(retString).find("\x69mg").eq(0).attr("sr\x63"); }params.imageDialogCaller.SetImagePath(retString); if (params.imageDialogCaller.AltText){params.imageDialogCaller.AltText.value=retValue.sCaption; }}document.body.focus( ); if (params.imageDialogCaller.onSrcChangeCallback!=null){params.imageDialogCaller.onSrcChangeCallback( ); }return false; }
function ImageInfoControl( ){}ImageInfoControl.prototype.Initialize= function (originalImage){ this.OriginalImage=originalImage; document.getElementById("\x72\141\x64Edito\x72Origina\x6cWidth").innerHTML="&nbsp;"+this.OriginalImage.width; document.getElementById("radE\x64itorOr\x69ginalHe\x69ght").innerHTML="&nbsp\x3b"+this.OriginalImage.height; var imageName=this.OriginalImage.src.substr(this.OriginalImage.src.lastIndexOf("/")+1); if (imageName.length>30){imageName="..."+imageName.substr((imageName.length-27),27); }document.getElementById("\x72adEd\x69\164\x6frImageS\x72c").innerHTML="&nbsp;"+imageName; document.getElementById("rad\x45ditorIm\x61geSize").innerHTML="\x26nbsp;"+((this.OriginalImage.fileSize!=null)?(this.OriginalImage.fileSize+"&nbsp;"+localization["Bytes"]): "N\x41"); } ;
var Rect_Fields=['\x72\x65ct_x','\x72ect_y','\x72ect\x5f\x77i\x64th','\x72ect\x5f\x68ei\x67\150\x74']; function ShowRectPropsDlg(RectProps){var Form=document.forms[0]; for (var i=0; i<Rect_Fields.length; i++){Form[Rect_Fields[i]].disabled= false; }Form['rect_x'].value=RectProps.x; Form['rect_\x79'].value=RectProps.y; Form['\162\x65ct_wid\x74h'].value=RectProps.width; if (CurrentArea.Shape.Type==AREA_SHAPE_CONSTANTS.RECTANGLE_TYPE){Form['r\x65ct_hei\x67\x68t'].value=RectProps.height; }else if (CurrentArea.Shape.Type==AREA_SHAPE_CONSTANTS.CIRCLE_TYPE){Form['\x72ect\x5f\x68ei\x67ht'].value=RectProps.width; Form['rec\x74_heigh\x74'].disabled= true; }}function CloseRectPropsDlg( ){var Form=document.forms[0]; for (var i=0; i<Rect_Fields.length; i++){Form[Rect_Fields[i]].value=''; Form[Rect_Fields[i]].disabled= true; }}function UpdateRectPropsDlg( ){var Form=document.forms[0]; var RectProps= {x:Form['\162\x65ct_x'].value,y:Form['\x72ect_\x79'].value,width:Form['re\x63t_width'].value,height:Form['r\x65ct_heig\x68\164'].value } ; if (!UpdateRectProps(RectProps)){alert(localization.getText('\x41lert\x49nvalidP\x72opertie\x73')); ShowRectProps( ); return false; } ; return true; }var Area_Fields=['area_lin\x6b','ar\x65\141\x5f\x74ar\x67et','\x61rea\x5f\x63om\x6d\145\x6e\x74','\141\x72\x65a_\x74arget_s\x65\154\x65ctor']; var Area_Buttons=['are\x61\137\x75\x70da\x74e_butto\x6e','\x61rea_rem\x6f\166\x65\137\x62\165\x74\164\x6f\156']; function ShowAreaPropsDlg(AreaProps){var Form=document.forms[0]; for (var i=0; i<Area_Fields.length; i++){Form[Area_Fields[i]].disabled= false; }for (var i=0; i<Area_Buttons.length; i++){Form[Area_Buttons[i]].disabled= false; }if (AreaProps.Link){Form['area_\x6cink'].value=AreaProps.Link; }else {Form['area_li\x6ek'].value='http://'; }Form['\x61rea_ta\x72\x67e\x74'].value=AreaProps.Target; Form['a\x72ea_targe\x74_select\x6fr'].value=AreaProps.Target; Form['ar\x65a_comme\x6et'].value=AreaProps.Comment; ShowMapProps( ); }function UpdateAreaPropsDlg( ){var Form=document.forms[0]; if (Form['\x61rea_up\x64\141\x74e_butt\x6fn'].disabled){return true; }if (!UpdateRectPropsDlg( )){return false; }var AreaProps= {Link:Form['\x61rea_li\x6e\153'].value,Comment:Form['\x61rea_comm\x65nt'].value,Target:Form['\x61rea\x5f\x74ar\x67et'].value } ; UpdateAreaProps(AreaProps); return true; }function CloseAreaPropsDlg( ){var Form=document.forms[0]; for (var i=0; i<Area_Fields.length; i++){Form[Area_Fields[i]].value=''; Form[Area_Fields[i]].disabled= true; }for (var i=0; i<Area_Buttons.length; i++){Form[Area_Buttons[i]].disabled= true; }CloseRectPropsDlg( ); DeselectCurrentArea( ); }function RemoveAreaDlg(RemoveAll){if (RemoveAll){if (!window.confirm(localization.getText('A\x6certDel\x65\164\x65AllAre\x61s'))){return; }RemoveAllAreas( ); }else {if (!window.confirm(localization.getText('AlertDe\x6ceteAre\x61'))){return; }RemoveArea( ); }}function ReturnNewImageMap( ){var ImageSrc=GetMapImageSrc( ); if (ImageSrc){if (UpdateAreaPropsDlg( )){var _props= {} ; _props.MapHtml=GetImageMapHTML( ); _props.ImageSrc=ImageSrc; CloseDlg(_props); }}else {CloseDlg( ); }}function GetMapImageSrc( ){var IMFrame=document.getElementById("\x49mageMapF\x72ame"); var IMDoc=IMFrame.contentWindow.document; var mappedImage=IMDoc.getElementById('\x6dapped\x49\x6da\x67\145'); if (mappedImage!=null){return mappedImage.src; }return null; }function GetImageMapInitialProperties( ){return GetDialogArguments( ); ; }function InsertNewMapAreaDlg( ){InsertNewMapArea( ); }function InitImageMapFrame( ){var IMHTML=document.getElementById("\111\x6dageM\x61pHTML"); var IMFrame=document.getElementById("\111\x6dag\x65\x4da\x70\106\x72ame"); var IMDoc=IMFrame.contentWindow.document; IMDoc.open( ); IMDoc.write('\x3chtm\x6c\076\x3chead>\x3c\x2fh\x65ad>\074\x62od\x79 style\x20= \042marg\x69n:0px\x200px 0p\x78 0px;\x66ont:1\x31px Ar\x69al; c\x6flor:\x72ed;ba\x63kgrou\x6ed-co\x6cor:w\x68ite;\042 onc\x6fntext\x6denu=\x22retu\x72n fa\x6cse\042\040\x75nse\x6cecta\x62le=\x22\x6fn\042\076'+IMHTML.value+'\074\057\x62\157\x64y>\074\x2fhtml\x3e'); IMDoc.close( ); }
function ImageMap(ImageElement){ this.AreaCollection=[ ]; this.AreaIDCnt=0; this.Name="\x49mageMap\x31"; this.Image=ImageElement; }ImageMap.prototype.Initialize= function (MapHTML){if (MapHTML){if (!this._InitFromHTMLString(MapHTML)){return false; }}return true; };ImageMap.prototype._InitFromHTMLString= function (MapHTML){var _Container=IMDoc.createElement('S\x50AN'); _Container.innerHTML=MapHTML; var Maps=_Container.getElementsByTagName('\x4dA\x50'); if (Maps.length!=1){return false; }var Map=Maps[0]; this.Name=Map.getAttribute('\156\x61me'); var AreaColl=Map.getElementsByTagName('area'); for (var i=0; i<AreaColl.length; i++){var Area=new MapArea(this.Image); Area.ID=this.AreaIDCnt; if (!Area.Initialize(AreaColl[i])){continue; }if (this.AddArea(Area)){Area.Draw( ); }}_Container=null; return true; };ImageMap.prototype.AddArea= function (MapArea){if (!this.IsAreaValid(MapArea)){return false; } this.AreaCollection.push(MapArea); this.AreaIDCnt++; return true; };ImageMap.prototype.AddNewArea= function (ShapeType,x,y,width,height){var Area=new MapArea(this.Image); Area.ID=this.AreaIDCnt; if (!Area.CreateDefaultShape(ShapeType,x,y,width,height)){return null; } this.AddArea(Area); Area.Draw( ); return Area; };ImageMap.prototype.GetAreaById= function (AreaID){return this.AreaCollection[AreaID]; };ImageMap.prototype.RemoveArea= function (AreaID){var Area=this.GetAreaById(AreaID); if (Area!=null){Area.Dispose( ); } this.AreaCollection[AreaID]=null; };ImageMap.prototype.IsAreaOverlaps= function (MapArea){return false; };ImageMap.prototype.IsAreaValid= function (MapArea){return !this.IsAreaOverlaps(MapArea); };ImageMap.prototype.GetHTML= function ( ){var _HTML=''; _HTML+='\074map'; _HTML+='\x20name=\x22\043'+this.Name.replace('\042','&#3\x34;')+'\042'; _HTML+='>'; for (var i=0; i<this.AreaCollection.length; i++){if (this.AreaCollection[i]!=null){_HTML+=this.AreaCollection[i].GetHTML( ); }}_HTML+='\074\x2fmap>'; return _HTML; };ImageMap.prototype.GetAreasNumber= function ( ){var nr=0; for (var i=0; i<this.AreaCollection.length; i++){if (this.AreaCollection[i]!=null){nr++;}}return nr; };function MapArea(ImageElement){ this.Comment=''; this.Link=''; this.Target=''; this.Image=ImageElement; }MapArea.prototype.GetHTML= function ( ){var _HTML=''; _HTML+='\074area'; _HTML+=' sh\x61pe=\042'+this.Shape.Type+'\042'; _HTML+='\x20coords\x3d\x22'+this.Shape.GetCoords( )+'\042'; if (this.Link.indexOf('about:b\x6cank')==0){ this.Link=this.Link.substr('\x61bout:bl\x61\156\x6b'.length); }else if (this.Link.indexOf('abou\x74:')==0){ this.Link=this.Link.substr('\141\x62out:'.length); }_HTML+=' \x68ref=\042'+this.Link.replace('\042','&#\x334;')+'\x22'; if (this.Target){_HTML+=' targe\x74=\042'+this.Target.replace('\x22','\046\x2334;')+'\042'; }if (this.Comment){_HTML+=' al\x74=\042'+this.Comment.replace('\x22','&\x2334;')+'\x22'; }_HTML+='\x2f>'; return _HTML; };MapArea.prototype.Initialize= function (AreaElement){var ShapeType=AreaElement.getAttribute('shape'); if (!ShapeType){ShapeType=AREA_SHAPE_CONSTANTS.DEFAULT_SHAPE_TYPE; } this.Shape=CreateAreaShapeByType(ShapeType); this.Shape.SetImage(this.Image); this.Shape.SetAreaId(this.ID); var Coords=AreaElement.getAttribute('\x63o\x6f\x72ds'); if (!this.Shape.AreCoordsValid(Coords)){return false; } this.Shape.SetCoords(Coords); this.Comment=AreaElement.getAttribute('\x61lt'); this.Link=AreaElement.getAttribute('hr\x65f'); if (this.Link.indexOf('about:b\x6cank')==0){ this.Link=this.Link.substr('\x61bout\x3a\x62la\x6ek'.length); }else if (this.Link.indexOf('\x61b\x6f\x75t:')==0){ this.Link=this.Link.substr('about\x3a'.length); } this.Target=AreaElement.getAttribute('\x74arget'); return true; };MapArea.prototype.Draw= function ( ){ this.Shape.Draw( ); };MapArea.prototype.Move= function (Props){var ShapeProps=this.Shape.GetShapeProperties( ); if (Props.x){ShapeProps.x+=Props.x; }if (Props.y){ShapeProps.y+=Props.y; }var ShapeCoords=this.Shape.ShapePropsToCoords(ShapeProps); if (!this.Shape.AreCoordsValid(ShapeCoords)){return false; } this.Shape.SetCoords(ShapeCoords); this.Shape.Draw( ); return true; };MapArea.prototype.SetSize= function (Props){var ShapeProps=this.Shape.GetShapeProperties( ); if (Props.width){ShapeProps.width=Props.width; }if (Props.height){ShapeProps.height=Props.height; }var ShapeCoords=this.Shape.ShapePropsToCoords(ShapeProps); if (!this.Shape.AreCoordsValid(ShapeCoords)){return false; } this.Shape.SetCoords(ShapeCoords); this.Shape.Resize(Props); return true; };MapArea.prototype.CreateDefaultShape= function (ShapeType,x,y,width,height){ this.Shape=CreateAreaShapeByType(ShapeType); this.Shape.SetImage(this.Image); this.Shape.SetAreaId(this.ID); var ShapeCoords=this.Shape.ShapePropsToCoords( {x:x,y:y,width:width,height:height } ); if (!this.Shape.AreCoordsValid(ShapeCoords)){return null; }return this.Shape.SetCoords(ShapeCoords); };MapArea.prototype.GetProperties= function ( ){return {Comment: this.Comment,Link: this.Link,Target: this.Target };};MapArea.prototype.SetProperties= function (Props){ this.Comment=Props.Comment; this.Link=Props.Link; this.Target=Props.Target; };MapArea.prototype.SetSelected= function ( ){ this.Shape.SetSelected( ); };MapArea.prototype.DeSelect= function ( ){ this.Shape.DeSelect( ); };MapArea.prototype.Dispose= function ( ){ this.Shape.Dispose( ); this.Image=null; };var AREA_SHAPE_CONSTANTS= {RECTANGLE_TYPE: "\x52ECT",CIRCLE_TYPE: "CIRCLE",POLYGON_TYPE: "POL\x59" };AREA_SHAPE_CONSTANTS.DEFAULT_SHAPE_TYPE=AREA_SHAPE_CONSTANTS.RECTANGLE_TYPE; function AreaShape( ){ this.Coords=""; this.Type=""; this.ResizeElementClassName="\x63irc_s\x68\141\x70e_resiz\x65r"; }AreaShape.prototype.GetType= function ( ){return this.Type; };AreaShape.prototype.GetCoords= function ( ){return this.Coords; };AreaShape.prototype.AreCoordsValid= function (Coords){return false; };AreaShape.prototype.SetCoords= function (Coords){if (!this.AreCoordsValid(Coords)){return false; } this.Coords=Coords; return true; };AreaShape.prototype.SetImage= function (ImageElement){ this.Image=ImageElement; };AreaShape.prototype.Resize= function (Props){};AreaShape.prototype.SetAreaId= function (AreaID){ this.AreaID=AreaID; };AreaShape.prototype.CreateResizerElement= function ( ){var ResizeElement=IMDoc.createElement('\x44IV'); ResizeElement.id='\x72es_'+this.AreaID; ResizeElement.className=this.ResizeElementClassName; ResizeElement.style.width=5; ResizeElement.style.height=5; ResizeElement.style.position='abs\x6flute'; ResizeElement.style.display='none'; return IMDoc.body.appendChild(ResizeElement); };AreaShape.prototype.GetShapeProperties= function ( ){return this.ShapeCoordsToProps(this.Coords); };AreaShape.prototype.SetSelected= function ( ){};AreaShape.prototype.DeSelect= function ( ){};AreaShape.prototype.Draw= function ( ){};AreaShape.prototype.OnSelect= function ( ){};AreaShape.prototype.Dispose= function ( ){};function CreateAreaShapeByType(ShapeType){var _ShapeTypes_Constructors= {} ; _ShapeTypes_Constructors[AREA_SHAPE_CONSTANTS.RECTANGLE_TYPE]=RectangleShape; _ShapeTypes_Constructors[AREA_SHAPE_CONSTANTS.POLYGON_TYPE]=PolygonShape; _ShapeTypes_Constructors[AREA_SHAPE_CONSTANTS.CIRCLE_TYPE]=CircleShape; if (!_ShapeTypes_Constructors[ShapeType]){ShapeType=AREA_SHAPE_CONSTANTS.DEFAULT_SHAPE_TYPE; }if (ShapeType==AREA_SHAPE_CONSTANTS.CIRCLE_TYPE && !IsCircleShapeSupported( )){return null; }return new _ShapeTypes_Constructors[ShapeType]( ); }function RectangleShape( ){ this.Type=AREA_SHAPE_CONSTANTS.RECTANGLE_TYPE; this.VisualFillElement=null; this.VisualBorderElement=null; this.ResizeElement=null; this.ResizeElementClassName="\x72e\x63\x74_s\x68ape_resi\x7aer"; this.SelectedClassName="rect_\x73hape_sel\x65cted"; this.NotSelectedClassName="rect\x5f\163\x68ape_not_\x73electe\x64"; this.BorderElementClass="\x72ect\x5f\x73ha\x70e_border"; }RectangleShape.prototype=new AreaShape( ); RectangleShape.prototype.ContainerTitle=''; RectangleShape.prototype.Resize= function (Props){if (Props.width){var Width=Math.abs(Props.width); this.VisualFillElement.style.width=Width-1; this.VisualBorderElement.style.width=Width; }if (Props.height){var Height=Math.abs(Props.height); this.VisualFillElement.style.height=Height-1; this.VisualBorderElement.style.height=Height; } this.SetResizeElementPosition( ); };RectangleShape.prototype.Draw= function ( ){var ImageCoords=RadEditorNamespace.Utils.GetRect(this.Image); if (this.VisualBorderElement){IMDoc.body.removeChild(this.VisualBorderElement); }if (this.ResizeElement){IMDoc.body.removeChild(this.ResizeElement); }var BorderContainer=IMDoc.createElement('DIV'); var Container=IMDoc.createElement('DIV'); BorderContainer.style.position='absolut\x65'; BorderContainer.className=this.BorderElementClass; BorderContainer.title=this.ContainerTitle; var ShapeProps=this.GetShapeProperties( ); BorderContainer.style.top=ImageCoords.top+ShapeProps.y; BorderContainer.style.left=ImageCoords.left+ShapeProps.x; BorderContainer.style.width=ShapeProps.width; BorderContainer.style.height=ShapeProps.height; Container.className=this.NotSelectedClassName; Container.style.width=ShapeProps.width-1; Container.style.height=ShapeProps.height-1; BorderContainer.id='rect_'+this.AreaID; BorderContainer.ShapeObj=this ; BorderContainer.onclick=this.HandleClick; BorderContainer.appendChild(Container); IMDoc.body.appendChild(BorderContainer); var ResizeElement=this.CreateResizerElement( ); this.VisualFillElement=Container; this.VisualBorderElement=BorderContainer; this.ResizeElement=ResizeElement; this.SetResizeElementPosition( ); var self=this ; var onMoveEnd= function ( ){var oRect=RadEditorNamespace.Utils.GetRect(self.VisualBorderElement); var oRect2=RadEditorNamespace.Utils.GetRect(self.Image); self.SetResizeElementPosition( ); var Coords=self.ShapePropsToCoords( {x:oRect.left-oRect2.left,y:oRect.top-oRect2.top,width:oRect.width,height:oRect.height } ); if (self.AreCoordsValid(Coords)){self.SetCoords(Coords); }else {self.Draw( ); }self.OnSelect( ); };var onMove= function ( ){self.SetResizeElementPosition( ); } ; var onResize= function (fff,x,y){BorderContainer.style.cursor="SE-resiz\x65"; var oRect=RadEditorNamespace.Utils.GetRect(BorderContainer); var bottomX=oRect.left+oRect.width+parseInt(self.ResizeElement.style.width); var bottomY=oRect.top+oRect.height+parseInt(self.ResizeElement.style.height); var areaDivHeight=(oRect.height+y-bottomY); var areaDivWidth=(oRect.width+x-bottomX);var Props= {width:areaDivWidth,height:areaDivHeight } ; self.Resize(Props); } ; var onResizeEnd= function ( ){BorderContainer.style.cursor="\x6dove"; onMoveEnd( ); } ; var _t=new Draggable(BorderContainer,BorderContainer,null,onMove,onMoveEnd); var _t2=new Draggable(ResizeElement,ResizeElement,null,onResize,onResizeEnd); };RectangleShape.prototype.SetResizeElementPosition= function ( ){var VisualElStyle=this.VisualBorderElement.style; this.ResizeElement.style.top=parseInt(VisualElStyle.top)+parseInt(VisualElStyle.height); this.ResizeElement.style.left=parseInt(VisualElStyle.left)+parseInt(VisualElStyle.width); this.ResizeElement.style.display="block"; };RectangleShape.prototype.HandleClick= function ( ){ this.ShapeObj.OnSelect( ); };RectangleShape.prototype.SetSelected= function ( ){ this.VisualFillElement.className=this.SelectedClassName; this.ResizeElement.style.display='block'; this.VisualBorderElement.style.zIndex=2; this.ResizeElement.style.zIndex=2; };RectangleShape.prototype.DeSelect= function ( ){ this.VisualFillElement.className=this.NotSelectedClassName; this.ResizeElement.style.display='\156\x6fne'; this.VisualBorderElement.style.zIndex=1; this.ResizeElement.style.zIndex=1; };RectangleShape.prototype.ShapePropsToCoords= function (ShapeProps){return ShapeProps.x+'\x2c'+ShapeProps.y+','+(parseInt(ShapeProps.x)+parseInt(ShapeProps.width))+'\054'+(parseInt(ShapeProps.y)+parseInt(ShapeProps.height)); };RectangleShape.prototype.ShapeCoordsToProps= function (Coords){var _Coords=Coords.split('\x2c'); var xLeft=_Coords[0]; var yTop=_Coords[1]; var xRight=_Coords[2]; var yBottom=_Coords[3]; return {x:parseInt(xLeft),y:parseInt(yTop),width:parseInt((xRight-xLeft)),height:parseInt((yBottom-yTop))};};RectangleShape.prototype.AreCoordsValid= function (Coords){var _Coords=Coords.split(','); if (_Coords.length!=4){return false; }for (var i=0; i<_Coords.length; i++){if (_Coords[i]<0){return false; }}var ShapeProps=this.ShapeCoordsToProps(Coords); if (ShapeProps.width<=0){return false; }if (ShapeProps.height<=0){return false; }if ((ShapeProps.x+ShapeProps.width)>this.Image.offsetWidth){return false; }if ((ShapeProps.y+ShapeProps.height)>this.Image.offsetHeight){return false; }return true; };RectangleShape.prototype.Dispose= function ( ){ this.VisualFillElement=null; if (this.VisualBorderElement){IMDoc.body.removeChild(this.VisualBorderElement); this.VisualBorderElement=null; }if (this.ResizeElement){IMDoc.body.removeChild(this.ResizeElement); this.ResizeElement=null; }};function IsCircleShapeSupported( ){if (!document.all && !IsFFCanvasSupported( )){return false; }return true; }function CircleShape( ){ this.Type=AREA_SHAPE_CONSTANTS.CIRCLE_TYPE; this.VisualElement=null; this.ResizeElement=null; this.SelectedClassName="ci\x72c_shape\x5fselected"; this.NotSelectedClassName="circ_sh\x61pe_not\x5f\163\x65lecte\x64"; }CircleShape.prototype=new AreaShape( ); CircleShape.prototype.ContainerTitle=''; CircleShape.prototype.Resize= function (Props){if (document.all){if (Props.width){ this.VisualElement.style.width=Math.abs(Props.width); this.VisualElement.style.height=Math.abs(Props.width); } this.SetResizeElementPosition( ); }else { this.Draw( ); }};CircleShape.prototype.Draw= function (FFCircColor){if (this.VisualElement){IMDoc.body.removeChild(this.VisualElement); }if (this.ResizeElement){IMDoc.body.removeChild(this.ResizeElement); }var ImageCoords=RadEditorNamespace.Utils.GetRect(this.Image); var ShapeProps=this.GetShapeProperties( ); var Container=IMDoc.createElement('\x44IV'); if (document.all){Container.innerHTML='\x3c'+'v:ova\x6c\040\x66illcol\x6fr=\042'+CIRCLESHAPE_BCKG_COLOR_NOT_SELECTED+'\x22 st\x79\x6ce=\x22position\x3aabsolu\x74e;\042\x20>\074/v:ova\x6c>'; }else {Container.innerHTML='\x3ccanv\x61\163\x20width=\x22'+ShapeProps.width+'\x22 he\x69\147h\x74=\042'+ShapeProps.width+'\x22>\074/canva\x73\076'; }Container=Container.childNodes[0]; Container.style.position='\x61bsolut\x65'; Container.title=this.ContainerTitle; Container.style.top=ImageCoords.top+ShapeProps.y; Container.style.left=ImageCoords.left+ShapeProps.x; if (!document.all){var ctx=Container.getContext('2\x64'); ctx.beginPath( ); var radius=parseInt(ShapeProps.width/2); var x=radius; var y=radius; var startAngle=0; var endAngle=360; ctx.arc(x,y,radius,startAngle,endAngle, false); if (!FFCircColor){FFCircColor=CIRCLESHAPE_BCKG_COLOR_NOT_SELECTED; }ctx.fillStyle=FFCircColor; ctx.fill( ); ctx.stroke( ); }else {}Container.style.width=ShapeProps.width; Container.style.height=ShapeProps.width; Container.className=this.NotSelectedClassName; Container.id='\x63irc_'+this.AreaID; Container.ShapeObj=this ; Container.onclick=this.HandleClick; IMDoc.body.appendChild(Container); var ResizeElement=this.CreateResizerElement( ); this.VisualElement=Container; this.ResizeElement=ResizeElement; this.SetResizeElementPosition( ); var self=this ; var onMoveEnd= function ( ){var oRect=RadEditorNamespace.Utils.GetRect(self.VisualElement); var oRect2=RadEditorNamespace.Utils.GetRect(self.Image); self.SetResizeElementPosition( ); var Coords=self.ShapePropsToCoords( {x:oRect.left-oRect2.left,y:oRect.top-oRect2.top,width:oRect.width } ); if (self.AreCoordsValid(Coords)){self.SetCoords(Coords); }else {self.Draw( ); }self.OnSelect( ); };var onMove= function ( ){self.SetResizeElementPosition( ); } ; var onResize= function (fff,x,y){Container.style.cursor="\x57-\x72\145\x73ize"; var oRect=RadEditorNamespace.Utils.GetRect(Container); var bottomX=oRect.left+oRect.width+parseInt(self.ResizeElement.style.width); var areaDivWidth=(oRect.width+(x-bottomX));Container.style.width=(areaDivWidth>0?areaDivWidth: 0)+"px"; Container.style.height=Container.style.width; self.SetResizeElementPosition( ); } ; var onResizeEnd= function ( ){Container.style.cursor="m\x6fve"; onMoveEnd( ); } ; var _t=new Draggable(Container,Container,null,onMove,onMoveEnd); var _t2=new Draggable(ResizeElement,ResizeElement,null,onResize,onResizeEnd); };CircleShape.prototype.SetResizeElementPosition= function ( ){var VisualElStyle=this.VisualElement.style; var CircleRadius=parseInt(VisualElStyle.width)/2; var SquareWidth=parseInt(VisualElStyle.width); var TopPos=parseInt(VisualElStyle.top)+CircleRadius; var LeftPos=parseInt(VisualElStyle.left)+SquareWidth; this.ResizeElement.style.top=TopPos; this.ResizeElement.style.left=LeftPos; this.ResizeElement.style.display="\x62lock"; };CircleShape.prototype.HandleClick= function ( ){ this.ShapeObj.OnSelect( ); };CircleShape.prototype.SetSelected= function ( ){if (document.all){ this.VisualElement.fillColor=CIRCLESHAPE_BCKG_COLOR_SELECTED; }else { this.Draw(CIRCLESHAPE_BCKG_COLOR_SELECTED); } this.VisualElement.className=this.SelectedClassName; this.ResizeElement.style.display='bl\x6fck'; this.VisualElement.style.zIndex=2; this.ResizeElement.style.zIndex=2; };CircleShape.prototype.DeSelect= function ( ){if (document.all){ this.VisualElement.fillColor=CIRCLESHAPE_BCKG_COLOR_NOT_SELECTED; }else { this.Draw(CIRCLESHAPE_BCKG_COLOR_NOT_SELECTED); } this.VisualElement.className=this.NotSelectedClassName; this.ResizeElement.style.display='none'; this.VisualElement.style.zIndex=1; this.ResizeElement.style.zIndex=1; };CircleShape.prototype.ShapePropsToCoords= function (ShapeProps){var Radius=parseInt(ShapeProps.width)/2; return (parseInt(ShapeProps.x)+Radius)+'\054'+(parseInt(ShapeProps.y)+Radius)+','+Radius; };CircleShape.prototype.ShapeCoordsToProps= function (Coords){var _Coords=Coords.split(','); var CenterLeft=parseInt(_Coords[0]); var CenterTop=parseInt(_Coords[1]); var Radius=parseInt(_Coords[2]); return {x:CenterLeft-Radius,y:CenterTop-Radius,width: (Radius*2)};};CircleShape.prototype.AreCoordsValid= function (Coords){var _Coords=Coords.split('\x2c'); if (_Coords.length!=3){return false; }for (var i=0; i<_Coords.length; i++){if (_Coords[i]<0){return false; }}var ShapeProps=this.ShapeCoordsToProps(Coords); if (ShapeProps.x<0){return false; }if (ShapeProps.y<0){return false; }if (ShapeProps.width<=0){return false; }if ((ShapeProps.x+ShapeProps.width)>this.Image.offsetWidth){return false; }if ((ShapeProps.y+ShapeProps.width)>this.Image.offsetHeight){return false; }return true; };CircleShape.prototype.Dispose= function ( ){if (this.VisualElement){IMDoc.body.removeChild(this.VisualElement); this.VisualElement=null; }if (this.ResizeElement){IMDoc.body.removeChild(this.ResizeElement); this.ResizeElement=null; }};function PolygonShape( ){ this.Type=AREA_SHAPE_CONSTANTS.POLYGON_TYPE; }PolygonShape.prototype=new AreaShape( ); PolygonShape.prototype.Draw= function ( ){alert('\x64raw po\x6c\171\x67on'); };if (typeof(RadEditorNamespace)=='u\x6edefined'){RadEditorNamespace= {} ; }RadEditorNamespace.Utils= {GetRect:function (element){if (!element){element=this ; }var left=0; var top=0; var width=element.offsetWidth; var height=element.offsetHeight; while (element.offsetParent){left+=element.offsetLeft; top+=element.offsetTop; element=element.offsetParent; }if (element.x)left=element.x; if (element.y)top=element.y; left=RadEditorNamespace.Utils.GetIntValue(left,0); top=RadEditorNamespace.Utils.GetIntValue(top,0); width=RadEditorNamespace.Utils.GetIntValue(width,0); height=RadEditorNamespace.Utils.GetIntValue(height,0); return new RadEditorNamespace.Utils.Rectangle(left,top,width,height); } ,Rectangle:function (left,top,width,height){ this.left=(null!=left?left: 0); this.top=(null!=top?top: 0); this.width=(null!=width?width: 0); this.height=(null!=height?height: 0); this.right=left+width; this.bottom=top+height; } ,AttachEventEx:function (element,eventName,handler){eventName=RadEditorNamespace.Utils.FixEventName(eventName); if (element.attachEvent){element.attachEvent(eventName,handler); }else if (element.addEventListener){element.addEventListener(eventName,handler, true); }} ,DetachEventEx:function (element,eventName,handler){eventName=RadEditorNamespace.Utils.FixEventName(eventName); if (element.detachEvent){element.detachEvent(eventName,handler); }else if (element.addEventListener){element.removeEventListener(eventName,handler, true); }} ,FixEventName:function (eventName){eventName=eventName.toLowerCase( ); if (document.addEventListener && RadEditorNamespace.Utils.StartsWith(eventName,"\157\x6e")){return eventName.substr(2); }else if (document.attachEvent && !RadEditorNamespace.Utils.StartsWith(eventName,"on")){return "\x6fn"+eventName; }else {return eventName; }} ,CancelEvent:function (eventArgs){if (!eventArgs)eventArgs=IMWin.event; if (!eventArgs)return false; eventArgs.returnValue= false; eventArgs.cancelBubble= true; if (eventArgs.stopPropagation){eventArgs.stopPropagation( ); }return false; } ,GetIntValue:function (sNumber,defaultValue){if (!defaultValue)defaultValue=0; var nNumber=parseInt(sNumber); return (isNaN(nNumber)?defaultValue:nNumber); } ,StartsWith:function (text,value){if (typeof(value)!="\x73trin\x67")return false; return (0==text.indexOf(value)); } ,GetEventSource:function (e){if (null==e)return null; if (e.srcElement)return e.srcElement; else if (e.target)return e.target; else return null; }};function Draggable(obj,objToMove,onDragStart,onDrag,onDragEnd){var objToMove=objToMove!=null?objToMove:obj; this.obj=obj; this.objToMove=objToMove; this.onDragStart=onDragStart; this.onDrag=onDrag; this.onDragEnd=onDragEnd; this.zIndex=0; var dragObj=this ; obj.onmousedown= function (e){if (dragObj.onDragStart)dragObj.onDragStart(objToMove); dragObj.elNode=objToMove; var array=GetCursorPos(e); x=array[0]; y=array[1]; dragObj.cursorStartX=x; dragObj.cursorStartY=y; var oRect=RadEditorNamespace.Utils.GetRect(objToMove); dragObj.elStartLeft=oRect.left; dragObj.elStartTop=oRect.top; if (isNaN(dragObj.elStartLeft))dragObj.elStartLeft=0; if (isNaN(dragObj.elStartTop))dragObj.elStartTop=0; objToMove.style.position="a\x62solute"; dragObj.elNode.style.zIndex= ++dragObj.zIndex; RadEditorNamespace.Utils.AttachEventEx(IMDoc,"\x6fnmo\x75\x73em\x6fve",dragObj.DragGo); RadEditorNamespace.Utils.AttachEventEx(IMDoc,"\x6fnmouseup",dragObj.DragStop); RadEditorNamespace.Utils.CancelEvent(e?e:IMWin.event); };this.DragGo= function (e){var array=GetCursorPos(e); x=array[0]; y=array[1]; var offsetX=(dragObj.elStartLeft+x-dragObj.cursorStartX); var offsetY=(dragObj.elStartTop+y-dragObj.cursorStartY); dragObj.elNode.style.left=offsetX+"p\x78"; dragObj.elNode.style.top=offsetY+"\x70x"; RadEditorNamespace.Utils.CancelEvent(e?e:IMWin.event); if (dragObj.onDrag)dragObj.onDrag(objToMove,x,y); };this.DragStop= function (event){RadEditorNamespace.Utils.DetachEventEx(IMDoc,"\x6fn\x6d\157\x75semove",dragObj.DragGo); RadEditorNamespace.Utils.DetachEventEx(IMDoc,"\x6fnmous\x65\x75p",dragObj.DragStop); if (dragObj.onDragEnd)dragObj.onDragEnd(objToMove); };function GetCursorPos(e){if (document.all){x=IMWin.event.clientX+IMDoc.documentElement.scrollLeft+IMDoc.body.scrollLeft; y=IMWin.event.clientY+IMDoc.documentElement.scrollTop+IMDoc.body.scrollTop; }else {x=e.clientX+IMWin.scrollX; y=e.clientY+IMWin.scrollY; }return [x,y]; }}
; function ShowRectProps( ){var RectProps=CurrentArea.Shape.GetShapeProperties( ); ShowRectPropsDlg(RectProps); }function UpdateRectProps(RectProps){if (!CurrentArea){return; }var Coords=CurrentArea.Shape.ShapePropsToCoords(RectProps); if (!CurrentArea.Shape.AreCoordsValid(Coords)){return false; }CurrentArea.Shape.SetCoords(Coords); CurrentArea.Shape.Draw( ); return true; }var CurrentArea=null;RectangleShape.prototype.OnSelect= function ( ){if (CurrentArea){CurrentArea.DeSelect( ); }CurrentArea=imageMap.GetAreaById(this.AreaID); var AreaProps=CurrentArea.GetProperties( ); ShowAreaPropsDlg(AreaProps); ShowRectProps( ); ShowAreaProps( ); CurrentArea.SetSelected( ); };CircleShape.prototype.OnSelect= function ( ){if (CurrentArea){CurrentArea.DeSelect( ); }CurrentArea=imageMap.GetAreaById(this.AreaID); var AreaProps=CurrentArea.GetProperties( ); ShowAreaPropsDlg(AreaProps); ShowRectProps( ); ShowAreaProps( ); CurrentArea.SetSelected( ); };function ShowAreaProps( ){}function UpdateAreaProps(AreaProps){CurrentArea.SetProperties(AreaProps); CurrentArea.Shape.OnSelect( ); }function DeselectCurrentArea( ){if (CurrentArea){CurrentArea.DeSelect( ); }}function RemoveArea( ){if (!imageMap || !CurrentArea){return; }imageMap.RemoveArea(CurrentArea.ID); CurrentArea=null; CloseAreaPropsDlg( ); if (imageMap.GetAreasNumber( )==0){HideMapProps( ); }}function RemoveAllAreas( ){for (var i=0; i<imageMap.AreaCollection.length; i++){if (imageMap.AreaCollection[i]!=null){imageMap.RemoveArea(imageMap.AreaCollection[i].ID); }}CurrentArea=null; CloseAreaPropsDlg( ); HideMapProps( ); }function HideMapProps( ){document.getElementById('map\x5fprops').style.display='\x6eone'; }function ShowMapProps( ){document.getElementById('map_prop\x73').style.display=''; }function CheckKeyDown(e){if (!CurrentArea){return; }if (e.keyCode==46){RemoveArea( ); }else if (e.keyCode==37){CurrentArea.Move( {x: -1,y: 0 } ); CurrentArea.Shape.OnSelect( ); }else if (e.keyCode==40){CurrentArea.Move( {x: 0,y: 1 } ); CurrentArea.Shape.OnSelect( ); }else if (e.keyCode==38){CurrentArea.Move( {x: 0,y: -1 } ); CurrentArea.Shape.OnSelect( ); }else if (e.keyCode==39){CurrentArea.Move( {x: 1,y: 0 } ); CurrentArea.Shape.OnSelect( ); }}function GetImageMapHTML( ){return imageMap.GetHTML( ); }var imageMap; var IMWin; var IMDoc; function InitializeImageMap( ){IMWin=document.getElementById("Imag\x65MapFrame").contentWindow; IMDoc=IMWin.document; var InitialProperties=GetImageMapInitialProperties( ); var ImageSrc=InitialProperties.ImageSrc; var ChangeImageSrc= function ( ){var NewSrc=ImageDialogCaller.GetImagePath( ); if (NewSrc){var ImageElement=IMDoc.getElementById('\x6dappedIma\x67e'); var ImageTextElement=IMDoc.getElementById('\x6dappedI\x6d\x61g\x65\124\x65xt'); if (ImageTextElement!=null){ImageTextElement.parentNode.removeChild(ImageTextElement); }if (ImageElement==null){ImageElement=InsertImageForMap( ); imageMap=new ImageMap(ImageElement); }ImageElement.src=NewSrc; SetDummyLayerOverImage(ImageElement); document.getElementById('a\x72ea_cont\x72\157\x6cs').style.display='bloc\x6b'; }};ImageDialogCaller.Initialize(InitialProperties.EditorObj,25,ChangeImageSrc); function InsertImageForMap( ){ImageElement=IMDoc.createElement('IMG'); ImageElement.id='m\x61ppedIma\x67e'; ImageElement.setAttribute('u\x6eselecta\x62le','o\x6e'); IMDoc.body.appendChild(ImageElement); return ImageElement; }function SetDummyLayerOverImage(oImage){var oRect=RadEditorNamespace.Utils.GetRect(oImage); var oDummy=IMDoc.getElementById("dum\x6dy"); oDummy.style.left=oRect.left; oDummy.style.top=oRect.top; oDummy.style.width=oRect.width; oDummy.style.height=oRect.height; RadEditorNamespace.Utils.AttachEventEx(IMDoc,'keydo\x77n',CheckKeyDown); RadEditorNamespace.Utils.AttachEventEx(oDummy,'mou\x73edown',ImageMapper_OnMouseDown); }var oImage; if (ImageSrc){oImage=InsertImageForMap( ); oImage.src=ImageSrc; var ImageWidth=InitialProperties.ImageWidth; if (ImageWidth){oImage.style.width=ImageWidth; }var ImageHeight=InitialProperties.ImageHeight; if (ImageHeight){oImage.style.height=ImageHeight; }ImageDialogCaller.SetImagePath(ImageSrc); SetDummyLayerOverImage(oImage); imageMap=new ImageMap(oImage); var ImageMapHTML=InitialProperties.ImageMapHTML; if (ImageMapHTML){imageMap.Initialize(ImageMapHTML); }document.getElementById('\x61rea_cont\x72\157\x6cs').style.display='\142\x6c\157c\x6b'; }else {var Element=IMDoc.createElement('CENTE\x52'); Element.id='\x6dapped\x49\x6dag\x65Text'; Element.innerHTML=localization.getText('Sele\x63tImage'); oImage=IMDoc.body.appendChild(Element); }RectangleShape.prototype.ContainerTitle=localization.getText('\123\x68apeAlt'); CircleShape.prototype.ContainerTitle=localization.getText('Shape\x41lt'); if (imageMap && imageMap.GetAreasNumber( )>0){ShowMapProps( ); }}function GetSelectedShapeType( ){var Form=document.forms[0]; var ShapeTypeGroup=Form["shape_\x74ype"]; for (var i=0; i<ShapeTypeGroup.length; i++){if (ShapeTypeGroup[i].checked){return ShapeTypeGroup[i].value; }}return AREA_SHAPE_CONSTANTS.DEFAULT_SHAPE_TYPE; }function InsertNewMapArea(x,y,width,height){var ShapeType=GetSelectedShapeType( ); var _ShapeTypes_CreateFunc= {} ; _ShapeTypes_CreateFunc[AREA_SHAPE_CONSTANTS.RECTANGLE_TYPE]=InsertNewMapAreaRect; _ShapeTypes_CreateFunc[AREA_SHAPE_CONSTANTS.POLYGON_TYPE]=InsertNewMapAreaPoly; _ShapeTypes_CreateFunc[AREA_SHAPE_CONSTANTS.CIRCLE_TYPE]=InsertNewMapAreaCirc; if (!_ShapeTypes_CreateFunc[ShapeType]){ShapeType=AREA_SHAPE_CONSTANTS.DEFAULT_SHAPE_TYPE; }return _ShapeTypes_CreateFunc[ShapeType](x,y,width,height); }function InsertNewMapAreaCirc(x,y,width,height){if (typeof(x)=='\x75ndefine\x64'){var oImage=IMDoc.getElementById("m\x61ppedIma\x67e"); if (oImage.offsetWidth<40 || oImage.offsetHeight<40){x=0; y=0; width=1; }else {x=10; y=10; width=20; }}IMDoc.body.scrollLeft=0; IMDoc.body.scrollTop=0; try {IMDoc.body.focus( ); }catch (e){}var Area=imageMap.AddNewArea(AREA_SHAPE_CONSTANTS.CIRCLE_TYPE,x,y,width); if (Area!=null){Area.Shape.OnSelect( ); }return Area; }function InsertNewMapAreaRect(x,y,width,height){if (typeof(x)=='unde\x66ined'){var oImage=IMDoc.getElementById("\155\x61ppedIma\x67e"); if (oImage.offsetWidth<40 || oImage.offsetHeight<40){x=0; y=0; width=1; height=1; }else {x=10; y=10; width=20; height=20; }}IMDoc.body.scrollLeft=0; IMDoc.body.scrollTop=0; try {IMDoc.body.focus( ); }catch (e){}var Area=imageMap.AddNewArea(AREA_SHAPE_CONSTANTS.RECTANGLE_TYPE,x,y,width,height); if (Area!=null){Area.Shape.OnSelect( ); }return Area; }function InsertNewMapAreaPoly(x,y,width,height){}function IsFFCanvasSupported( ){var oCanvas=document.createElement('canv\x61s'); if (!oCanvas.getContext){return false;}return true; }var InitialOffsetX=0; var InitialOffsetY=0; function ImageMapper_OnMouseDown(e){var oEvent=(document.all)?IMWin.event:e; var oRect=RadEditorNamespace.Utils.GetRect(IMDoc.getElementById("\x6dapp\x65\x64Im\x61ge")); var ImageLeft=oRect.left; var ImageTop=oRect.top; InitialOffsetX=oEvent.clientX-ImageLeft; InitialOffsetY=oEvent.clientY-ImageTop; IsMouseMoved= false; if (CurrentArea){CloseAreaPropsDlg( ); CurrentArea=null; }RadEditorNamespace.Utils.AttachEventEx(IMDoc,"mouse\x6dove",ImageMapper_OnMouseMove); RadEditorNamespace.Utils.AttachEventEx(IMDoc,"mo\x75seup",ImageMapper_OnMouseUp); RadEditorNamespace.Utils.CancelEvent(oEvent); }function ImageMapper_OnMouseMove(e){var oEvent=(document.all)?IMWin.event:e; if (!CurrentArea){var DefaultWidth=2; var DefaultHeight=2; CurrentArea=InsertNewMapArea(InitialOffsetX,InitialOffsetY,DefaultWidth,DefaultHeight); if (!CurrentArea){return; }}IsMouseMoved= true; var oRect=RadEditorNamespace.Utils.GetRect(IMDoc.getElementById("mappedIm\x61ge")); var ImageLeft=oRect.left; var ImageTop=oRect.top; var offsetX=oEvent.clientX-ImageLeft; var offsetY=oEvent.clientY-ImageTop; var NewProps= {width:Math.abs(offsetX-InitialOffsetX),height:Math.abs(offsetY-InitialOffsetY)} ; CurrentArea.SetSize(NewProps); RadEditorNamespace.Utils.CancelEvent(oEvent); }function ImageMapper_OnMouseUp( ){if (IsMouseMoved){if (CurrentArea){CurrentArea.Shape.OnSelect( ); }}RadEditorNamespace.Utils.DetachEventEx(IMDoc,"\x6dousemove",ImageMapper_OnMouseMove); RadEditorNamespace.Utils.DetachEventEx(IMDoc,"mouse\x75p",ImageMapper_OnMouseUp); IsMouseMoved= false; }
var fileName,pathName; var deletePath=-1; var selectedControl=null; var selectedItem=""; var selectedFolder=""; var disableThumb="H\x65\x69ght"; var submitForUpload; function submitImagesFile(fileBrowser){submitForUpload= true; var imageFileControl=document.getElementById(FileUploadID); if (trim(imageFileControl.value)==""){alert(localization["\x41lertIm\x61\x67e"]); imageFileControl.focus( ); submitForUpload= false; }else {document.getElementById(fileDirID).value=fileBrowser.CurrentItem.GetPath( ); document.getElementById("loader").innerHTML=localization["\x55p\x6c\x6fadi\x6eg"]; showObject("loader"); }}function validateUnit(unit){return unit.match(/(\x31|\x32|\x33|\x34|\x35|\x36|\x37|\x38|\x39)\d*\x25?$/gi); }function ImagePreviewer(Id,ThumbnailCreator,ThumbnailSuffix,CanCreateThumbnail){ this.ImagePath=""; this.Id=Id; this.ThumbnailCreator=ThumbnailCreator; this.ThumbnailCreatorHolder=document.getElementById(this.Id+"\x5fthu\x6d\x62na\x69lCreato\x72Holde\x72"); this.ThumbnailSuffix=ThumbnailSuffix; this.CanCreateThumbnail=CanCreateThumbnail; this.PreviewAreaHolder=document.getElementById(this.Id+"\x5fprev\x69\x65w\x41\162\x65aHol\x64\145\x72"); this.IsPreviewerShown= false; this.AltTextRow=document.getElementById(this.Id+"\x5faltT\x65\x78t\x52\157\x77"); this.AltTextRow.style.display="none"; this.AltTextHolder=document.getElementById(this.Id+"_altTex\x74"); this.ThumbnailCreatorLink=document.getElementById(this.Id+"_thu\x6dbnailCre\x61torLink"); this.Area=document.getElementById("Previ\x65wArea"); if (this.CanCreateThumbnail!= true){ this.ThumbnailCreatorLink.className="\x44isabled"; }if (typeof(GetDisposeManager)!="undefine\x64")GetDisposeManager( ).Add(this ); }ImagePreviewer.prototype.Dispose= function ( ){ this.ThumbnailCreator=null; this.ThumbnailCreatorHolder=null; this.PreviewAreaHolder=null; this.AltTextRow=null; this.AltTextHolder=null; this.ThumbnailCreatorLink=null; this.Area=null; } ; ImagePreviewer.prototype.Clear= function ( ){ this.Area.innerHTML=""; this.ImagePath=""; };ImagePreviewer.prototype.GetHtml= function ( ){if (this.ImagePath){return "\074\151m\x67 src=\042"+this.ImagePath+"\042\x20bor\x64\145\x72=\042\x30\042\x3e"; }else {return ""; }};ImagePreviewer.prototype.LoadObjectFromPath= function (path){ this.SetAltText(""); if (path){ this.AltTextRow.style.display=""; this.ImagePath=path; this.Area.innerHTML=""; var img=document.createElement("IMG"); img=img.cloneNode( true); img.src=path; if (img.complete){FitImage(img); this.Area.appendChild(img); }else {if (document.all){ this.Area.innerHTML=localization["\x4coadingI\x6d\x61g\x65\120\x72ompt"]; this.Area.style.font="\x6denu"; var selfPointer=this ; img.onload= function ( ){selfPointer.Area.innerHTML=""; FitImage(this ); selfPointer.Area.appendChild(this ); this.onload=null; };}else { this.Area.appendChild(img); }}if (this.CanCreateThumbnail){ this.ThumbnailCreator.Enable( ); this.ThumbnailCreator.Initialize(img,this.ThumbnailSuffix); }}else {if (this.ThumbnailCreator){ this.ThumbnailCreator.Disable( ); } this.AltTextRow.style.display="non\x65"; this.Area.innerHTML="\x3c\x64\151\x76 style\x3d\047\x74ext-\x61lign:c\x65\156\x74er;co\x6cor:#\x61aaaaa\x3bfont-f\x61mily:\x54ahoma\x3b\047\x3ex\074/div>"; }} ; ImagePreviewer.prototype.SetAltText= function (altText){ this.AltTextHolder.value=altText; } ; ImagePreviewer.prototype.GetAltText= function ( ){return this.AltTextHolder.value; } ; ImagePreviewer.prototype.ShowThumbnailCreator= function ( ){if (this.CanCreateThumbnail){ this.IsPreviewerShown= true; this.PreviewAreaHolder.style.display="\x6eon\x65"; this.ThumbnailCreatorHolder.style.display=""; }} ; ImagePreviewer.prototype.HideThumbnailCreator= function ( ){ this.IsPreviewerShown= false; this.PreviewAreaHolder.style.display=""; this.ThumbnailCreatorHolder.style.display="\x6eone"; } ; ImagePreviewer.prototype.SwitchThumbnailCreator= function ( ){if (this.IsPreviewerShown){ this.HideThumbnailCreator( ); }else { this.ShowThumbnailCreator( ); }};function FitImage(img){var height=230; var width=240; var hRatio=img.height/height; var wRatio=img.width/width; img.setAttribute("Origin\x61lWidth",img.width); img.setAttribute("\117\x72iginalH\x65\151\x67\150\x74",img.height); if (img.width>width && img.height>height){var ratio=(hRatio>=wRatio?hRatio:wRatio); img.width=(img.width/ratio); img.height=(img.height/ratio); }else {if (img.width>width){img.width=(img.width/wRatio); img.height=(img.height/wRatio); }else {if (img.height>height){img.width=(img.width/hRatio); img.height=(img.height/hRatio); }}}img.style.border="\x31px \x73\157\x6c\151\x64\x20b\x6cack"; }function ShowActualImageSize( ){var img=GetPreviewedImage( ); if (!img){return; }var originalWidth=img.getAttribute("\x4fri\x67\151\x6ealWidth"); var originalHeight=img.getAttribute("\x4frigin\x61\154\x48eight"); if (originalWidth){}else {originalWidth=img.width; }if (originalHeight){}else {originalHeight=img.height; }if (originalWidth && originalHeight){img.width=originalWidth; img.height=originalHeight; }}function CallFitImage( ){var img=GetPreviewedImage( ); if (!img)return; var oWidth=img.getAttribute("Original\x57idth"); var oHeight=img.getAttribute("\x4fri\x67\151\x6ealHeigh\x74"); if (oWidth && oWidth!=img.width)img.width=oWidth; if (oHeight && oHeight!=img.height)img.height=oHeight; FitImage(img); }function GetPreviewedImage( ){var area=document.getElementById("Preview\x41rea"); if (!area){return null; }var imgs=area.getElementsByTagName("\x49MG"); if (imgs && imgs.length>0){return imgs.item(0); }else {return null; }}function ScaleImage(perc,makeBigger){var img=GetPreviewedImage( ); if (!img){return; }perc=perc/100; if (makeBigger){img.width+=img.width*perc; img.height+=img.height*perc; }else {img.width-=img.width*perc; img.height-=img.height*perc; }}
function ImagePropertiesControl(Id,BorderColorPicker,AlignmentSelector,ConstrainerImage,BorderSizeSpinBox,HorizontalSpacingSpinBox,VerticalSpacingSpinBox,ChangeSourceImageDialogCaller){ this.Id=Id; this.BorderColorPicker=BorderColorPicker; this.AlignmentSelector=AlignmentSelector; this.ConstrainerImage=ConstrainerImage; this.BorderSizeSpinBox=BorderSizeSpinBox; this.HorizontalSpacingSpinBox=HorizontalSpacingSpinBox; this.VerticalSpacingSpinBox=VerticalSpacingSpinBox; this.ChangeSourceImageDialogCaller=ChangeSourceImageDialogCaller; this.WidthHolder=document.getElementById(this.Id+"\x5f\x77idth"); this.HeightHolder=document.getElementById(this.Id+"_heigh\x74"); this.AltHolder=document.getElementById(this.Id+"_alt"); this.LongDescriptionHolder=document.getElementById(this.Id+"\x5flongDes\x63\x72i\x70tion"); this.ThumbParent=null; this.OriginalImage=null; this.ImageToModify=null; this.ConstrainDimentions= false; this.Ratio=0; this.AllowedASCII=new Array(8,16,35,36,37,39,45,46); }ImagePropertiesControl.prototype.Initialize= function (imageToModify,EditorObject,ColorsArray,allowCustomColors){ this.BorderColorPicker.CanAddCustomColor=allowCustomColors; this.BorderColorPicker.CanAddHexColor=allowCustomColors; if (ColorsArray)this.BorderColorPicker.SetColors(ColorsArray); this.ImageToModify=imageToModify; this.EditorObject=EditorObject; this.OriginalImage=new Image( ); this.OriginalImage.src=this.ImageToModify.src; var me=this ; this.ChangeSourceImageDialogCaller.Initialize(this.EditorObject,20, function ( ){me.WidthHolder.value=""; me.HeightHolder.value=""; } ); var imgClassName=this.ImageToModify.getAttribute("classN\x61me"); var imgSrc=this.ImageToModify.getAttribute("src"); imgSrc=imgSrc.replace(location.protocol+"//"+location.host+"/","/"); this.ChangeSourceImageDialogCaller.SetImagePath(imgSrc); this.ChangeSourceImageDialogCaller.EnableImageSrc(imgClassName!="ektr\x6f\156\x5fthumbn\x61il"); this.Ratio=this.ImageToModify.width/this.ImageToModify.height; var oAlt=this.ImageToModify.getAttribute("alt"); if (oAlt)this.AltHolder.value=oAlt; var oLong=this.ImageToModify.getAttribute("long\x44esc"); if (oLong)this.LongDescriptionHolder.value=oLong; var oBorderSize=(this.ImageToModify.style.borderWidth || this.ImageToModify.border); oBorderSize=$ektron.toInt(oBorderSize); this.BorderSizeSpinBox.Initialize(oBorderSize,20,2); var oHspace=(this.ImageToModify.style.marginLeft || this.ImageToModify.getAttribute("\x68space")); oHspace=$ektron.toInt(oHspace); this.HorizontalSpacingSpinBox.Initialize(oHspace,20,2); var oVspace=(this.ImageToModify.style.marginTop || this.ImageToModify.getAttribute("\x76space")); oVspace=$ektron.toInt(oVspace); this.VerticalSpacingSpinBox.Initialize(oVspace,20,2); var oAlign=(this.ImageToModify.style.align || this.ImageToModify.align); this.AlignmentSelector.SelectAlignment(oAlign); var borderColor=this.ImageToModify.style.borderColor.toUpperCase( ); this.BorderColorPicker.SelectColor(borderColor); this.ConstrainPropotions( ); this.WidthHolder.value=$ektron(this.ImageToModify).width( ); this.HeightHolder.value=$ektron(this.ImageToModify).height( ); } ; ImagePropertiesControl.prototype.GetOriginalImage= function ( ){return this.OriginalImage; } ; ImagePropertiesControl.prototype.ValidateNumber= function (e){if (window.event!=null){e=window.event; }if (((e.keyCode>=48) && (e.keyCode<=57)) || ((e.keyCode>=96) && (e.keyCode<=105)) || (inArray(this.AllowedASCII,e.keyCode))){return true; }else {if (e.preventDefault){e.preventDefault( ); e.stopPropagation( ); }return false; }} ; ImagePropertiesControl.prototype.ValidateDimension= function (e,isWidthRuling){if (!this.ValidateNumber(e)){return false; }if (this.ConstrainDimentions){var dependantControl=null; var rulingControl=null; var ratio=0; if (isWidthRuling){dependantControl=this.HeightHolder; rulingControl=this.WidthHolder; ratio=1/this.Ratio; }else {dependantControl=this.WidthHolder; rulingControl=this.HeightHolder; ratio=this.Ratio; }dependantControl.value=Math.ceil(rulingControl.value*ratio); }return true; } ; ImagePropertiesControl.prototype.GetUpdatedImage= function ( ){if (!this.UpdatedImage){ this.UpdatedImage=this.ImageToModify.cloneNode( true); }if (this.AltHolder.value || ""==this.AltHolder.value){ this.UpdatedImage.setAttribute("alt",this.AltHolder.value); this.UpdatedImage.setAttribute("ti\x74le",this.AltHolder.value); }else { this.UpdatedImage.removeAttribute("\x61lt", false); this.UpdatedImage.removeAttribute("\x74itl\x65", false); }if (this.LongDescriptionHolder.value || ""==this.LongDescriptionHolder.value){ this.UpdatedImage.setAttribute("long\x44esc",this.LongDescriptionHolder.value,0); }else { this.UpdatedImage.removeAttribute("l\x6fngDesc", false); }var url=this.ChangeSourceImageDialogCaller.GetImagePath( ); var hasWidthAttr=(this.UpdatedImage.getAttribute("widt\x68")>0); var hasHeightAttr=(this.UpdatedImage.getAttribute("\x68e\x69\x67ht")>0); this.UpdatedImage.setAttribute("\x73rc",url); this.UpdatedImage.setAttribute("d\x61ta-ektro\x6e-url",url); if (!hasWidthAttr){ this.UpdatedImage.removeAttribute("\x77idth"); }if (!hasHeightAttr){ this.UpdatedImage.removeAttribute("\x68eig\x68\x74"); } this.UpdatedImage.removeAttribute("\x61li\x67\x6e"); this.UpdatedImage.removeAttribute("\x62order"); this.UpdatedImage.removeAttribute("hspace"); this.UpdatedImage.removeAttribute("vspace"); if (this.UpdatedImage.style.removeAttribute){ this.UpdatedImage.style.removeAttribute("\x61li\x67\156", false); this.UpdatedImage.style.removeAttribute("\142\x6frderB\x6fttomSty\x6c\145", false); this.UpdatedImage.style.removeAttribute("borderB\x6fttomWi\x64th", false); this.UpdatedImage.style.removeAttribute("\142\x6frder\x4ceftStyle", false); this.UpdatedImage.style.removeAttribute("bo\x72derLeft\x57idth", false); this.UpdatedImage.style.removeAttribute("\x62o\x72\x64erR\x69ghtStyle", false); this.UpdatedImage.style.removeAttribute("borderRi\x67htWid\x74h", false); this.UpdatedImage.style.removeAttribute("\142\x6frderTop\x53tyle", false); this.UpdatedImage.style.removeAttribute("borderTo\x70Width", false); this.UpdatedImage.style.removeAttribute("bor\x64er", false); this.UpdatedImage.style.removeAttribute("\160\x61ddin\x67", false); this.UpdatedImage.style.removeAttribute("\x70a\x64\x64ing\x42ottom", false); this.UpdatedImage.style.removeAttribute("paddin\x67Left", false); this.UpdatedImage.style.removeAttribute("padding\x52ight", false); this.UpdatedImage.style.removeAttribute("paddin\x67Top", false); this.UpdatedImage.style.removeAttribute("margin", false); this.UpdatedImage.style.removeAttribute("mar\x67inBotto\x6d", false); this.UpdatedImage.style.removeAttribute("marginL\x65ft", false); this.UpdatedImage.style.removeAttribute("\x6dar\x67\x69nR\x69ght", false); this.UpdatedImage.style.removeAttribute("margi\x6eTop", false); }else { this.UpdatedImage.align=null; this.UpdatedImage.style.align=null; this.UpdatedImage.style.border=null; this.UpdatedImage.style.padding=null; this.UpdatedImage.style.margin=null; } this.UpdatedImage.style.borderColor=this.BorderColorPicker.SelectedColor; var theAlign=this.AlignmentSelector.GetAlign( ); if (theAlign){ this.UpdatedImage.style.align=theAlign; this.UpdatedImage.align=theAlign; this.UpdatedImage.setAttribute("\141\x6cign",theAlign); }var theBorderSize=this.BorderSizeSpinBox.GetCurrentSize( ); if (theBorderSize.toString( )!="" && theBorderSize>0){ this.UpdatedImage.border=theBorderSize; this.UpdatedImage.setAttribute("\x62orde\x72",theBorderSize); theBorderSize=theBorderSize+"\x70x"; this.UpdatedImage.style.borderWidth=theBorderSize; this.UpdatedImage.style.borderStyle="\x73olid"; }var theHspace=this.HorizontalSpacingSpinBox.GetCurrentSize( ); if (theHspace>0){theHspace=theHspace+"\x70x"; this.UpdatedImage.style.marginLeft=theHspace; this.UpdatedImage.style.marginRight=theHspace; }var theVspace=this.VerticalSpacingSpinBox.GetCurrentSize( ); if (theVspace>0){theVspace=theVspace+"px"; this.UpdatedImage.style.marginTop=theVspace; this.UpdatedImage.style.marginBottom=theVspace; }var theWidth=parseInt(this.WidthHolder.value); if (theWidth && theWidth!=this.OriginalImage.width){ this.UpdatedImage.removeAttribute("\x77idth"); if (this.UpdatedImage.style.removeAttribute){ this.UpdatedImage.style.removeAttribute("width", false); }else { this.UpdatedImage.style.width=null; } this.UpdatedImage.style.width=theWidth+"px"; this.UpdatedImage.width=theWidth; }var theHeight=parseInt(this.HeightHolder.value); if (theHeight && theHeight!=this.OriginalImage.height){ this.UpdatedImage.removeAttribute("height"); if (this.UpdatedImage.style.removeAttribute){ this.UpdatedImage.style.removeAttribute("\x68eigh\x74", false); }else { this.UpdatedImage.style.height=null; } this.UpdatedImage.style.height=theHeight+"\x70x"; this.UpdatedImage.height=theHeight; }if (this.UpdatedImage.style.cssText==''){ this.UpdatedImage.removeAttribute('\x73tyle', false); } this.ThumbParent=this.ChangeSourceImageDialogCaller.GetThumbParent( ); if (this.ThumbParent!=null){var retObj= {UpdatedImage: this.UpdatedImage,ThumbParent: this.ThumbParent } ; return retObj; }else {return this.UpdatedImage; }} ; ImagePropertiesControl.prototype.ConstrainPropotions= function ( ){ this.ConstrainerImage.src=this.ConstrainerImage.src.substr(0,this.ConstrainerImage.src.length-(this.ConstrainDimentions?6: 7))+(this.ConstrainDimentions?"O\x66f.gif": "\117\x6e\056\x67if"); this.ConstrainDimentions=!this.ConstrainDimentions; if (this.ConstrainDimentions){ this.HeightHolder.value=Math.ceil(this.WidthHolder.value/this.Ratio); }} ;
function LinkManager(id,hyperlinkCssClassSelector,emailCssClassSelector){ this.Id=id; this.HyperlinkCssClassSelector=hyperlinkCssClassSelector; this.EmailCssClassSelector=emailCssClassSelector; this.LinkObject=null; this.LinkVariant="\x6c\x69nk"; this.OnOkClicked=null; this.OnCancelClicked=null; this.bookmarks=new Array; this.AddressHolder=document.getElementById(this.Id+'\x5fad\x64\162\x65ss'); this.SubjectHolder=document.getElementById(this.Id+'_subje\x63t'); this.LinkNameHolder=document.getElementById(this.Id+'\x5flinkNam\x65'); this.LinkTextHolder=document.getElementById(this.Id+'_linkTex\x74'); this.LinkTextRow=document.getElementById(this.Id+'_rowLi\x6ekText'); this.LinkUrlHolder=document.getElementById(this.Id+'_link\x55rl'); this.PageAnchorsHolder=document.getElementById(this.Id+'_pageAn\x63horsHo\x6c\144\x65r'); this.LinkTypeHolder=document.getElementById(this.Id+'_l\x69nkType'); this.LinkTargetHolder=document.getElementById(this.Id+'\x5flin\x6b\x54ar\x67et'); this.LinkTargetSelector=document.getElementById(this.Id+'\x5fli\x6e\153\x54argetS\x65\154\x65ctor'); this.TitleTextHolder=document.getElementById(this.Id+'_ti\x74leText'); this.EmailTextHolder=document.getElementById(this.Id+'_emai\x6cText'); this.EmailTextRow=document.getElementById(this.Id+'_rowEm\x61ilText'); this.dialogOpenerButton=document.getElementById(this.Id+'_dialogO\x70enerBut\x74on'); this.ExistingBookmarksHolder=document.getElementById(this.Id+'_page\x45xisting\x42ookmark\x73'); this.TypeInBookmarkHolder=document.getElementById(this.Id+'_typeIn\x42ookmark'); }LinkManager.prototype.Initialize= function (linkObject){var me=this ; this.LinkObject=linkObject; this.HyperlinkCssClassSelector.Initialize(this.LinkObject.CssClasses); this.EmailCssClassSelector.Initialize(this.LinkObject.CssClasses); this.ExistingBookmarksHolder.innerHTML=populateBookmarks(this.LinkObject.documentAnchors); if (this.LinkObject.SelectedTab && this.LinkObject.SelectedTab>=0){TabHolder.SetTabSelected(this.LinkObject.SelectedTab); if (trim(this.LinkObject.name)!=""){ this.LinkNameHolder.value=this.LinkObject.name; }if (1==this.LinkObject.SelectedTab){$ektron("t\x61ble#T\x61\x62H\x6f\154\x64er0").remove( ); $ektron("t\x61ble#Ta\x62\x48ol\x64er2").remove( ); }else {$ektron("table#T\x61bHolde\x721").remove( ); }}else if (this.LinkObject.href && this.LinkObject.href.match(/^(\x6d\x61\x69\x6c\x74\x6f\x3a)([^\x3f\x26]*)/gi)){ this.SetLinkVariant("\x65m\x61\151\x6c"); TabHolder.SetTabSelected(2); this.AddressHolder.value=RegExp.$2; if (this.LinkObject.href.match(/(\x3f|\x26)\x73\x75\x62\x6a\x65\x63\x74\x3d([^\x26]*)/gi)){ this.SubjectHolder.value=RegExp.$2; } this.EmailCssClassSelector.SelectCssClass(this.LinkObject.className); $ektron("\x74able\x23\x54a\x62\x48ol\x64er1").remove( ); }else if (trim(this.LinkObject.name)!=""){ this.SetLinkVariant("anch\x6fr"); TabHolder.SetTabSelected(1); this.LinkNameHolder.value=this.LinkObject.name; }else {$ektron("tab\x6ce#Tab\x48older1").remove( ); var href='http:\x2f/'; if (this.LinkObject.href){href=this.LinkObject.href; }if (href.indexOf("\x23")>=0){var reBookmark=/\x23([^\x3f]*)/; var bookmark=href.match(reBookmark)[1]; href=href.replace(reBookmark,""); this.TypeInBookmarkHolder.value=bookmark; }else { this.TypeInBookmarkHolder.value=""; } this.LinkUrlHolder.value=href; var options=this.LinkTypeHolder.getElementsByTagName("\x4f\x50\x54ION"); this.LinkTypeHolder.selectedIndex=0; for (var i=1; i<options.length; i++){var re=new RegExp("\x5e("+options[i].value+"\x29","\x67i"); if (re.test(href)){ this.LinkTypeHolder.selectedIndex=i; break; }}for (var anchorIndex=0; anchorIndex<this.LinkObject.documentAnchors.length; anchorIndex++){var currentAnchorLink=this.LinkObject.documentAnchors[anchorIndex]; var newOption=new Option(currentAnchorLink.name,"\x23"+currentAnchorLink.name); this.PageAnchorsHolder.options.add(newOption); if ("#"+currentAnchorLink.name==this.LinkObject.href){ this.PageAnchorsHolder.selectedIndex=0; newOption.selected= true; }} this.LinkTargetHolder.value=this.LinkObject.target; for (var targetIndex=0; targetIndex<this.LinkTargetSelector.options.length; targetIndex++){if (this.LinkTargetHolder.value==this.LinkTargetSelector.options[targetIndex].value){ this.LinkTargetSelector.options[targetIndex].selected= true; }}var sTitleText=this.LinkObject.title; if (""==sTitleText && this.LinkObject.text!=""){sTitleText=$ektron.removeTags(this.LinkObject.text); if (""==sTitleText){var joLinkObjectText=$ektron(this.LinkObject.text); sTitleText=(joLinkObjectText.attr("title") || joLinkObjectText.attr("\x61lt")); }} this.TitleTextHolder.value=sTitleText; var currentStyle=this.LinkObject.className; if (currentStyle!="\x64esig\x6e\137\x73elected\x5f\146\x69eld"){ this.HyperlinkCssClassSelector.SelectCssClass(currentStyle); }}if (this.LinkObject.showText){ this.LinkTextRow.style.display=""; this.EmailTextRow.style.display=""; this.LinkTextHolder.value=this.LinkObject.text; this.EmailTextHolder.value=this.LinkObject.text; }else { this.LinkTextRow.style.display="\x6eone"; this.EmailTextRow.style.display="non\x65"; this.LinkTextHolder.value=''; this.EmailTextHolder.value=''; }var I2=EkUtil_parseQuery( ); if ("\x75n\x64\145\x66ined"!=typeof I2.LibraryAllowed && "False"==I2.LibraryAllowed){ this.dialogOpenerButton.style.display="\x6eone"; }function populateBookmarks(docAnchors){me.bookmarks=[ ]; var sBookmarkList=""; if (docAnchors && docAnchors.length>0){for (var i=0; i<docAnchors.length; i++){me.bookmarks.push(docAnchors[i].name); }me.bookmarks.sort( ); sBookmarkList=me.bookmarks.join("\x3c\x62r />"); }return (sBookmarkList || localization.getText("\x41nchorNon\x65")); }} ; LinkManager.prototype.SetLinkVariant= function (linkVariant){ this.LinkVariant=linkVariant; } ; LinkManager.prototype.ChangeLinkType= function (linkType){var urlValue=this.LinkUrlHolder.value; var index; index=urlValue.indexOf("\x3a"); if (index>=0){urlValue=urlValue.substring(index+1); }index=urlValue.indexOf("//"); if (index>=0){urlValue=urlValue.substring(index+2); } this.LinkUrlHolder.value=linkType+urlValue; } ; LinkManager.prototype.ChangeLinkTarget= function (linkTargetDropdown){ this.LinkTargetHolder.value=linkTargetDropdown.value; } ; LinkManager.prototype.SetLinkToAnchor= function (pageAnchorsDropDown){if (pageAnchorsDropDown.selectedIndex!=0){ this.LinkUrlHolder.value=pageAnchorsDropDown.value; this.TypeInBookmarkHolder.value=""; }} ; LinkManager.prototype.ValidateEntry= function (entry){var errMsg=""; switch (this.LinkVariant){case "\x6cin\x6b":if (0==entry.href.length || "\x68ttp:/\x2f"==entry.href){errMsg=localization.getText("\125\x72lRequir\x65d"); }else if (entry.href.indexOf("\x3a///")>-1){errMsg=localization.getText("Inva\x6cidUrl"); }break; case "\x61nchor":if (0==entry.name.length){errMsg=localization.getText("\x4eameR\x65\161\x75ired"); }else {var currentName=entry.realLinkObject?entry.realLinkObject.name: ""; errMsg=this.ValidateUniqueBookmark(entry.name,currentName); }break; case "\x65mail":if (0==entry.mail.length){errMsg=localization.getText("Ad\x64\162\x65ssRequi\x72\145\x64"); }else if (!/[\x41-\x5a\x61-\x7a\x30-\x39\x21\x23-\x27\x2a\x2b\x2d\x2f\x3d\x3f\x5e\x5f\x60\x7b-\x7e]+(\x2e[\x41-\x5a\x61-\x7a\x30-\x39\x21\x23-\x27\x2a\x2b\x2d\x2f\x3d\x3f\x5e\x5f\x60\x7b-\x7e]+)*\x40[\x41-\x5a\x61-\x7a\x30-\x39\x21\x23-\x27\x2a\x2b\x2d\x2f\x3d\x3f\x5e\x5f\x60\x7b-\x7e]+(\x2e[\x41-\x5a\x61-\x7a\x30-\x39\x21\x23-\x27\x2a\x2b\x2d\x2f\x3d\x3f\x5e\x5f\x60\x7b-\x7e]+)*/.test(entry.mail)){errMsg=localization.getText("\x49nva\x6c\151\x64Email"); }break; default:break; }return errMsg; } ; LinkManager.prototype.ValidateUniqueBookmark= function (newBookmark,currentBookmark){var errMsg=""; for (var i=0; i<this.bookmarks.length; i++){if (newBookmark==this.bookmarks[i] && newBookmark!=currentBookmark){errMsg=localization.getText("Duplicat\x65dName"); break; }}return errMsg; } ; LinkManager.prototype.GetModifiedLinkObject= function ( ){var result= {realLinkObject: this.LinkObject.realLinkObject,href: "",className: "",text: "",target: "",name: "",title: "",showText: false ,mail: "",errMsg: "" };result.text=this.LinkTextHolder.value; if (this.LinkVariant=="\154\x69nk"){var linkUrl=this.LinkUrlHolder.value; if (-1==linkUrl.indexOf("\x23")){var bookmarkName=this.TypeInBookmarkHolder.value; if (bookmarkName!=""){linkUrl=linkUrl+"#"+bookmarkName; }}result.href=linkUrl; result.target=this.LinkTargetHolder.value; result.title=this.TitleTextHolder.value; result.className=this.HyperlinkCssClassSelector.GetSelectedClassName( ); }else if (this.LinkVariant=="\x61nchor"){var linkName=this.LinkNameHolder.value; var validName=fixName(linkName); result.name=validName; result.className="design_\x62ookmark"; result.title=validName; }else {var linkAddress=this.AddressHolder.value; result.href="m\x61ilto:"+linkAddress; result.mail=linkAddress; result.text=this.EmailTextHolder.value; if (this.SubjectHolder.value!=""){result.href+="?sub\x6aect="+this.SubjectHolder.value; result.title=this.SubjectHolder.value; }result.className=this.EmailCssClassSelector.GetSelectedClassName( ); }result.errMsg=this.ValidateEntry(result); return result; function fixName(uriString){if ("string"==typeof uriString){var reFixName=new RegExp("\x5b^A-Za-z\x30\055\071"+Ektron.RegExp.escape("\x3b/?:@\x26\075\x2b$,-\x5f.!~*\047()")+"\x5d","\x67"); return uriString.replace(reFixName,"\x5f"); }return ""; }} ; LinkManager.prototype.OkClicked= function ( ){if (this.OnOkClicked){ this.OnOkClicked( ); }} ; LinkManager.prototype.CancelClicked= function ( ){if (this.OnCancelClicked){ this.OnCancelClicked( ); }} ;
function Hashtable( ){ this.keys=new Array( ); this.values=new Array( ); }Hashtable.prototype.Add= function (name,object){ this.keys[this.keys.length]=name; this.values[this.values.length]=object; } ; Hashtable.prototype.Item= function (name){for (var i=0; i<this.keys.length; i++){if (this.keys[i]==name){return this.values[i]; }}return null; } ; Hashtable.prototype.Keys= function ( ){return this.keys; } ; var properties=null; function GetProperties( ){if (!properties){properties=new Hashtable( ); properties.Add("Allow\x43\x68ange\x44isplay\x53ize",new Array(localization["Al\x6cowChan\x67eDispla\x79Size"],null,"ra\x64io","\x62ool\x65\x61n","tr\x75\145")); properties.Add("All\x6fwScan",new Array(localization["A\x6c\x6cowS\x63an"],null,"\x72adio","\x62oole\x61\x6e","true")); properties.Add("An\x69mation\x41\164\x53tart",new Array(localization["Anim\x61tionAt\x53tart"],null,"radio","boo\x6cean","tr\x75e")); properties.Add("\x41udioS\x74\x72ea\x6d",new Array(localization["AudioSt\x72eam"],null,"t\x65xt-regexp","^[0-\x39]*$",localization["Val\x69dateNumb\x65r"],"")); properties.Add("\x41ut\x6f\122\x65wind",new Array(localization["Aut\x6fRewind"],null,"\x72adio","\x62ool\x65\141n","true")); properties.Add("\x41uto\x53\x69ze",new Array(localization["\101\x75to\x53\x69ze"],null,"\x72adio","\x62oolean","")); properties.Add("AutoSta\x72t",new Array(localization["\x41uto\x53\164\x61rt"],null,"r\x61dio","boole\x61\156","\x74rue")); properties.Add("\x42ala\x6e\143\x65",new Array(localization["\x42al\x61\x6ece"],null,"\x74ext-ra\x6e\147\x65","({tex\x74\175\x20\x3e= \x2d10000\x29 && \x28{text}\x20\074\x3d 10\x3000)",localization["Va\x6cidateNu\x6dber1000\x30"],0)); properties.Add("CCActive",new Array(localization["\103\x43Activ\x65"],null,"radio","bool\x65an","\x66alse")); properties.Add("\x43lick\x54\157\x50lay",new Array(localization["ClickTo\x50lay"],null,"ra\x64io","b\x6folean","t\x72\165e")); properties.Add("Colo\x72Key",new Array(localization["ColorKe\x79"],null,"\x74ex\x74","",localization["Va\x6cidateNum\x62erHex"],"")); properties.Add("\x43ur\x72\x65ntA\x6egle",new Array(localization["Curren\x74Angle"],null,"\x73elect-ra\x6ege",1,9,1)); properties.Add("Curr\x65ntAudioS\x74ream",new Array(localization["Curren\x74AudioS\x74\162\x65am"],null,"tex\x74\055\x72ange","(\x28\050\x7b\164\x65\170t\x7d >= 0)\x20&& ({t\x65\170\x74} \074\075\x207))\x20|| ({t\x65xt} =\x3d \047\x30xF\x46FFFFF\x46\047\x29)",localization["V\x61lidateAu\x64io"],0)); properties.Add("CurrentC\x43Service",new Array(localization["Curr\x65ntCCSer\x76ice"],null,"se\x6cect",new Array(0,1,2,3,4,5),new Array(localization["\x4eone"],localization.DefaultCaption1,localization.Caption2,localization.Text1,localization.Text2,localization.ExtendedDataServices),0)); properties.Add("\x43\165\x72\x72e\x6e\164\x4d\141\x72ker",new Array(localization["Current\x4darker"],null,"text-reg\x65\170\x70","\x5e\x5b0-\x39\x5d*$",localization["\x56alida\x74\x65Nu\x6d\142\x65r"],0)); properties.Add("\x43ur\x72\x65nt\x50osition",new Array(localization["\x43ur\x72\145\x6etPos\x69\164\x69on"],null,"\x74ext-\x72\145\x67exp","^[0-9]*$",localization["Validate\x4eumber"],"")); properties.Add("Curren\x74Subpict\x75\162\x65\123\x74\162\x65\141\x6d",new Array(localization["C\x75rrentSu\x62pictureS\x74\162\x65am"],null,"\x73elect\x2d\163\x70\145\x63\x69a\x6c",new Array(localization["\x53tre\x61\155\x69sval\x69d"],"\x72ang\x65",0,31),new Array(localization.Nosubpicturestream,"v\x61lue",63),0)); properties.Add("\x43ursorTy\x70\x65",new Array(localization["\x43ursorT\x79\x70e"],null,"\x73elect",new Array(32650,32512,32515,32513,32648,32646,32643,32645,32642,32644,32516,32514,1),new Array(localization["Arrowhou\x72glass"],localization.Standardarrow,localization.Crosshair,localization.TextIbeam,localization.SlashedCircle,localization.Fourpointedarrow,localization.DoublepointedNESW,localization.DoublepointedNS,localization.DoublepointedNWSE,localization.DoublepointedWE,localization.Verticalarrow,localization.Hourglass,localization.Handpointing),"")); properties.Add("\x44efa\x75\154\x74Frame",new Array(localization["Defa\x75ltFram\x65"],null,"text","","","")); properties.Add("\x44ispla\x79\x42ac\x6bColor",new Array(localization["\x44ispla\x79\102\x61ckColo\x72"],null,"\163\x65lect-co\x6c\157\x72",16777215)); properties.Add("\x44ispla\x79\106\x6f\162\x65\x43o\x6cor",new Array(localization["Di\x73playFo\x72eColor"],null,"sel\x65\143t\x2dcolor",16777215)); properties.Add("Displa\x79\115\x6fde",new Array(localization["\104\x69splay\x4dode"],null,"radio","i\x6eteger",0)); properties.Add("\x44isp\x6c\141y\x53ize",new Array(localization["DisplayS\x69ze"],null,"select",new Array(0,1,2,3,4,5,6,7),new Array(localization["Sa\x6desize"],localization.HalfSourceImage,localization.DoubleSourceImage,localization.EntireScreen,localization.DesignTime,localization.SixteenthScreen,localization.QuarterScreen,localization.HalfScreen),"")); properties.Add("\x45nableC\x6f\156\x74\145\x78\x74M\x65nu",new Array(localization["\x45na\x62\x6ceC\x6fntextMen\x75"],null,"\x72adi\x6f","boolea\x6e","tru\x65")); properties.Add("\x45nabled",new Array(localization["Enabled"],null,"\x72adio","bool\x65an","\x74\162u\x65")); properties.Add("Enabl\x65\106u\x6clScreen\x43ontrols",new Array(localization["En\x61bleFullS\x63reenCont\x72ols"],null,"\x72adio","boolea\x6e","\x74rue")); properties.Add("\x45nableP\x6f\163\x69tionCon\x74rols",new Array(localization["En\x61blePosi\x74ionCont\x72\157\x6cs"],null,"radio","\x62oo\x6c\145a\x6e","\x74rue")); properties.Add("Enab\x6ceTracker",new Array(localization["\105\x6eableT\x72acker"],null,"\x72adio","bo\x6flean","true")); properties.Add("\x48id\x64\145n",new Array(localization["Hidd\x65n"],null,"rad\x69\157","boo\x6c\145a\x6e","\x66alse")); properties.Add("In\x76okeURLs",new Array(localization["\x49nvokeUR\x4c\163"],null,"\x72ad\x69\x6f","boole\x61n","t\x72\165e")); properties.Add("Language",new Array(localization["\x4ca\x6e\147\x75age"],null,"\x74ext\x2d\x72eg\x65xp","\x5e\1330\x2d\071\x5d*$",localization["\x56alidateL\x43ID"],"")); properties.Add("\x4dute",new Array(localization["\x4dut\x65"],null,"r\x61\144i\x6f","\x62oolea\x6e","\x74rue")); properties.Add("Pla\x79\103o\x75nt",new Array(localization["\x50layC\x6f\165\x6et"],null,"\x74ext-rege\x78\160","^\x5b\060\x2d9]*$",localization["Valid\x61teNumber"],1)); properties.Add("Previe\x77Mode",new Array(localization["\x50r\x65\x76iew\x4dode"],null,"ra\x64io","bo\x6flean","false")); properties.Add("Rate",new Array(localization["Rate"],null,"\x74ext-ra\x6e\147\x65","\050\x7btext} \x3e\075\x20-10) &&\x20({text\x7d \074\x3d 10)",localization["\x56alid\x61\164\x65Number1\x30"],.10e1)); properties.Add("\x53elec\x74\151\x6fnEnd",new Array(localization["Selec\x74ionEnd"],null,"te\x78t-range","((({tex\x74\x7d \x3e\075\x20Number\x2eMIN_VAL\x55E) && \x28{text\x7d \074= Numb\x65r.MAX\x5f\126\x41LUE))\x20|| ({\x74ext} \x3d= \047\047\x29)",localization["\x56ali\x64\141t\x65Number"],"")); properties.Add("\x53electio\x6e\123\x74\141\x72\164",new Array(localization["\x53el\x65\143\x74ionStar\x74"],null,"text-r\x61nge","\x28{t\x65\170t\x7d >= Numb\x65r.MIN_V\x41LUE) &\x26\040\x28{tex\x74} \074= Numb\x65r.MAX\x5fVALUE)",localization["Valid\x61teNumbe\x72"],0)); properties.Add("\x53endEr\x72\157\x72\x45ve\x6ets",new Array(localization["\x53\x65\x6edEr\x72orEvent\x73"],null,"radio","\x62\157\x6f\x6cea\x6e","\x74rue")); properties.Add("Se\x6e\144\x4b\x65yb\x6f\141r\x64Events",new Array(localization["S\x65ndKeyb\x6f\x61rd\x45\166\x65nts"],null,"radio","\x62oo\x6c\x65an","fal\x73\145")); properties.Add("SendMo\x75\163\x65ClickEve\x6ets",new Array(localization["\x53endMou\x73\145\x43lickEv\x65nts"],null,"\x72adio","boole\x61\x6e","\x66\141l\x73\145")); properties.Add("\x53endMou\x73\145\x4doveEven\x74s",new Array(localization["\x53endMo\x75\x73e\x4d\157\x76eEvent\x73"],null,"radio","boole\x61n","\x66alse")); properties.Add("\x53end\x4f\160e\x6eStateCh\x61ngeEven\x74s",new Array(localization["\x53e\x6e\144\x4fpenSta\x74\145\x43hangeEv\x65nts"],null,"radio","b\x6f\157\x6c\x65an","true")); properties.Add("SendP\x6cayStateC\x68angeEve\x6ets",new Array(localization["S\x65ndPlay\x53\x74at\x65\103\x68angeE\x76ents"],null,"rad\x69\157","\x62oolean","true")); properties.Add("\x53endWarn\x69\156\x67Events",new Array(localization["\x53endW\x61\162\x6eingE\x76\145\x6ets"],null,"\x72adi\x6f","boolean","\x74rue")); properties.Add("ShowAudi\x6fControl\x73",new Array(localization["\x53howAu\x64\151\x6fContro\x6cs"],null,"rad\x69o","boolea\x6e","\x74rue")); properties.Add("ShowCa\x70\164i\x6fning",new Array(localization["\x53howCapt\x69\157\x6eing"],null,"radio","\x62oolean","\x66alse")); properties.Add("Sho\x77Controls",new Array(localization["\x53howCont\x72\157\x6cs"],null,"radio","b\x6folean","true")); properties.Add("S\x68owDisp\x6c\x61y",new Array(localization["S\x68owDispl\x61y"],null,"\x72adio","boolea\x6e","\x66al\x73\x65")); properties.Add("\123\x68\157w\x47otoBar",new Array(localization["\x53h\x6f\x77Go\x74oBar"],null,"\x72adio","boo\x6cean","\x66als\x65")); properties.Add("Sh\x6f\167\x50osition\x43ontrols",new Array(localization["\x53\x68\157\x77Positi\x6fnContro\x6cs"],null,"radio","\x62oole\x61\156","\x74rue")); properties.Add("\x53\150\x6f\x77St\x61tusBar",new Array(localization["ShowS\x74atusBar"],null,"\x72adio","\x62ool\x65\141n","f\x61lse")); properties.Add("\123\x68\x6fwT\x72\141\x63\153e\x72",new Array(localization["\x53how\x54\x72ac\x6ber"],null,"\x72adio","boolean","true")); properties.Add("\x53ubpictu\x72\x65O\x6e",new Array(localization["Subpi\x63tureOn"],null,"radi\x6f","b\x6folean","")); properties.Add("Transp\x61rentAtS\x74\141\x72\164",new Array(localization["\124\x72ansp\x61rentAtSt\x61\162\x74"],null,"radio","\x62oolean","fa\x6cse")); properties.Add("V\x69deoBorde\x723D",new Array(localization["\x56ideo\x42\157\x72der3\x44"],null,"\x72adio","boo\x6c\145a\x6e","\x66als\x65")); properties.Add("Vi\x64eoBorde\x72\103\x6f\154\x6fr",new Array(localization["VideoB\x6frderCo\x6cor"],null,"\x73elect-\x63\x6flo\x72",000000)); properties.Add("VideoBor\x64erWidth",new Array(localization["VideoBor\x64erWidth"],null,"text-\x72\145\x67exp","\x5e\1330\x2d\071\x5d*$",localization["V\x61lidateNu\x6dber"],0)); properties.Add("\x56olume",new Array(localization["\x56olu\x6d\x65"],null,"\164\x65xt-range","({text} \x3e= -1000\x30) && ({\x74ext} \074= 100\x300)",localization["Val\x69dateNum\x62er10000"],-600)); }return properties; }var fileName,pathName; var deletePath= false; var selection= true; var dropDownMedia; var submitForUpload; function changeValue(control){var item=GetProperties( ).Item(document.getElementById("\160\162o\x70erty").value); item[1]=control.value; }function checkMovieFile(name){if (name.match(/(\x2e\x63\x64\x61)|(\x2e\x69\x76\x66)|(\x2e\x61\x69\x66)|(\x2e\x61\x69\x66\x63)|(\x2e\x61\x69\x66\x66)|(\x2e\x61\x73\x66)|(\x2e\x61\x73\x78)|(\x2e\x77\x61\x78)|(\x2e\x77\x6d)|(\x2e\x77\x6d\x61)|(\x2e\x77\x6d\x64)|(\x2e\x77\x6d\x76)|(\x2e\x77\x76\x78)|(\x2e\x77\x6d\x70)|(\x2e\x77\x6d\x78)|(\x2e\x61\x76\x69)|(\x2e\x77\x61\x76)|(\x2e\x77\x6d\x7a)|(\x2e\x77\x6d\x73)|(\x2e\x6d\x70\x65\x67)|(\x2e\x6d\x70\x67)|(\x2e\x6d\x31\x76)|(\x2e\x6d\x70\x32)|(\x2e\x6d\x70\x61)|(\x2e\x6d\x70\x65)|(\x2e\x6d\x70\x65)|(\x2e\x6d\x70\x32\x76)|(\x2e\x6d\x70\x76\x32)|(\x2e\x6d\x69\x64)|(\x2e\x6d\x69\x64\x69)|(\x2e\x72\x6d\x69)|(\x2e\x61\x75)|(\x2e\x73\x6e\x64)|(\x2e\x6d\x70\x33)|(\x2e\x6d\x33\x75)|(\x2e\x76\x6f\x62)$/gi)){return true; }else {return false; }}function createRadio(id,radioValue,defaultValue){var radioBox; if (document.all){radioBox=document.createElement("\074INPUT NA\x4dE=\047booleanG\x72oup\047\040\x4fNCLIC\x4b=\047\x63ha\x6egeVa\x6c\165\x65(this\x29\047"+((radioValue==defaultValue.toString( ))?"\x20CHE\x43\113E\x44": "")+"\x3e"); }else {radioBox=document.createElement("\x49NPUT"); radioBox.name="\x62oolea\x6e\x47r\x6f\165p"; radioBox.onclick= function ( ){changeValue(this ); } ; if (radioValue==defaultValue.toString( )){radioBox.setAttribute("che\x63\153\x65\x64", true); }}radioBox.type="radi\x6f"; radioBox.id=id; radioBox.value=radioValue; return radioBox; }function createText(textValue,expression,isRegExp){var textBox=document.createElement("INPUT"); textBox.onkeydown= function ( ){changeText(this.id); } ; textBox.onblur= function ( ){validateText(this,expression,isRegExp); } ; textBox.id="textPro\x70erty"; textBox.type="tex\x74"; textBox.value=textValue; textBox.className="flatTex\x74\102\x6fx"; return textBox; }function createLabel(controlID,labelText){var label=document.createElement("\x4cABEL"); label.htmlFor=controlID; label.innerHTML=labelText; return label; }function changeText(controlID){window.setTimeout("cha\x6egeValue(\x64ocument.\x67etEleme\x6etById(\x27"+controlID+"\047\x29)",100); return true; }function changeProperty(propValue){var pValue=document.getElementById("propert\x79\126\x61lue"); var item=GetProperties( ).Item(propValue); if (propValue!=""){var description=document.createElement("S\x50AN"); description.innerHTML=localization["\x44escri\x70\164\x69on"]+item[0]; pValue.innerHTML=""; pValue.appendChild(description); switch (item[2]){case "\x72adi\x6f":var defaultValue=((item[1]==null)?item[4]:item[1]); switch (item[3]){case "\x62oo\x6c\145\x61n":var values=new Array("\x74\162\x75\x65","false"); var texts=new Array(localization["\x59es"],localization["\x4eo"]); break; case "\x69nteger":var values=new Array(0,1); var texts=new Array(localization["Y\x65\163"],localization["No"]); break; }var table=document.createElement("T\x41BLE"); table.cellPadding="0"; table.cellSpacing="0"; var tbody=document.createElement("\x54BODY"); table.appendChild(tbody); var row=document.createElement("TR"); for (var i=0; i<values.length; i++){var cell=document.createElement("\x54D"); cell.valign="\x6diddle"; cell.innerHTML="\x26nbsp;"; cell.appendChild(createRadio("boolean\x47roup"+i,values[i],defaultValue)); cell.appendChild(createLabel("\x62ool\x65\141\x6eGroup"+i,texts[i])); row.appendChild(cell); }tbody.appendChild(row); pValue.insertBefore(table,description); break; case "select":var defaultValue=(item[1]==null)?item[5]:item[1]; var select=document.createElement("\x53EL\x45\103T"); select.onchange= function ( ){changeValue(this ); } ; var values=item[3]; var texts=item[4]; for (var i=0; i<values.length; i++){var option=document.createElement("\x4fPTION"); option.innerHTML=texts[i]; option.value=values[i]; select.appendChild(option); }selectOption(select,defaultValue); pValue.insertBefore(select,description); break; case "\x73elect-\x72\x61ng\x65":var defaultValue=((item[1]==null)?item[5]:item[1]); var select=document.createElement("\x53ELECT"); select.onchange= function ( ){changeValue(this ); } ; for (var i=item[3]; i<=item[4]; i++){var option=document.createElement("\x4fPTIO\x4e"); option.innerHTML=i; option.value=i; select.appendChild(option); }selectOption(select,defaultValue); pValue.insertBefore(select,description); break; case "select\x2dspecial":var defaultValue=(item[1]==null)?item[5]:item[1]; var select=document.createElement("S\x45LECT"); select.onchange= function ( ){changeValue(this ); } ; for (var i=3; i<(item.length-1); i++){var optGroup=document.createElement("\x4fP\x54\x47ROU\x50"); optGroup.label=item[i][0]; select.appendChild(optGroup); switch (item[i][1]){case "\x72ang\x65":for (var j=item[i][2]; j<=item[i][3]; j++){var option=document.createElement("\x4fPTIO\x4e"); option.innerHTML=j; option.value=j; optGroup.appendChild(option); }break; case "\166\x61\154\x75e":var option=document.createElement("\x4fPTI\x4f\x4e"); option.innerHTML=item[i][2]; option.value=item[i][2]; optGroup.appendChild(option); break; }}selectOption(select,defaultValue); pValue.insertBefore(select,description); break; case "sel\x65ct-color":var defaultValue=((item[1]==null)?item[3]:item[1]); var select=document.createElement("SEL\x45CT"); select.onchange= function ( ){changeColor(this,"",8); } ; select.style.width="14\x30px"; var values=new Array("\x30000\x30\x30","000\x30FF","\x30080\x30\x30","FFA500","\x46F0000","\x46FFFFF","\106\x46FF00",""); var texts=new Array(localization["\x42l\x61\143\x6b"],localization["B\x6cue"],localization["\x47reen"],localization["\117\x72ange"],localization["\x52ed"],localization["Whit\x65"],localization["\x59ellow"],localization["Cust\x6f\155"]); var options=new Array( ); for (var i=0; i<values.length; i++){var option=document.createElement("\x4f\120\x54ION"); if (values[i]==""){option.value=""; }else {option.value=eval("\x30x"+values[i]); option.style.backgroundColor="#"+values[i]; }option.innerHTML=texts[i]; select.appendChild(option); options[options.length]=option; }pValue.insertBefore(select,description); if (!selectOption(select,parseInt(defaultValue))){option=document.createElement("OPTION"); color=convertColor(defaultValue); option.innerHTML=localization["Custo\x6dh"]+color; option.value=defaultValue; option.style.backgroundColor=color; select.insertBefore(option,options[7]); select.selectedIndex=7; }break; case "text":var defaultValue=((item[1]==null)?item[5]:item[1]); var textBox=createText(defaultValue,"", false); pValue.insertBefore(textBox,description); if (item[4]!=""){description.innerHTML+=localization["\116\x6fte"]+item[4]; }break; case "text-r\x65gexp":var defaultValue=((item[1]==null)?item[5]:item[1]); var textBox=createText(defaultValue,item[3], true); pValue.insertBefore(textBox,description); description.innerHTML+=localization["No\x74e"]+item[4]; break; case "\x74ext-ra\x6e\147\x65":var defaultValue=((item[1]==null)?item[5]:item[1]); var textBox=createText(defaultValue,item[3], false); pValue.insertBefore(textBox,description); description.innerHTML+=localization["\x4eote"]+item[4]; break; }}else {pValue.innerHTML=localization["\x4e\101"]; }}function convertColor(color){color=parseInt(color); color=color.toString(16); if (color.length<6){var sTempString="0\x300000".substring(0,(6-color.length)); color="\x23"+sTempString.concat(color).toUpperCase( ); }else {color="#"+color.toUpperCase( ); }return color; }function validateText(control,expression,isRegExp){try {if (isRegExp){var re=new RegExp(expression,"gi"); if (re.test(control.value)){return true; }}else if (expression==""){return true; }else if (eval(expression.replace(/\x7b\x74\x65\x78\x74\x7d/gi,control.value))){return true; }}catch (e){} ; alert(localization["\x41ler\x74\x56al\x75e"]); control.focus( ); return false; }function getParameterValue(object,name){for (var i=0; i<object.childNodes.length; i++){if ((object.childNodes[i].tagName.toUpperCase( )=="\x50ARAM") && (object.childNodes[i].name.toUpperCase( )==name.toUpperCase( ))){return object.childNodes[i].value; }}return null; }function createMediaEmbed(asText,movieSrc){var movieType=(movieSrc.match(new RegExp(".mo\x76$"))?"\x71t": "wi\x6e"); var object=document.createElement("\x45MBED"); object.style.width=document.getElementById("mediaWid\x74h").value; object.style.height=document.getElementById("\x6dediaH\x65\x69g\x68\164").value; if (movieType=="qt"){object.setAttribute("type","movie/qu\x69cktime"); object.setAttribute("\x70lugins\x70\141\x67e","\x68ttp:/\x2f\x77w\x77\x2eap\x70le.c\x6fm/quic\x6b\164\x69me/dow\x6elo\x61d/"); }else {object.setAttribute("type","appli\x63ation/x-\x6d\x70\154\x61yer2"); object.setAttribute("\160\x6c\165g\x69nspage","h\x74\164\x70\x3a//\x64\157\x77\156\x6c\157\x61\144\x2e\155\x69cros\x6fft.c\x6f\155\x2fdownl\x6fad/wi\x6emedia\x70layer\x2fnsplu\x67in/6\x2e4/WIN\x398/EN-\x55S/wmp\x70lugin\x2eexe"); }object.setAttribute("src",movieSrc); object.setAttribute("\x61lign",document.getElementById("m\x65diaAlign").value); var keys=GetProperties( ).Keys( ); for (var i=0; i<keys.length; i++){var item=GetProperties( ).Item(keys[i]); if (item[1]!=null){object.setAttribute(keys[i],item[1]); }}if (asText){var divObj=document.createElement("DIV"); divObj.appendChild(object); return divObj.innerHTML; }else {return object; }}function submitMediaFile(fleBrowser){submitForUpload= true; var mediaFileControl=document.getElementById(FileUploadID); if (trim(mediaFileControl.value)==""){alert(localization["AlertFil\x65"]); mediaFileControl.focus( ); submitForUpload= false; }else {document.getElementById(fileDirID).value=fileBrowser.CurrentItem.GetPath( ); document.getElementById("load\x65r").innerHTML=localization["\x55plo\x61\144\x69ng"]; showObject("\x6coader"); }}var isPreviewerInPreviewMode= false; function MediaPreviewer( ){ this.MediaPath=""; }MediaPreviewer.prototype.Clear= function ( ){ this.SetDefaultValues(document.getElementById("\x50roper\x74\151\x65sPane")); };MediaPreviewer.prototype.GetHtml= function ( ){var movieSrc=""; if (fileBrowser.SelectedItem){movieSrc=fileBrowser.SelectedItem.GetUrl( ); }if (movieSrc!=""){return createMediaEmbed( true ,movieSrc); }else {return null; }};MediaPreviewer.prototype.LoadObjectFromPath= function (path){} ; MediaPreviewer.prototype.SetDefaultValues= function (elem){if (!elem.attributes)return; if (elem.attributes && elem.attributes["d\x65faultva\x6cue"]){var attr=elem.attributes["defa\x75ltvalu\x65"].value; if (elem.tagName && elem.tagName=="\x49NPUT"){var elemType=elem.getAttribute("type",0).toLowerCase( ); if (elemType=="rad\x69o"){var radioName=elem.getAttribute("\x6eame",2); var radios=document.getElementsByName(radioName); for (i=0; i<radios.length; i++){var thisRadio=radios[i]; if (thisRadio.getAttribute("val\x75e",2)==attr){thisRadio.setAttribute("check\x65d", true); break; }}}else if (elemType=="text"){elem.setAttribute("value",attr); }}else if (elem.tagName && (elem.tagName=="\x44IV" || elem.tagName=="\x54D")){elem.innerHTML=attr; }else if (elem.tagName && elem.tagName=="SELECT"){selectOption(elem,attr); }}if (elem.childNodes && elem.childNodes.length>0){for (var broi=0; broi<elem.childNodes.length; broi++){ this.SetDefaultValues(elem.childNodes[broi]); }}};MediaPreviewer.prototype.SwitchPreviewMode= function (browserItem,fileFullName){isPreviewerInPreviewMode=!isPreviewerInPreviewMode; this.Preview(browserItem,fileFullName); };MediaPreviewer.prototype.Preview= function (browserItem,defaultlyPreviewedFileFullName){if ((browserItem!=null) && (browserItem.Type!="\x44")){if (defaultlyPreviewedFileFullName==browserItem.GetUrl( )){ this.PreviewCurrentMode( true); }else { this.PreviewCurrentMode( false); }}else { this.Clear( ); document.getElementById("\x50r\x65\166\x69ewObje\x63\164\x48older").innerHTML=""; document.getElementById("Prope\x72tiesPa\x6ee").style.display="no\x6ee"; document.getElementById("Previe\x77Pane").style.display="none"; document.getElementById("\x45mp\x74\171\x50ane").style.display="inli\x6e\145"; }};MediaPreviewer.prototype.PreviewCurrentMode= function (isLoadingNeeded){document.getElementById("EmptyPan\x65").style.display="\x6eone"; var divPropertiesPane=document.getElementById("Propert\x69esPane"); var divPreviewPane=document.getElementById("\120\x72evi\x65\x77P\x61\156e"); var previewObjectHolder=document.getElementById("\x50rev\x69\145\x77Object\x48older"); if (isLoadingNeeded){LoadMediaProperties( ); }else { this.Clear( ); }previewObjectHolder.innerHTML=""; if (isPreviewerInPreviewMode){divPropertiesPane.style.display="none"; divPreviewPane.style.display="inline"; previewObjectHolder.innerHTML=this.GetHtml( ); }else {divPreviewPane.style.display="non\x65"; divPropertiesPane.style.display="\x69nline"; }};function LoadMediaProperties( ){if (dialogArgs.Media.tagName.toUpperCase( )=="\x4fBJECT"){document.getElementById("\155\x65diaW\x69dth").value=(dialogArgs.Media.width!="")?dialogArgs.Media.width:dialogArgs.Media.style.width; document.getElementById("\x6dedi\x61\x48ei\x67ht").value=(dialogArgs.Media.height!="")?dialogArgs.Media.height:dialogArgs.Media.style.height; if (dialogArgs.Media.align!=null){selectOption(document.getElementById("medi\x61Align"),dialogArgs.Media.align); }for (var i=0; i<GetProperties( ).keys.length; i++){var param=getParameterValue(dialogArgs.Media,GetProperties( ).keys[i]); if (param!=null){var item=parameters.Item(GetProperties.keys[i]); item[1]=param; }}}else if (dialogArgs.Media.tagName.toUpperCase( )=="\x45MB\x45\x44"){document.getElementById("mediaWid\x74h").value=(dialogArgs.Media.width!="")?dialogArgs.Media.width:dialogArgs.Media.style.width; document.getElementById("me\x64iaHeig\x68t").value=(dialogArgs.Media.height!="")?dialogArgs.Media.height:dialogArgs.Media.style.height; if (dialogArgs.Media.align!=null){selectOption(document.getElementById("\x6dedia\x41\154\x69gn"),dialogArgs.Media.align); }for (var i=0; i<GetProperties( ).keys.length; i++){var param=dialogArgs.Media.getAttribute(GetProperties( ).keys[i]); if (param!=null){var item=GetProperties( ).Item(GetProperties( ).keys[i]); item[1]=param; }}}}function FitMedia(media){var height=230; var width=240; var hRatio=media.height/height; var wRatio=media.width/width; media.setAttribute("\x4friginal\x57\151\x64th",media.width); media.setAttribute("Origi\x6ealHeig\x68\164",media.height); if (media.width>width && media.height>height){var ratio=(hRatio>=wRatio?hRatio:wRatio); media.width=(media.width/ratio); media.height=(media.height/ratio); }else {if (media.width>width){media.width=(media.width/wRatio); media.height=(media.height/wRatio); }else {if (media.height>height){media.width=(media.width/hRatio); media.height=(media.height/hRatio); }}}media.style.border="1px soli\x64 black"; }function ShowActualMediaSize( ){var media=GetPreviewedMedia( ); if (!media){return; }media.width=media.getAttribute("Origina\x6cWidth"); media.height=media.getAttribute("\x4fri\x67\151\x6ealHeight"); }function CallFitMedia( ){var media=GetPreviewedMedia( ); if (!media)return; var oWidth=media.getAttribute("\x4frig\x69\x6eal\x57idth"); var oHeight=media.getAttribute("Original\x48eight"); if (oWidth && oWidth!=media.width)media.width=oWidth; if (oHeight && oHeight!=media.height)media.height=oHeight; FitMedia(media); }function GetPreviewedMedia( ){var area=document.getElementById("\x50revi\x65\x77Ar\x65\141"); if (!area){return null; }var objects=area.getElementsByTagName("\x4fBJEC\x54"); if (objects && objects.length>0){return objects.item(0); }else {return null; }}function ScaleMedia(perc,makeBigger){var media=GetPreviewedMedia( ); if (!media){return; }perc=perc/100; if (makeBigger){media.width+=media.width*perc; media.height+=media.height*perc; }else {media.width-=media.width*perc; media.height-=media.height*perc; }}
function PreviewerBase( ){ this.PreviewedNode=null; }PreviewerBase.prototype.ChangePreviewedObject= function (previewedNode){ this.PreviewedNode=previewedNode; } ;
function PropertyTextBox(id,usage,message){ this.TextBox=document.getElementById(id); this.Usage=usage; this.Message=message; this.LastValidValue=this.TextBox.value; if (!this.IsValueValid( )){ this.TextBox.value=''; this.LastValidValue=''; }var thePropertyTextBox=this ; this.TextBox.onchange= function (e){if (!e)e=window.event; if (!thePropertyTextBox.ValidateText(e)){return false; }};}PropertyTextBox.prototype.GetValue= function ( ){return this.TextBox.value.replace(/^\x20*/gi,'').replace(/\x20*$/gi,''); } ; PropertyTextBox.prototype.IsValueValid= function ( ){var theText=this.GetValue( ); var checkResult= true; switch (this.Usage){case "DIMENSI\x4fN":checkResult=(theText=='') || theText.match(/^[\x30-\x39]*((\x25)|(\x70\x78))?$/gi); break; case "INT":checkResult=(theText=='') || theText.match(/[\x30-\x39]/gi); break; case "\x46LOAT":checkResult=!(isNaN(theText)); break; }return checkResult; } ; PropertyTextBox.prototype.ValidateText= function (e){if (!this.IsValueValid( )){alert(this.Message); this.TextBox.value=this.LastValidValue; this.TextBox.focus( ); if (e.stopPropagation){e.stopPropagation( ); }e.returnValue= false; e.cancelBubble= true; return false; }else { this.LastValidValue=this.GetValue( ); return true; }} ;
function SpinBox(controlId){ this.ControlId=controlId; this.tbSize=document.getElementById(this.ControlId+'_t\x65xtB\x6f\x78'); this.SizeValue=""; this.OnChangeValue=null; this.AllowBlankValue= false; }SpinBox.prototype.Initialize= function (size,textBoxSize,textBoxMaxLength){ this.SizeValue=size; if (size)this.tbSize.value=size; if (textBoxSize){ this.tbSize.style.width=textBoxSize; }if (textBoxMaxLength){ this.tbSize.maxLength=textBoxMaxLength; }} ; SpinBox.prototype.GetCurrentSize= function ( ){return this.SizeValue; } ; SpinBox.prototype.SetSize= function (size){ this.SizeValue=size; this.tbSize.value=size; this.RaiseChangeValue( ); };SpinBox.prototype.OnTextBoxKeyDown= function (e){if (!e)var e=window.event; e.returnValue=this.IsKeyValid(e); } ; SpinBox.prototype.OnTextBoxKeyUp= function (e){if (!e)var e=window.event; if (this.IsKeyValid(e, true)){ this.SizeValue=this.GetTextBoxValue( ); this.RaiseChangeValue( ); }} ; SpinBox.prototype.IsKeyValid= function (e,numsOnly){try {if (!numsOnly)numsOnly= false; if (!e)e=window.event; var acceptKey=((48<=e.keyCode && e.keyCode<=57) || (96<=e.keyCode && e.keyCode<=105) || (13==e.keyCode) || (8==e.keyCode) || (46==e.keyCode) || (9==e.keyCode)); if (!numsOnly)acceptKey |= ((35<=e.keyCode && e.keyCode<=40)); return acceptKey; }catch (ex){return true; }} ; SpinBox.prototype.GetTextBoxValue= function ( ){var size=-1; if (null!=this.tbSize){size=parseInt(this.tbSize.value); if (isNaN(size))size=-1; }return size; } ; SpinBox.prototype.RaiseChangeValue= function ( ){if (this.OnChangeValue){ this.OnChangeValue( ); }};SpinBox.prototype.ModifyBorderSize= function (increase){var size=this.SizeValue; var sizeTB=this.GetTextBoxValue( ); if (-1!=sizeTB && size!=sizeTB)size=sizeTB; if (increase && size<1000)size++; else if (!increase && size>0)size--; this.SizeValue=size; this.tbSize.value=size; this.RaiseChangeValue( ); } ; SpinBox.prototype.ButtonOver= function (control){if (this.IsEnabled(control)){control.className="O\x76\x65r"; }} ; SpinBox.prototype.ButtonOut= function (control){if (this.IsEnabled(control)){control.className=""; }} ; SpinBox.prototype.IsEnabled= function (control){return (control.className!="\x44isabled"); } ;
function StyleBuilder( ){ this.StyleElements=radEditorGetStyleElements( ); this.StyledObject=null; }StyleBuilder.prototype.Initialize= function (StyledObject){ this.StyledObject=StyledObject; alert("Curre\x6e\x74\154\x79 mod\x69\146\x69ed ob\x6aect ta\x67\116\x61me =\x20"+this.StyledObject.tagName); } ; StyleBuilder.prototype.GetStyleText= function ( ){return "\x62orde\x72\072\x31px \x73\157\x6cid red\x3b"; } ;
function StyleBuilderCaller(Id){ this.Id=Id; this.EditorObject=null; this.StyledObject=null; this.StyleTextHolder=document.getElementById(this.Id+"_styleT\x65\x78tHold\x65r"); }StyleBuilderCaller.prototype.Initialize= function (EditorObject){ this.EditorObject=EditorObject; } ; StyleBuilderCaller.prototype.SetStyledObject= function (StyledObject){ this.StyledObject=StyledObject; this.StyleTextHolder.value=this.StyledObject.style.cssText; } ; StyleBuilderCaller.prototype.ShowDialog= function ( ){var callBackParams= {StyleBuilderDialogCaller: this } ; if (this.StyledObject==null){alert('\x4fb\x6a\x65ct\x20to set \x73\164\171\x6ce to n\x6ft set!\x21!'); return; }var argument= {StyledObject: this.StyledObject } ; var url=''; if (this.EditorObject.UseSession==RadEditorNamespace.DIALOG_PARAMETERS_MODE_SESSION){var relativeRadControlsDir=this.EditorObject.RadControlsDir.substr(this.EditorObject.ApplicationPath.length); url=this.EditorObject.ApplicationPath+this.EditorObject.SessionID1+relativeRadControlsDir; }else {url=this.EditorObject.RadControlsDir; }return url+this.EditorObject.ShowDialog(url+"E\x64\x69tor/Dia\x6cog.aspx\x3fdi\x61log=St\x79leBuil\x64erHold\x65r"+"\x26editor\x49\x44="+this.EditorObject.Id+"\046\x73ki\x6e\x50at\x68="+this.EditorObject.SkinBasePath+"&us\x65\123\x65\163\x73\151\x6fn="+this.EditorObject.UseSession+"&se\x73sionID2="+this.EditorObject.SessionID2+"&\x6canguage="+this.EditorObject.Language,argument,400,300,StyleBuilderCallerSetCellStyleValue,callBackParams); return false; } ; StyleBuilderCaller.prototype.SetStyleText= function (styleText){ this.StyleTextHolder.value=styleText; } ; StyleBuilderCaller.prototype.GetStyleText= function ( ){return this.StyleTextHolder.value; };function StyleBuilderCallerSetCellStyleValue(retValue,params){if (retValue){params.StyleBuilderDialogCaller.SetStyleText(retValue); }window.focus( ); }
function Tab( ){ this.Id=""; this.ElementId=""; this.Image=null; this.ImageOver=null; this.Text=null; this.OnClientClick=null; this.Enabled=null; this.Selected= false; this.Table=null; }
; function TabManager(resizeControlId){ this.Tabs=new Array( ); this.SelectedTab=null; this.ResizeControlId=resizeControlId; this.Initialized= false; }
; TabManager.prototype= {GetCoords:function (node){var coords=new Array(0,0); if (node.offsetParent){while (node.offsetParent){coords[0]+=node.offsetLeft; coords[1]+=node.offsetTop; node=node.offsetParent; if (node==document.body){coords[0]-=node.offsetLeft; coords[1]-=node.offsetTop; }}}return coords; } ,ResizeDialog:function (elem){var coords=this.GetCoords(elem); var width=(coords[0]+elem.offsetWidth); var height=(coords[1]+elem.offsetHeight+75); if (window.radWindow && window.radWindow.SetWidth){if (window.radWindow.Width>width)width=window.radWindow.Width; window.radWindow.SetSize(width,height); try {if (document.documentElement && !document.all){document.documentElement.scrollTop=0; document.documentElement.scrollLeft=0; document.body.scrollTop=0; document.body.scrollLeft=0; }}catch (e){ ; } ; }else if (window.dialogWidth){var scrTop=window.screenTop; var scrLeft=window.screenLeft; window.dialogWidth=(width+8)+"p\x78"; window.dialogHeight=height+"\160\x78"; window.dialogTop=scrTop-30; window.dialogLeft=scrLeft-4; }else {window.outerWidth=width; window.outerHeight=height; }} ,GetTabByTable:function (table){for (var i=0; i<this.Tabs.length; i++){if (this.Tabs[i].Id==table.id){if (!this.Tabs[i].Table)this.Tabs[i].Table=table; return this.Tabs[i]; }}return null; } ,AddTab:function (id,elementid,img,imgover,onclick,enabled,selected){var tab=new Tab( ); tab.Id=id; tab.ElementId=elementid; tab.Image=img; tab.ImageOver=imgover; tab.OnClientClick=onclick; tab.Enabled=enabled; tab.Selected=selected; this.Tabs[this.Tabs.length]=tab; } ,Initialize:function ( ){if (this.Initialized){return; } this.Initialized= true; for (var i=0; i<this.Tabs.length; i++){var theTab=this.Tabs[i]; if (!theTab.Table && theTab.Id){theTab.Table=document.getElementById(theTab.Id); }if (theTab.ElementId){var elem=document.getElementById(theTab.ElementId); if (elem)elem.style.display=(theTab.Selected)?"\x62lock": "\x6eone"; }} this.SelectCurrentTab( ); } ,SetTabEnabled:function (tabIndex,enabled){if (!this.Initialized){ this.Initialize( ); }var tab=this.Tabs[tabIndex]; if (!tab)return; if (enabled){tab.Enabled= true; this.SetTabCss(tab,""); }else {tab.Enabled= false; this.SetTabCss(tab,"\x44i\x73\x61ble\x64"); }} ,SetTabSelected:function (tabIndex){if (!this.Initialized){ this.Initialize( ); }var tab=this.Tabs[tabIndex]; if (!tab){return; }else { this.SelectTab(tab.Table); }} ,SetTabCss:function (tab,css){if (!this.Initialized){ this.Initialize( ); }var table=tab.Table; if (!table){table=tab.Table=document.getElementById(tab.Id); }if (table){var tds=table.getElementsByTagName("\x54D"); table.className="Tab"+css; tds.item(0).className="\x54abLef\x74"+css; tds.item(1).className="TabCe\x6eter"+css; tds.item(2).className="\x54abRight"+css; }} ,ResizeWindow:function ( ){var parentElem=document.getElementById(this.ResizeControlId); if (parentElem){ this.ResizeDialog(parentElem); }} ,SelectTab:function (table){if (!this.Initialized){ this.Initialize( ); }var tab=this.GetTabByTable(table); if (!tab.Enabled)return; if (this.SelectedTab==tab)return; this.SetTabCss(tab,"Sel\x65cted"); if (this.SelectedTab){var table=this.SelectedTab.Table; var tds=table.getElementsByTagName("T\x44"); this.SetTabCss(this.SelectedTab,""); if (this.SelectedTab.ElementId){var elem=document.getElementById(this.SelectedTab.ElementId); if (elem)elem.style.display="\156\x6fne"; }} this.SelectedTab=tab; if (tab.ElementId){var elem=document.getElementById(tab.ElementId); if (elem)elem.style.display=""; if (tab.OnClientClick)eval(tab.OnClientClick); this.ResizeWindow( ); this.Refocus(elem); } this.SelectedTab.Table.focus( ); } ,Refocus:function (elem){try {var inps=elem.getElementsByTagName("input"); var first=null; for (var i=0; i<inps.length; i++){var inp=inps[i]; if (inp && inp.type!="hidden"){if (!first)first=inp; inp.setAttribute("\x74abin\x64\x65x","\x30"); }}}catch (ex){} ; } ,SelectCurrentTab:function ( ){for (var i=0; i<this.Tabs.length; i++){var theTab=this.Tabs[i]; if (theTab.Selected)this.SelectTab(theTab.Table); }}};
function TableBorderControl(id,borderColorPicker,spinBox){ this.Id=id; this.TargetTable=null; this.SpinBox=spinBox; this.PreviewTable=document.getElementById(this.Id+'\x5fPREVIEW'); this.BorderColorPicker=borderColorPicker; }TableBorderControl.prototype.Initialize= function (targetTable,colorsArray,allowCustomColors){ this.TargetTable=targetTable; if (this.TargetTable){var size=parseInt(this.TargetTable.border); if (isNaN(size)){ this.PreviewTable.removeAttribute('border'); this.PreviewTable.className="\x54ableBo\x72\144\x65rCon\x74rolPr\x65viewNo\x42\157\x72der"; }else { this.PreviewTable.border=size; }} this.PreviewTable.rules=this.TargetTable?this.TargetTable.rules: "\x61ll"; this.PreviewTable.frame=this.TargetTable?this.TargetTable.frame: "\x62or\x64\x65r"; var bColor=(this.TargetTable?this.TargetTable.getAttribute("b\x6frderCo\x6c\x6fr"): ""); if (!bColor)bColor=""; this.PreviewTable.setAttribute("\x62ord\x65\162\x43olor",bColor); this.SpinBox.Initialize(this.PreviewTable.border,18,4); var borderControl=this ; this.SpinBox.OnChangeValue= function anon( ){borderControl.SetBorderSize(this.GetCurrentSize( )); };this.BorderColorPicker.CanAddCustomColor=allowCustomColors; this.BorderColorPicker.CanAddHexColor=allowCustomColors; this.BorderColorPicker.SetColors(colorsArray); this.BorderColorPicker.OnClientClick= function anon( ){borderControl.SetBorderColor(this.SelectedColor); };this.OnColorSelected=null; this.BorderColorPicker.SelectColor(this.PreviewTable.getAttribute("\x62orde\x72\103\x6flor")); } ; TableBorderControl.prototype.UpdateTarget= function ( ){if (null!=this.TargetTable && null!=this.PreviewTable){var frame=this.GetFrame( ); if (frame){ this.TargetTable.frame=frame; }else { this.TargetTable.removeAttribute('fra\x6de'); }var rules=this.GetRules( ); if (rules){ this.TargetTable.rules=rules; }else { this.TargetTable.removeAttribute('\x72ul\x65\x73'); }if (this.PreviewTable.border!=""){ this.TargetTable.border=this.PreviewTable.border; }else { this.TargetTable.removeAttribute('\x62\x6f\x72der'); }var bColor=this.PreviewTable.getAttribute("\x62orderC\x6f\x6co\x72"); if (!bColor)bColor=""; this.TargetTable.setAttribute("borde\x72Color",bColor); }} ; TableBorderControl.prototype.SetBorderColor= function (color){if (null!=this.PreviewTable){if (""!=color && 0==parseInt(this.PreviewTable.border)){ this.SpinBox.SetSize(1); } this.PreviewTable.setAttribute("bor\x64\x65rColo\x72",color); }} ; TableBorderControl.prototype.GetFrame= function ( ){if (null!=this.PreviewTable && 'borde\x72'!=this.PreviewTable.frame && '\x62ox'!=this.PreviewTable.frame){return this.PreviewTable.frame; }else {return ''; }} ; TableBorderControl.prototype.GetRules= function ( ){if (null!=this.PreviewTable && 'al\x6c'!=this.PreviewTable.rules){return this.PreviewTable.rules; }else {return ''; }} ; TableBorderControl.prototype.GetBorderSize= function ( ){if (null!=this.PreviewTable){return this.PreviewTable.border; }else {return 0; }} ; TableBorderControl.prototype.SetFrame= function (frame){if (null!=this.PreviewTable){if ("\x76oid"!=frame && ""!=frame && 0==parseInt(this.PreviewTable.border)){ this.SpinBox.SetSize(1); } this.PreviewTable.frame=frame; }} ; TableBorderControl.prototype.SetRules= function (rule){if (null!=this.PreviewTable){if ("\x6eon\x65"!=rule && ""!=rule && 0==parseInt(this.PreviewTable.border)){ this.SpinBox.SetSize(1); } this.PreviewTable.rules=rule; }} ; TableBorderControl.prototype.SetBorderSize= function (size){if (null!=this.PreviewTable){if (size<0){ this.PreviewTable.removeAttribute('borde\x72'); }else {if (size>1000){alert(localization["BO\x52DER_SI\x5aE_OVERF\x4cOW"]); size=1000; } this.PreviewTable.border=size; } this.PreviewTable.className=(this.PreviewTable.border>0)?"Ta\x62leBorder\x43ontrolP\x72\145\x76i\x65\167": "Table\x42\157\x72derCont\x72\157\x6cPreview\x4eoBorde\x72"; }} ;
function TableDesignControl(id){ this.Id=id; this.SelectedCell=null; this.CurrentRowSpan=1; this.CurrentColSpan=1; this.SelectedCell=null; this.SelectedCellIndex=-1; this.VictimColumns=new Array( ); this.VictimRows=new Array( ); this.RowsCount=0; }TableDesignControl.prototype.Initialize= function (tableToModify,selectedCell){ this.TableToModify=tableToModify; this.TablePreviewControl=new TablePreviewControl(document.getElementById(this.Id+"\137Prev\x69ewTabl\x65Holder")); this.RowsCount=this.TableToModify.rows.length; this.SelectedCell=selectedCell; this.SelectedCellIndex=0; this.TablePreviewControl.UpdateTable(this.TableToModify,this.SelectedCell); var theTableDesignControl=this ; this.TablePreviewControl.OnSelectedCellChanged= function anon( ){theTableDesignControl.OnSelectedCellChanged( ); } ; this.CheckButtonAvailability( ); } ; TableDesignControl.prototype.OnSelectedCellChanged= function ( ){ this.SynchronizeSelectedCell( ); this.CheckButtonAvailability( ); } ; TableDesignControl.prototype.SynchronizeSelectedCell= function ( ){var previewSelectedCell=this.TablePreviewControl.GetSelectedCell( ); var previewTable=this.TablePreviewControl.GetPreviewTable( ); var previewTableRows=previewTable.rows; this.SelectedCell=null; this.SelectedCellIndex=-1; for (var i=0; i<previewTableRows.length; i++){var previewTableCells=previewTableRows[i].cells; for (var j=0; j<previewTableCells.length; j++){if (previewTableCells[j]==previewSelectedCell){ this.SelectedCell=this.TableToModify.rows[i].cells[j]; this.SelectedCellIndex=j; return; }}}} ; TableDesignControl.prototype.GetEquivalentModelTableCell= function (previewTableCell){var table=this.TablePreviewControl.GetPreviewTable( ); var rows=table.rows; for (var i=0; i<rows.length; i++){var cells=rows[i].cells; for (var j=0; j<cells.length; j++){if (cells[j]==previewTableCell){return this.TableToModify.rows[i].cells[j]; }}}} ; TableDesignControl.prototype.GetRowSpan= function (oCell){if (!oCell)return; return oCell.rowSpan>0?oCell.rowSpan: 1; } ; TableDesignControl.prototype.GetColSpan= function (oCell){if (!oCell)return; return oCell.colSpan>0?oCell.colSpan: 1; };TableDesignControl.prototype.CheckButtonAvailability= function ( ){var table=this.TablePreviewControl.GetPreviewTable( ); var selectedCell=this.TablePreviewControl.GetSelectedCell( ); if (this.GetNamedNodesLength(table.firstChild,"T\x52")>1){ this.EnableControl(document.getElementById(this.Id+"_delRow")); }else { this.DisableControl(document.getElementById(this.Id+"_de\x6cRow")); }if (this.GetMaxColumns( )>1){ this.EnableControl(document.getElementById(this.Id+"\x5fd\x65\x6cCol")); }else { this.DisableControl(document.getElementById(this.Id+"_delCol")); }var nextColumn=this.FindNextNamedSibling(selectedCell,"\x54D"); if ((selectedCell) && (nextColumn) && (selectedCell.offsetTop==nextColumn.offsetTop) && ((selectedCell.offsetLeft+selectedCell.offsetWidth+1)==nextColumn.offsetLeft)){var i; var rows=table.rows; var column=nextColumn; this.CurrentColSpan=this.GetColSpan(column); this.VictimColumns=new Array(this.GetEquivalentModelTableCell(column)); for (i=this.GetRowSpan(column); i<this.GetRowSpan(selectedCell); i+=this.GetRowSpan(column)){column=this.GetCellByOffset(this.FindNextNamedSibling(selectedCell.parentNode,"\x54R"),nextColumn.offsetLeft); this.VictimColumns[this.VictimColumns.length]=this.GetEquivalentModelTableCell(column); if (this.GetColSpan(column)!=this.CurrentColSpan){i=0; break; }}if (this.GetRowSpan(selectedCell)==i){ this.EnableControl(document.getElementById(this.Id+"\x5fadd\x43\x6flS\x70an")); }else { this.DisableControl(document.getElementById(this.Id+"_ad\x64\103\x6f\154\x53pan")); }}else { this.DisableControl(document.getElementById(this.Id+"\x5fad\x64\103o\x6cSpan")); }if ((selectedCell) && (selectedCell.colSpan>1)){ this.EnableControl(document.getElementById(this.Id+"\137\x64\145l\x43olSpan")); }else { this.DisableControl(document.getElementById(this.Id+"\x5f\144e\x6c\103\x6f\154\x53\160\x61n")); }try {var row=table.rows[this.GetNamedNodeIndex(selectedCell.parentNode,"TR")+this.GetRowSpan(selectedCell)]; if ((selectedCell) && (row)){var column=this.GetCellByOffset(row,selectedCell.offsetLeft); if (column){var i; var rows=table.rows; this.CurrentRowSpan=this.GetRowSpan(column); this.VictimRows=new Array(this.GetEquivalentModelTableCell(column)); for (i=this.GetColSpan(column); i<this.GetColSpan(selectedCell); i+=this.GetColSpan(column)){column=this.FindNextNamedSibling(column,"\x54D"); this.VictimRows[this.VictimRows.length]=this.GetEquivalentModelTableCell(column); if (this.GetRowSpan(column)!=this.CurrentRowSpan){i=0; break; }}if (this.GetColSpan(selectedCell)==i){ this.EnableControl(document.getElementById(this.Id+"_ad\x64RowSpan")); }else { this.DisableControl(document.getElementById(this.Id+"\x5faddRow\x53\160\x61n")); }}else { this.DisableControl(document.getElementById(this.Id+"\x5fad\x64\122o\x77Span")); }}else { this.DisableControl(document.getElementById(this.Id+"_ad\x64RowSpan")); }}catch (exc){ this.DisableControl(document.getElementById(this.Id+"\137\x61\144d\x52owSpan")); }if ((selectedCell) && (this.GetRowSpan(selectedCell)>1)){ this.EnableControl(document.getElementById(this.Id+"\x5fdelRow\x53\160\x61n")); }else { this.DisableControl(document.getElementById(this.Id+"\137\x64\145l\x52owSpan")); }} ; TableDesignControl.prototype.GetNamedNodesLength= function (node,name){var counter=0; for (var i=0; i<node.childNodes.length; i++){if (node.childNodes[i].nodeName==name){counter++; }}return counter; } ; TableDesignControl.prototype.EnableControl= function (control){if (!this.IsEnabled(control)){control.className=""; }} ; TableDesignControl.prototype.DisableControl= function (control){if (this.IsEnabled(control)){control.className="\x44isab\x6c\145\x64"; }} ; TableDesignControl.prototype.IsEnabled= function (control){if (control.className!="\104\x69\163a\x62led"){return true; }else {return false; }} ; TableDesignControl.prototype.OnButtonOver= function (control){if (this.IsEnabled(control)){control.className="O\x76er"; }} ; TableDesignControl.prototype.OnButtonOut= function (control){if (this.IsEnabled(control)){control.className=""; }} ; TableDesignControl.prototype.GetMaxColumns= function ( ){var maxCols=0; var firstRow=this.TableToModify.rows[0]; if (firstRow){var cells=firstRow.cells; for (var i=0; i<cells.length; i++){var oCell=cells[i]; var colSpan=oCell.colSpan>0?oCell.colSpan: 1; maxCols+=colSpan; }}return maxCols; } ; TableDesignControl.prototype.FindFirstNamedChild= function (node,nodeIndex,name){var nodesChild=node.childNodes; for (var i=nodeIndex; i<nodesChild.length; i++){if (nodesChild[i].nodeName==name){return nodesChild[i]; }}return null; } ; TableDesignControl.prototype.FindNextNamedSibling= function (node,name){if (node!=null){var nSibling=node.nextSibling; while (nSibling!=null){if (nSibling.nodeName==name){return nSibling; }nSibling=nSibling.nextSibling; }}return null; } ; TableDesignControl.prototype.GetCellByOffset= function (row,offset){var cells=row.cells; for (var i=0; i<cells.length; i++){if (cells[i].offsetLeft==offset){return cells[i]; }}return null; } ; TableDesignControl.prototype.GetNamedNodeIndex= function (node,name){if (node.parentNode && node.parentNode.childNodes){var nodesChild=node.parentNode.childNodes; var nodeIndex=0; for (var i=0; i<nodesChild.length; i++){if (nodesChild[i]==node){return nodeIndex; }else if (nodesChild[i].nodeName==name){nodeIndex++; }}}return -1; } ; TableDesignControl.prototype.RemoveNamedChild= function (node,name,index){var tempIndex=0; for (var i=0; i<node.childNodes.length; i++){if (node.childNodes[i].nodeName==name){if ((tempIndex==index) || (i==node.childNodes.length-1)){node.removeChild(node.childNodes[i]); break; }tempIndex++; }}} ; TableDesignControl.prototype.GetIndexByOffset= function (row,offset){var cells=row.cells; for (var i=0; i<cells.length; i++){if (offset>=cells[i].offsetLeft){return i; }}return cells.length; } ; TableDesignControl.prototype.DeleteLastColumn= function (control){if (this.IsEnabled(control)){var previewTableRows=this.TablePreviewControl.GetPreviewTable( ).rows; var modelTableRows=this.TableToModify.rows; for (var i=0; i<this.RowsCount; i++){var previewTableCells=previewTableRows[i].cells; var modelTableCells=modelTableRows[i].cells; if ((previewTableCells.length>1) || ((previewTableCells.length==1) && (previewTableCells[0].offsetLeft!=(this.TablePreviewControl.GetPreviewTable( ).cellSpacing+1)))){if (previewTableCells[previewTableCells.length-1].colSpan>1){previewTableCells[previewTableCells.length-1].colSpan--; modelTableCells[modelTableCells.length-1].colSpan--; }else { this.RemoveNamedChild(previewTableRows[i],"\124\x44",previewTableRows[i].getElementsByTagName("\x54D").length-1); this.RemoveNamedChild(modelTableRows[i],"\x54D",modelTableRows[i].getElementsByTagName("\x54D").length-1); }}} this.CheckButtonAvailability( ); }} ; TableDesignControl.prototype.DeleteLastRow= function (control){if (this.IsEnabled(control)){var previewTable=this.TablePreviewControl.GetPreviewTable( ); var previewTableRows=previewTable.rows; var modelTableRows=this.TableToModify.rows; for (var i=0; i<this.RowsCount; i++){var previewTableCells=previewTableRows[i].cells; var modelTableCells=modelTableRows[i].cells; for (var j=0; j<previewTableCells.length; j++){if ((this.GetRowSpan(previewTableCells[j])>1) && ((i+this.GetRowSpan(previewTableCells[j]))==this.RowsCount)){if (previewTableCells[j].rowSpan>0)previewTableCells[j].rowSpan--; if (modelTableCells[j].rowSpan>0)modelTableCells[j].rowSpan--; }}} this.RemoveNamedChild(previewTable.firstChild,"TR",this.RowsCount-1); this.RemoveNamedChild(this.TableToModify.firstChild,"\x54R",this.RowsCount-1); this.RowsCount--; this.CheckButtonAvailability( ); }} ; TableDesignControl.prototype.AddNewColumn= function ( ){var rows=this.TableToModify.rows; for (var i=0; i<this.RowsCount; i++){var oCell=null; try {oCell=rows[i].insertCell((this.SelectedCellIndex==0)?this.SelectedCellIndex+1: this.SelectedCellIndex); }catch (ex){oCell=rows[i].insertCell(0); }if (oCell){oCell.innerHTML="\x26nbs\x70\x3b"; }} this.TablePreviewControl.UpdateTable(this.TableToModify,this.SelectedCell); this.CheckButtonAvailability( ); } ; TableDesignControl.prototype.AddNewRow= function ( ){var newRow=this.TableToModify.insertRow(-1); for (var i=0; i<this.GetMaxColumns( ); i++){var oCell=newRow.insertCell(-1); oCell.innerHTML="&nbsp;"; } this.RowsCount++; this.TablePreviewControl.UpdateTable(this.TableToModify,this.SelectedCell); this.CheckButtonAvailability( ); } ; TableDesignControl.prototype.IncreaseColSpan= function (control){if (this.IsEnabled(control)){for (i=0; i<this.VictimColumns.length; i++){var row=this.VictimColumns[i].parentNode; var cellIndex=this.GetNamedNodeIndex(this.VictimColumns[i],"TD"); if (cellIndex>=0){row.removeChild(row.childNodes[cellIndex]); }}var colSpan=this.CurrentColSpan>0?this.CurrentColSpan: 1; colSpan+=this.GetColSpan(this.SelectedCell); this.SelectedCell.colSpan=colSpan; this.TablePreviewControl.UpdateTable(this.TableToModify,this.SelectedCell); this.CheckButtonAvailability( ); }} ; TableDesignControl.prototype.DecreaseColSpan= function (control){if (this.IsEnabled(control)){var row=this.SelectedCell.parentNode; for (var i=0; i<this.GetRowSpan(this.SelectedCell); i++){try {row.insertCell(this.SelectedCellIndex==0?this.SelectedCellIndex+1: this.SelectedCellIndex); }catch (ex){row.insertCell(0); }row=this.FindNextNamedSibling(row,"\x54R"); }if (this.SelectedCell.colSpan>1)this.SelectedCell.colSpan--; this.TablePreviewControl.UpdateTable(this.TableToModify,this.SelectedCell); this.CheckButtonAvailability( ); }} ; TableDesignControl.prototype.IncreaseRowSpan= function (control){if (this.IsEnabled(control)){for (i=0; i<this.VictimRows.length; i++){ this.VictimRows[i].parentNode.removeChild(this.VictimRows[i]); }var rowSpan=this.CurrentRowSpan>0?this.CurrentRowSpan: 1; rowSpan+=this.GetRowSpan(this.SelectedCell);this.SelectedCell.rowSpan=rowSpan; this.TablePreviewControl.UpdateTable(this.TableToModify,this.SelectedCell); this.CheckButtonAvailability( ); }} ; TableDesignControl.prototype.DecreaseRowSpan= function (control){if (this.IsEnabled(control)){var row=this.TableToModify.rows[this.GetNamedNodeIndex(this.SelectedCell.parentNode,"T\x52")+this.GetRowSpan(this.SelectedCell)-1]; if (this.SelectedCell.rowSpan>1)this.SelectedCell.rowSpan--; for (var i=0; i<this.GetColSpan(this.SelectedCell); i++){row.insertCell(0); } this.TablePreviewControl.UpdateTable(this.TableToModify,this.SelectedCell); this.CheckButtonAvailability( ); }} ;
function TablePreviewControl(previewHolder){ this.PreviewHolder=previewHolder; this.PreviewHolder.innerHTML=""; var dummyTable=document.createElement("TAB\x4c\x45"); this.PreviewHolder.appendChild(dummyTable); this.PreviewTable=dummyTable; this.selectedCells=[ ]; this.AllowMultiCellSelection= false; this.o3=null; }TablePreviewControl.prototype.UpdateTable= function (modelTable,selectedCell){var newTable=document.createElement("\124ABLE");newTable.style.width="\x332\x38\160\x78"; newTable.style.height="\062\x350px"; newTable.cellPadding=1; newTable.cellSpacing=1; for (var i=0; i<modelTable.rows.length; i++){var currentRow=modelTable.rows[i]; var newRow=newTable.insertRow(-1); for (var j=0; j<currentRow.cells.length; j++){var currentCell=currentRow.cells[j]; var newCell=newRow.insertCell(-1); newCell.rowSpan=currentCell.rowSpan; newCell.colSpan=currentCell.colSpan; if (currentCell==selectedCell){ this.SelectCell(newCell); }else { this.DeSelectCell(newCell); }newCell.theTablePreviewControl=this ; newCell.onclick=this.HandleCellClick; newCell.innerHTML="&nbs\x70;&nbsp;"; }} this.PreviewTable.parentNode.replaceChild(newTable,this.PreviewTable); this.PreviewTable=newTable; } ; TablePreviewControl.prototype.ChangeSelectedCell= function (Cell){ this.SetEditedCells(this.GetSelectedCells( )); var IsCellSelected=this.IsCellSelected(Cell); var IsMultiCellSelection=this.IsMultiCellSelection( ); this.DeSelectAllCells( ); if (!IsCellSelected || IsMultiCellSelection){ this.SelectCell(Cell); }if (this.OnSelectedCellChanged){ this.OnSelectedCellChanged( ); }} ; TablePreviewControl.prototype.HandleCellClick= function (e){if (!e){e=window.event; }var PreviewControl=this.theTablePreviewControl; var Cell=RadUtil_GetEventSource(e); if (PreviewControl.AllowMultiCellSelection && e.ctrlKey){if (PreviewControl.IsCellSelected(Cell)){PreviewControl.DeSelectCell(Cell); }else {PreviewControl.SelectCell(Cell); }if (PreviewControl.o3!=null){PreviewControl.o3.value=""; PreviewControl.o3.disabled= true; }}else {if (PreviewControl.o3!=null){PreviewControl.o3.disabled= false; }PreviewControl.ChangeSelectedCell(Cell); }} ; TablePreviewControl.prototype.GetPreviewTable= function ( ){return this.PreviewTable; } ; TablePreviewControl.prototype.SelectCell= function (Cell){ this.selectedCell=Cell; var RowIndex=Cell.parentNode.rowIndex; var CellIndex=GetCellIndex(Cell); if (typeof(this.selectedCells[RowIndex])=='\x75nd\x65\x66in\x65d'){ this.selectedCells[RowIndex]=[ ]; } this.selectedCells[RowIndex][CellIndex]=Cell; Cell.className="\x54able\x44\x69a\x6cogSelec\x74edCell"; } ; TablePreviewControl.prototype.DeSelectCell= function (Cell){if (this.IsCellSelected(Cell)){var RowIndex=Cell.parentNode.rowIndex; var CellIndex=GetCellIndex(Cell); this.selectedCells[RowIndex][CellIndex]=null; if (Cell==this.selectedCell){ this.selectedCell=null; }}Cell.className="Tabl\x65DialogCe\x6cl"; } ; TablePreviewControl.prototype.IsCellSelected= function (Cell){return (Cell.className=="\124\x61bleDial\x6fgSelect\x65\144\x43ell"); } ; TablePreviewControl.prototype.GetSelectedCell= function ( ){var selectedCells=this.GetSelectedCells( ); if (selectedCells && selectedCells.length>0){return this.GetSelectedCells( )[selectedCells.length-1]; }};TablePreviewControl.prototype.SetEditedCells= function (EditedCells){ this.editedCells=EditedCells; };TablePreviewControl.prototype.GetEditedCells= function ( ){return this.editedCells; };TablePreviewControl.prototype.GetSelectedCells= function ( ){var SelectedCells=[ ]; for (var RowIndex in this.selectedCells){for (var CellIndex in this.selectedCells[RowIndex]){SelectedCells.push(this.selectedCells[RowIndex][CellIndex]); }}return SelectedCells; } ; TablePreviewControl.prototype.DeSelectAllCells= function ( ){var SelectedCells=this.GetSelectedCells( ); for (var i=0; i<SelectedCells.length; i++){ this.DeSelectCell(SelectedCells[i]); } this.selectedCells=[ ]; };TablePreviewControl.prototype.IsMultiCellSelection= function ( ){return (this.GetSelectedCells( ).length>1); };
function TablePropertiesControl(id,skinPath,bgColorPicker,alignmentSelector,tableBorderControl,bgImageDialogCaller,cssClassSelector,cellSpacingSpinBox,cellPaddingSpinBox,StyleBuilderCaller){ this.Id=id; this.SkinPath=skinPath; this.BgColorPicker=bgColorPicker; this.AlignmentSelector=alignmentSelector; this.TableBorderControl=tableBorderControl; this.BgImageDialogCaller=bgImageDialogCaller; this.CssClassSelector=cssClassSelector; this.CellSpacingSpinBox=cellSpacingSpinBox; this.CellPaddingSpinBox=cellPaddingSpinBox; this.StyleBuilderCaller=StyleBuilderCaller; this.ColorsArray=null; this.AllowCustomColors= true; this.TableWidthHolder=document.getElementById(this.Id+"\x5f\x74\141\x62leWidt\x68"); this.TableHeightHolder=document.getElementById(this.Id+"\x5ftab\x6c\x65He\x69\147\x68t"); this.TableWidthBox=new PropertyTextBox(this.TableWidthHolder.id,"\104\x49MEN\x53\x49O\x4e",localization["\x49nvali\x64\x54a\x62\154\x65Width"]); this.TableHeightBox=new PropertyTextBox(this.TableHeightHolder.id,"DIMENSIO\x4e",localization["\x49n\x76\x61lid\x54ableHe\x69\147\x68t"]); this.TableStyleValueHolder=document.getElementById(this.Id+"_\x74ableStyl\x65Value"); this.IdHolder=document.getElementById(this.Id+"_id\x48\157\x6c\144\x65\162"); this.Initialized= false; }TablePropertiesControl.prototype.Initialize= function (tableToModify,AvailableCssClasses,EditorObject,ColorsArray,allowCustomColors){if (!this.Initialized){ this.ColorsArray=ColorsArray; this.EditorObject=EditorObject; this.TableToModify=tableToModify; this.AvailableCssClasses=AvailableCssClasses; this.AllowCustomColors=allowCustomColors; this.CssClassSelector.Initialize(this.AvailableCssClasses); this.BgImageDialogCaller.Initialize(this.EditorObject); this.StyleBuilderCaller.Initialize(this.EditorObject); this.BgColorPicker.CanAddCustomColor=this.AllowCustomColors; this.BgColorPicker.CanAddHexColor=this.AllowCustomColors; this.BgColorPicker.SetColors(this.ColorsArray); this.Initialized= true; this.LoadValues(this.TableToModify); }} ; TablePropertiesControl.prototype.LoadValues= function (tableToModify){var oTable=this.TableToModify=tableToModify; this.TableWidthHolder.value=oTable.style.width?oTable.style.width: (oTable.width?oTable.width: ""); this.TableHeightHolder.value=oTable.style.height?oTable.style.height: (oTable.height?oTable.height: ""); this.IdHolder.value=oTable.getAttribute("id")?oTable.getAttribute("\x69d"): ""; this.AlignmentSelector.SelectAlignment(oTable.align); this.CellSpacingSpinBox.Initialize(oTable.cellSpacing,50,4); this.CellPaddingSpinBox.Initialize(oTable.cellPadding,50,4); this.BgColorPicker.Enable( true); this.BgColorPicker.SelectColor(oTable.bgColor.toUpperCase( )); this.TableBorderControl.Initialize(oTable,this.ColorsArray,this.AllowCustomColors); this.CssClassSelector.SelectCssClass(oTable.className); this.StyleBuilderCaller.SetStyledObject(oTable); if (this.BgImageDialogCaller && oTable){var imagePath=this.TableToModify.getAttribute("backgr\x6fund"); if (!imagePath)imagePath=""; this.BgImageDialogCaller.SetImagePath(imagePath); }} ; TablePropertiesControl.prototype.UpdateTable= function ( ){var oTable=this.TableToModify; oTable.style.cssText=this.StyleBuilderCaller.GetStyleText( ); if (oTable.style.cssText==''){oTable.removeAttribute('styl\x65', false); }if (!this.TableWidthBox.IsValueValid( )){return false; }var theWidthValue=this.TableWidthBox.GetValue( ); oTable.removeAttribute("w\x69dth", false); oTable.style.width=theWidthValue?ConvertIntToPixel(theWidthValue): ""; if (!this.TableHeightBox.IsValueValid( )){return false; }var theHeightValue=this.TableHeightBox.GetValue( ); oTable.removeAttribute("\x68eig\x68\x74", false); oTable.style.height=theHeightValue?ConvertIntToPixel(theHeightValue): ""; this.SetAttribValue("\x69d",this.IdHolder.value); this.SetAttribValue("\x61lign",this.AlignmentSelector.GetAlign( )); var oSpacing=this.CellSpacingSpinBox.GetCurrentSize( ); this.SetAttribValue("\x63ellS\x70\141\x63ing",oSpacing>=0?oSpacing: "",(oSpacing>=0)); var oPadding=this.CellPaddingSpinBox.GetCurrentSize( ); this.SetAttribValue("ce\x6clPadding",oPadding>=0?oPadding: "",(oPadding>=0)); this.SetAttribValue("\x62gColor",this.BgColorPicker.SelectedColor); this.SetAttribValue("backg\x72ound",this.BgImageDialogCaller.GetImagePath( )); var className=document.all?"clas\x73Name": "\x63lass"; this.SetAttribValue(className,this.CssClassSelector.GetSelectedClassName( )); this.TableBorderControl.UpdateTarget( ); return true; } ; TablePropertiesControl.prototype.SetAttribValue= function (attribName,oVal,forceVal){if (oVal || ( true ==forceVal)){ this.TableToModify.setAttribute(attribName,oVal); }else { this.TableToModify.removeAttribute(attribName, false); }} ;
function TableWizard(id,tableDesignControl,tablePropertiesControl,cellPropertiesControl,accessibleTableControl){ this.Id=id; this.TableDesignControl=tableDesignControl; this.TablePropertiesControl=tablePropertiesControl; this.TablePreviewControl=new TablePreviewControl(document.getElementById(this.Id+"_\x43\x65llPr\x6fpertiesP\x72evie\x77TableHo\x6cder")); this.CellPropertiesControl=cellPropertiesControl; this.AccessibleTableControl=accessibleTableControl; this.CurrentlyEditedCell=null; this.CssClasses=null; this.CellCssClasses=null; this.EditorObject=null; }TableWizard.prototype= {Initialize:function (tableToModify,CssClasses,CellCssClasses,EditorObject,ColorsArray,allowCustomColors){ this.ColorsArray=ColorsArray; this.AllowCustomColors=allowCustomColors; this.CssClasses=CssClasses; this.CellCssClasses=CellCssClasses; this.TableToModify=tableToModify; this.OriginalTableClone=tableToModify.cloneNode( true); this.SelectedCell=null; this.SelectedCellIndex=-1; this.EditorObject=EditorObject; this.InitTableProperties(this.EditorObject); } ,GetCurrentlyEditedCell:function ( ){return this.CurrentlyEditorCell; } ,OnCellPropertiesSelectedCellChanged:function ( ){var EditedCells=this.TablePreviewControl.GetEditedCells( ); this.CellPropertiesControl.UpdateMultiple(this.GetModifyCellsForPreviewCells(EditedCells)); this.SynchronizeSelectedCell( ); if (this.SelectedCell){ this.CurrentlyEditedCell=this.SelectedCell; this.CellPropertiesControl.LoadPropertyValues(this.SelectedCell); }} ,OnCellPropertiesSelectedMultipleCells:function ( ){ this.CellPropertiesControl.Clear( ); } ,SynchronizeSelectedCell:function ( ){var previewSelectedCell=this.TablePreviewControl.GetSelectedCell( ); var previewTable=this.TablePreviewControl.GetPreviewTable( ); var previewTableRows=previewTable.rows; this.SelectedCell=null; this.SelectedCellIndex=-1; for (var i=0; i<previewTableRows.length; i++){var previewTableCells=previewTableRows[i].cells; for (var j=0; j<previewTableCells.length; j++){if (previewTableCells[j]==previewSelectedCell){ this.SelectedCell=this.TableToModify.rows[i].cells[j]; this.SelectedCellIndex=j; return; }}}} ,GetModifyCellForPreviewCell:function (PreviewCell){var RowIndex=PreviewCell.parentNode.rowIndex; var CellIndex=GetCellIndex(PreviewCell); return this.TableToModify.rows[RowIndex].cells[CellIndex]; } ,GetModifyCellsForPreviewCells:function (PreviewCells){var ModifyCells=[ ]; for (var i=0; i<PreviewCells.length; i++){ModifyCells.push(this.GetModifyCellForPreviewCell(PreviewCells[i])); }return ModifyCells; } ,InitCellProperties:function ( ){var theTableDesignControl=this ; this.TablePreviewControl.OnSelectedCellChanged= function anon( ){theTableDesignControl.OnCellPropertiesSelectedCellChanged( ); } ; this.TablePreviewControl.OnSelectedMultipleCells= function anon( ){theTableDesignControl.OnCellPropertiesSelectedMultipleCells( ); } ; this.TablePreviewControl.AllowMultiCellSelection= true; this.TablePreviewControl.UpdateTable(this.TableToModify,this.SelectedCell); this.CurrentlyEditedCell=this.SelectedCell; this.CellPropertiesControl.Initialize(this.CurrentlyEditedCell,this.CellCssClasses,this.EditorObject,this.ColorsArray,this.AllowCustomColors); this.TablePreviewControl.o3=this.CellPropertiesControl.IdHolder; } ,SaveLastEditedCellProperties:function ( ){if (this.CurrentlyEditedCell){var SelectedCells=this.TablePreviewControl.GetSelectedCells( ); if (!this.CellPropertiesControl.UpdateMultiple(this.GetModifyCellsForPreviewCells(SelectedCells))){return false; }}return true; } ,InitTableProperties:function ( ){ this.SaveLastEditedCellProperties( ); this.TablePropertiesControl.Initialize(this.TableToModify,this.CssClasses,this.EditorObject,this.ColorsArray,this.AllowCustomColors); } ,InitAccessibleTable:function ( ){ this.SaveLastEditedCellProperties( ); this.AccessibleTableControl.Initialize(this.TableToModify,this.TableToModify.document); } ,InitSelectedCell:function ( ){if (this.TableToModify.rows.length>0){if (this.TableToModify.rows[0].cells.length>0){ this.SelectedCell=this.TableToModify.rows[0].cells[0]; }}} ,InitDesigner:function ( ){ this.SaveLastEditedCellProperties( ); this.InitSelectedCell( ); this.TableDesignControl.Initialize(this.TableToModify,this.SelectedCell); } ,InsertTable:function ( ){if (!this.SaveLastEditedCellProperties( )){return; } this.AccessibleTableControl.UpdateTable( ); if (!this.TablePropertiesControl.UpdateTable( )){return; }CloseDlg(this.TableToModify); } ,RestoreOriginalTable:function ( ){if (this.TableToModify && this.TableToModify.parentNode)this.TableToModify.parentNode.replaceChild(this.OriginalTableClone,this.TableToModify); this.TableToModify=this.OriginalTableClone; }};
TemplateManager.prototype=new BrowserDialogBase( ); function TemplateManager(fileBrowser,previewer,tabHolder){BrowserDialogBase.call(this,fileBrowser,previewer,tabHolder); }TemplateManager.prototype.GetReturnResult= function ( ){return this.Previewer.GetTemplateHtml( ); } ; TemplateManager.prototype.IsTemplateChosen= function ( ){return this.FileBrowser.SelectedItem.Type!="\x44"; } ; function submitTemplateFile(fleBrowser){submitForUpload= true; var templateFileControl=document.getElementById(FileUploadID); if (trim(templateFileControl.value)==""){alert(localization["\101\x6cer\x74\x46i\x6ce"]); templateFileControl.focus( ); submitForUpload= false; }else {document.getElementById(fileDirID).value=fileBrowser.CurrentItem.GetPath( ); document.getElementById("\x6co\x61\x64er").innerHTML=localization["Uplo\x61ding"]; showObject("loader"); }}
TemplatePreviewer.prototype=new PreviewerBase; function TemplatePreviewer(Id){ this.Id=Id; this.PreviewArea=document.getElementById(this.Id+"_\x70revie\x77\101\x72ea"); PreviewerBase.call(this ); }TemplatePreviewer.prototype.ChangePreviewedObject= function (previewedItem){ this.PreviewedItem=previewedItem; if (this.PreviewedItem.Type=="D"){ this.Clear( ); }else { this.ShowTemplate(this.PreviewedItem.GetUrl( )); }} ; TemplatePreviewer.prototype.ShowTemplate= function (path){ this.PreviewArea.src=path; } ; TemplatePreviewer.prototype.GetTemplateHtml= function ( ){var theDocument=this.PreviewArea.document; return this.PreviewArea.contentWindow.document.body.innerHTML; } ; TemplatePreviewer.prototype.Clear= function ( ){ this.PreviewArea.src="j\x61vascr\x69\x70t\x3a\047\047"; } ;
function ThumbLinkOptionSetter(id){ this.Id=id; this.MainTable=document.getElementById("\x4dain\x54\141\x62le_"+this.Id); this.LinkSpecifier=document.getElementById("c\x62Link_"+this.Id); this.TargetSpecifier=document.getElementById("cbTarget\x5f"+this.Id); this.SetVisibility( false); this.TargetSpecifier.disabled= true; var theOptionSetter=this ; this.LinkSpecifier.onclick= function ( ){theOptionSetter.LinkSpecifier_Clicked( ); };if (typeof(GetDisposeManager)!="undefi\x6eed")GetDisposeManager( ).Add(this ); }ThumbLinkOptionSetter.prototype.Dispose= function ( ){ this.LinkSpecifier.onclick=null; this.LinkSpecifier=null; this.MainTable=null; this.TargetSpecifier=null; } ; ThumbLinkOptionSetter.prototype.SetVisibility= function (visible){ this.MainTable.style.display=visible?"": "\x6eo\x6e\145"; this.IsVisible=visible; } ; ThumbLinkOptionSetter.prototype.LinkSpecifier_Clicked= function ( ){ this.TargetSpecifier.disabled=!this.LinkSpecifier.checked; } ; ThumbLinkOptionSetter.prototype.GetOptions= function ( ){var returnValue= {LinkToImage: this.IsVisible && this.LinkSpecifier.checked,TargetToNew: this.IsVisible && this.LinkSpecifier.checked && this.TargetSpecifier.checked } ; return returnValue; } ;
function ThumbnailCreator(Id,WidthHolder,HeightHolder,NewImageNameHolder,OriginalFileLocationHolder,ConstrainHolder,DimentionUnitHolder,CreateButton,overwriteExistingHolder){ this.Id=Id; this.RealImage=""; this.RealImagePath=""; this.ImageName=""; this.Width=0; this.Height=0; this.RealImageWidth=0; this.RealImageHeight=0; this.Constrain= true; this.IsUsingPercents= false; this.OverwriteExisting= false; this.DimentionUnit="p\x69\x78el"; this.WidthHolder=WidthHolder; this.HeightHolder=HeightHolder; this.NewImageNameHolder=NewImageNameHolder; this.OriginalFileLocationHolder=OriginalFileLocationHolder; this.ConstrainHolder=ConstrainHolder; this.DimentionUnitHolder=DimentionUnitHolder; this.CreateButton=CreateButton; this.OverwriteExistingHolder=overwriteExistingHolder; this.MessageHolderRow=document.getElementById(this.Id+"\x5fht\x72\x4des\x73age"); this.MessageHolderCell=document.getElementById(this.Id+"\x5fhtcMe\x73\163\x61ge"); if (typeof(GetDisposeManager)!="undefi\x6eed")GetDisposeManager( ).Add(this ); }ThumbnailCreator.prototype.Dispose= function ( ){ this.WidthHolder=null; this.HeightHolder=null; this.NewImageNameHolder=null; this.OriginalFileLocationHolder=null; this.ConstrainHolder=null; this.DimentionUnitHolder=null; this.CreateButton=null; this.MessageHolderRow=null; this.MessageHolderCell=null; } ; ThumbnailCreator.prototype.Initialize= function (RealImage,ThumbnailSuffix){ this.RealImage=RealImage; this.ThumbnailSuffix=ThumbnailSuffix; this.RealImagePath=decodeURI(this.RealImage.src); this.RealImageWidth=this.RealImage.width; this.RealImageHeight=this.RealImage.height; if (this.RealImageWidth==0){ this.RealImageWidth=35; }if (this.RealImageHeight==0){ this.RealImageHeight=35; } this.ResetDimentions( ); var imageFileName=this.RealImagePath.substr(this.RealImagePath.lastIndexOf("\x2f")+1); var imageNameReplacer=new RegExp("(\x2e[ A-Za-\x7a0-9_]*?\x29\044","\x69"); imageNameReplacer.exec(imageFileName); this.NewImageNameHolder.value=imageFileName.replace(imageNameReplacer,this.ThumbnailSuffix+RegExp.$1); this.OriginalFileLocationHolder.value=this.RealImagePath; this.Constrain=this.ConstrainHolder.checked; this.DimentionUnitHolder.options[0].text=localization['Pi\x78el']; this.DimentionUnitHolder.options[1].text=localization['\x50erce\x6e\x74']; var thumbCreator=this ; this.HeightHolder.onkeyup= function (ev){thumbCreator.SetValue(this,"\150\x65ight"); } ; this.WidthHolder.onkeyup= function (ev){thumbCreator.SetValue(this,"\x77idth"); } ; this.ConstrainHolder.onclick= function (ev){thumbCreator.SetConstrain(this.checked); } ; this.DimentionUnitHolder.onchange= function (ev){thumbCreator.SetDimentionUnit( ); } ; var theOnClick=this.CreateButton.onclick; this.CreateButton.onclick= function (ev){if (!thumbCreator.CheckValidDimension( ))return; theOnClick( ); } ; this.ResetMessage( ); } ; ThumbnailCreator.prototype.SetDimentionUnit= function ( ){ this.DimentionUnit=this.DimentionUnitHolder.options[this.DimentionUnitHolder.selectedIndex].value.toLowerCase( ); this.ResetDimentions( ); } ; ThumbnailCreator.prototype.ResetMessage= function ( ){ this.MessageHolderRow.style.display='no\x6ee'; this.MessageHolderCell.style.display='n\x6fne'; this.MessageHolderCell.innerHTML=''; } ; ThumbnailCreator.prototype.ResetDimentions= function ( ){if (this.DimentionUnit=="\x70ixel"){ this.Width=this.RealImageWidth; this.Height=this.RealImageHeight; }else { this.Width=100; this.Height=100; } this.WidthHolder.value=this.Width; this.HeightHolder.value=this.Height; } ; ThumbnailCreator.prototype.SetConstrain= function (keepConstrain){ this.Constrain=keepConstrain; } ; ThumbnailCreator.prototype.ConstrainProportions= function (Dimention,DimentionType){var proportion=0; if (DimentionType.toLowerCase( )=="width"){if (this.DimentionUnit=="pixel"){if (this.RealImageWidth>0){proportion=Dimention/this.RealImageWidth; this.Height=Math.round(this.RealImageHeight*proportion); }else { this.Height=0; }}else { this.Height=parseInt(Dimention); }}else if (DimentionType.toLowerCase( )=="height"){if (this.DimentionUnit=="pi\x78el"){if (this.RealImageHeight>0){proportion=Dimention/this.RealImageHeight; this.Width=Math.round(this.RealImageWidth*proportion); }else { this.Width=0; }}else { this.Width=parseInt(Dimention); }}} ; ThumbnailCreator.prototype.ApplyConstrain= function (DimentionType){if (this.Constrain){if (DimentionType.toLowerCase( )=="width"){ this.ConstrainProportions(this.WidthHolder.value,DimentionType); this.HeightHolder.value=this.Height; }else if (DimentionType.toLowerCase( )=="he\x69ght"){ this.ConstrainProportions(this.HeightHolder.value,DimentionType); this.WidthHolder.value=this.Width; }}} ; ThumbnailCreator.prototype.SetValue= function (DimentionHolder,DimentionType){if (!DimentionHolder.value.match(/^\d*$/gi)){if (DimentionType.toLowerCase( )=="wid\x74h"){DimentionHolder.value=this.Width; }else if (DimentionType.toLowerCase( )=="\x68eight"){DimentionHolder.value=this.Height; }}else {if (DimentionType.toLowerCase( )=="width"){if (DimentionHolder.value==""){ this.Width=0; }else { this.Width=parseInt(DimentionHolder.value); } this.ApplyConstrain(DimentionType); this.HeightHolder.value=this.Height; }else if (DimentionType.toLowerCase( )=="h\x65ight"){if (DimentionHolder.value==""){ this.Height=0; }else { this.Height=parseInt(DimentionHolder.value); } this.ApplyConstrain(DimentionType); this.WidthHolder.value=this.Width; }}} ; ThumbnailCreator.prototype.SetMessage= function (MessageToken){ this.MessageHolderRow.style.display='block'; this.MessageHolderCell.style.display='bloc\x6b'; this.MessageHolderCell.innerHTML=localization[MessageToken]; } ; ThumbnailCreator.prototype.CheckValidDimension= function ( ){if (this.Width<=0 || this.Height<=0){alert(localization['Mess\x61geNoVa\x6cidDimen\x73ions']); return false; }return true; } ; ThumbnailCreator.prototype.Enable= function ( ){ this.private_SetEnabledState( true); } ; ThumbnailCreator.prototype.Disable= function ( ){ this.private_SetEnabledState( false); } ; ThumbnailCreator.prototype.private_SetEnabledState= function (enable){ this.WidthHolder.value=""; this.HeightHolder.value=""; this.NewImageNameHolder.value=""; this.OriginalFileLocationHolder.value=""; this.CreateButton.disabled=!enable; this.WidthHolder.disabled=!enable; this.HeightHolder.disabled=!enable; this.NewImageNameHolder.disabled=!enable; this.ConstrainHolder.disabled=!enable; this.DimentionUnitHolder.disabled=!enable; this.OverwriteExistingHolder=!enable; } ;
