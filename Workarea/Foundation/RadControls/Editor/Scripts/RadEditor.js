if (typeof(RadEditorNamespace)=="\x75\x6edefi\x6eed"){window.RadEditorNamespace= {RADEDITOR_INDENT_STEP: "\xb7\267\267",RADEDITOR_OUTDENT_STEP: "\xb7",RADCOMMAND_STATE_DISABLED: -1,RADCOMMAND_STATE_OFF: 0,RADCOMMAND_STATE_ON: 1,RADEDITOR_DESIGN_MODE: 1,RADEDITOR_HTML_MODE: 2,RADEDITOR_PREVIEW_MODE: 3,RADEVENT_CALLBACK_STARTED: "\x52ADEVENT\x5f\x43A\x4c\114\x42ACK_\x53TARTED",RADEVENT_MODE_CHANGED: "R\x41\104\x45VENT_M\x4f\104\x45_CHANG\x45D",RADEVENT_CONTEXTMENU: "RADEVEN\x54_CONTEXT\x4d\105\x4eU",RADEVENT_SEL_CHANGED: "\x52AD\x45\126\x45NT_SEL_\x43\110\x41NGED",RADEVENT_SIZE_CHANGED: "R\x41DEVENT_S\x49\132\x45_CHANG\x45D",RADEVENT_DISPOSE: "\x52ADEVENT\x5f\104\x49SPOSE",RADEVENT_SUBMIT: "\x52ADEVENT_\x53\125\x42MIT",RADEVENT_BEFORE_EDIT_FOCUS: "RADEV\x45NT_BEFOR\x45_EDIT_F\x4f\103\x55S",RADEVENT_KEYDOWN: "\x52ADEV\x45\116\x54_KEYDOW\x4e",RADEVENT_KEYUP: "\x52ADEV\x45\x4eT\x5f\113\x45YUP",RADEVENT_MOUSEDOWN: "\x52ADEVENT\x5f\115\x4fUSEDOW\x4e",RADEVENT_MOUSEUP: "\x52\101\x44\x45VE\x4e\124\x5f\115\x4f\125\x53\105\x55\120",RADEVENT_CUT: "R\x41DEVENT_C\x55\124",RADEVENT_COPY: "RADEVENT\x5fCOPY",RADEVENT_PASTE: "RADEV\x45NT_PAST\x45",RADEVENT_RESIZE_START: "RA\x44EVENT_RE\x53IZE_STA\x52\124",RADEVENT_RESIZE_END: "\x52ADE\x56\105\x4eT_RESIZE\x5fEND",RADEVENT_DRAG_START: "\x52AD\x45\x56EN\x54\x5fDR\x41G_START",RADEVENT_DRAG_END: "\x52ADE\x56\x45NT\x5fDRAG_END",RADEVENT_DROP: "\x52AD\x45\x56ENT\x5fDROP",RADCOMMAND_BOLD: "\x42old",RADCOMMAND_ITALIC: "Itali\x63",RADCOMMAND_UNDERLINE: "\x55nde\x72\154\x69ne",RADCOMMAND_FORECOLOR: "\106\x6freColor",RADCOMMAND_BACKCOLOR: "\x42ac\x6b\x43ol\x6f\162",RADCOMMAND_FONTNAME: "FontName",RADCOMMAND_FONTSIZE: "FontSiz\x65",RADCOMMAND_REAL_FONTSIZE: "R\x65alFontSi\x7ae",RADCOMMAND_CONVERT_TO_UPPER: "\x43onver\x74\124\x6fUpper",RADCOMMAND_CONVERT_TO_LOWER: "\x43onver\x74\x54oL\x6f\167\x65r",RADCOMMAND_JUSTIFY_LEFT: "\112\x75stifyLe\x66\164",RADCOMMAND_JUSTIFY_RIGHT: "\x4austifyRi\x67ht",RADCOMMAND_JUSTIFY_CENTER: "Ju\x73tifyCen\x74er",RADCOMMAND_JUSTIFY_FULL: "\x4austify\x46\165\x6cl",RADCOMMAND_JUSTIFY_NONE: "\x4austifyNo\x6ee",RADCOMMAND_INDENT: "I\x6edent",RADCOMMAND_OUTDENT: "Outden\x74",RADCOMMAND_SUBSCRIPT: "\x53ubscript",RADCOMMAND_SUPERSCRIPT: "\x53upersc\x72\x69pt",RADCOMMAND_STRIKETHROUGH: "\x53trikeTh\x72\157\x75gh",RADCOMMAND_FORMAT_BLOCK: "F\x6f\162\x6datBlock",RADCOMMAND_CUT: "Cut",RADCOMMAND_COPY: "\x43op\x79",RADCOMMAND_PASTE: "Paste",RADCOMMAND_UNDO: "Undo",RADCOMMAND_REDO: "\x52edo",RADCOMMAND_SELECT_ALL: "SelectA\x6cl",RADCOMMAND_TYPE: "\124\x79ping",RADCOMMAND_BACK: "\x42ack",RADCOMMAND_DELETE: "Delete",RADCOMMAND_INSERT_TABLE: "Ins\x65rtTable",RADCOMMAND_TABLE_WIZARD: "\124\x61bleWiza\x72\144",RADCOMMAND_INSERT_IMAGE: "Insert\x49mage",RADCOMMAND_INSERT_FLASH: "I\x6esertFlas\x68",RADCOMMAND_INSERT_MEDIA: "InsertM\x65dia",RADCOMMAND_INSERT_DOCUMENT: "\111\x6esertDocu\x6dent",RADCOMMAND_INSERT_SYMBOL: "Inser\x74\123\x79mbol",RADCOMMAND_INSERT_SNIPPET: "\x49nsertS\x6e\x69pp\x65t",RADCOMMAND_INSERT_FORM_ELEMENT: "Inser\x74\106\x6frmElem\x65\156t",RADCOMMAND_INSERT_DATE: "InsertDa\x74e",RADCOMMAND_INSERT_TIME: "\x49ns\x65\x72tT\x69\155\x65",RADCOMMAND_INSERT_ROW_ABOVE: "\x49nsertRo\x77\x41bo\x76\145",RADCOMMAND_INSERT_ROW_BELOW: "In\x73\145\x72tRowBelo\x77",RADCOMMAND_DELETE_ROW: "DeleteRo\x77",RADCOMMAND_INSERT_COLUMN_LEFT: "In\x73\145\x72tColumnL\x65ft",RADCOMMAND_INSERT_COLUMN_RIGHT: "I\x6e\163\x65rtColumn\x52ight",RADCOMMAND_DELETE_COLUMN: "\104\x65leteColu\x6dn",RADCOMMAND_MERGE_COLUMNS: "MergeC\x6flumns",RADCOMMAND_MERGE_ROWS: "\x4de\x72\147\x65Rows",RADCOMMAND_SPLIT_CELL: "\x53\160\x6c\151\x74\x43el\x6c",RADCOMMAND_DELETE_CELL: "Delet\x65\103\x65ll",RADCOMMAND_SET_CELL_PROPERTIES: "\x53etCel\x6c\120\x72opertie\x73",RADCOMMAND_SET_TABLE_PROPERTIES: "\x53et\x54\x61bl\x65\120\x72operti\x65s",RADCOMMAND_DELETE_TABLE: "\x44ele\x74\145\x54able",RADCOMMAND_TOGGLE_TABLE_BORDER: "\x54oggl\x65\124\x61bleBord\x65r",RADCOMMAND_SET_IMAGE_PROPERTIES: "\x53et\x49\x6dag\x65\120\x72operti\x65s",RADCOMMAND_SHOW_IMAGE_MAP_DIALOG: "Imag\x65\115\x61pDialog",RADCOMMAND_SHOW_EKTRON_IMAGE_MODIFICATION_TOOL: "\x45ktro\x6e\x49ma\x67eModifi\x63ationTo\x6fl",RADCOMMAND_FORMAT_CODE_BLOCK_DIALOG: "\x46ormatCo\x64\x65Bl\x6fck",RADCOMMAND_SET_LINK_PROPERTIES: "SetL\x69nkProper\x74\151\x65s",RADCOMMAND_STRIP_FORMAT: "\x46\157\x72\155\x61\164S\x74ripper",RADCOMMAND_SHOW_LINK_DIALOG: "LinkMana\x67er",RADCOMMAND_SHOW_IMAGE_DIALOG: "ImageMan\x61ger",RADCOMMAND_SHOW_FLASH_DIALOG: "\x46lash\x4d\x61na\x67\145\x72",RADCOMMAND_SHOW_MEDIA_DIALOG: "Medi\x61Manager",RADCOMMAND_SHOW_DOCUMENT_DIALOG: "\x44ocumen\x74\x4dan\x61\147\x65r",RADCOMMAND_SHOW_FIND_DIALOG: "\x46indAnd\x52\145\x70lace",RADCOMMAND_SHOW_ABOUT_DIALOG: "\x41\142\x6futDialo\x67",RADCOMMAND_SHOW_TEMPLATE_DIALOG: "Te\x6d\160\x6cateMa\x6e\141\x67\145\x72",RADCOMMAND_HELP: "Hel\x70",RADCOMMAND_MANAGE_MODULE: "\x4doduleMa\x6e\141\x67er",RADCOMMAND_PAGE_PROPERTIES: "Pa\x67\145\x50ropertie\x73",RADCOMMAND_PRINT: "Prin\x74",RADCOMMAND_SPELLCHECK: "Sp\x65llCheck",RADCOMMAND_PASTE_FROM_WORD: "P\x61steFrom\x57\157\x72d",RADCOMMAND_PASTE_FROM_WORD_ALL: "\x50ast\x65\x46ro\x6d\127\x6f\162\x64NoFonts\x4eoSizes",RADCOMMAND_PASTE_PLAIN_TEXT: "PastePl\x61inText",RADCOMMAND_PASTE_AS_HTML: "\x50asteAsHt\x6d\154",RADCOMMAND_ABSOLUTE_POSITION: "\x41bsolu\x74\145\x50osition",RADCOMMAND_UNLINK: "Un\x6c\151\x6e\x6b",RADCOMMAND_INSERT_ORDERED_LIST: "\x49nser\x74\117\x72deredLi\x73t",RADCOMMAND_INSERT_UNORDERED_LIST: "\x49nsertU\x6e\x6frd\x65redList",RADCOMMAND_INSERT_PARAGRAPH: "\x49ns\x65\x72tP\x61\162\x61graph",RADCOMMAND_INSERT_CUSTOM_LINK: "Inse\x72tCustomL\x69nk",RADCOMMAND_TOGGLE_SCREEN_MODE: "To\x67gleScree\x6eMode",RADCOMMAND_TOGGLE_DOCKING: "ToggleDo\x63king",RADCOMMAND_ZOOM: "Zoom",RADCOMMAND_APPLY_CLASS: "ApplyC\x6c\141\x73s",RADCOMMAND_REPEAT_LAST_COMMAND: "\x52epeat\x4c\141\x73tComm\x61\156\x64",RADCOMMAND_MOVE: "\x4doveCo\x6d\155\x61nd",RADCOMMAND_RESIZE: "Resize\x43\157\x6dmand",RADCOMMAND_TAB: "\105\x6e\141b\x6ceTab",RADCOMMAND_SHIFT_TAB: "\x53\x68if\x74\x54ab",DM_DELETE: "D\x45LETE",DM_BACK: "\x42ACKSP\x41\x43E",KEY_F1: 112,KEY_F2: 113,KEY_F3: 114,KEY_F4: 115,KEY_F5: 116,KEY_F6: 117,KEY_F7: 118,KEY_F8: 119,KEY_F9: 120,KEY_F10: 121,KEY_F11: 122,KEY_F12: 123,KEY_CTRL: 17,KEY_SHIFT: 16,KEY_ALT: 18,KEY_ENTER: 13,KEY_HOME: 36,KEY_END: 35,KEY_LEFT: 37,KEY_RIGHT: 39,KEY_UP: 38,KEY_DOWN: 40,KEY_PAGEUP: 33,KEY_PAGEDOWN: 34,KEY_ESC: 27,KEY_SPACE: 32,KEY_TAB: 9,KEY_BACK: 8,KEY_DELETE: 46,KEY_INSERT: 45,KEY_CONTEXT_MENU: 93,KF_CTRL: (1<<0),KF_SHIFT: (1<<2),KF_ALT: (1<<4),TOOL_BUTTON: "B",TOOL_COMBOBOX: "\x44",TOOL_DROP_BUTTON: "\x44B",TOOL_SEPARATOR: "S",TOOL_BUTTON_COMBOBOX: "TD",TOOL_CUSTOM: "CUSTOM",TOOL_CUSTOM_DROP_BUTTON: "CDB",CLEAR_PASTE_FORMATTING_NONE: 0,CLEAR_PASTE_FORMATTING_NONE_SUPRESS_MESSAGE: 1,CLEAR_PASTE_FORMATTING_WORD: 2,CLEAR_PASTE_FORMATTING_WORD_NO_FONTS: 4,CLEAR_PASTE_FORMATTING_WORD_REMOVE_ALL: 8,CLEAR_PASTE_FORMATTING_CSS: 16,CLEAR_PASTE_FORMATTING_FONT: 32,CLEAR_PASTE_FORMATTING_SPAN: 64,CLEAR_PASTE_FORMATTING_ALL: 128,CLEAR_PASTE_FORMATTING_WORD_PRESERVE_CLASSES: 256,CLEAR_PASTE_FORMATTING_WORD_PRESERVE_STYLES: 512,DIALOG_PARAMETERS_MODE_JAVASCRIPT: 0,DIALOG_PARAMETERS_MODE_SESSION: 1,DIALOG_PARAMETERS_MODE_COOKIE: 2,IMAGE_MANAGER_DIALOG_NAME: "\x49m\x61\x67eMa\x6eager" } ; }
RadEditorNamespace.Utils= {GetPasteIframe:function ( ){if (!this.PasteIframe){ this.PasteIframe=document.createElement("\x49\106\x52AME"); var style=this.PasteIframe.style; style.width="1px"; style.height="1p\x78"; style.border="0\x70x solid\x20red"; style.overflow="\x68idden"; style.position="absolu\x74e"; document.body.appendChild(this.PasteIframe); var doc=this.PasteIframe.contentWindow.document; var O=doc.open("\x74\x65\x78t/h\x74ml","\x72ep\x6c\x61ce"); var I="\x3chtml>\x3c\x68ea\x64>\074\x74it\x6ce>New \x44\157\x63ument\074/tit\x6ce>\074\x2fh\x65ad>"+"\x3cbody\x20\x63on\x74entEdit\x61ble=\047\x74ru\x65\047\x20style\x3d\047\x6fve\x72flow:h\x69dden;\x6dargi\x6e:0px;p\x61dding\x3a0px;\x68eigh\x74:100\x25\047\x3e"+"\074\x2fhtml>"; O.write(I); O.close( ); }return this.PasteIframe; } ,GetPasteContainer:function ( ){var area=this.GetPasteIframe( ); return area.contentWindow.document.body; } ,GetCellIndex:function (oCell){var selCol=oCell?(oCell.cellIndex+1): 0; if (TelerikNamespace.Utils.DetectBrowser("sa\x66ari")){var oP=oCell.parentNode; for (var i=0; i<oP.cells.length; i++){if (oCell==oP.cells[i]){selCol=i+1; break; }}}return selCol; } ,GetComputedStyle:function (element,propertyName,pseudoElement){if (element.ownerDocument.defaultView && element.ownerDocument.defaultView.getComputedStyle){try {return element.ownerDocument.defaultView.getComputedStyle(element,pseudoElement || null)[propertyName]; }catch (ev){} ; }else if (element && element.currentStyle){return element.currentStyle[propertyName]; }return null; } ,ExtendObject:function (object,extender){for (var prop in extender){try {object[prop]=extender[prop]; }catch (ex){}}} ,OnItemDragStart:function ( ){return false; } ,GetPlainTable:function (oDoc){var oTable=oDoc.createElement("\x74ab\x6c\145"); oTable.cellSpacing=0; oTable.cellPadding=0; oTable.border=0; oTable.setAttribute("unse\x6cectable","\x6fn"); oTable.style.cursor="\x64efault"; return oTable; } ,IsMouseInElement:function (e){var pageX=e.pageX?e.pageX:e.clientX; var pageY=e.pageY?e.pageY:e.clientY; var srcElement=RadEditorNamespace.Utils.GetEventSource(e); for (var i=1; i<arguments.length; i++){var oElem=arguments[i]; if (oElem && oElem.componentFromPoint && ""==oElem.componentFromPoint(pageX,pageY)){return true; }else if (srcElement && (oElem==srcElement || RadEditorNamespace.Utils.IsParentNode(oElem,srcElement))){return true; }}return false; } ,StringBuilder:function (sString){ this.length=0; this.Append= function (sString){ this.length+=(this._parts[this._current++]=String(sString)).length; this._string=null; return this ; } ; this.ToString= function ( ){if (this._string!=null)return this._string; var s=this._parts.join(""); this._parts=[s]; this._current=1; this.length=s.length; return this._string=s; } ; this._current=0; this._parts=[ ]; this._string=null; if (sString!=null)this.Append(sString); } ,GetElementsByAttributeName:function (startElement,attribName,skipStartElement){var arr=[ ]; if (null!=startElement){if (!skipStartElement && null!=startElement && null!=startElement.getAttribute && null!=startElement.getAttribute(attribName)){arr.push(startElement); }for (var i=0; i<startElement.childNodes.length; i++){arr=arr.concat(this.GetElementsByAttributeName(startElement.childNodes[i],attribName)); }}return arr; } ,SelectElement:function (oWindow,oElement){if (!oElement)return; var oDocument=oWindow.document; if (!oDocument)return false; if (oDocument.selection && !window.opera){var range; switch (oElement.tagName){case "\x54AB\x4c\x45":case "IMG":case "HR":case "\x49NP\x55\x54":range=oDocument.body.createControlRange( ); range.add(oElement); break; case "UL":case "\x4fL":range=oDocument.body.createTextRange( ); range.moveToElementText(oElement); var parEl=range.parentElement( ); if (parEl.tagName!="UL" || parEl.tagName!="OL"){range.moveEnd("charact\x65r",-1); }break; default:range=oDocument.body.createTextRange( ); range.moveToElementText(oElement); break; }if (range){range.select( ); return true; }}else if (oWindow.getSelection){var range=oDocument.createRange( ); range.selectNode(oElement); if (window.opera){range.selectNodeContents(oElement); }var selection=oWindow.getSelection( ); if (TelerikNamespace.Utils.DetectBrowser("safari")){selection.setBaseAndExtent(range.startContainer,range.startOffset,range.endContainer,range.endOffset); }else {selection.removeAllRanges( ); selection.addRange(range); }return true; }return false; } ,MergeElementAttributes:function (oSource,oTarget,bPreserve){if (!oSource || !oTarget)return; if (oSource.mergeAttributes){oTarget.mergeAttributes(oSource,bPreserve); }else {}} ,IsParentNode:function (parent,child){if (!parent || !child)return false; var oParent=child.parentNode; do {if (oParent==parent)return true; }while ((oParent=oParent.parentNode)!=null); return false; } ,FindScrollPosY:function (node){var y=0; var currentElement=node; while (currentElement.parentNode && currentElement.parentNode.tagName!="B\x4fDY"){if (typeof(currentElement.parentNode.scrollTop)=="\x6eumber"){y+=currentElement.parentNode.scrollTop; }currentElement=currentElement.parentNode; }return y; } ,GetRect:function (element){if (!element){element=this ; }var left=0; var top=0; var elem=$ektron(element); var width=elem.outerWidth( ); var height=elem.outerHeight( ); if (element.x){left=element.x; top=element.y; }else {while (element!=null){left+=element.offsetLeft; top+=element.offsetTop; element=element.offsetParent; }}left=RadEditorNamespace.Utils.GetIntValue(left,0); top=RadEditorNamespace.Utils.GetIntValue(top,0); return new RadEditorNamespace.Utils.Rectangle(left,top,width,height); } ,Rectangle:function (left,top,width,height){ this.left=(null!=left?left: 0); this.top=(null!=top?top: 0); this.width=(null!=width?width: 0); this.height=(null!=height?height: 0); this.right=left+width; this.bottom=top+height; } ,MakeSeparator:function (oCell,isVertical){if (!oCell)return; oCell.setAttribute("\x75nselec\x74\141\x62le","\x6fn"); oCell.className=isVertical?"RadESe\x70aratorH\x6f\162\x69zonta\x6c": "RadES\x65parator"; } ,IsNull:function (value,defaultValue){return (null==value)?defaultValue:value; } ,IsSystemKey:function (keyCode){if (keyCode>=112 && keyCode<=123)return true; if (keyCode>=8 && keyCode<=27)return true; if (keyCode>=32 && keyCode<=46)return true; if (keyCode==93)return true; return false; } ,Format:function (text){for (var i=1; i<arguments.length; i++){text=text.replace(new RegExp("\x5c{"+(i-1)+"\134\x7d","\x69g"),arguments[i]); }return text; } ,StartsWith:function (text,value){if (typeof(value)!="\x73tring")return false; return (0==text.indexOf(value)); } ,EndsWith:function (text,value){if (typeof(value)!="\x73tring")return false; return (text.lastIndexOf(value)+value.length==text.length-1); } ,TrimLeft:function (text){if (!text || !text.replace)return text; return text.replace(/^\s+/gi,""); } ,TrimRight:function (text){if (!text || !text.replace)return text; return text.replace(/\s+$/gi,""); } ,Trim:function (text){return (RadEditorNamespace.Utils.TrimLeft(RadEditorNamespace.Utils.TrimRight(text))); } ,ArrayAdd:function (array,item){array[array.length]=item; } ,ArrayRemove:function (array,item){var itemFound= false; for (var i=0; i<array.length; i++){if (item==array[i]){itemFound= true; }if (itemFound){array[i]=array[i+1]; }}if (itemFound){array.length-=1; }} ,AttachEventEx:function (element,eventName,handler){eventName=RadEditorNamespace.Utils.FixEventName(eventName); if (element){if (element.attachEvent){element.attachEvent(eventName,handler); }else if (element.addEventListener){element.addEventListener(eventName,handler, false); }}} ,DetachEventEx:function (element,eventName,handler){eventName=RadEditorNamespace.Utils.FixEventName(eventName); if (element){if (element.detachEvent){element.detachEvent(eventName,handler); }else if (element.addEventListener){element.removeEventListener(eventName,handler, false); }}} ,FixEventName:function (eventName){eventName=eventName.toLowerCase( ); if (document.addEventListener && RadEditorNamespace.Utils.StartsWith(eventName,"on")){return eventName.substr(2); }else if (document.attachEvent && !RadEditorNamespace.Utils.StartsWith(eventName,"\x6fn")){return "on"+eventName; }else {return eventName; }} ,GetEventSource:function (e){if (null==e)return null; if (e.srcElement)return e.srcElement; else if (e.target)return e.target; else return null; } ,CancelEvent:function (eventArgs){if (!eventArgs)eventArgs=window.event; if (!eventArgs)return false; eventArgs.returnValue= false; eventArgs.cancelBubble= true; if (eventArgs.stopPropagation){eventArgs.stopPropagation( ); }if (eventArgs.preventDefault){eventArgs.preventDefault( ); }return false; } ,GetElementParentByTag:function (element,tagName){if (null==element)return null; if (null==tagName)return element; try {while (element && null!=element.tagName && element.tagName!=tagName){element=element.parentNode; }return ((element.tagName==tagName)?element:null); }catch (e){return null; }} ,GetOuterHtml:function (element){if (element.outerHTML){return element.outerHTML; }else {var _emptyTags= { "IMG": true ,"\x42R": true ,"\x49NPUT": true ,"M\x45\124\x41": true ,"\x4c\x49NK": true ,"\x50ARAM": true ,"H\x52": true } ; var elementCopy=element.cloneNode( true); var tmpDiv=element.ownerDocument.createElement("\x44I\x56"); tmpDiv.appendChild(elementCopy); return tmpDiv.innerHTML; }} ,GetIntValue:function (sNumber,defaultValue){if (!defaultValue)defaultValue=0; var nNumber=parseInt(sNumber); return (isNaN(nNumber)?defaultValue:nNumber); } ,HasHtmlContent:function (text){if (!text || !text.match)return text; return text.match(/\x3c/); } ,RemoveProtocolNameAndServerName:function (url){var splitPosition=url.indexOf("//"); if (splitPosition>=0){splitPosition=url.indexOf("/",splitPosition+2); if (splitPosition>=0){return url.substring(splitPosition); }}return url; } ,RemoveElementStyleAttribute:function (element,styleAttributeName){if (element.style && element.style[styleAttributeName]){element.style[styleAttributeName]=null; if (element.style.removeAttribute){element.style.removeAttribute(styleAttributeName); }if (element.style.cssText){}else {element.removeAttribute("st\x79le"); }}} ,EscapeRegexSpecialChars:function (pattern){pattern=pattern.replace(/\x5c/gi,"\134\x5c"); pattern=pattern.replace(/\x26/gi,"&amp;"); pattern=pattern.replace(/\x3f/gi,"\134\x3f"); pattern=pattern.replace(/\x2b/gi,"\x5c+"); pattern=pattern.replace(/\x28/gi,"\134\x28"); pattern=pattern.replace(/\x29/gi,"\x5c)"); pattern=pattern.replace(/\x5b/gi,"\x5c\133"); pattern=pattern.replace(/\x5d/gi,"\134\x5d"); pattern=pattern.replace(/\x5e/gi,"\134\x5e"); pattern=pattern.replace(/\x24/gi,"\x5c$"); pattern=pattern.replace(/\x2e/gi,"\x5c."); pattern=pattern.replace(/\x2a/gi,"\134\x2a"); pattern=pattern.replace(/\x7c/gi,"\x5c\x7c"); return pattern; }};
if ("\165\x6ede\x66\151\x6eed"==typeof(window.RadEditorGlobalArray)){window.RadEditorGlobalArray=[ ]; }function GetRadEditor(clientID){try {return eval("\x77i\x6e\x64ow\x5b\047"+clientID+"\047\x5d"); }catch (e){return null; }}RadEditorNamespace.ToolbarModesEnum= {Default: 1,Floating: 2,PageTop: 4,ShowOnFocus: 8 } ; function RadEditorInitialize(editorID,submitFnStr,cancelFnStr,applicationPath,radControlsDir,skinBasePath,direction,className,width,height,toolsWidth,toolsHeight,language,serverName,serverPort,serverPath,anchorPathToStrip,imagesPathToStrip,stripAbsoluteAnchorPaths,stripAbsoluteImagesPaths,convertTagsToLower,allowScripts,enableHtmlIndentation,useSession,useClassicDialogs,toolbarMode,atlasPartialRendering,enableContextMenus,allowCustomColors,enableEnhancedEdit,clearPasteFormatting,newLineBr,spellId,ajaxSpellId,colorsArray,fontNamesArray,fontSizesArray,realFontSizesArray,symbolsArray,paragraphsArray,cssClassesArray,cssFilesArray,linksArray,modulesArray,dialogParametersArray,toolsArray,sessionID1,sessionID2,mediaFilters,documentFilters,imagesFilters,templateFilters,overflow,causesValidation,thumbSuffix,showHtmlMode,showPreviewMode,showSubmitCancelButtons,onClientLoad,onClientCommandExecuting,onClientCommandExecuted,onClientModeChange,onClientSubmit,onClientCancel,onClientInit,languagesArray,enableTab,enableClientSerialize,contextMenusArray,spellAllowAddCustom,convertFontToSpan,focusOnLoad,formID,enableDocking,convertToXhtml,snippetsArray,validationGroup,dialogInternalParameters,enableServerSideRendering,useEmbeddedScripts){if (null==document.getElementById("\x52adECon\x74\x65nt\x48iddenTe\x78tarea"+editorID)){return null; }try {theEditor=new RadEditor(editorID); if (onClientInit)theEditor.AttachClientEvent("\x4fnClie\x6e\x74I\x6e\151\x74",onClientInit); theEditor.ExecuteClientEvent("OnClie\x6etInit"); theEditor.SpellAllowAddCustom=spellAllowAddCustom; theEditor.FormID=formID; theEditor.SpellId=spellId; theEditor.AjaxSpellId=ajaxSpellId; theEditor.SubmitFnStr=submitFnStr; theEditor.CancelFnStr=cancelFnStr; theEditor.ApplicationPath=applicationPath; theEditor.RadControlsDir=radControlsDir?radControlsDir: "Rad\x43ontrols"; theEditor.SkinBasePath=skinBasePath?skinBasePath: "RadC\x6fntrols/E\x64itor/Sk\x69ns/Def\x61ult/"; theEditor.Direction=direction; theEditor.Width=width?width: "\x3600"; theEditor.Height=height?height: "\x3600"; theEditor.ClassName=className?className: "\x52adEC\x6f\x6et\x65\156\x74"; theEditor.ToolsWidth=toolsWidth!=null?toolsWidth:theEditor.Width; theEditor.SessionID1=sessionID1; theEditor.SessionID2=sessionID2; theEditor.ToolbarMode=toolbarMode>-1?toolbarMode:RadEditorNamespace.ToolbarModesEnum.Default; theEditor.Language=language?language: "\x65n_US"; var loc=window["local\x69zation_"+theEditor.Language]; if ("\x75ndefi\x6e\145\x64"==typeof loc)loc=window["\x6cocalizat\x69on_en_U\x53"]; if ("und\x65fined"==typeof loc)loc=[ ]; theEditor.Localization=loc; theEditor.AnchorPathToStrip=anchorPathToStrip; theEditor.ImagesPathToStrip=imagesPathToStrip; theEditor.UseEmbeddedScripts=useEmbeddedScripts; theEditor.StripAbsoluteAnchorPaths=( true ==stripAbsoluteAnchorPaths); theEditor.StripAbsoluteImagesPaths=( true ==stripAbsoluteImagesPaths); theEditor.ConvertFontToSpan=( true ==convertFontToSpan); theEditor.ConvertTagsToLower=( true ==convertTagsToLower); theEditor.AllowScripts=( true ==allowScripts); theEditor.ConvertToXhtml=( true ==convertToXhtml); theEditor.FocusOnLoad=( true ==focusOnLoad); theEditor.UseClassicDialogs=( true ==useClassicDialogs); theEditor.EnableServerSideRendering=( true ==enableServerSideRendering); theEditor.AtlasPartialRendering=( true ==atlasPartialRendering); theEditor.UseSession=useSession; theEditor.EnableContextMenus=enableContextMenus!=null?enableContextMenus: true; theEditor.EnableEnhancedEdit=enableEnhancedEdit!=null?enableEnhancedEdit: true; theEditor.EnableTab=enableTab!=null?enableTab: true; theEditor.EnableHtmlIndentation=( true ==enableHtmlIndentation); theEditor.EnableClientSerialize=( true ==enableClientSerialize); theEditor.EnableDocking=( true ==enableDocking); if (theEditor.IsOpera)theEditor.EnableDocking= false; theEditor.ShowHtmlMode=showHtmlMode!=null?showHtmlMode: true; theEditor.ShowPreviewMode=showPreviewMode!=null?showPreviewMode: true; theEditor.ShowSubmitCancelButtons=showSubmitCancelButtons!=null?showSubmitCancelButtons: true; theEditor.AllowCustomColors=allowCustomColors?allowCustomColors: false; theEditor.NewLineBr=newLineBr?newLineBr: false; theEditor.CausesValidation=causesValidation!=null?causesValidation: false; theEditor.ClearPasteFormatting=clearPasteFormatting?clearPasteFormatting:RadEditorNamespace.CLEAR_PASTE_FORMATTING_NONE; theEditor.SnippetsArray=snippetsArray; theEditor.MediaFilters=mediaFilters; theEditor.DocumentFilters=documentFilters; theEditor.ImagesFilters=imagesFilters; theEditor.TemplateFilters=templateFilters; theEditor.ThumbSuffix=thumbSuffix; theEditor.ValidationGroup=validationGroup; theEditor.DialogInternalParameters=dialogInternalParameters; if (cssFilesArray && cssFilesArray.length>0)theEditor.CssFilesArray=cssFilesArray; if (colorsArray && colorsArray.length>0)theEditor.ColorsArray=colorsArray; if (fontNamesArray && fontNamesArray.length>0)theEditor.FontNamesArray=fontNamesArray; if (fontSizesArray && fontSizesArray.length>0)theEditor.FontSizesArray=fontSizesArray; if (realFontSizesArray && realFontSizesArray.length>0)theEditor.RealFontSizesArray=realFontSizesArray; if (paragraphsArray && paragraphsArray.length>0)theEditor.ParagraphsArray=paragraphsArray; if (symbolsArray && symbolsArray.length>0)theEditor.SymbolsArray=symbolsArray; if (linksArray && linksArray.length>0)theEditor.LinksArray=linksArray; if (dialogParametersArray && dialogParametersArray.length>0)theEditor.DialogParametersArray=dialogParametersArray; theEditor.ToolsArray=toolsArray; theEditor.DefaultModulesArray=modulesArray; theEditor.Languages=languagesArray; if (cssClassesArray && cssClassesArray.length>0){var oNewArray= {} ; var oLen=cssClassesArray.length; for (var i=0; i<oLen; i++){var oKey=cssClassesArray[i][1]; var oVal=cssClassesArray[i][0]; oNewArray[oKey.replace(/(.*?)\x2e/gi, function ($1){return $1.toUpperCase( ); } )]=oVal; }theEditor.CssFiltersObject=oNewArray; }var oHidden=theEditor.FindElement("RadE\x43ontent\x48iddenTe\x78tarea"); oHidden.style.display="\x6eon\x65"; oHidden.setAttribute("id",theEditor.Id); theEditor.ContentHiddenTextarea=oHidden; var txtArea=theEditor.FindElement("\x52adE\x43\x6fnt\x65ntTextar\x65a"); theEditor.ContentTextarea=txtArea; txtArea.removeAttribute("\x72ows",0); txtArea.removeAttribute("\x63o\x6c\163",0); theEditor.ContentAreaElement=theEditor.FindElement("\x52adEC\x6f\156\x74entI\x66\162\x61me"); theEditor.WrapperElement=theEditor.FindElement("\x52a\x64\x45Wra\x70per"); theEditor.DesignButton=theEditor.FindElement("RadED\x65signBut\x74on"); theEditor.HtmlButton=theEditor.FindElement("\x52adEHtm\x6c\x42u\x74\164\x6fn"); theEditor.PreviewButton=theEditor.FindElement("\x52adE\x50\162\x65viewBu\x74ton"); theEditor.CancelButton=theEditor.FindElement("RadEC\x61ncelBu\x74ton"); theEditor.UpdateButton=theEditor.FindElement("\x52adE\x55\160\x64ateBut\x74on"); var oPar=document.getElementById(theEditor.Id+"_w\x72apper"); if (oPar){if (oPar.tagName=="\x44IV"){oPar.style.display="block"; oPar.style.height="\x61uto"; }if (oPar.tagName=="TABL\x45"){oPar.style.width=theEditor.Width; oPar.style.height=theEditor.Height; }}var oZones=theEditor.DockingZones; oZones.TopZone=theEditor.FindElement("Top"); oZones.LeftZone=theEditor.FindElement("Le\x66t"); oZones.RightZone=theEditor.FindElement("Right"); oZones.ModuleZone=theEditor.FindElement("Module"); oZones.BottomZone=theEditor.FindElement("\x42ot\x74\x6fm"); if (theEditor.IsOpera && oZones.BottomZone){oZones.BottomZone.style.width=""; }if (oZones.TopZone)oZones.TopZone.setAttribute("do\x63king","\x68orizon\x74\x61l"); if (oZones.LeftZone)oZones.LeftZone.setAttribute("dock\x69ng","vertica\x6c"); if (oZones.RightZone)oZones.RightZone.setAttribute("docking","verti\x63al"); if (oZones.BottomZone)oZones.BottomZone.setAttribute("d\x6fcking","h\x6f\162\x69zontal"); if (oZones.ModuleZone)oZones.ModuleZone.setAttribute("\144\x6fcki\x6e\147","\150\x6f\x72izo\x6etal"); var buttons=[theEditor.DesignButton,theEditor.HtmlButton,theEditor.PreviewButton]; var modes=[RadEditorNamespace.RADEDITOR_DESIGN_MODE,RadEditorNamespace.RADEDITOR_HTML_MODE,RadEditorNamespace.RADEDITOR_PREVIEW_MODE]; var modeNames=["R\x41DEDITO\x52\x5fDE\x53IGN_MOD\x45","\x52AD\x45\x44IT\x4f\122\x5fHTML_M\x4f\104\x45","RADEDI\x54\117R\x5fPREVIEW\x5f\115\x4fDE"]; var visibilityArr=[(theEditor.ShowHtmlMode || theEditor.ShowPreviewMode),theEditor.ShowHtmlMode,theEditor.ShowPreviewMode]; var attachModeButtonHandler= function (editor,button,mode,modeName,hideButton){if (button){if (hideButton)button.style.display="\x6eone"; else {button.onclick= function ( ){editor.SetMode(mode); return false; } ; button.title=editor.Localization[modeName]; var oImg=button.getElementsByTagName("IMG")[0]; if (oImg)oImg.removeAttribute("\x61lt"); editor.UtilButtons[editor.UtilButtons.length]=button; }}} ; for (var i=0; i<buttons.length; i++){attachModeButtonHandler(theEditor,buttons[i],modes[i],modeNames[i],!visibilityArr[i]); }var RadEditorRegisterButton= function (anEditor,button,buttonStr,title){if (!button)return; if ("U\x50DATE"==buttonStr)button.onclick= function (e){anEditor.Submit( ); return RadEditorNamespace.Utils.CancelEvent(e); } ; else if ("\x43AN\x43\x45L"==buttonStr)button.onclick= function (e){anEditor.CancelEdit( ); return RadEditorNamespace.Utils.CancelEvent(e); } ; if (title)button.innerHTML=title; anEditor.UtilButtons[anEditor.UtilButtons.length]=button; } ; if (theEditor.ShowSubmitCancelButtons){RadEditorRegisterButton(theEditor,theEditor.CancelButton,"C\x41NCEL",theEditor.Localization["\x43ancelBut\x74on"]); RadEditorRegisterButton(theEditor,theEditor.UpdateButton,"UPDAT\x45",theEditor.Localization["Updat\x65Button"]); }else {if (theEditor.CancelButton)theEditor.CancelButton.style.display="none"; if (theEditor.UpdateButton)theEditor.UpdateButton.style.display="\x6eone"; }if (onClientLoad)theEditor.AttachClientEvent("\x4fnClie\x6e\164\x4coad",onClientLoad); if (onClientCommandExecuting)theEditor.AttachClientEvent("\x4fnClien\x74\x43o\x6d\155\x61ndExe\x63uting",onClientCommandExecuting); if (onClientCommandExecuted)theEditor.AttachClientEvent("\x4fnClie\x6e\x74Co\x6d\155\x61ndExecu\x74ed",onClientCommandExecuted); if (onClientModeChange)theEditor.AttachClientEvent("OnCl\x69entModeC\x68ange",onClientModeChange); if (onClientSubmit)theEditor.AttachClientEvent("\117\x6eClient\x53ubmit",onClientSubmit); if (onClientCancel)theEditor.AttachClientEvent("\x4fnClie\x6e\164\x43ancel",onClientCancel); if (theEditor.IsIE && theEditor.NewLineBr){theEditor.AddShortcut("E\x6eter","\x45NTER"); theEditor.AddShortcut("ShiftEnt\x65r","S\x48\x49FT\x2b\x45NT\x45R"); theEditor.AddShortcut(RadEditorNamespace.RADCOMMAND_INSERT_PARAGRAPH,"C\x54\122\x4c+ENTER"); }else if (!theEditor.IsSafari && !window.opera && !theEditor.NewLineBr){theEditor.AddShortcut("Enter","\x45NTER"); if (!theEditor.IsIE){theEditor.AddShortcut("\x53hiftEnte\x72","\x53HIFT+EN\x54\105\x52"); }}if (theEditor.EnableTab){theEditor.AddShortcut(RadEditorNamespace.RADCOMMAND_TAB,"T\x41B"); theEditor.AddShortcut(RadEditorNamespace.RADCOMMAND_SHIFT_TAB,"SHIFT+TA\x42"); }var oShortcuts=[[RadEditorNamespace.RADCOMMAND_UNDO,"\x43TRL\x2b\x5a"],[RadEditorNamespace.RADCOMMAND_REDO,"CT\x52L+Y"],[RadEditorNamespace.RADCOMMAND_SELECT_ALL,"CTRL+A"],[RadEditorNamespace.RADCOMMAND_COPY,"\103\x54\122\x4c\053\x43"],[RadEditorNamespace.RADCOMMAND_PASTE,"CTRL\x2bV"],[RadEditorNamespace.RADCOMMAND_CUT,"CTRL+X"],[RadEditorNamespace.RADCOMMAND_BOLD,"\x43TRL+B"],[RadEditorNamespace.RADCOMMAND_ITALIC,"\103\x54\122L\x2bI"],[RadEditorNamespace.RADCOMMAND_UNDERLINE,"CTRL\x2bU"],[RadEditorNamespace.RADCOMMAND_COPY,"\x43TRL+\x49\116\x53"],[RadEditorNamespace.RADCOMMAND_PASTE,"S\x48IFT+INS"],[RadEditorNamespace.RADCOMMAND_TOGGLE_SCREEN_MODE,"\x46\x311"],[RadEditorNamespace.RADCOMMAND_SHOW_LINK_DIALOG,"\x43TRL+K"],[RadEditorNamespace.RADCOMMAND_SHOW_IMAGE_DIALOG,"\x43TRL+G"]]; for (var i=0; i<oShortcuts.length; i++){theEditor.AddShortcut(oShortcuts[i][0],oShortcuts[i][1]); }RadEditorNamespace.RegisterInGlobalArray(theEditor); var registeredCallbackEventsType=RadEditorNamespace.GetRegisteredCallbackEventsType( ); if (registeredCallbackEventsType>0){RadEditorNamespace.AttachCallbackEventHandlers(theEditor); }else {var tempEditor=theEditor; RadEditorNamespace.Utils.AttachEventEx(window,"l\x6fad", function ( ){RadEditorNamespace.AttachCallbackEventHandlers(tempEditor); } ); }if (theEditor.EnableContextMenus){theEditor.ContextMenuArray=contextMenusArray; theEditor.ContextMenu=RadEditorNamespace.RadEditorContextMenu.New(theEditor,theEditor.ContextMenuArray); }var popup=window["R\x61dEditorP\x6fpupInst\x61\156\x63e"]; popup.AddStyleSheet(theEditor.SkinBasePath+"Contro\x6cs.css"); try {popup.ShowDropdown(0,0,theEditor.CancelButton, false , false); }catch (e){} ; if (!theEditor.IsIE)popup.Hide( ); if (theEditor.ConvertFontToSpan)theEditor.FiltersManager.Add(new RadFont2SpanFilter( )); if (theEditor.StripAbsoluteAnchorPaths)theEditor.FiltersManager.Add(new RadStripPathFilter("A",theEditor.AnchorPathToStrip)); if (theEditor.StripAbsoluteImagesPaths)theEditor.FiltersManager.Add(new RadStripPathFilter("\x49MG",theEditor.ImagesPathToStrip)); if (theEditor.AllowScripts!= true)theEditor.FiltersManager.Add(new RadStripScriptsFilter( )); if (theEditor.IsSafari){theEditor.FiltersManager.Add(new RadSafariStripFilter( )); }if (!theEditor.IsIE && !theEditor.IsOpera){theEditor.FiltersManager.Add(new RadEditorNamespace.RadMozillaContentFilter( )); theEditor.FiltersManager.AddAt(new RadEditorNamespace.RadEditorMozillaFlashStart(theEditor),0); }if ("funct\x69on"==typeof theEditor.addFilters){theEditor.addFilters( ); }RadEditorNamespace.RunPageLoadCode(theEditor); if (oPar)oPar.style.visibility="\x76isib\x6c\145"; theEditor.private_EncodeHiddenAreaContent( false); var oInitContent=theEditor.GetHiddenTextareaValue( ); theEditor.private_SetPageHtml(oInitContent, true , function ( ){theEditor.SetEditable( true); window.setTimeout( function ( ){if (theEditor.FocusOnLoad){theEditor.SetFocus( ); }else if (theEditor.IsIE){RadEditorNamespace.InitSetEditableIE(theEditor); }} ,0); theEditor.ExecuteClientEvent("OnCl\x69entLoad"); } ); }catch (ex){Ektron.OnException(Ektron.ContentDesigner,null,ex,arguments); theEditor=null; }return theEditor; }RadEditorNamespace.ConfigureMozillaEditMode= function (editor){if (!editor.IsIE){try {editor.Document.execCommand('\x55seCSS', false , true); }catch (ex){} ; }};RadEditorNamespace.StoreBrowserPosition= function ( ){var oBody=document.body; var oDoc=document.documentElement; RadEditorNamespace.BrowserTop=oBody.scrollTop>oDoc.scrollTop?oBody.scrollTop:oDoc.scrollTop; RadEditorNamespace.BrowserLeft=oBody.scrollLeft>oDoc.scrollLeft?oBody.scrollTop:oDoc.scrollLeft; } ; RadEditorNamespace.RestoreBrowserPosition= function ( ){try {var oBody=document.body; var oDoc=document.documentElement; var top=RadEditorNamespace.BrowserTop; var left=RadEditorNamespace.BrowserLeft; oBody.scrollTop=top; oBody.scrollLeft=left; oDoc.scrollTop=top; oDoc.scrollLeft=left; }catch (ex){} ; } ; RadEditorNamespace.InitSetEditableIE= function (editor){if (editor.IsOpera)return; var r; if (editor && editor.ContentArea){r=editor.ContentArea.createTextRange( ); }try {RadEditorNamespace.StoreBrowserPosition( ); var range=document.body.createTextRange( ); range.moveStart('\x74e\x78\164\x65dit',range.text.length); range.collapse( true); range.select( ); RadEditorNamespace.RestoreBrowserPosition( ); }catch (e){}} ; RadEditorNamespace.GetRegisteredCallbackEventsType= function ( ){if (typeof(RadCallbackNamespace)!="\x75n\x64\145f\x69ned" && RadCallbackNamespace.attachEvent){return 1; }else if (window["\x4fnCallb\x61\143\x6bRequest\x53tart"]){return 2; }return 0; } ; RadEditorNamespace.AttachCallbackEventHandlers= function (oEditor){var registeredCallbackEventsType=RadEditorNamespace.GetRegisteredCallbackEventsType( );if (registeredCallbackEventsType==0){return; }var callbackRequestStartEventHandler= function ( ){try {oEditor.FireEvent(RadEditorNamespace.RADEVENT_CALLBACK_STARTED); }catch (e){}try {RadEditorNamespace.SaveEditorValue(oEditor); }catch (ex){}} ; var callbackResponseEndEventHandler= function ( ){oEditor.ValueSaved= false; RadEditorNamespace.ValidationSucceeded= true; } ; if (registeredCallbackEventsType==1){RadCallbackNamespace.attachEvent("onrequ\x65ststart",callbackRequestStartEventHandler); RadCallbackNamespace.attachEvent("\x6fnre\x73\x70on\x73\145\x65nd",callbackResponseEndEventHandler); }else if (registeredCallbackEventsType==2){var originalOnCallbackRequestStartFunction=window.OnCallbackRequestStart; var originalOnCallbackResponseEndFunction=window.OnCallbackResponseEnd; window.OnCallbackRequestStart= function ( ){originalOnCallbackRequestStartFunction( ); callbackRequestStartEventHandler( ); };window.OnCallbackResponseEnd= function ( ){originalOnCallbackResponseEndFunction( ); callbackResponseEndEventHandler( ); };}} ; RadEditorNamespace.GetEditorPositionInGlobalArray= function (editorId){if ("\165\x6edefined"==typeof(RadEditorGlobalArray)){window.RadEditorGlobalArray=[ ]; }for (var i=0; i<RadEditorGlobalArray.length; i++){if (RadEditorGlobalArray[i].Id==theEditor.Id){return i; }}return -1; } ; RadEditorNamespace.RegisterInGlobalArray= function (theEditor){if (0==RadEditorGlobalArray.length){RadEditorNamespace.Utils.AttachEventEx(window,"unloa\x64", function ( ){RadEditorNamespace.DisposeAllEditors( ); } ); }var editorInArray=RadEditorNamespace.GetEditorPositionInGlobalArray(theEditor.Id); RadEditorNamespace.ValidationSucceeded= true; if (editorInArray==-1){theEditor.PostBackRegisterEditor(theEditor); RadEditorGlobalArray[RadEditorGlobalArray.length]=theEditor; }else {var oldEditor=RadEditorGlobalArray[editorInArray]; if (oldEditor && oldEditor.Dispose)oldEditor.Dispose( ); RadEditorGlobalArray[editorInArray]=theEditor; }} ; RadEditorNamespace.ReplaceAspNetSubmit= function (oID,form){try {RadEditorNamespace.ReplaceFormSubmit(oID,form); RadEditorNamespace.ReplaceDoPostBack(oID); }catch (exc){}} ; RadEditorNamespace.DoesAnyEditorCauseValidation= function ( ){var editors=RadEditorGlobalArray; for (var i=0; i<editors.length; i++){if (editors[i].CausesValidation){return true; }}return false; } ; RadEditorNamespace.ResetEditorSaveStatus= function ( ){var editors=RadEditorGlobalArray; for (var i=0; i<editors.length; i++){editors[i].ValueSaved= false; }} ; RadEditorNamespace.SaveAllEditors= function (checkValidation){var isValid= true; if (checkValidation && RadEditorNamespace.DoesAnyEditorCauseValidation( ) && (typeof(Page_ClientValidate)=="\x66unc\x74\151\x6fn")){isValid=Page_ClientValidate( ); }if (isValid){var editors=RadEditorGlobalArray; for (var i=0; i<editors.length; i++){RadEditorNamespace.SaveEditorValue(editors[i]); }window.setTimeout( function ( ){RadEditorNamespace.ResetEditorSaveStatus( ); } ,100); }return isValid; } ; RadEditorNamespace.PrepareEditorsForValidation= function ( ){var editors=RadEditorGlobalArray; for (var i=0; i<editors.length; i++){var editor=editors[i]; if (editor.IsIE && !editor.HasContent( )){editor.SetHiddenTextareaValue(""); }else {editor.SetHiddenTextareaValue(editor.GetHtml( true)); editor.ValueSaved= false; }}} ; RadEditorNamespace.ReplaceDoPostBack= function (oID){var radEditorDoPostBack=__doPostBack; __doPostBack= function (eventTarget,eventArgument){var isValid=RadEditorNamespace.SaveAllEditors( ); if (isValid){radEditorDoPostBack(eventTarget,eventArgument); }} ; } ; RadEditorNamespace.ReplaceFormSubmit= function (oID,form){var radEditorFormSubmit=form.submit; form.submit= function ( ){try {RadEditorNamespace.SaveAllEditors( ); var tempSubmit=this.submit; this.submit=radEditorFormSubmit; var submitResult=this.submit( ); this.submit=tempSubmit; }catch (exc){}} ; form=null; } ; RadEditorNamespace.ReplaceFormOnSubmit= function (form){try {var onSubmit=form.onsubmit; form.onsubmit= function ( ){RadEditorNamespace.SaveAllEditors( ); if (typeof(onSubmit)=="f\x75nction")return onSubmit( ); return true; } ; if ("\165\x6edefined"!=typeof(Sys) && Sys.WebForms && Sys.WebForms.PageRequestManager){var A=Sys.WebForms.PageRequestManager._instance; if (A && A._onSubmitStatements && A._onSubmitStatements.push){A._onSubmitStatements.push(RadEditorNamespace.SaveAllEditors); }}}catch (ex){Ektron.OnException(Ektron.ContentDesigner,null,ex,arguments); } finally {form=null; }} ; RadEditorNamespace.ReplacePage_ClientValidate= function ( ){if (typeof(Page_ClientValidate)=="\x66unctio\x6e"){var radEditorClientValidate=Page_ClientValidate; Page_ClientValidate= function (validationGroup){RadEditorNamespace.PrepareEditorsForValidation( ); RadEditorNamespace.ValidationSucceeded=radEditorClientValidate(validationGroup); return RadEditorNamespace.ValidationSucceeded; } ; }} ; RadEditorNamespace.SaveEditorValue= function (editor){if (RadEditorNamespace.ValidationSucceeded){}else {return; }if (editor.ValueSaved)return; editor.private_EncodeHiddenAreaContent( true); editor.ValueSaved= true; } ; RadEditorNamespace.SetElementInnerHTML= function (elem,content){elem.innerHTML="\074\x73pa\x6e\076\x26nbsp;\074/spa\x6e>"+content; elem.removeChild(elem.firstChild); };RadEditorNamespace.RunPageLoadCode= function (editor){try {if (editor.InitDocking)editor.InitDocking( ); editor.LoadToolbars( ); if (editor.LoadModules)editor.LoadModules(editor); editor.SetSize(editor.Width,editor.Height); RadEditorNamespace.Utils.AttachEventEx(window,"\x6fnloa\x64", function ( ){window.setTimeout( function ( ){if (editor.IsIE)editor.SetSize(editor.Width,editor.Height); } ,70); editor.Serialize( false); editor.FireEvent(RadEditorNamespace.RADEVENT_SIZE_CHANGED); if (editor.IsIE || editor.IsToolbarModeEnabled(RadEditorNamespace.ToolbarModesEnum.Default)){editor.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED); }} ); }catch (ex){Ektron.OnException(Ektron.ContentDesigner,null,ex,arguments); }} ; RadEditorNamespace.DisposeAllEditors= function ( ){var editors=RadEditorGlobalArray; for (var counter=0; counter<editors.length; counter++){try {var editor=editors[counter]; editor.Dispose( ); }catch (e){} ; }if (RadEditorNamespace.Docking && RadEditorNamespace.Docking.DisposeDockingObjects)RadEditorNamespace.Docking.DisposeDockingObjects( ); } ; RadEditorNamespace.ShowEditorStatusBar= function (editorID){var span=document.getElementById("r\x61dEditor\x4coading"+editorID); if (span)span.style.display="\x62lock"; } ; RadEditorNamespace.HideEditorStatusBar= function (editorID){var span=document.getElementById("ra\x64\105\x64itorLo\x61\144\x69ng"+editorID); if (span)span.style.display="none"; } ; RadEditorNamespace.GetIndentedElementContent= function (elem,indent,indentStep,oBuilder){if (!elem)return; var nodeType=elem.nodeType; if (1==nodeType){if (elem.uniqueID && this.UniqueIds){if (this.UniqueIds[elem.uniqueID])return; else this.UniqueIds[elem.uniqueID]= true; }var tagName=elem.tagName.toUpperCase( ); if (elem.tagName.charAt(0)=='/'){return; }oBuilder.Append("\012"+indent+"\x3c"+(elem.scopeName && elem.scopeName.toLowerCase( )!="\x68tml"?elem.scopeName+":": "")+tagName.toLowerCase( )); var oAttribs=elem.attributes; var oAttrLen=oAttribs.length; if ("IMG"==tagName && elem.mergeAttributes){var oSpan=document.createElement("IMG"); oSpan.mergeAttributes(elem); if (oSpan.width)oBuilder.Append('\x20widt\x68\x3d\x22'+oSpan.width+'\x22'); if (oSpan.height)oBuilder.Append('\x20he\x69\x67ht\x3d\042'+oSpan.height+'\x22'); }for (var i=0; i<oAttrLen; i++){var oAttrib=oAttribs[i]; var attribName=oAttrib.nodeName.toUpperCase( ); var attribValue=oAttrib.nodeValue; if ((attribValue && oAttrib.specified) || ("IMG"==tagName && "\x41LT"==attribName && attribValue) || ("INPUT"==tagName && "VAL\x55E"==attribName && attribValue) || ("\x41REA"==tagName && "SHAPE"==attribName && attribValue) || ("\x41REA"==tagName && "\x43OORD\x53"==attribName && attribValue)){if ("AREA"==tagName && "\x48REF"==attribName && attribValue && attribValue.length>0){var strSboutBlank="\x61bout:bl\x61\x6ek"; if (0==attribValue.indexOf(strSboutBlank) && attribValue.length>strSboutBlank.length){attribValue=attribValue.substr(strSboutBlank.length); }}oBuilder.Append(" "+oAttrib.nodeName+'\x3d\042'+attribValue+'\x22'); }}if (document.all){var css=elem.style.cssText; if (css){oBuilder.Append('\x20style\x3d\x22'+css+'\042'); }}if (elem.canHaveChildren || elem.hasChildNodes( )){oBuilder.Append(">"); var childNodesLength=elem.childNodes.length; var runChildren= true; if (!document.all && "TD"==tagName){runChildren= false; for (var i=0; i<childNodesLength; i++){if (1==elem.childNodes[i].nodeType && "\x42R"==elem.childNodes[i].tagName){continue; }else if (3==elem.childNodes[i].nodeType && (!elem.childNodes[0].nodeValue || 0==RadEditorNamespace.Utils.Trim(elem.childNodes[0].nodeValue).length)){continue; }else {runChildren= true; break; }}}var counter=0; if (runChildren){for (counter=0; counter<childNodesLength; counter++){RadEditorNamespace.GetIndentedElementContent(elem.childNodes[counter],indent+indentStep,indentStep,oBuilder); }}oBuilder.Append((counter>0?"\012"+indent: "")+"\074\x2f"+tagName.toLowerCase( )+"\x3e"); }else if (!document.all && !elem.hasChildNodes( ) && "\x64iv"==tagName.toLowerCase( )){oBuilder.Append(">\074/div>"); }else if (tagName=="\x53\103\x52\x49P\x54")oBuilder.Append("\x3e"+elem.text+"\074\x2fscri\x70t>"); else if (tagName=="TI\x54LE" || tagName=="S\x54\131\x4c\x45" || tagName=="\x43OMMENT" || tagName=="IFRAME")oBuilder.Append(">"+elem.innerHTML+"\x3c/"+tagName.toLowerCase( )+">"); else oBuilder.Append("\x2f>"); }else if (3==nodeType){var str=elem.data.replace(/[\x0a\x0d]/gi,"").replace(/\x3c/gi,"\x26lt\x3b").replace(/\x3e/gi,"\x26gt;"); if (!document.all){var trimmed=RadEditorNamespace.Utils.Trim(str); if (trimmed.length==0)return oBuilder; }oBuilder.Append("\x0a"+indent+str); }else if (8==nodeType){oBuilder.Append("\012"+indent+elem.innerHTML); }return oBuilder; } ; function RadEditor(id){ this.ParagraphsArray=[["\x4eormal","\074p>"],["\x3ch1>Hea\x64\151\x6eg 1\074\x2fh\x31>","\x3ch1>"],["\074\x682>H\x65\141\x64\151\x6e\147\x20\062\x3c/h2>","\074\x682>"],["\x3ch3>He\x61\x64i\x6e\x67 3\x3c/h3>","\x3ch3>"],["\x3ch4>He\x61\144\x69ng 4\074\x2fh4>","\x3ch4\x3e"],["\x3ch5\x3e\110e\x61ding 5\074/h5>","\x3c\x685>"],["\x3cpr\x65\076\x46ormatted\x3c/pre>","\x3cpre>"],["\x3caddre\x73\163\x3e\101d\x64ress\074\057\x61ddress\x3e","\x3caddres\x73\076"]]; this.Id=id; this.SubmitFnStr=""; this.Mode=RadEditorNamespace.RADEDITOR_DESIGN_MODE; this.IsIE=document.all && !window.opera? true : false; this.IsIE9=(this.IsIE && parseInt($ektron.browser.version,10)>=9); this.IsIE7=( true ==(this.IsIE && null!=window.XMLHttpRequest)); this.IsSafari=TelerikNamespace.Utils.DetectBrowser("\x73afari"); this.IsOpera=window.opera? true : false; this.IsMozilla=$ektron.browser.mozilla; this.IsFirefox4=(this.IsMozilla && parseInt($ektron.browser.version,10)>=2); this.ToolbarMode=RadEditorNamespace.ToolbarModesEnum.Default; this.UseClassicDialogs= false; this.IsUndoEnabled= true; this.CausesValidation= false; this.EnableContextMenus= true; this.EnableTab= true; this.ShowHtmlMode= true; this.ShowPreviewMode= true; this.ShowSubmitCancelButtons= true; this.OnClientLoad=null; this.OnClientCommandExecuting=null; this.OnClientCommandExecuted=null; this.OnClientModeChange=null; this.OnClientSubmit=null; this.OnClientCancel=null; this.Document=null; this.ContentWindow=null; this.ContentArea=null; this.ContentAreaElement=null; this.ContentTextarea=null; this.ContentHiddenTextarea=null; this.WrapperElement=null; this.UpdateButton=null; this.CancelButton=null; this.DesignButton=null; this.HtmlButton=null; this.PreviewButton=null; this.IndentHtmlWrapper=null; this.IndentHtmlElement=null; this.Width=null; this.Height=null; this.ClassName=""; this.LastClassName=""; this.ApplicationPath=""; this.RadControlsDir=""; this.SkinBasePath=""; this.Overflow=""; this.ThumbSuffix=""; this.Direction=""; this.AnchorPathToStrip=""; this.ImagesPathToStrip=""; this.ConvertTagsToLower= false; this.MediaFilters=null; this.DocumentFilters=null; this.ImagesFilters=null; this.TemplateFilters=null; this.CssFilesArray=[ ]; this.CssFiltersObject=null; this.LinksArray=[ ]; this.DialogParametersArray=[ ]; this.DockingZones= {} ; this.DefaultModulesArray=[ ]; this.Modules=[ ]; this.Events=[ ]; this.Tools=[ ]; this.ToolsArray=[ ]; this.Toolbars=[ ]; this.Filters=[ ]; this.PageLoadHandlersArray=[ ]; this.ContentAreaEventHandlers=[ ]; this.UtilButtons=[ ]; this.Localization=null; this.ContextMenu=null; this.CommandsManager=RadEditorNamespace.RadCommandsManager.New(this ); this.KeyboardManager=RadEditorNamespace.RadKeyboardManager.New( ); this.FiltersManager=RadEditorNamespace.RadEditorFiltersManager.New( ); this.Disposed= false; this.LastDialogOwner=null; }
; RadEditor.prototype= {LoadToolbars:function ( ){var editor=this ; if (editor.IsToolbarModeEnabled(RadEditorNamespace.ToolbarModesEnum.Floating)){editor.FloatingToolbarManager=RadEditorNamespace.FloatingToolbarMode.New(editor); }else if (editor.IsToolbarModeEnabled(RadEditorNamespace.ToolbarModesEnum.PageTop)){RadEditorNamespace.PageTopToolbarMode.New(editor); }else if (editor.IsToolbarModeEnabled(RadEditorNamespace.ToolbarModesEnum.ShowOnFocus)){RadEditorNamespace.ShowOnFocusToolbarMode.New(editor); }else {var funcOnLoad= function ( ){if (!editor.IsIE){}var modeChangedHandlerPtr= function ( ){editor.SetToolbarsVisible( true); } ; editor.AttachEventHandler(RadEditorNamespace.RADEVENT_MODE_CHANGED,modeChangedHandlerPtr); var oToolbarZone=editor.DockingZones.TopZone; editor.SetToolbarsVisible( false); var oToolbars=editor.GetToolbars( ); editor.SetToolbarHolderWidth(oToolbarZone); for (var i=0; i<oToolbars.length; i++){var toolbar=oToolbars[i]; var oZone=editor.GetDockingZoneById(toolbar.ZoneId); if (!oZone)oZone=editor.DockingZones.TopZone; toolbar.IsVertical=editor.IsZoneVertical(oZone); var oToolbarTable=toolbar.GetTopElement( ); oZone.appendChild(oToolbarTable); if (toolbar.IsDockable){editor.MakeDockable(oToolbarTable,useDragHelper= true ,useOverlay= true ,resizable= false); }}if (editor.IsIE){setTimeout( function ( ){var topZone=editor.DockingZones.TopZone; topWidth=topZone.offsetWidth; if (topWidth==0){topZone.style.width="1\x300px"; var oInterval=window.setInterval( function ( ){if (topZone.offsetWidth>0){window.clearInterval(oInterval); editor.WrapperElement.onresize( ); }} ,100); var toggleResize= false; editor.WrapperElement.onresize= function ( ){toggleResize=!toggleResize; if (toggleResize){topZone.style.width=topZone.offsetWidth+"\x70x"; }} ; }if (!editor.EnableDocking){var cancelInterval=0; var lastResizedValue=0; var resizedValue=0; RadEditorNamespace.Utils.AttachEventEx(window,"onresi\x7ae", function (e){var td=topZone; td.style.height=td.offsetHeight; editor.SetToolbarsVisible( false); resizedValue++; if (!cancelInterval){if (!editor || editor.Disposed)return; cancelInterval=window.setInterval( function ( ){try {if (resizedValue>lastResizedValue){lastResizedValue=resizedValue+1; return; }window.clearInterval(cancelInterval); cancelInterval=0; var tempWidth=editor.GetWidth( ); if (tempWidth>1){var tempWidth2=tempWidth-20; if (tempWidth2>=0)td.style.width=tempWidth2+"\x70x"; }td.style.height=""; }catch (ex){ ; }} ,3); }} ); }} ,3000); }editor.SetToolbarsVisible( true); } ; funcOnLoad( ); }} ,FindElement:function (oName){return document.getElementById(oName+this.Id); } ,PostBackRegisterEditor:function (editor){try {var oID=editor.Id; var form=document.getElementById(editor.FormID); if (!form)form=document.forms[0]; if (RadEditorGlobalArray.length==0){RadEditorNamespace.ReplacePage_ClientValidate( ); RadEditorNamespace.ReplaceFormOnSubmit(form); RadEditorNamespace.ReplaceAspNetSubmit(oID,form); }RadEditorNamespace.Utils.AttachEventEx(form,"\x6fnsu\x62\x6dit", function ( ){var editor=GetRadEditor(oID); RadEditorNamespace.SaveEditorValue(editor); } ); }catch (ex){Ektron.OnException(this,Ektron.ContentDesigner.onexception,ex,arguments); } finally {form=null; }} ,IsToolbarModeEnabled:function (oFlavor){return oFlavor&this.ToolbarMode? true : false; } ,SetToolbarHolderWidth:function (oElem){if (this.ToolsWidth)oElem.style.width=this.ToolsWidth; else {var oWidth=this.Width; if (oWidth.indexOf("\x25")!=-1){oElem.style.width=this.Width; }else if (oWidth>=10){oElem.style.width=parseInt(oWidth,10)-10; }else {oElem.style.width=this.Width; }}} ,SetContentAreaHtml:function (newContent){ this.contentCache=null; try {RadEditorNamespace.SetElementInnerHTML(this.ContentArea,newContent); }catch (e){ ; }} ,GetPageHtml:function ( ){if (!theEditor.IsIE && !theEditor.IsOpera){var filter=new RadEditorNamespace.RadEditorMozillaFlashEnd(this ); filter.MaintainPathsPartTwo(this.ContentArea); }if (this.FullPage && this.Mode!=RadEditorNamespace.RADEDITOR_HTML_MODE){var oDocument=this.Document; var oLinks=oDocument.getElementsByTagName("L\x49NK"); var oRemove=[ ]; for (var i=0; i<oLinks.length; i++){var oLink=oLinks[i]; if (oLink.href){if (oLink.href.indexOf('E\x64itorCont\x65ntArea.\x63ss')>0){oRemove[oRemove.length]=oLink; }else if (this.CssFilesArray && this.CssFilesArray.length>0){var arr=this.CssFilesArray; for (var counter=0; counter<arr.length; counter++){if (oLink.href.indexOf(arr[counter])>=0)oRemove[oRemove.length]=oLink; }}}}for (var i=0; i<oRemove.length; i++)oRemove[i].parentNode.removeChild(oRemove[i]); var oBody=oDocument.getElementsByTagName("\x42ODY")[0]; if (oBody){oBody.removeAttribute("con\x74entEdit\x61ble"); var className=oBody.className.toLowerCase( ); if ("\x72adecon\x74\145\x6etborde\x72ed"==className || "rad\x65\143\x6f\x6et\x65\156t"==className){oBody.removeAttribute("\x63lass",0); oBody.removeAttribute("\x63lassname",0); }}var oHtml=oDocument.getElementsByTagName("\x48TML")[0]; var outerHtml=(this.DoctypeString?this.DoctypeString: "")+(oHtml.outerHTML?oHtml.outerHTML:RadEditorNamespace.Utils.GetOuterHtml(oHtml)); return outerHtml; }else {return this.GetHtml( true); }} ,ColorsArray: ["","\x23fff\x66\060\x30","#0\x30ff00","#\x61dd8e6","#0\x30\070\x3000","#80808\x30","#ffd7\x30\060","#\x66\x66e4\x65\x31","#00fff\x66","#87ceeb","#\x30000ff","\043\x619a9a9","#ffa5\x30\060","#\x66\x66c0\x63\x62","#a52a2a","\x23008080","\x23000080","\x23\x630c\x30\x630","\x23ff0\x30\060\x30","\x23c715\x38\065","#8b0000","\x23\064\x62\060\x3082","\x2300\x30000","\x23\146\x66\x66ff\x66"],FontNamesArray: ["\124\x69mes New\x20Roman","\x4dS San\x73\x20S\x65\162\x69\x66","\x54\141\x68\x6fma","\126\x65\x72da\x6ea","\x41ria\x6c","Courie\x72 New"],FontSizesArray: [1,2,3,4,5,6,7],RealFontSizesArray: ["8\x70t","9p\x74","\x310pt","\x311pt","\x312pt","14pt","\x316pt","\061\x38pt","\x320p\x74","22p\x74","24pt","2\x36\160t","\x328pt","\x336pt","\064\x38pt","\x37\062\x70t"],AttachClientEvent:function (eventName,eventHandler){if (!eventHandler)return; else this[eventName]=eventHandler; } ,ExecuteClientEvent:function (eventName){try {var functionPtr=this[eventName]; if (!functionPtr)return; if (typeof(functionPtr)=="\x73tr\x69\x6eg"){functionPtr=eval(functionPtr); this[eventName]=functionPtr; }var argLength=arguments.length; if (argLength<2){return functionPtr(this ); }else {var argsArray=arguments; return functionPtr(this,argsArray[1],argsArray[2],argsArray[3]); }}catch (e){alert("\x45xception\x20while e\x78ecutin\x67 clien\x74 event\x20"+eventName+" Error:"+e.message); } ; return true; } ,HasContent:function ( ){var hasContent= true; try {var content=this.GetText( ); content=RadEditorNamespace.Utils.Trim(content); if (!content){hasContent= false; var oDiv=document.createElement("D\x49V"); oDiv.innerHTML=this.GetHtml( ); var oElems=oDiv.childNodes; for (var elemCount=0; elemCount<oElems.length; elemCount++){var oElem=oElems[elemCount]; if (oElem && oElem.nodeType==1){hasContent= true; break; }}}else hasContent= true; }catch (e){}return hasContent; } ,SubmitPage:function ( ){var isValid=(this.CausesValidation && (typeof(Page_ClientValidate)=="\x66unction"))?Page_ClientValidate(this.ValidationGroup): true; if (isValid && this.SubmitFnStr){eval(this.SubmitFnStr); }} ,Dispose:function ( ){var editor=this ; if ( true ==editor.Disposed)return; editor.Disposed= true; editor.Serialize( true); if (editor.WrapperElement)editor.WrapperElement.onresize=null; try {var tools=editor.Tools; for (var i=0; i<tools.length; i++){if (tools[i].Dispose)tools[i].Dispose( ); tools[i]=null; }}catch (e){} ; try {if (editor.ContextMenu)editor.ContextMenu.Dispose( ); }catch (e){} ; try {var toolbars=editor.Toolbars; for (var i=0; i<toolbars.length; i++){if (toolbars[i].Dispose)toolbars[i].Dispose( ); }}catch (e){} ; try {var modules=editor.Modules; for (var i=0; i<modules.length; i++){if (modules[i].Dispose)modules[i].Dispose( ); }}catch (e){} ; var utilButtonsArray=editor.UtilButtons; for (var i=0; i<utilButtonsArray.length; i++){utilButtonsArray[i].onclick=null; utilButtonsArray[i]=null; }try {editor.FireEvent(RadEditorNamespace.RADEVENT_DISPOSE); }catch (e){} ; editor.DetachBrowserEvents( ); for (var prop in editor){if (typeof(editor[prop])!="\x66unct\x69\x6fn")editor[prop]=null; }} ,Serialize:function (isStoring){if (this.private_Serialize)this.private_Serialize(isStoring); } ,MakeDockable:function (oElem,useDragHelper,useOverlay,resizable){if (!this.EnableDocking)return; RadEditorNamespace.Docking.MakeDockable(oElem,useDragHelper,useOverlay,resizable); } ,GetDockingZoneById:function (zoneId){if (zoneId){var oZones=this.DockingZones; switch (zoneId.toLowerCase( )){case "\x74op":return oZones.TopZone; case "left":return oZones.LeftZone; case "\x72ight":return oZones.RightZone; case "b\x6fttom":return oZones.BottomZone; case "mod\x75le":return oZones.ModuleZone; default:return document.getElementById(zoneId); }}} ,IsZoneVertical:function (zone){if (!zone)return null; var docking=zone.getAttribute("dock\x69ng"); if (docking && "\x76ertical"==docking){return true; }} ,ToggleEnhancedEdit:function ( ){if (this.EnableEnhancedEdit){ this.SetClassName(this.ClassName); this.EnableEnhancedEdit= false; }else { this.SetClassName("\x52adE\x43\x6fnt\x65ntBorder\x65d"); this.EnableEnhancedEdit= true; }var oTool=this.GetToolByName(RadEditorNamespace.RADCOMMAND_TOGGLE_TABLE_BORDER); if (oTool && oTool.SetState)oTool.SetState(this.EnableEnhancedEdit?RadEditorNamespace.RADCOMMAND_STATE_ON:RadEditorNamespace.RADCOMMAND_STATE_OFF); } ,SetClassName:function (className){ this.ContentArea.className=className; this.LastClassName=className; } ,GetLocalizedString:function (initStr,defaultStr){var str=this.Localization[initStr]; if (typeof str!="\x73tri\x6e\147"){Ektron.ContentDesigner.trace("Una\x62le to lo\x63ate str\x69\156\x67 \047"+initStr+"\047\x20in Ge\x74Localiz\x65\144\x53tring f\x75nction\x2e"); return defaultStr; }else return str; } ,GetImageUrl:function (fileName){return (this.SkinBasePath+"\x42uttons/"+fileName); } ,EnableEditing:function (enable,optionalIgnoredTools,optionalEnableTools,optionalEnableTyping,optionalEnableContext,optionalEnableTab,optionalEnableModules,optionalEnableModes){ this.EnableTools(!(!enable || false ==optionalEnableTools),optionalIgnoredTools); if (this.SetModulesVisible)this.SetModulesVisible(!(!enable || false ==optionalEnableModules)); this.DisableModeSwitching=(!enable || false ==optionalEnableModes); if (!enable || false ==optionalEnableTyping){ this.DisableTypingHandler= function (e){return RadEditorNamespace.Utils.CancelEvent(e); };this.AttachEventHandler("o\x6ekeypress",this.DisableTypingHandler); }else if (this.DisableTypingHandler)this.DetachEventHandler("on\x6beypress",this.DisableTypingHandler); if (!enable || false ==optionalEnableTab){ this.EnableTab_temp=this.EnableTab; this.EnableTab= false; }else {if (null!=this.EnableTab_temp){ this.EnableTab=this.EnableTab_temp; this.EnableTab_temp=null; }}if (!enable || false ==optionalEnableContext){ this.U=this.EnableContextMenus; this.EnableContextMenus= false; }else {if (null!=this.U){ this.EnableContextMenus=this.U; this.U=null; }} this.EditingEnabled=enable; if (enable){ this.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED); }} ,IsEditingEnabled:function ( ){return ( false !=this.EditingEnabled); } ,EnableTools:function (enable,optionalIgnoredTools){ this.ToolsEnabled=enable; var state=enable?RadEditorNamespace.RADCOMMAND_STATE_OFF:RadEditorNamespace.RADCOMMAND_STATE_DISABLED; var toolsArray=this.Tools; for (var i=0; i<toolsArray.length; i++){var oTool=toolsArray[i]; if (oTool.SetState){if (!optionalIgnoredTools || (optionalIgnoredTools && null==optionalIgnoredTools[oTool.Name])){oTool.SetState(state, true); }}}} ,IsVisible:function ( ){return (this.WrapperElement.style.display!="n\x6fne"); } ,Submit:function ( ){if ( false ==this.ExecuteClientEvent("\x4fn\x43\x6cie\x6etSubmit"))return; this.SubmitPage( ); } ,CancelEdit:function ( ){if ( false ==this.ExecuteClientEvent("\x4fnClient\x43\141\x6ecel"))return; this.private_EncodeHiddenAreaContent( true); if (!this.CancelFnStr)this.CancelFnStr="\x68ist\x6f\x72y.\x62ack()"; eval(this.CancelFnStr); } ,SetFocus:function ( ){try {if (this.Mode==RadEditorNamespace.RADEDITOR_DESIGN_MODE){ this.ContentWindow.focus( ); }else if (this.Mode==RadEditorNamespace.RADEDITOR_HTML_MODE)this.ContentTextarea.focus( ); }catch (e){} ; } ,SetActive:function ( ){if (this.IsIE && !this.IsIE9){var curArea=this.ContentAreaElement; if (curArea && curArea.setActive)curArea.setActive( ); }} ,ResetSize:function ( ){var oEditor=this ; var oHeight=oEditor.GetHeight( ); if (oHeight>0){oEditor.SetSize(oEditor.GetWidth( ),oEditor.GetHeight( )+1, false); oEditor.SetSize(oEditor.GetWidth( ),oEditor.GetHeight( )-1, false); }} ,SetSize:function (width,height,bFireEvent){width=(""+width); height=(""+height); if (-1==width.indexOf("\x25")){width=parseInt(width); if (isNaN(width)){width=300; }width=width+"px"; }var isPercent= false; if (-1==height.indexOf("%")){height=parseInt(height); if (isNaN(height)){height=300; }height=height+"\x70x"; }else isPercent= true; var oWrapper=this.WrapperElement; if ( false !=bFireEvent){ this.ProposedWidth=width; this.FireEvent(RadEditorNamespace.RADEVENT_SIZE_CHANGED); this.ProposedWidth=null; }oWrapper.style.width=width; oWrapper.style.height=height; if (!isPercent)this.FixIeHeight(oWrapper,height); } ,FixIeHeight:function (oElem,height){if (this.IsIE && "\x43SS1Comp\x61\164"==document.compatMode){var oRect=RadEditorNamespace.Utils.GetRect(oElem); var difference=(oRect.height-parseInt(oElem.style.height)); if (difference>0){var newHeight=(parseInt(oElem.style.height)-difference); if (newHeight>0)oElem.style.height=newHeight+"\x70x"; }}} ,GetWidth:function ( ){var oRect=RadEditorNamespace.Utils.GetRect(this.WrapperElement); return oRect.width; } ,GetHeight:function ( ){var oRect=RadEditorNamespace.Utils.GetRect(this.WrapperElement); return oRect.height; } ,SetVisible:function (visible){ this.WrapperElement.style.display=(visible?"": "none"); if (visible && !this.IsIE){ this.SetEditable( true); }} ,SetupPasteContainer:function ( ){var tmpPasteContainer=RadEditorNamespace.Utils.GetPasteContainer( ); tmpPasteContainer.innerHTML=""; if ("\x66\x75\x6ecti\x6fn"==typeof tmpPasteContainer.setActive){tmpPasteContainer.setActive( ); }tmpPasteContainer.focus( ); return tmpPasteContainer; } ,GetPasteContainerContent:function ( ){var tmpPasteContainer=RadEditorNamespace.Utils.GetPasteContainer( ); var Z=tmpPasteContainer.innerHTML; tmpPasteContainer.innerHTML=""; return Z; } ,GetClipboardAsHtml:function ( ){var tmpPasteContainer=this.SetupPasteContainer( ); try {tmpPasteContainer.ownerDocument.execCommand("\x50aste", false ,null); }catch (ex){}return this.GetPasteContainerContent( ); } ,GetSelectionHtml:function ( ){return this.GetSelection( ).GetHtmlText( ); } ,GetSelection:function ( ){return RadEditorNamespace.RadSelection.New(this.ContentWindow); } ,GetSelectedElement:function ( ){return this.GetSelection( ).GetParentElement( ); } ,GetContentArea:function ( ){return this.ContentArea; } ,GetDocument:function ( ){return this.Document; } ,GetMode:function ( ){return this.Mode; } ,GetToolByName:function (name){var tools=this.Tools; var length=tools.length; for (var i=0; i<length; i++){if (name==tools[i].Name)return tools[i]; }return null; } ,PasteHtml:function (content,sTitle,bSelectText,bFireSelChanged,bAddUndo){if (!this.IsEditingEnabled( ))return; this.contentCache=null; if (RadEditorNamespace.RADEDITOR_DESIGN_MODE==this.Mode || "\x64a\x74\141\x65ntry"==this.ekParameters.editMode){var bSetFocus= false; if (!bSelectText){ this.SetFocus( ); bSetFocus=null; } this.ExecuteCommand(RadEditorNamespace.RadPasteHtmlCommand.New(sTitle,this.ContentWindow,content,bSelectText),bSetFocus,bAddUndo); if (bFireSelChanged!= false)this.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED,null); }else if (RadEditorNamespace.RADEDITOR_HTML_MODE==this.Mode){if (this.IsIE){ this.ContentTextarea.setActive( ); var range=document.selection.createRange( ); range.text=content; }else {var textControl=this.ContentTextarea; if (textControl.setSelectionRange){var oldSelectionStart=textControl.selectionStart; var oldSelectionEnd=textControl.selectionEnd; var selectedText=textControl.value.substring(oldSelectionStart,oldSelectionEnd); var newText=content; textControl.value=textControl.value.substring(0,oldSelectionStart)+newText+textControl.value.substring(oldSelectionEnd); textControl.setSelectionRange(oldSelectionStart+newText.length,oldSelectionStart+newText.length); this.SetFocus( ); return false; }}}} ,CreateButtonTool:function (toolName,controller,oDocument,iconUrl,showIcon,showText,textPos,toolType,btnIndex){if (!controller)controller=this ; if (!oDocument)oDocument=this.Document; var locToolName=this.Localization[toolName]; if (!locToolName)locToolName=toolName; if ( false !=showIcon){if (!iconUrl)iconUrl=this.GetImageUrl(toolName+"\x2egif"); }var toolArgs= {GetController:function ( ){return controller; } ,Document:oDocument,Name:toolName,Title:locToolName,IconUrl:iconUrl,ShowIcon: ( false ==showIcon? false : true),ShowText: ( false ==showText? false : true),Type:toolType,ButtonIndex:btnIndex,TextPosition:textPos } ; tool=RadEditorNamespace.RadToolBase.New(toolArgs); tool.Create( ); return tool; } ,GetHiddenTextareaValue:function ( ){return this.ContentHiddenTextarea.value; } ,SetHiddenTextareaValue:function (oVal){if (this.IsSafari && this.ContentHiddenTextarea.innerText!=null){ this.ContentHiddenTextarea.innerText=oVal; try { this.ContentHiddenTextarea.value=oVal; }catch (ex){}}else { this.ContentHiddenTextarea.value=oVal; }} ,SetMode:function (mode){if (!this.IsEditingEnabled( ) || this.DisableModeSwitching)return; if (!mode)mode=RadEditorNamespace.RADEDITOR_DESIGN_MODE; if (mode==this.Mode || (mode!=RadEditorNamespace.RADEDITOR_HTML_MODE && mode!=RadEditorNamespace.RADEDITOR_DESIGN_MODE && mode!=RadEditorNamespace.RADEDITOR_PREVIEW_MODE)){return; }if ( false ==this.ExecuteClientEvent("\x4fn\x43\x6cien\x74ModeCha\x6ege"))return; var oRect=RadEditorNamespace.Utils.GetRect(this.WrapperElement); var height=oRect.height; var width=oRect.width; var content=this.GetPageHtml( ); if (content!=null)this.SetHiddenTextareaValue(content); this.Mode=mode; try { this.setDesignContent(content); this.private_UpdateContentArea( ); }catch (ex){ this.Mode=RadEditorNamespace.RADEDITOR_HTML_MODE; this.OnContentError(ex); return; } this.private_SetVisibleArea(mode==RadEditorNamespace.RADEDITOR_HTML_MODE?this.ContentTextarea: this.ContentAreaElement); this.private_SetPressedButton(mode); this.SetIndentButtonVisible(mode==RadEditorNamespace.RADEDITOR_HTML_MODE); this.SetEditable(mode==RadEditorNamespace.RADEDITOR_DESIGN_MODE); if (mode!=RadEditorNamespace.RADEDITOR_HTML_MODE && this.IsIE && "CSS1C\x6fmpat"==document.compatMode){ this.ContentTextarea.style.height=""; }try { this.FireEvent(RadEditorNamespace.RADEVENT_MODE_CHANGED); }catch (e){} ; this.SetSize(width,height, false); if (mode==RadEditorNamespace.RADEDITOR_DESIGN_MODE){ this.SetClassName(this.LastClassName); this.ContentWindow.ektronHideShowElementState= false; }else if (mode==RadEditorNamespace.RADEDITOR_PREVIEW_MODE){ this.ContentArea.className=this.ClassName; }else if (mode==RadEditorNamespace.RADEDITOR_HTML_MODE && this.IsIE && "CS\x531Compat"==document.compatMode){var oArea=this.ContentTextarea; var tableHeight=0; if (this.DockingZones.LeftZone){tableHeight=RadEditorNamespace.Utils.GetRect(this.DockingZones.LeftZone).height; }var oHeight=tableHeight-10-RadEditorNamespace.Utils.GetRect(this.DockingZones.BottomZone).height; if (oHeight>0){oArea.style.height=oHeight+"\x70x"; this.FixIeHeight(oArea,oHeight); }else {oHeight=RadEditorNamespace.Utils.GetRect(this.DockingZones.BottomZone).top-RadEditorNamespace.Utils.GetRect(this.DockingZones.TopZone).bottom; oArea.style.height=oHeight+"\x70x"; this.FixIeHeight(oArea,oHeight); }if (this.ToggleFullScreen){oArea.style.width="\x3100%"; }else {oArea.style.width=RadEditorNamespace.Utils.GetRect(oArea.parentNode).width-10; }} this.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED); this.SetFocus( ); } ,private_HandleLinksInDesignMode:function (oDoc,enable){if (!enable){var oLinks=oDoc.links; var oFun= function ( ){return false; } ; for (var i=0; i<oLinks.length; i++){oLinks[i].onclick=oFun; }}} ,private_SetPressedButton:function (number){var array=[this.DesignButton,this.HtmlButton,this.PreviewButton]; for (var i=0; i<array.length; i++){if (array[i]){array[i].className=(i==(number-1))?"\x52adE\x54\x6fgg\x6ceButto\x6ePress\x65d": "\x52adETog\x67\x6ce\x42\165\x74ton"; }}} ,private_SetVisibleArea:function (area){var isFrame=(area==this.ContentAreaElement); var toShow=(isFrame?this.ContentAreaElement: this.ContentTextarea); var toHide=(isFrame?this.ContentTextarea: this.ContentAreaElement); if (toShow==this.ContentAreaElement){if (this.IsSafari)toShow.style.display="\x62lock"; toShow.style.width="\x31\060\x30%"; toShow.style.height="100%"; }else toShow.style.display="blo\x63\153"; if (toHide==this.ContentAreaElement){toHide.style.width="\060\x70x"; toHide.style.height="\x30px"; if (this.IsSafari)toHide.style.display="n\x6fne"; }else toHide.style.display="no\x6ee"; } ,SetHtml:function (content,title,setFocus){if (!this.IsEditingEnabled( ))return; var cmd=RadEditorNamespace.RadGenericCommand.New(title,this.ContentWindow); this.SetHiddenTextareaValue(content); try { this.private_UpdateContentArea( ); }catch (ex){ this.SetMode(RadEditorNamespace.RADEDITOR_HTML_MODE); this.ContentTextarea.value=content; this.OnContentError(ex); } this.SetEditable( true); this.ExecuteCommand(cmd,setFocus); this.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED,null); } ,private_UpdateContentArea:function ( ){var content=this.GetHiddenTextareaValue( ); if (this.Mode==RadEditorNamespace.RADEDITOR_DESIGN_MODE){var newContent=this.FiltersManager.GetDesignContent(content); this.private_SetPageHtml(newContent); }else if (this.Mode==RadEditorNamespace.RADEDITOR_PREVIEW_MODE){var args=null; try {var strInitDoc=this.getContent("\x64atadoc\x75\155\x65ntxml"); var strDataEntryXslt=this.getContent("da\x74aentryxs\x6c\164"); var strEntryPage=this.ekXml.xslTransform(strInitDoc,strDataEntryXslt,args,Ektron.OnException.throwException); this.private_SetPageHtml(strEntryPage); }catch (ex){var errmsg=this.GetLocalizedString("\x45rr\x50\162\x6fcessCo\x6etent","\x41n error \x6fccurred \x77\150\x65n proc\x65ssing \x74he con\x74ent."); alert(errmsg+"\012\012"+ex.message); this.private_SetPageHtml(newContent); }}else if (RadEditorNamespace.RADEDITOR_HTML_MODE){if ("\x73tring"==typeof content){content=content.replace(/\xa0/g,"&#160\x3b"); } this.ContentTextarea.value=content; } this.ValueSaved= false; this.contentCache=null; } ,private_EncodeHiddenAreaContent:function (toEncode){if (toEncode){ this.FireEvent(RadEditorNamespace.RADEVENT_SUBMIT); var encoded=this.GetPageHtml( ); encoded=TelerikNamespace.Utils.EncodePostbackContent(encoded); this.SetHiddenTextareaValue(encoded); this.ContentTextarea.value=""; }else {var decoded=TelerikNamespace.Utils.DecodePostbackContent(this.GetHiddenTextareaValue( )); if (null==this.initialContent && decoded){ this.initialContent=decoded; }try {decoded=this.FiltersManager.GetDesignContent(decoded); }catch (e){ ; } this.SetHiddenTextareaValue(decoded); }} ,GetCssArrayForDocument:function (oDoc){if (null==oDoc)oDoc=document; var cssServer=RadEditorNamespace.GetCssClassServer( {localization: this.Localization } ); var classList=cssServer.GetCssArrayForDocument(oDoc); var classList=this.GetFilteredCssClasses(classList); return classList; } ,GetCssClassesByTagName:function (oTag,cssDocument){var cssServer=RadEditorNamespace.GetCssClassServer( {localization: this.Localization } ); var classList=cssServer.GetCssClassesByTagName(oTag,cssDocument); classList=this.GetFilteredCssClasses(classList); return classList; } ,GetFilteredCssClasses:function (oClassArray){var classArray=[ ]; if (oClassArray && this.CssFiltersObject){for (var index=0; index<oClassArray.length; index++){var radCssClass=oClassArray[index]; if (outAlias=this.CheckCssFilter(radCssClass.Rule.selectorText)){radCssClass.Alias=outAlias; classArray[classArray.length]=radCssClass; }}return classArray; }else return oClassArray; } ,CheckCssFilter:function (curAlias){if (!curAlias || !this.CssFiltersObject)return null; return this.CssFiltersObject[curAlias.replace(/(.*?)\x2e/gi, function ($1){return $1.toUpperCase( ); } )]; } ,GetNamedCssForSelectedElement:function (oVal){var filtered=this.CheckCssFilter("."+oVal); if (!filtered){var selElem=this.GetSelection( ).GetParentElement( ); if (selElem && selElem.tagName){filtered=this.CheckCssFilter(selElem.tagName+"\x2e"+oVal); }}return filtered; } ,Fire:function (commandName,oTool){if ( false ==this.ExecuteClientEvent("\x4fnCli\x65\156\x74Comma\x6e\144\x45xecutin\x67",commandName,oTool))return; if (!this.IsEditingEnabled( ) && commandName!="Undo" && commandName!="\x52ed\x6f")return; this.PendingTextTypeCmd=null; var commandPtr=RadEditorCommandList[commandName]; var toUpdate= false; if (commandPtr){toUpdate=( false !=commandPtr(commandName,this,oTool)); }else {alert("\x43o\x75\x6cd \x6eot find \x74he com\x6dand "+commandName+"\x2e Pl\x65\x61se\x20update \x79our com\x6dand lis\x74."); }if (toUpdate){ this.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED,null); } this.ExecuteClientEvent("\x4fnCl\x69\145\x6e\164\x43\157m\x6dandExe\x63uted",commandName,oTool); } ,SetToolState:function (toolsArray,z){if (!this.IsEditingEnabled( ) || false ==this.ToolsEnabled)return; this.ToolsUpdate= true; var oTool=null; var oCmd=null; var contentWindow=this.ContentWindow; var W= false; var isRichEditable= false; var isImgSelected= false; var w= false; var V= false; if (z){var element=z.srcElement?z.srcElement:z.target; if ("function"==typeof this.GetSelectedElement){var oSelected=this.GetSelectedElement( ); if (oSelected){element=oSelected; }}if (3==element.nodeType){element=element.parentNode; }W=$ektron.isEditableElement(element); var tagName=element.tagName; w=( true ==ekCanHaveChildren(element) && tagName!="\x4cEGE\x4e\x44" && tagName!="CAP\x54\111\x4f\x4e"); if (Ektron.SmartForm && (Ektron.SmartForm.isDDFieldElement(element) || Ektron.SmartForm.isCustomTag(element))){V= true; }isImgSelected=("I\x4dG"==tagName); isRichEditable=(W && w && tagName!="TEX\x54AREA"); }for (var i=0; i<toolsArray.length; i++){oTool=toolsArray[i]; var toolName=oTool.Name; oCmd=RadEditorNamespace.UpdateCommandsArray[toolName]; if (toolName==RadEditorNamespace.RADCOMMAND_UNDO){oTool.SetState(this.CommandsManager.GetUndoState( )); }else if (toolName==RadEditorNamespace.RADCOMMAND_REDO){oTool.SetState(this.CommandsManager.GetRedoState( )); }else if (toolName==RadEditorNamespace.RADCOMMAND_REPEAT_LAST_COMMAND){oTool.SetState(this.CommandsManager.CanRepeatLastCommand( )?RadEditorNamespace.RADCOMMAND_STATE_OFF:RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }else if ("\x50aste"==toolName){if ( true ==W || true ==this.isSelectionEditable( )){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF); }else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }}else if (toolName.indexOf("\x50aste")==0){if (z && ( false ==w || false ==W || true ==V)){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }else if ( true ==this.isSelectionEditable( )){if (this.IsSafari && element && "DIV"==element.tagName && null==element.parentNode){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF); }}else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }}else if (",LinkM\x61nager,I\x6esertAnc\x68or,".indexOf("\x2c"+toolName+"\054")>-1){var isThumbnail= false; if (element && "I\x4dG"==element.tagName && $ektron(element).hasClass("ektro\x6e_thumb\x6eail")){isThumbnail= true; }if (isRichEditable || (isImgSelected && !isThumbnail)){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF); }else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }}else if ("\111\x6esertHor\x69\172\x6f\156\x74alRule,\x49nsert\x53\171\x6dbol,\x45kAdd\x4cinkPag\x65,".indexOf(","+toolName+",")>-1){if (isRichEditable){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF); }else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }}else if (toolName.indexOf("\x45k")==0 && toolName.indexOf("EkPre\x76iew")!=0){switch (toolName){case "EkLoc\x61lize":var isLocalizeSectionAllowed=isRichEditable; if (element && ($ektron(element).hasClass('ekt\x64esignns\x5f\154\x6fcalize') || $ektron(element).parents( ).hasClass('ektde\x73ignns_l\x6fcalize'))){isLocalizeSectionAllowed= false; }if (isLocalizeSectionAllowed){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF); }else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }break; case "\x45kLibrar\x79":if (this.Mode==RadEditorNamespace.RADEDITOR_HTML_MODE){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }else {if (isRichEditable || isImgSelected){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF); }else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }}break; case "EkValid\x61teData":if (this.Mode==RadEditorNamespace.RADEDITOR_PREVIEW_MODE || "da\x74aentry"==this.ekParameters.editMode){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF); }else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }break; case "\105\x6bCompat\x69bility":if (this.initialContent && this.Mode==RadEditorNamespace.RADEDITOR_DESIGN_MODE){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF); }else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }break; case "\x45kH\x69\144\x65ShowEle\x6d\145\x6ets":if (this.Mode==RadEditorNamespace.RADEDITOR_DESIGN_MODE){oTool.SetState(contentWindow.ektronHideShowElementState?RadEditorNamespace.RADCOMMAND_STATE_ON:RadEditorNamespace.RADCOMMAND_STATE_OFF); }else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }break; default:if (this.Mode==RadEditorNamespace.RADEDITOR_DESIGN_MODE || this.Mode==RadEditorNamespace.RADEDITOR_PREVIEW_MODE){if (oTool.SetState && oCmd && oCmd.GetState){oTool.SetState(oCmd.GetState(contentWindow)); }else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF); }}else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }break; }}else if (toolName==RadEditorNamespace.RADCOMMAND_REAL_FONTSIZE){if (this.Mode==RadEditorNamespace.RADEDITOR_DESIGN_MODE){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF); }else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }}else if (this.IsSafari && toolName==RadEditorNamespace.RADCOMMAND_FONTSIZE){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }else if (toolName==RadEditorNamespace.RADCOMMAND_SHOW_FIND_DIALOG){if (this.Mode==RadEditorNamespace.RADEDITOR_DESIGN_MODE){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF); }else {oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); }}else if (oTool.SetState && oCmd && oCmd.GetState){oTool.SetState(oCmd.GetState(contentWindow)); }if (oTool.UpdateValue)oTool.UpdateValue(oCmd.GetValue(contentWindow)); oTool=oCmd=null; } this.ToolsUpdate= false; } ,RegisterTool:function (tool){RadEditorNamespace.Utils.ArrayAdd(this.Tools,tool); } ,Undo:function (depth){ this.CommandsManager.Undo(depth); } ,Redo:function (depth){ this.CommandsManager.Redo(depth); } ,MarkCurrentState:function (oName){return RadEditorNamespace.RadGenericCommand.New(oName,this.ContentWindow); } ,SaveCurrentState:function (oState){ this.ExecuteCommand(oState); } ,ExecuteCommand:function (radCommand,setFocus,addToStack){ this.contentCache=null; if ( false !=setFocus && !this.IsOpera)this.SetFocus( ); this.CommandsManager.Execute(radCommand,addToStack); } ,ExecuteFormatObjectCommand:function (srcObject,sTitle,targetObject){return this.ExecuteCommand(RadEditorNamespace.RadFormatObjectCommand.New(sTitle,this.ContentWindow,srcObject,targetObject)); } ,ExecuteApplyCssClassCommand:function (className,sTitle){return this.ExecuteCommand(RadEditorNamespace.RadStyleCommand.New(sTitle,this.ContentWindow,className)); } ,ExecuteSetAttributeCommand:function (oElem,attribName,attribValue,sTitle){return this.ExecuteCommand(RadEditorNamespace.RadSetAttributeCommand.New(sTitle,this.ContentWindow,oElem,attribName,attribValue)); } ,ExecuteSetStyleRuleCommand:function (oElem,styleRuleName,styleRuleValue,sTitle){return this.ExecuteCommand(RadEditorNamespace.RadSetStyleRuleCommand.New(sTitle,this.ContentWindow,oElem,styleRuleName,styleRuleValue)); } ,CreateElement:function (tagName,styleWidth,styleHeight,sId,sName,sValue){var oElement=this.Document.createElement(tagName); oElement.style.width=RadEditorNamespace.Utils.IsNull(styleWidth,""); oElement.style.height=RadEditorNamespace.Utils.IsNull(styleHeight,""); if (null!=sId)oElement.id=sId; if (null!=sName)oElement.name=sName; if (null!=sValue)oElement.value=sValue; return oElement; } ,SelectElement:function (element,fireEvent){if (RadEditorNamespace.Utils.SelectElement(this.ContentWindow,element) && false !=fireEvent){ this.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED,null); }} ,CreateRestorePoint:function ( ){return RadEditorNamespace.RadCreateRestorePoint(this.ContentWindow); } ,InsertLink:function (url,text,linkInfo){ this.SetActive( ); if (!linkInfo){linkInfo= {} ; }linkInfo.href=url; var genericCmd=RadEditorNamespace.RadGenericCommand.New(this.Localization["Creat\x65Link"],this.ContentWindow); var oSel=this.GetSelection( ); var startR; var endR; if (this.IsIE && !oSel.IsControl( )){var oRange=this.Document.selection.createRange( ); startR=oRange.duplicate( ); endR=oRange.duplicate( ); startR.collapse( ); endR.collapse( false); }var testLink=RadEditorNamespace.Utils.GetElementParentByTag(oSel.GetParentElement( ),"A"); var linkObj; if (testLink){linkObj=testLink; this.SetLinkProperties(linkInfo,'',linkObj); }else if (oSel.GetText( )!="" || oSel.GetParentElement( ).tagName=="IMG"){ this.ExecuteBrowserCommand(RadEditorNamespace.RADCOMMAND_UNLINK, true ,null); var retVal=RadEditorNamespace.MarkEditorSelection(this ); var elementsToModify=retVal.markedElements; for (var i=0; i<elementsToModify.length; i++){var oElement=elementsToModify[i]; var parentLink=RadEditorNamespace.Utils.GetElementParentByTag(oElement,"\x41"); if (parentLink){if (parentLink.href!=linkInfo.href){ this.SetLinkProperties(linkInfo,'',parentLink); }continue; }var linkObj=this.Document.createElement('A'); linkObj.innerHTML=oElement.innerHTML; oElement.innerHTML=''; if (this.IsSafari)linkObj.href="#"; oElement.appendChild(linkObj); this.SetLinkProperties(linkInfo,'',linkObj); }var newElements=retVal.newElements; for (var i=0; i<newElements.length; i++){if (this.IsIE || this.IsOpera){newElements[i].removeNode( false); }else {var range=this.Document.createRange( ); range.selectNodeContents(newElements[i]); var oFrag=range.extractContents( ); range.selectNode(newElements[i]); range.deleteContents( ); range.insertNode(oFrag); }}}else {var _tmp_id="\x65di\x74\x6fr_\x5ftmp__id"; this.PasteHtml("\074a href\x3d\047\x23\047\x20id \x3d \047"+_tmp_id+"\047\x3e"+linkInfo.text+"\x3c/a>"); var linkObj=this.Document.getElementById(_tmp_id); linkObj.removeAttribute('\151\x64'); linkInfo.text=(linkInfo.text || linkInfo.href || linkInfo.mail); this.SetLinkProperties(linkInfo,'',linkObj); }if (this.IsIE){try {var oNewRange=this.Document.selection.createRange( ); oNewRange.setEndPoint("Start\x54\157\x53tart",startR); oNewRange.setEndPoint("EndToEn\x64",endR); oNewRange.select( ); }catch (e){}}else {var selection=this.ContentWindow.getSelection( ); if (!this.IsSafari){var rng=selection.getRangeAt(0); rng.collapse( true); }} this.ExecuteCommand(genericCmd); this.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED,null); if (this.IsIE){var v=new Ektron.SelectionRange( {window: this.ContentWindow } ); var oElem=v.getContainerElement( ); if (oElem!=null){var T=$ektron(oElem); var strHtml=T.html( ); if (0==strHtml.indexOf("&\x23160;") || 0==strHtml.indexOf("&nb\x73p;")){strHtml=strHtml.substring(6); if (strHtml.length>0){T.html(strHtml); }}}}} ,SetLinkProperties:function (linkInfo,cmdTitle,linkObj){cmdTitle=cmdTitle || this.Localization[RadEditorNamespace.RADCOMMAND_SET_LINK_PROPERTIES]; var selElem=this.GetSelectedElement( ); var linkObj=linkObj || RadEditorNamespace.Utils.GetElementParentByTag(selElem,"A"); var newLink=this.Document.createElement("A"); var attrToTrim=['\x68ref','name','tit\x6c\145','\x74\141\x72\x67e\x74','\x63lassNam\x65']; for (var i=0; i<attrToTrim.length; i++){if (linkInfo[attrToTrim[i]] && RadEditorNamespace.Utils.Trim(linkInfo[attrToTrim[i]])){newLink[attrToTrim[i]]=linkInfo[attrToTrim[i]]; }}if (linkInfo.text && RadEditorNamespace.Utils.Trim(linkInfo.text)){linkObj.innerHTML=linkInfo.text; }var tmpInnerHTML=linkObj.innerHTML; if (this.IsIE){linkObj.removeAttribute("\x74arge\x74"); linkObj.removeAttribute("\x63\154\x61\x73s"); linkObj.mergeAttributes(newLink); }else { this.ExecuteFormatObjectCommand(newLink,cmdTitle,linkObj); }if (!newLink.href){linkObj.removeAttribute("\x68ref"); }else {linkObj.setAttribute("\x64ata-\x65\153\x74ron-ur\x6c",linkObj.getAttribute("\x68ref",2)); }linkObj.innerHTML=tmpInnerHTML; if (this.IsIE && newLink.name){linkObj.removeAttribute("name"); linkObj.removeAttribute("\x4eAME"); linkObj.name=null; linkObj.name=newLink.name; linkObj.setAttribute("name",newLink.name); }var imagesList=linkObj.getElementsByTagName('I\x4dG'); for (var i=0; i<imagesList.length; i++){if (!imagesList[i].style.border && !imagesList[i].border){imagesList[i].border=0; }}try { this.SelectElement(linkObj, false); }catch (e){} this.SetFocus( ); } ,InsertRow:function (sDirection){var sTitle="Ins\x65rt row"; if (sDirection=="above")sTitle=this.Localization[RadEditorNamespace.RADCOMMAND_INSERT_ROW_ABOVE]; else if (sDirection=="\x62elo\x77")sTitle=this.Localization[RadEditorNamespace.RADCOMMAND_INSERT_ROW_BELOW]; this.ExecuteCommand(RadEditorNamespace.RadTableInsertRow.New(sTitle,this.ContentWindow,sDirection)); } ,InsertColumn:function (sDirection){var sTitle="I\x6esert col\x75mn"; if (sDirection=="\x6ceft")sTitle=this.Localization[RadEditorNamespace.RADCOMMAND_INSERT_COLUMN_LEFT]; else if (sDirection=="\x72ight")sTitle=this.Localization[RadEditorNamespace.RADCOMMAND_INSERT_COLUMN_RIGHT]; this.ExecuteCommand(RadEditorNamespace.RadTableInsertColumn.New(sTitle,this.ContentWindow,sDirection)); } ,DeleteRow:function ( ){ this.ExecuteCommand(RadEditorNamespace.RadTableDeleteRow.New(this.Localization[RadEditorNamespace.RADCOMMAND_DELETE_ROW],this.ContentWindow)); } ,DeleteColumn:function ( ){ this.ExecuteCommand(RadEditorNamespace.RadTableDeleteColumn.New(this.Localization[RadEditorNamespace.RADCOMMAND_DELETE_COLUMN],this.ContentWindow)); } ,DeleteCell:function ( ){ this.ExecuteCommand(RadEditorNamespace.RadTableDeleteCell.New(this.Localization[RadEditorNamespace.RADCOMMAND_DELETE_CELL],this.ContentWindow)); } ,MergeColumns:function ( ){ this.ExecuteCommand(RadEditorNamespace.RadTableMergeColumns.New(this.Localization[RadEditorNamespace.RADCOMMAND_MERGE_COLUMNS],this.ContentWindow)); } ,MergeRows:function ( ){ this.ExecuteCommand(RadEditorNamespace.RadTableMergeRows.New(this.Localization[RadEditorNamespace.RADCOMMAND_MERGE_ROWS],this.ContentWindow)); } ,SplitCell:function ( ){ this.ExecuteCommand(RadEditorNamespace.RadTableSplitCell.New(this.Localization[RadEditorNamespace.RADCOMMAND_SPLIT_CELL],this.ContentWindow)); } ,AddShortcut:function (shortcutName,shortcutString){if (this.KeyboardManager){ this.KeyboardManager.AddShortcut(shortcutName,shortcutString); }} ,RemoveShortcut:function (shortcutName){if (this.KeyboardManager){ this.KeyboardManager.RemoveShortcut(shortcutName); }} ,SetShortcut:function (shortcutName,shortcutString){if (this.KeyboardManager){ this.KeyboardManager.SetShortcut(shortcutName,shortcutString); }} ,GetDialogParameters:function (dialogName){var args=null; var array=this.DialogParametersArray; for (var i=0; i<array.length; i++){var curArray=array[i]; if (dialogName==curArray[0]){args= {} ; dialogArguments=curArray[1]; for (var j=0; j<dialogArguments.length; j++){args[dialogArguments[j][0]]=dialogArguments[j][1]; }}}return args; } ,ShowDialog:function (url,argument,width,height,callBackFn,callBackArgs,sCaption){var dialogOwner=sCaption+"\x7c"+url; if ( false ==$ektron.browser.safari && this.LastDialogOwner!=null && this.LastDialogOwner==dialogOwner)return; this.LastDialogOwner=dialogOwner; var re=this ; if (!callBackArgs){callBackArgs= {} ; }callBackArgs.editor=this ; if (this.Document.selection){callBackArgs.rngSelection=ekCreateRange(this.Document.selection); }callBackArgs.callBackFn=callBackFn; if (document.selection && document.selection.type.toLowerCase( )=="\x63on\x74\162\x6fl"){document.selection.empty( ); document.body.focus( ); window.focus( ); }if (!argument){argument= {} ; }var editorID=this.Id; argument.editorID=editorID; argument.HideEditorStatusBar=RadEditorNamespace.HideEditorStatusBar; argument.ColorsArray=this.ColorsArray; argument.CanAddCustomColors=this.AllowCustomColors; argument.StripAbsoluteImagesPaths=this.StripAbsoluteImagesPaths; argument.CommonInternalParameters=this.GetDialogInternalParameters("\103\x6fmmon\x44ialogPa\x72\141\x6deters"); RadEditorNamespace.ShowEditorStatusBar(editorID); window.setTimeout("\x52adEdi\x74\x6fr\x4e\141m\x65space.\x48\151\x64eEdito\x72Statu\x73Bar(\x27"+editorID+"\x27)",1000); var rwi=new RadWindowInfo( ); rwi.Url=url; rwi.Width=width; rwi.Height=height; rwi.Caption=(sCaption?sCaption: ""); rwi.IsVisible= true; rwi.Argument=argument; rwi.CallbackFunc= function (retValue,params){re.LastDialogOwner=null; if (params.rngSelection && params.rngSelection.select){params.rngSelection.select( ); }params.editorID=null; params.CanAddCustomColors=null; params.StripAbsoluteImagesPaths=null; if (params.callBackFn && retValue!=null && typeof retValue!="undefin\x65d"){var oRes=params.callBackFn(retValue,params); if ( false ==oRes)return; }params.editor.sfInstance.setSelectedField(null); if (null!=retValue)params.editor.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED,null); params.editor.SetFocus( ); } ; rwi.OnLoadFunc=null; rwi.Param=callBackArgs; rwi.Resizable= true; rwi.Movable= true; rwi.UseClassicDialogs=re.UseClassicDialogs; rwi.BlankIFrameLocation=re.BlankIFrameLocation; wnd=GetEditorRadWindowManager( ).ShowModalWindow(rwi); return wnd; } ,CleanIndent:function ( ){var newText=this.ContentTextarea.value; if (this.EnableHtmlIndentation && newText.indexOf(RadEditorNamespace.RADEDITOR_OUTDENT_STEP)>-1){var os=RadEditorNamespace.RADEDITOR_OUTDENT_STEP; var re=new RegExp(os+"\x2b","ig"); newText=newText.replace(re,""); } this.ContentTextarea.value=newText; } ,GetIndentedHtml:function ( ){RadEditorNamespace.UniqueIds= {} ; var elem=document.createElement("DIV"); RadEditorNamespace.SetElementInnerHTML(elem,this.ContentTextarea.value); var content=elem.innerHTML; if (content){var strBuild=new RadEditorNamespace.Utils.StringBuilder(""); RadEditorNamespace.GetIndentedElementContent(elem,"",RadEditorNamespace.RADEDITOR_INDENT_STEP,strBuild); content=strBuild.ToString( ); content=content.substring(7,content.length-7); this.FiltersManager.EnableDomFilters( false); var content=this.FiltersManager.GetHtmlContent(content); this.FiltersManager.EnableDomFilters( true); } this.ContentTextarea.value=content; } ,SetIndentButtonVisible:function (isVisible){if (!this.EnableHtmlIndentation)return; if (this.FullPage)return; if (!this.privateIndentButtonProcessed){var theEditor=this ; var oIndent=theEditor.FindElement("\x52adEI\x6e\144\x65ntH\x74ml"); oIndent.innerHTML+=this.Localization["Ind\x65ntHtml"]; oIndent.onclick=new Function('this.ge\x74Element\x73ByTagNam\x65(\042\111\x4ePUT\042\x29[0\x5d.cli\x63k()'); var oInput=oIndent.getElementsByTagName("\x49NPUT")[0]; oInput.onclick= function (e){if (this.checked){theEditor.GetIndentedHtml( ); }else {theEditor.CleanIndent( ); }if (e && e.stopPropagation)e.stopPropagation( ); } ; theEditor.IndentHtmlWrapper=oIndent; theEditor.IndentHtmlElement=oInput; this.privateIndentButtonProcessed= true; }if (null!=this.IndentHtmlWrapper){ this.IndentHtmlWrapper.style.display=isVisible?"bl\x6fck": "\x6eone"; this.IndentHtmlElement.checked= false; }} ,SetOverlay:function ( ){var editorContentArea=this.ContentArea; var shim=document.createElement("\x49MG"); shim.src=this.SkinBasePath+"\x42ut\x74\157n\x73/transp\x2egif"; shim.style.position="\141\x62solute"; shim.style.zIndex=50000; shim.style.width=parseInt(window.screen.width); shim.style.height=parseInt(window.screen.height); shim.style.top=0; shim.style.left=0; shim.id="\x73him"+this.Id; shim.style.display="block"; document.body.appendChild(shim); return shim.id; } ,ClearOverlay:function ( ){var shim=this.FindElement("shim"); if (shim){shim.parentNode.removeChild(shim); }} ,GetDialogUrl:function (dialogName){var url=''; if (this.UseSession==RadEditorNamespace.DIALOG_PARAMETERS_MODE_SESSION){var relativeRadControlsDir=this.RadControlsDir.substr(this.ApplicationPath.length); url=this.ApplicationPath+this.SessionID1+relativeRadControlsDir; }else {url=this.RadControlsDir; }var result=url+"\x45ditor/D\x69\141\x6cog.aspx\x3fdialog\x3d"+dialogName+"&\x65\144i\x74\157\x72ID="+this.Id+"&us\x65Session="+this.UseSession+"\x26sessi\x6f\x6eI\x44\062\x3d"+this.SessionID2+"&\x6canguage="+this.Language+"\046\x55seEmbed\x64\145\x64\123\x63ripts="+this.UseEmbeddedScripts; var dialogParameters=this.GetDialogParameters(dialogName); for (var parameterName in dialogParameters){result+="&"+parameterName+"="+dialogParameters[parameterName]; }return result; } ,GetDialogInternalParameters:function (dialogName){return this.DialogInternalParameters[dialogName]; }};
RadEditor.prototype.ArrowDropdown="ar\x72\x6fwDrop\x64own.gi\x66"; RadEditor.prototype.ArrowIcon="a\x72rowIco\x6e\056\x67if"; RadEditor.prototype.GetToolbars= function ( ){if ( true ==this.EnableServerSideRendering && true !=this.ServerSideInitialized){ this.ServerSideInitialized= true; var makeToolbarsDockable=this.IsToolbarModeEnabled(RadEditorNamespace.ToolbarModesEnum.Default); RadEditorNamespace.ServerRenderingInitializer(this,makeToolbarsDockable); }else { this.CreateEditorToolbars(this.ToolsArray); }return this.Toolbars; } ; RadEditor.prototype.GetHtmlToolbarElements= function ( ){var oArray=[ ]; var toolbarId=this.Id+"\x54oolba\x72"; var toolbarTable=null; var counter=0; while (null!=(toolbarTable=document.getElementById(toolbarId+counter))){oArray[counter]=toolbarTable; counter++; }return oArray; } ; RadEditor.prototype.SetToolbarsVisible= function (visible){var toolbarsArray=this.GetHtmlToolbarElements( ); for (var i=0; i<toolbarsArray.length; i++){ this.SetToolbarVisible(toolbarsArray[i],visible); }if (visible)$ektron(this.DockingZones.TopZone).parent( ).show( ); } ; RadEditorNamespace.DockableObjectDisplay=document.all && !window.opera?"i\x6eline": ""; RadEditor.prototype.SetToolbarVisible= function (oToolbarTable,visible){if (visible){if (oToolbarTable.Show)oToolbarTable.Show( ); else oToolbarTable.style.display=RadEditorNamespace.DockableObjectDisplay; }else {if (oToolbarTable.Hide)oToolbarTable.Hide( ); else oToolbarTable.style.display="\x6eon\x65"; }} ; RadEditor.prototype.CreateEditorToolbar= function (toolbarId,toolbarName,zoneId,isDockable,forElement,isRibbon){var radToolbar=RadEditorNamespace.RadToolbar.New( {Id:toolbarId,Document:document,Title:toolbarName,IsDockable:isDockable && this.IsToolbarModeEnabled(RadEditorNamespace.ToolbarModesEnum.Default),ZoneId:zoneId,IsRibbon:isRibbon } ); this.Toolbars[this.Toolbars.length]=radToolbar; return radToolbar; } ; RadEditor.prototype.CreateEditorToolbars= function (toolsArray){if (this.ToolbarsCreated)return; else this.ToolbarsCreated= true; for (var i=0; i<toolsArray.length; i++){var arg=0; var toolsRow=toolsArray[i]; if (toolsRow.length<=1)continue; var toolbarId=toolsRow[arg++]; var toolbarName=toolsRow[arg++]; var zoneId=toolsRow[arg++]; var isDockable=toolsRow[arg++]; var forElement=toolsRow[arg++]; var isRibbon=toolsRow[arg++]; if (toolbarName){var localName=this.Localization[toolbarName]; toolbarName=localName?localName:toolbarName; }var toolbar=this.CreateEditorToolbar(toolbarId,toolbarName,zoneId,isDockable && this.EnableDocking,forElement,isRibbon); var tools=toolsRow[arg++]; for (var j=0; j<tools.length; j++){var toolInfo=tools[j]; var tool=this.CreateEditorTool(toolInfo); if (tool){toolbar.AddTool(tool); this.RegisterTool(tool); }else if (toolInfo && toolInfo[0]==RadEditorNamespace.TOOL_SEPARATOR){toolbar.AddSeparator( ); }}}} ; RadEditor.prototype.CreateEditorTool= function (toolInfo){var localiz=this.Localization; var controller=this ; var tool=null; if (toolInfo){arg=0; var toolType=toolInfo[arg++]; var toolCommand=toolInfo[arg++]; var toolShortcut=toolInfo[arg++]; var toolArgs= {} ; toolArgs.GetController= function ( ){return controller; } ; toolArgs.Document=document; toolArgs.Name=toolCommand; toolArgs.Type=toolType; toolArgs.Shortcut=toolShortcut; if (toolShortcut){ this.SetShortcut(toolCommand,toolShortcut); }toolArgs.ShowText=toolInfo[arg++]; toolArgs.ShowIcon=toolInfo[arg++]; toolArgs.TextPosition=toolInfo[arg++]; var iconUrl=toolInfo[arg++]; var fullIconUrl=iconUrl?iconUrl: this.GetImageUrl(toolCommand+".\x67if"); toolArgs.IconUrl=fullIconUrl; var title=localiz[toolCommand]; if (null==title)title=toolCommand; toolArgs.Title=title; if (toolType==RadEditorNamespace.TOOL_BUTTON){tool=RadEditorNamespace.RadToolBase.New(toolArgs); }else if (toolType==RadEditorNamespace.TOOL_COMBOBOX || toolType==RadEditorNamespace.TOOL_BUTTON_COMBOBOX || toolType==RadEditorNamespace.TOOL_DROP_BUTTON){toolArgs.GetDataFunction= function (name){return controller.GetDataArrayForTool(name); } ; toolArgs.ArrowUrl=this.GetImageUrl(this.ArrowIcon); toolArgs.ItemsPerRow=toolInfo[arg++]; toolArgs.PopupWidth=toolInfo[arg++]; toolArgs.PopupHeight=toolInfo[arg++]; var toolArgsArray=toolInfo[arg++]; switch (toolCommand){case RadEditorNamespace.RADCOMMAND_UNDO:case RadEditorNamespace.RADCOMMAND_REDO:toolArgs.CellSpacing=1; toolArgs.PopupWidth=130; toolArgs.PopupHeight=130; toolArgs.PopupClassName="Ra\x64ESymb\x6f\x6cP\x69\143\x6ber"; toolArgs.ClassName="\x52adETo\x6f\154\x4cong"; tool=RadEditorNamespace.RadUndoRedoCombo.New(toolArgs); break; case RadEditorNamespace.RADCOMMAND_STRIP_FORMAT:toolArgs.CellSpacing=1; toolArgs.CellPadding=1; toolArgs.PopupWidth=180; toolArgs.PopupHeight=138; toolArgs.ClassName="\x52a\x64\x45To\x6flLong"; tool=RadEditorNamespace.RadEditorComboBox.New(toolArgs); break; case RadEditorNamespace.RADCOMMAND_MANAGE_MODULE:toolArgs.PopupWidth=180; toolArgs.PopupHeight=150; toolArgs.ClassName="\x52\141\x64\x45To\x6flLong"; toolArgs.SkinBasePath=controller.SkinBasePath; tool=RadEditorNamespace.RadModuleManagerCombo.New(toolArgs); break; case RadEditorNamespace.RADCOMMAND_INSERT_SNIPPET:toolArgs.PopupWidth=180; toolArgs.PopupHeight=150; toolArgs.ClassName="\x52adEToolL\x6f\156\x67"; tool=RadEditorNamespace.RadEditorComboBox.New(toolArgs); break; case RadEditorNamespace.RADCOMMAND_INSERT_FORM_ELEMENT:toolArgs.PopupWidth=180; toolArgs.PopupHeight=200; toolArgs.CellPadding=0; toolArgs.ClassName="RadET\x6folLon\x67"; tool=RadEditorNamespace.RadEditorComboBox.New(toolArgs); break; case RadEditorNamespace.RADCOMMAND_ZOOM:if (document.all){toolArgs.PopupWidth=60; toolArgs.PopupHeight=175; toolArgs.ArrowUrl=this.GetImageUrl(this.ArrowDropdown); toolArgs.IconUrl=null; tool=RadEditorNamespace.RadEditorComboBox.New(toolArgs); }break; case RadEditorNamespace.RADCOMMAND_INSERT_CUSTOM_LINK:toolArgs.Width=80; toolArgs.PopupWidth=220; toolArgs.PopupHeight=220; toolArgs.IconUrl=null; toolArgs.ArrowUrl=this.GetImageUrl(this.ArrowDropdown); toolArgs.BasePath=this.SkinBasePath; tool=RadEditorNamespace.RadInsertLinkCombo.New(toolArgs); break; case RadEditorNamespace.RADCOMMAND_INSERT_TABLE:toolArgs.CellSpacing=2; toolArgs.CellPadding=2; toolArgs.PopupWidth=122; toolArgs.PopupHeight=226; toolArgs.ClassName="Rad\x45ToolLon\x67"; toolArgs.CancelLabel=localiz["Cancel\x54able"]; toolArgs.TableWizardLabel=localiz["\x54ableW\x69\172\x61rd"]; toolArgs.TableLabel=localiz["Table"]; toolArgs.Localization=localiz; toolArgs.IconBasePath=this.SkinBasePath+"\x42utt\x6f\x6es/"; tool=RadEditorNamespace.RadInsertTableCombo.New(toolArgs); break; case RadEditorNamespace.RADCOMMAND_FORMAT_BLOCK:toolArgs.CellSpacing=2; toolArgs.CellPadding=2; toolArgs.PopupWidth=260; toolArgs.PopupHeight=250; toolArgs.Width=80; toolArgs.IconUrl=null; toolArgs.ArrowUrl=this.GetImageUrl(this.ArrowDropdown); toolArgs.UpdateValue= function (oVal){if (!oVal)return; this.SelectedValue=oVal; try { this.HeaderElement.innerHTML=oVal; }catch (e){} ; } ; tool=RadEditorNamespace.RadEditorComboBox.New(toolArgs); var beforeShowFn=tool.OnBeforeShowPopup; tool.OnBeforeShowPopup= function ( ){var toolDoc=this.Popup.GetDocument( ); if (!this.HasCopiedCss){var cssServer=RadEditorNamespace.GetCssClassServer( {localization: this.Localization } ); cssServer.CopyStyleSheets(controller.Document,toolDoc); this.HasCopiedCss= true; }if (beforeShowFn)beforeShowFn.call(this ); };break; case RadEditorNamespace.RADCOMMAND_FORECOLOR:case RadEditorNamespace.RADCOMMAND_BACKCOLOR:toolArgs.AllowCustomColors=this.AllowCustomColors; toolArgs.AddCustomColor=localiz["\x41ddCusto\x6d\103\x6flor"]; toolArgs.AddCustomHexColor=localiz["\x41dd\x43\165s\x74omHexCol\x6fr"]; toolArgs.PromptColor=localiz["Pro\x6dptColor"]; tool=RadEditorNamespace.RadColorPicker.New(toolArgs); break; case RadEditorNamespace.RADCOMMAND_FONTSIZE:case RadEditorNamespace.RADCOMMAND_FONTNAME:var popupWidth=150; var popupHeight=115; var theWidth=80; if (toolCommand==RadEditorNamespace.RADCOMMAND_FONTSIZE){theWidth=21; popupWidth=100; popupHeight=180; }var updateValPtr= function (oVal){ this.SelectedValue=oVal; try {if (!oVal)oVal=this.Title; this.HeaderElement.innerHTML=(""+oVal).replace(/\s+/gi,"&n\x62sp;"); }catch (e){} ; } ; toolArgs.CellSpacing=0; toolArgs.PopupWidth=popupWidth; toolArgs.PopupHeight=popupHeight; toolArgs.PopupClassName="Rad\x45Dro\x70\x44o\x77nFont"; toolArgs.ArrowUrl=this.GetImageUrl(this.ArrowDropdown); toolArgs.IconUrl=null; toolArgs.Width=theWidth; toolArgs.UpdateValue=updateValPtr; tool=RadEditorNamespace.RadEditorComboBox.New(toolArgs); break; case RadEditorNamespace.RADCOMMAND_REAL_FONTSIZE:var updateValPtr= function (oVal){var o=this.GetController( ).GetSelectedElement( ); if (o){var fontSize=RadEditorNamespace.Utils.GetComputedStyle(o,'fontS\x69ze'); if (fontSize){newSize=parseFloat(fontSize); if (newSize>parseInt(fontSize)){if (fontSize.indexOf("\x70x")>-1){fontSize=parseInt(fontSize)+"\x70x"; }}}var oText=fontSize?fontSize: this.Title; try { this.HeaderElement.innerHTML=oText; }catch (e){} ; }};toolArgs.CellSpacing=0; toolArgs.Width=40; toolArgs.PopupClassName="RadEDr\x6fpDownFo\x6e\164"; toolArgs.PopupWidth=50; toolArgs.PopupHeight=170; toolArgs.ArrowUrl=this.GetImageUrl(this.ArrowDropdown); toolArgs.IconUrl=null; toolArgs.UpdateValue=updateValPtr; tool=RadEditorNamespace.RadEditorComboBox.New(toolArgs); break; case RadEditorNamespace.RADCOMMAND_INSERT_SYMBOL:toolArgs.PopupWidth=245; toolArgs.PopupHeight=200; toolArgs.CellSpacing=0; toolArgs.CellPadding=0; toolArgs.Width=40; toolArgs.IsPopupScrollable= true; toolArgs.ClassName="RadETo\x6flLong"; toolArgs.PopupClassName="Ra\x64\105\x53ymbolPic\x6ber"; toolArgs.ItemsPerRow=10; tool=RadEditorNamespace.RadEditorComboBox.New(toolArgs); break; case RadEditorNamespace.RADCOMMAND_APPLY_CLASS:toolArgs.PopupWidth=180; toolArgs.PopupHeight=150; toolArgs.Width=80; toolArgs.IconUrl=null; toolArgs.ArrowUrl=this.GetImageUrl(this.ArrowDropdown); toolArgs.PopupIconPath=this.SkinBasePath+"\x49mg/"; toolArgs.ClearStyleString=localiz["\x43lea\x72\123\x74yle"]; tool=RadEditorNamespace.RadCssCombo.New(toolArgs); break; case RadEditorNamespace.RADCOMMAND_SPELLCHECK:case "\x41ja\x78\123p\x65llCheck":if (!this.Languages || 0==this.Languages.length){tool=RadEditorNamespace.RadToolBase.New(toolArgs); }else {toolArgs.ClassName="R\x61dEToolLo\x6e\147"; tool=RadEditorNamespace.RadEditorComboBox.New(toolArgs); }break; default:var GetClosureDataFunction= function (args){return function ( ){return args; } ; };toolArgs.GetDataFunction=GetClosureDataFunction(toolArgsArray); if (iconUrl){toolArgs.IconUrl=fullIconUrl; toolArgs.ClassName="\x52adETo\x6f\154\x4cong"; }else {toolArgs.IconUrl=null; toolArgs.Width=80; toolArgs.ArrowUrl=this.GetImageUrl(this.ArrowDropdown); }if (toolType=="TD"){tool=RadEditorNamespace.RadEditorButtonComboBox.New(toolArgs); }else {toolArgs.CellSpacing=1; toolArgs.CellPadding=1; tool=RadEditorNamespace.RadEditorComboBox.New(toolArgs); }break; }}else if (toolType==RadEditorNamespace.TOOL_CUSTOM && RadEditorToolInitializer && RadEditorToolInitializer[toolCommand]){tool=RadEditorToolInitializer[toolCommand](toolArgs); }}return tool; } ; RadEditor.prototype.GetDataArrayForTool= function (toolName){if (!this.RawDataArrays){ this.RawDataArrays= {} ; var editor=this ; var localiz=editor.Localization; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_UNDO]= function ( ){return editor.CommandsManager.GetCommandsToUndo( ); } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_REDO]= function ( ){return editor.CommandsManager.GetCommandsToRedo( ); };this.RawDataArrays[RadEditorNamespace.RADCOMMAND_MANAGE_MODULE]= function ( ){return editor.Modules; } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_INSERT_CUSTOM_LINK]= function ( ){return editor.LinksArray; } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_INSERT_SNIPPET]= function ( ){return editor.SnippetsArray; } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_FORECOLOR]=this.RawDataArrays[RadEditorNamespace.RADCOMMAND_BACKCOLOR]= function ( ){return editor.ColorsArray; } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_SPELLCHECK]=this.RawDataArrays["\x41jaxSpel\x6c\103\x68eck"]= function ( ){return editor.Languages; } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_ZOOM]= function ( ){return [["\x310%","\x310%"],["20%","2\x30%"],["\x350%","50%"],["10\x30%","100%"],["\x3150%","150%"],["\x3200%","200\x25"],["300\x25","300%"],["500%","500%"]]; } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_STRIP_FORMAT]= function ( ){return [["\x41LL",localiz["ClearA\x6clHtmlTag\x73"],editor.GetImageUrl("\x53tripAll\x2e\147\x69f")],["\x57ORD",localiz["\x43learWor\x64\106\x6frmattin\x67"],editor.GetImageUrl("\123\x74ripWord.\x67if")],["CSS",localiz["Cle\x61rCssForm\x61tting"],editor.GetImageUrl("Str\x69pCss.gif")],["FON\x54",localiz["\x43learFo\x6e\x74Ta\x67s"],editor.GetImageUrl("St\x72ipFont.g\x69\146")],["SP\x41\116",localiz["\x43lea\x72\x53pa\x6eTags"],editor.GetImageUrl("\x53\164\x72\151\x70\123p\x61\156\x2egif")]]; } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_INSERT_FORM_ELEMENT]= function ( ){return [["FOR\x4d",localiz["Form\x46orm"],editor.GetImageUrl("\x49ns\x65\162\x74FormForm\x2egif")],["BUT\x54\117\x4e",localiz["FormBu\x74ton"],editor.GetImageUrl("\x49nsert\x46\x6frm\x42utton.gi\x66")],["CHE\x43KBOX",localiz["Form\x43heckbox"],editor.GetImageUrl("\x49nse\x72\x74Fo\x72\155\x43heckbox\x2egif")],["\x48IDDEN",localiz["FormHi\x64den"],editor.GetImageUrl("\x49nser\x74\x46or\x6dHidden.g\x69f")],["R\x41DIO",localiz["\x46or\x6d\x52ad\x69\157"],editor.GetImageUrl("Inser\x74FormRadi\x6f\056\x67if")],["PASSWOR\x44",localiz["\x46ormP\x61\163\x73word"],editor.GetImageUrl("\x49nser\x74\106\x6frmPasswo\x72d.gif")],["\x52ESE\x54",localiz["Fo\x72mReset"],editor.GetImageUrl("InsertF\x6frmReset\x2e\147\x69f")],["SELE\x43\124",localiz["FormS\x65lect"],editor.GetImageUrl("\x49nsertFor\x6dSelect.\x67\151\x66")],["SUBMIT",localiz["For\x6dSubmit"],editor.GetImageUrl("\x49nsert\x46\157\x72mSubmit\x2egif")],["\x54EX\x54",localiz["Fo\x72mText"],editor.GetImageUrl("\x49ns\x65\162\x74\106\x6f\x72mT\x65xt.gif")],["\x54EXTARE\x41",localiz["\x46ormTe\x78\x74ar\x65a"],editor.GetImageUrl("Inse\x72tFormTex\x74area.gif")]]; } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_FORMAT_BLOCK]= function ( ){var paragraphsArray=editor.ParagraphsArray; if (paragraphsArray){var x; for (var k=0; k<paragraphsArray.length; k++){x=paragraphsArray[k][0]; paragraphsArray[k][0]=paragraphsArray[k][1]; paragraphsArray[k][1]=x; }}return paragraphsArray; } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_FONTSIZE]= function ( ){var itemsArray=editor.FontSizesArray; if (itemsArray){itemsArray=itemsArray.concat([ ]); for (var oCount=0; oCount<itemsArray.length; oCount++){var oItem=itemsArray[oCount]; itemsArray[oCount]=[oItem,RadEditorNamespace.Utils.Format("\074\x66o\x6e\x74 s\x69ze={0}>",oItem)+oItem+"\074/font>"]; }}return itemsArray; } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_REAL_FONTSIZE]= function ( ){var itemsArray=editor.RealFontSizesArray; if (itemsArray){itemsArray=itemsArray.concat([ ]); for (var oCount=0; oCount<itemsArray.length; oCount++){var oItem=itemsArray[oCount]; itemsArray[oCount]=[oItem,oItem]; }}return itemsArray; } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_FONTNAME]= function ( ){var itemsArray=editor.FontNamesArray; if (itemsArray){itemsArray=itemsArray.concat([ ]); for (var oCount=0; oCount<itemsArray.length; oCount++){var oItem=itemsArray[oCount]; itemsArray[oCount]=[oItem,RadEditorNamespace.Utils.Format("\074\x73p\x61\x6e \x73\x74yl\x65=\047\x66ont:\x6eormal \x313px {\x30};\047>",oItem)+oItem+"\074/span>"]; }}return itemsArray; } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_INSERT_SYMBOL]= function ( ){var itemsArray=editor.SymbolsArray; if (itemsArray)itemsArray=itemsArray.concat([ ]); for (var oCount=0; oCount<itemsArray.length; oCount++){var oItem=itemsArray[oCount];oItem=("&"==oItem?"&amp;":oItem); itemsArray[oCount]=[oItem,oItem]; }return itemsArray; } ; this.RawDataArrays[RadEditorNamespace.RADCOMMAND_APPLY_CLASS]= function ( ){return editor.GetCssArrayForDocument(editor.Document); } ; }if (this.RawDataArrays[toolName])return this.RawDataArrays[toolName]( ); } ;
if (typeof window.RadControlsNamespace=="\165\x6edefi\x6eed"){window.RadControlsNamespace= {} ; }if (typeof(window.RadControlsNamespace.Browser)=="\x75ndef\x69\156\x65d" || typeof(window.RadControlsNamespace.Browser.Version)==null || window.RadControlsNamespace.Browser.Version<1){window.RadControlsNamespace.Browser= {Version: 1 } ; window.RadControlsNamespace.Browser.ParseBrowserInfo= function ( ){ this.IsMacIE=(navigator.appName=="\x4dicroso\x66\x74 \x49\156\x74ern\x65t Exp\x6corer") && ((navigator.userAgent.toLowerCase( ).indexOf("\x6dac")!=-1) || (navigator.appVersion.toLowerCase( ).indexOf("m\x61c")!=-1)); this.IsSafari=(navigator.userAgent.toLowerCase( ).indexOf("\x73afari")!=-1); this.IsMozilla=window.netscape && !window.opera; this.IsFirefox4=/\x46\x69\x72\x65\x66\x6f\x78\x2f\x34./.test(navigator.userAgent); this.IsNetscape=/\x4e\x65\x74\x73\x63\x61\x70\x65/.test(navigator.userAgent); this.IsOpera=window.opera; this.IsOpera9=window.opera && (parseInt(window.opera.version( ))>8); this.IsIE=!this.IsMacIE && !this.IsMozilla && !this.IsOpera && !this.IsSafari; this.IsIE9=/\x4d\x53\x49\x45\x20\x39/.test(navigator.appVersion); this.IsIE7=/\x4d\x53\x49\x45\x20\x37/.test(navigator.appVersion); this.StandardsMode=this.IsSafari || this.IsOpera9 || this.IsMozilla || document.compatMode=="CSS1Co\x6dpat"; this.IsMac=/\x4d\x61\x63/.test(navigator.userAgent); };RadControlsNamespace.Browser.ParseBrowserInfo( ); }
RadEditorNamespace.RadCommandsManager= {New:function (eventDispatcher){var obj= {} ; RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.Commands=[ ]; obj.CurrentCommandIndex=-1; obj.EventDispatcher=eventDispatcher; return obj; } ,Execute:function (command,addToStack){if (command && command.Execute){var bDone=command.Execute( ); if ( false ==addToStack)return false; if (bDone && command.CanUnexecute){ this.ClearCommandsToRedo( ); RadEditorNamespace.Utils.ArrayAdd(this.Commands,command); this.CurrentCommandIndex=this.Commands.length-1; return true; }}return false; } ,RemoveCommandAt:function (index){ this.Commands.splice(index,1); if (this.CurrentCommandIndex>=index)this.CurrentCommandIndex--; } ,ClearCommandsToRedo:function ( ){if (this.IsRedoAvailable( )){ this.Commands.splice(this.CurrentCommandIndex+1,this.Commands.length-this.CurrentCommandIndex); }} ,Undo:function (depth){depth=Math.min(RadEditorNamespace.Utils.IsNull(depth,0),this.Commands.length); var cmdCount=0; var command=null; while (0<depth-- && 0<=this.CurrentCommandIndex && this.CurrentCommandIndex<this.Commands.length){command=this.Commands[this.CurrentCommandIndex--]; if (command){command.Unexecute( ); cmdCount++; }}} ,Redo:function (depth){depth=Math.min(RadEditorNamespace.Utils.IsNull(depth,0),this.Commands.length); var cmdCount=0; var command=null; var commandIndex=this.CurrentCommandIndex+1; while (0<depth-- && 0<=commandIndex && commandIndex<this.Commands.length){command=this.Commands[commandIndex]; if (command){command.Execute( ); this.CurrentCommandIndex=commandIndex; cmdCount++; }commandIndex++; }} ,IsUndoAvailable:function ( ){return (-1<this.CurrentCommandIndex); } ,IsRedoAvailable:function ( ){return (this.CurrentCommandIndex<this.Commands.length-1); } ,GetUndoState:function ( ){return this.IsUndoAvailable( )?RadEditorNamespace.RADCOMMAND_STATE_OFF:RadEditorNamespace.RADCOMMAND_STATE_DISABLED; } ,GetRedoState:function ( ){return this.IsRedoAvailable( )?RadEditorNamespace.RADCOMMAND_STATE_OFF:RadEditorNamespace.RADCOMMAND_STATE_DISABLED; } ,GetCommandsToUndo:function ( ){if (this.IsUndoAvailable( )){return (this.Commands.slice(0,this.CurrentCommandIndex+1)).reverse( ); }else {return [ ]; }} ,GetCommandsToRedo:function ( ){if (this.IsRedoAvailable( )){return this.Commands.slice(this.CurrentCommandIndex+1); }else {return [ ]; }} ,CanRepeatLastCommand:function ( ){return ((this.CurrentCommandIndex==this.Commands.length-1) && null!=this.Commands[this.CurrentCommandIndex] && ("\x66\x75nction"==typeof(this.Commands[this.CurrentCommandIndex].Clone))); } ,RepeatLastCommand:function ( ){if (this.CanRepeatLastCommand( )){var command=this.Commands[this.CurrentCommandIndex].Clone( ); this.Execute(command); }}} ;
RadEditorNamespace.RadEditorContextMenu= {New:function (editor,contextMenuArray){var contextMenu= {} ; RadEditorNamespace.Utils.ExtendObject(contextMenu,this ); contextMenu.Editor=editor; editor.AttachEventHandler(RadEditorNamespace.RADEVENT_CONTEXTMENU, function (sender,e){if (editor.EnableContextMenus && editor.Mode==RadEditorNamespace.RADEDITOR_DESIGN_MODE){contextMenu.Show(e); return RadEditorNamespace.Utils.CancelEvent(e); }} ); contextMenu.Localization=contextMenu.Editor.Localization; contextMenu.IsIE=contextMenu.Editor.IsIE; contextMenu.IsHtmlFormContent= false; contextMenu.ImagesPath=contextMenu.Editor.SkinBasePath+"\102ut\x74ons/"; contextMenu.Popup=window["\x52adEdit\x6f\162\x50opup\x49nstanc\x65"]; contextMenu.Popup.AddStyleSheet(contextMenu.Editor.SkinBasePath+"Edit\x6fr.css"); contextMenu.SelectedValue=null; contextMenu.IsCreated= false; contextMenu.EnabledContextMenus= {} ; contextMenu.ContextMenusArray=[['\x4cOC\x41\114\x49ZE', true ,[['\x43DB','EkMen\x75',''],['\102','EkL\x6f\143a\x6cize',''],['B','\x45kLocali\x7a\x65Re\x6dove','']]],['\x54ABLE', true ,[['\x43DB','\x45kMenu',''],['B','\x54ogg\x6c\x65Ta\x62leBorde\x72',''],['B','SetTabl\x65Propert\x69\145\x73',''],['B','\x44elete\x54\x61bl\x65',''],['B','EkFi\x65\154\x64\120r\x6fp','']]],['T\x44', true ,[['CDB','EkMen\x75',''],['B','InsertR\x6fwAbove',''],['B','Insert\x52owBelow',''],['B','\x44eleteRo\x77',''],['B','Ins\x65rtColumn\x4c\145\x66t',''],['\x42','In\x73\145\x72\x74Co\x6c\165\x6dnRight',''],['\x42','\x44elete\x43\157\x6cumn',''],['\x42','\x4dergeC\x6f\154\x75\155n\x73',''],['\x42','Merge\x52\157w\x73',''],['\x53','',''],['B','SplitC\x65\154l',''],['\x42','Dele\x74\145C\x65ll',''],['\x42','S\x65tCellPro\x70\145\x72\164i\x65s',''],['\x42','\123\x65\164T\x61blePrope\x72ties',''],['\x42','Toggl\x65\124a\x62leBorder',''],['\x42','EkField\x50\162o\x70','']]],['\111\x4d\107', true ,[['\x43DB','\x45kMen\x75',''],['\x42','SetImage\x50\162\x6fperties',''],['B','\x45ktronIm\x61\x67e\x4d\157d\x69ficati\x6fnTool',''],['\x42','\x45kFie\x6c\x64P\x72op','']]],['\101', true ,[['C\x44\102','\105\x6b\x4denu',''],['\x42','SetLi\x6e\153\x50\162\x6f\x70er\x74ies',''],['B','Un\x6cink',''],['B','\x45kFieldP\x72\x6f\x70','']]],['\x2a', true ,[['\x43DB','EkMenu',''],['B','Cut',''],['B','\x43opy',''],['\x42','Paste',''],['B','Pa\x73\164e\x46\162\x6fmWordNoF\x6fntsNoS\x69zes',''],['\x42','\x50ast\x65\x50la\x69nText',''],['\102','\105\x6b\122i\x63hAreaSo\x75\162\x63e',''],['\x42','\x45\153F\x69\145\x6cdProp','']]]]; if (contextMenuArray && contextMenuArray.length>0){contextMenu.ContextMenusArray=contextMenu.ContextMenusArray.concat(contextMenuArray); }contextMenu.ContextMenus= {} ; return contextMenu; } ,IsMenuDisabled:function (tagName){return ( false ==this.EnabledContextMenus[tagName]); } ,Create:function ( ){var contextMenus=[ ]; if (this.Editor && this.Editor.ToolsArray){var objMenu=this.CreateMenuFromToolsArray("EkMe\x6eu", true ,this.Editor.ToolsArray); if (objMenu && objMenu.length>0){ this.ContextMenusArray[this.ContextMenusArray.length]=objMenu; for (var i=0; i<this.Editor.ToolsArray.length; i++){var toolbarSubMenu=this.CreateMenuFromToolsArray(this.Editor.ToolsArray[i][1], true ,this.Editor.ToolsArray[i][6]); if (toolbarSubMenu && toolbarSubMenu.length>0){ this.ContextMenusArray[this.ContextMenusArray.length]=toolbarSubMenu; for (var j=0; j<toolbarSubMenu[2].length; j++){var subTool=toolbarSubMenu[2][j]; var toolName=subTool[1]; switch (toolName){case RadEditorNamespace.RADCOMMAND_APPLY_CLASS:var DataArray=this.Editor.GetDataArrayForTool(toolName); var RawDataArraysMenu=this.CreateContextMenuArray(DataArray,toolName,"\x44at\x61\x41rr\x61\171\x5b\153\x5d.Alias"); if (RawDataArraysMenu){ this.ContextMenusArray[this.ContextMenusArray.length]=RawDataArraysMenu; }break; case "EkHt\x6dlFieldP\x72\157\x70": this.IsHtmlFormContent= true; break; }}}}}}for (var i=0; i<this.ContextMenusArray.length; i++){var curArray=this.ContextMenusArray[i]; var tagName=curArray[0].toUpperCase( ); this.EnabledContextMenus[tagName]=curArray[1]; if ( false ==curArray[1]){continue; }else {var toolsArray=curArray[2]; var oMenu=contextMenus[tagName]; if (oMenu)this.DisposeContextMenu(tagName,oMenu); contextMenus[tagName]=this.CreateContextMenu(toolsArray); }} this.ContextMenus=contextMenus; } ,CreateContextMenu:function (toolsArray){if (!toolsArray || toolsArray.length==0)return null; var oDoc=this.Popup.GetDocument( ); var table=RadEditorNamespace.Utils.GetPlainTable(oDoc); table.style.width=165; table.className="RadE\x43ontextMe\x6eu"; var tools=[ ]; var separatorCount=0; for (var i=0; i<toolsArray.length; i++){var oTool=toolsArray[i]; var toolType=oTool[0]; var toolName=oTool[1]; var row=table.insertRow(-1); var cell=row.insertCell(0); var bDropDown= false; var iconFile=null; switch (toolName){case "\x41jax\x53\160e\x6clCheck":toolType=RadEditorNamespace.TOOL_CUSTOM; iconFile=this.GetImageUrl(toolName); break; case RadEditorNamespace.RADCOMMAND_INSERT_TABLE:toolName=RadEditorNamespace.RADCOMMAND_TABLE_WIZARD; iconFile=this.GetImageUrl("InsertT\x61ble"); toolType=RadEditorNamespace.TOOL_CUSTOM; break; case RadEditorNamespace.RADCOMMAND_UNDO:case RadEditorNamespace.RADCOMMAND_REDO:iconFile=this.GetImageUrl(toolName); toolType=RadEditorNamespace.TOOL_CUSTOM; break; case RadEditorNamespace.RADCOMMAND_INSERT_SYMBOL:case RadEditorNamespace.RADCOMMAND_FORECOLOR:case RadEditorNamespace.RADCOMMAND_BACKCOLOR:iconFile=this.GetImageUrl(toolName); case RadEditorNamespace.RADCOMMAND_FORMAT_BLOCK:case RadEditorNamespace.RADCOMMAND_FONTSIZE:case RadEditorNamespace.RADCOMMAND_FONTNAME:case RadEditorNamespace.RADCOMMAND_REAL_FONTSIZE:bDropDown= true; break; case "\x45k\x46\x69eld\x50rop":if ( true ==this.IsHtmlFormContent){toolName="EkHtm\x6cFieldP\x72op"; toolType=RadEditorNamespace.TOOL_CUSTOM; }break; }if (toolType==RadEditorNamespace.TOOL_SEPARATOR){RadEditorNamespace.Utils.MakeSeparator(cell, true); cell.setAttribute("\x61li\x67\156","ce\x6e\164e\x72"); separatorCount++; }else if (toolType==RadEditorNamespace.TOOL_BUTTON){var tool=this.Editor.CreateButtonTool(toolName,this,oDoc,null,null, true ,"\x72igh\x74",toolType,i); cell.appendChild(tool.GetTopElement( )); tools[tools.length]=tool; }else {if ("\x45KMENU"==toolName.toUpperCase( ) || toolType==RadEditorNamespace.TOOL_DROP_BUTTON || toolType==RadEditorNamespace.TOOL_CUSTOM_DROP_BUTTON){toolType=RadEditorNamespace.TOOL_CUSTOM_DROP_BUTTON; if (null==iconFile){iconFile=this.GetImageUrl("\x45kMenu"); }}var tool=this.Editor.CreateButtonTool(toolName,this,oDoc,iconFile, true , true ,"\x72igh\x74",toolType,i); cell.appendChild(tool.GetTopElement( )); var me=this ; if (toolType==RadEditorNamespace.TOOL_CUSTOM){$ektron(tool.Element).click( function (e,posX,posY){var commandName=this.Tool.Name; var pDelimiter=commandName.indexOf("\x20: "); if (pDelimiter>-1){value=commandName.substr(pDelimiter+3); commandName=commandName.substr(0,pDelimiter); }if (commandName!="\x41jaxSp\x65\x6cl\x43\150\x65\143\x6b"){ this.Tool.GetSelectedValue= function ( ){return value; };}RadEditorCommandList[commandName](commandName,me.Editor,this.Tool); return RadEditorNamespace.Utils.CancelEvent(e); } ); }else if ( true ==bDropDown){$ektron(tool.Element).click( function (e,posX,posY){var dropDownMenu=null; for (var j=0; j<me.Editor.Tools.length; j++){if (this.Tool.Name==me.Editor.Tools[j].Name){dropDownMenu=me.Editor.Tools[j]; dropDownMenu.HeaderElementClick( ); return RadEditorNamespace.Utils.CancelEvent(e); }}return false; } ); }else {$ektron(tool.Element).click( function (e,posX,posY){var contextMenu=me.ContextMenus[this.Tool.Name.toUpperCase( )]; if (contextMenu && e){window["RadEd\x69torPopup\x49nstance"].SetTopElement(contextMenu.TopElement); e.posX=posX; e.posY=posY; me.Popup.ShowContextMenu(e,contextMenu.Width,contextMenu.Height,me.Editor.ContentArea); }return false; } ); }tools[tools.length]=tool; tool=null; }}var height=3+(tools.length*24)+(separatorCount*5); var contextMenu= {Tools:tools,Width: 170,Height:height,TopElement:table } ; return contextMenu; } ,DisposeContextMenu:function (tagName,contextMenu){if (contextMenu){if (contextMenu.Tools){for (var i=0; i<contextMenu.Tools.length; i++){var oTool=contextMenu.Tools[i]; if (oTool && oTool.Dispose)oTool.Dispose( ); }contextMenu.Tools=null; }contextMenu.TopElement=null; }if (this.ContextMenus)this.ContextMenus[tagName]=null; } ,Dispose:function ( ){for (var item in this.ContextMenus){var contextMenu=this.ContextMenus[item]; this.DisposeContextMenu(item,contextMenu); } this.Popup=null; this.ContextMenus=null; this.ContextMenusArray=null; this.EnabledContextMenus=null; this.SelectedValue=null; this.Editor=null; } ,Fire:function (oName,oTool){ this.Popup.Hide( ); this.Editor.Fire(oName,this ); } ,GetSelectedValue:function ( ){var selValue=this.SelectedValue; this.SelectedValue=null; return selValue; } ,Show:function (e){if (!this.IsCreated){ this.Create( ); this.IsCreated= true; }var element=e.srcElement?e.srcElement:e.target; if (null==this.Editor)return; var elemName=element.tagName; var S=$ektron(element); {if (!this.Editor.IsIE9 && "function"==typeof this.Editor.GetSelectedElement && !S.hasClass("\x64esign\x5f\164\x65xtfiel\x64")){var oSelected=this.Editor.GetSelectedElement( ); if (oSelected){element=oSelected; elemName=element.tagName; }}if ("P"==elemName){var eSelCtlElem=$ektron("\x2ede\x73\151\x67n_selec\x74\145\x64_field",element.ownerDocument); if (1==eSelCtlElem.length){element=eSelCtlElem.get(0); }}else if ("LABE\x4c"==elemName){var eDIVAncestor=S.closest("\x64iv.ektd\x65\x73i\x67\156\x6es_choi\x63es, div\x2eektdes\x69gnns\x5fchec\x6blist"); if (eDIVAncestor.length>0){element=eDIVAncestor.get(0); if (this.Editor.sfInstance){ this.Editor.sfInstance.setSelectedField(element); }}}}if (element.nodeType!=1)return; if (element.parentNode.nodeType!=1){element=element.ownerDocument.body; }var parentClassName=""; if (element.parentNode){parentClassName=element.parentNode.className; }var R= false; var Q= false; $ektron.each(parentClassName.split(/\s+/), function (i,className){switch (className){case "\x64esign_\x69\x6da\x67\145\x6fnly":case "\x64esign_fi\x6celink":case "\x64esign\x5f\143\x61\154e\x6edar":case "design_c\x6f\156t\x65nt":Q= true; return false; break; default:break; }var preClassName=className.substr(0,12); if ("ektd\x65signns_"==preClassName || "\x64\145s\x69\147\x6e\137s\x65\154\x65cted_f\x69eld"==className || "\x64esign\x5f\154\x69\163\x74\x5f"==preClassName){R= true; }} ); if (Q){return; }var elemClassName=element.className; var P= false; var bThumbnail= false; Q= false; $ektron.each((elemClassName || "").split(/\s+/), function (i,className){if ("d\x65sign_"==className.substr(0,7)){switch (className){case "design_r\x69charea":P= true; break; case "design\x5fcalcul\x61\164\x69on":case "desi\x67n_mode_d\x65sign":case "\x64es\x69\x67n_selec\x74\145\x64_field":case "\x64esign_\x72\145\x61donly":case "\144\x65\163i\x67n_textfi\x65ld":case "d\x65\x73ig\x6e\x5fme\x6d\142\x72ane":break; default:if (!R){Q= true; return false; }break; }}else if ("e\x6b\164\x72on_thum\x62\156\x61il"==className){bThumbnail= true; }} ); if (Q){return; }if ("\x49NPUT"==element.tagName && R){return; }else if ("OL"==element.tagName && R){element=element.parentNode; }var N= false; if (this.Editor.sfInstance && (this.Editor.sfInstance.isDDFieldElement(element) || this.Editor.sfInstance.isCustomTag(element))){N= true; }else if ("string"==typeof element.getAttribute("\x65ktd\x65\163i\x67nns_nam\x65")){N= true; }if ( false ==N && false ==R && !$ektron.isEditableElement(element)){return; }if (this.IsMenuDisabled(elemName)){return; }var contextMenu=this.ContextMenus[elemName]; if ("TH"==elemName && !contextMenu){contextMenu=this.ContextMenus["\x54D"]; }if ($ektron(element).hasClass("\145\x6btdesign\x6es_local\x69ze") || $ektron(element).parents( ).hasClass("\x65ktdesig\x6e\156\x73_local\x69ze")){contextMenu=this.ContextMenus["LOCALIZ\x45"]; }var contextMenuId=""; if (!contextMenu){var parent=RadEditorNamespace.Utils.GetElementParentByTag(element,"\x41"); if (!parent)parent=RadEditorNamespace.Utils.GetElementParentByTag(element,"T\x44"); if (!parent)parent=RadEditorNamespace.Utils.GetElementParentByTag(element,"\124\x41BLE"); if ($ektron.isEditableElement(parent)){contextMenuId=parent.tagName; }else {contextMenuId="\x2a"; }contextMenu=this.ContextMenus[contextMenuId]; }if (contextMenu && elemName=="IMG" && element && "t\x72ue"==element.getAttribute("\x69sf\x6c\141\x73h")){contextMenu=null; }if (contextMenu){ this.SelectedValue=element; var toolsUpdate=this.Editor.ToolsUpdate; this.Editor.ToolsUpdate= true; var oRichAreaParent=null; for (var i=0; i<contextMenu.Tools.length; i++){var tool=contextMenu.Tools[i]; var command=RadEditorNamespace.UpdateCommandsArray[tool.Name]; if (tool.Name && "Pa\x73te"==tool.Name){if ( true ==$ektron.isEditableElement(element)){tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF, true); }else {tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED, true); }}else if (tool.Name && tool.Name.indexOf("Past\x65")==0){if ( true ==$ektron.isEditableElement(element) && true ==ekCanHaveChildren(element)){if ("d\x65\163\x69\x67n"==this.Editor.ekParameters.editMode && (N || R)){tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED, true); }else if (this.Editor.IsSafari && "\x44IV"==element.tagName && null==element.parentNode){tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED, true); }else {tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF, true); }}else {tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED, true); }}else if (tool.SetState && command && command.GetState){tool.SetState(command.GetState(this.Editor.ContentWindow), true); }else if (tool.Name && tool.Name.indexOf("\x45kRich\x41\x72e\x61")==0){if (this.Editor.sfInstance){oRichAreaParent=this.Editor.sfInstance.getRichAreaParent(element); this.Editor.sfInstance.selectedField=oRichAreaParent; }if (oRichAreaParent!=null){tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF, true); }else {tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED, true); }}else if (tool.Name && tool.Name.indexOf("FieldP\x72op")>0){if (null==oRichAreaParent && (N || R)){if (this.Editor.sfInstance){if (!N && !$ektron(element).hasClass("\x64esig\x6e\137\x73elected\x5ffield")){element=$ektron(element).closest(".desig\x6e_select\x65d_field").get(0); }}if (element){ this.Editor.sfInstance.selectedField=element; tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF, true); }else {tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED, true); }}else {tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED, true); }}else if (tool.Name && "S\x65tImageP\x72operties"==tool.Name){if (N || R || bThumbnail){tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED, true); }else {tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF, true); }}else if (tool.Name && "Ekt\x72onImageM\x6f\144\x69ficati\x6fnTool"==tool.Name){if (N || R || bThumbnail || this.Editor.ekParameters.CanModifyImg!="True"){tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED, true); }else {tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF, true); }}else {tool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF, true); }} this.Editor.ToolsUpdate=toolsUpdate; if (contextMenu.TopElement)window["\x52adE\x64\x69to\x72PopupIns\x74ance"].SetTopElement(contextMenu.TopElement); this.Popup.ShowContextMenu(e,contextMenu.Width,contextMenu.Height,this.Editor.ContentArea); }else {if (!this.IsIE){ this.Popup.Hide( ); e.preventDefault( ); }return false; }} ,CreateContextMenuArray:function (DataArray,commandName,evalExp){if (DataArray){var RawDataArraysMenu=new Array(3); RawDataArraysMenu[0]=commandName; RawDataArraysMenu[1]= true; var newMenu=new Array(DataArray.length); for (var k=0; k<DataArray.length; k++){var subMenu=new Array(3); subMenu[0]=RadEditorNamespace.TOOL_CUSTOM; subMenu[1]=commandName+" \x3a "+eval(evalExp); subMenu[2]=""; newMenu[k]=subMenu; }RawDataArraysMenu[2]=newMenu; return RawDataArraysMenu; }return null; } ,CreateMenuFromToolsArray:function (toolName,enabled,subTools){var toolbarMenu=new Array(3); toolbarMenu[0]=toolName; toolbarMenu[1]=enabled; var newMenu=new Array(subTools.length); for (var i=0; i<subTools.length; i++){var subMenu=new Array(3); if ("EKMENU"==toolName.toUpperCase( ) || RadEditorNamespace.TOOL_DROP_BUTTON==subTools[i][0]){subMenu[0]=RadEditorNamespace.TOOL_CUSTOM_DROP_BUTTON; }else {subMenu[0]=subTools[i][0]; }if (subMenu[0]!=RadEditorNamespace.TOOL_SEPARATOR){subMenu[1]=subTools[i][1]; }else {subMenu[1]= false; }subMenu[2]=""; newMenu[i]=subMenu; }toolbarMenu[2]=newMenu; return toolbarMenu; } ,GetImageUrl:function (fileName){return (this.ImagesPath+fileName+".gif"); }};
RadEditorNamespace.GetCssClassServer= function (settings){if (settings && settings.localization){RadEditorNamespace.RadCssClassServer.localization=settings.localization; }return RadEditorNamespace.RadCssClassServer; } ; RadEditorNamespace.RadCssClassServer= {IsIE: (document.all && !window.opera? true : false),DocumentArray: [ ],Reset:function ( ){ this.DocumentArray=[ ]; } ,AddStyleSheet:function (sStyleSheetUrl,oDocument){TelerikNamespace.Utils.AddStyleSheet(sStyleSheetUrl,oDocument); } ,CopyStyleSheets:function (sourceDoc,targetDoc){if (null==sourceDoc && null==targetDoc)return; var counter=0; var targetStylesheet=null; if (targetDoc.styleSheets.length==0){if (targetDoc.createStyleSheet)targetDoc.createStyleSheet( ); else {css=targetDoc.createElement('\x73tyle'); css.media='\x61ll'; css.type='\x74\145\x78t/css'; var oHead=targetDoc.getElementsByTagName("\x68e\x61\x64")[0]; oHead.appendChild(css); targetStylesheet=css; }}if (targetDoc.styleSheets[0])targetStylesheet=targetDoc.styleSheets[0]; for (var i=0; i<sourceDoc.styleSheets.length; i++){try {var styleSheet=sourceDoc.styleSheets[i]; var cssHref=styleSheet.href; if (cssHref && cssHref.indexOf('\x45ditor/\x53\x6bi\x6es')>0)continue; if (cssHref && (cssHref.indexOf('Spe\x6cl/Skins')>0) && (cssHref.indexOf('Main.c\x73s')>0))continue; var arrRules=(styleSheet.rules)?styleSheet.rules:styleSheet.cssRules; for (var j=0; j<arrRules.length; j++){var oRule=arrRules[j]; if (targetStylesheet.addRule){var oText=oRule.selectorText; var oCss=oRule.style.cssText; if (oCss && oText)targetStylesheet.addRule(oText,oCss,counter); }else if (targetStylesheet.insertRule){targetStylesheet.insertRule(oRule.cssText,counter); }else {var oCss=oRule.selectorText+"{"+oRule.style.cssText+"\175"; var oNode=targetDoc.createTextNode(oCss); targetStylesheet.appendChild(oNode); }counter++; }}catch (exc){}}} ,GetCssArrayForDocument:function (oDocument,forceNew){var theDoc=oDocument!=null?oDocument:document; var serverObject=this.GetServerObjectForDocument(oDocument); if (serverObject && true !=forceNew){return serverObject.CssClassArray; }if ( true ==forceNew){for (var index=0; index<this.DocumentArray.length; index++){var curDoc=this.DocumentArray[index]; if (curDoc.Document==theDoc){ this.DocumentArray.splice(index,1); break; }}}var cssClassArray=[ ]; for (var i=0; i<theDoc.styleSheets.length; i++){try {var styleSheet=theDoc.styleSheets[i]; var cssHref=styleSheet.href?styleSheet.href: ""; cssHref=cssHref.replace(/(\x68\x74\x74\x70\x3a[^\x3a]+)\x3a\x38\x30\x2f/,"\x241/").replace(/(\x68\x74\x74\x70\x73\x3a[^\x3a]+)\x3a\x34\x34\x33\x2f/,"$\x31/"); var M=styleSheet.title; M=M.replace(/(\x68\x74\x74\x70\x3a[^\x3a]+)\x3a\x38\x30\x2f/,"$1/").replace(/(\x68\x74\x74\x70\x73\x3a[^\x3a]+)\x3a\x34\x34\x33\x2f/,"\x241/"); if (M.length>0 && -1==M.indexOf("\150\x74\164p\x3a//")){M="\x68\164t\x70\072\x2f/"+location.host+M; }if (cssHref && cssHref!=M){continue; }var arrRules=(this.IsIE)?styleSheet.rules:styleSheet.cssRules; for (var j=0; j<arrRules.length; j++){var m= true; var rule=arrRules[j]; if (rule.style && rule.style.visible){if ("false"==rule.style.visible.toLowerCase( )){m= false; }}else if (0==rule.selectorText.indexOf("\x6coca\x6c\145\x72ef.")){m= false; }else {var L=rule.selectorText.split(","); for (var k=0; k<L.length; k++){var selector=$ektron.trim(L[k]).toLowerCase( ); if ("unsel\x65ctable"==selector){m= false; }}}if (!m)continue; var oRule=RadEditorNamespace.RadCssClass.New(arrRules[j]); cssClassArray[cssClassArray.length]=oRule; }}catch (ex){}} this.DocumentArray[this.DocumentArray.length]= {Document:theDoc,CssClassArray:cssClassArray };return cssClassArray; } ,GetCssClassesByTagName:function (tagName,oDocument){var serverObject=this.GetServerObjectForDocument(oDocument); if (!serverObject){ this.GetCssArrayForDocument(oDocument); serverObject=this.GetServerObjectForDocument(oDocument); }if (!tagName){return serverObject.CssClassArray; }tagName=tagName.toUpperCase( ); var oCssClassArray=serverObject[tagName]; if (oCssClassArray!=null){try {if (oCssClassArray[0])var oText=oCssClassArray[0].Rule.selectorText; return oCssClassArray; }catch (e){ this.GetCssArrayForDocument(oDocument, true); serverObject=this.GetServerObjectForDocument(oDocument); }}var arr=[ ]; for (var i=0; i<serverObject.CssClassArray.length; i++){var rcc=serverObject.CssClassArray[i]; if (rcc.Tag.toUpperCase( )==tagName || rcc.Tag=="ALL"){arr[arr.length]=rcc; }}arr.sort(RadEditorNamespace.SortRadCssClassesArrayByTagAlias); serverObject[tagName]=arr; return arr; } ,GetServerObjectForDocument:function (oDocument){var theDoc=oDocument!=null?oDocument:document; for (var index=0; index<this.DocumentArray.length; index++){var curDoc=this.DocumentArray[index]; if (curDoc.Document==theDoc){return curDoc; }}return null; }} ; RadEditorNamespace.SortRadCssClassesArrayByTagSelectorText= function (radCssClass1,radCssClass2){if (!radCssClass1 && !radCssClass2)return 0; if (!radCssClass2)return 1; if (!radCssClass1)return -1; return radCssClass1.CompareByTagSelectorText(radCssClass2); } ; RadEditorNamespace.SortRadCssClassesArrayByTagAlias= function (radCssClass1,radCssClass2){if (!radCssClass1 && !radCssClass2)return 0; if (!radCssClass2)return 1; if (!radCssClass1)return -1; return radCssClass1.CompareByTagAlias(radCssClass2); };RadEditorNamespace.RadCssClass= {New:function (rule){var obj= {} ; RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.Rule=rule; obj.Tag=obj.GetClassTag(obj.Rule); obj.Alias=obj.GetDisplayName(obj.Rule); obj.ClassName=obj.GetClassName(obj.Rule); return obj; } ,GetClassTag:function (rule){var str=rule?rule.selectorText: ""; var lastIndex=str.lastIndexOf("\x2e"); if (lastIndex==0){return "ALL"; }var firstIndex=str.lastIndexOf(" ",lastIndex); return str.substring((firstIndex+1),lastIndex); } ,GetDisplayName:function (rule){if (!rule)return ""; var ruleSelectorText=rule.selectorText; var K=""; if (rule.style && rule.style.caption){return rule.style.caption; }if (rule.style && rule.style.localeRef){K=rule.style.localeRef; }var L=rule.selectorText.split("\054"); for (var i=0; i<L.length; i++){var selector=$ektron.trim(L[i]); if (0==selector.indexOf("\x6cocal\x65\x72e\x66.")){K=selector.substring(10); ruleSelectorText=ruleSelectorText.replace(","+L[i],""); break; }}if (K && RadEditorNamespace.RadCssClassServer.localization){var sCaption=RadEditorNamespace.RadCssClassServer.localization[K]; if (sCaption)return sCaption; }return ruleSelectorText; } ,GetClassName:function (rule){var str=rule.selectorText; var lastIndex=str.lastIndexOf("\x2e"); if (lastIndex==-1)return ""; var firstIndex=str.indexOf("\x20",lastIndex); if (-1==firstIndex)firstIndex=str.indexOf(":",lastIndex); if (-1==firstIndex)firstIndex=str.length; return str.substring((lastIndex+1),firstIndex); } ,CompareByTag:function (radCssClass){if (this.Tag!=radCssClass.Tag){if ("\101\x4c\114"==this.Tag.toUpperCase( ))return 1; else if ("\x41LL"==radCssClass.Tag.toUpperCase( ))return -1; }if (this.Tag>radCssClass.Tag)return 1; else if (this.Tag<radCssClass.Tag)return -1; return 0; } ,CompareByTagSelectorText:function (radCssClass){var res=this.CompareByTag(radCssClass); if (0!=res)return res; if (this.selectorText>radCssClass.selectorText)return 1; else if (this.selectorText<radCssClass.selectorText)return -1; else return 0; } ,CompareByTagAlias:function (radCssClass){var res=this.CompareByTag(radCssClass); if (0!=res)return res; if (this.Alias>radCssClass.Alias)return 1; else if (this.Alias<radCssClass.Alias)return -1; else return 0; }} ;
RadEditorNamespace.HighLevelEvents= {} ; RadEditorNamespace.HighLevelEvents[RadEditorNamespace.RADEVENT_MODE_CHANGED]=RadEditorNamespace.RADEVENT_MODE_CHANGED; RadEditorNamespace.HighLevelEvents[RadEditorNamespace.RADEVENT_SEL_CHANGED]=RadEditorNamespace.RADEVENT_SEL_CHANGED; RadEditorNamespace.HighLevelEvents[RadEditorNamespace.RADEVENT_CONTEXTMENU]=RadEditorNamespace.RADEVENT_CONTEXTMENU; RadEditorNamespace.HighLevelEvents[RadEditorNamespace.RADEVENT_SIZE_CHANGED]=RadEditorNamespace.RADEVENT_SIZE_CHANGED; RadEditorNamespace.HighLevelEvents[RadEditorNamespace.RADEVENT_CALLBACK_STARTED]=RadEditorNamespace.RADEVENT_CALLBACK_STARTED; RadEditorNamespace.HighLevelEvents[RadEditorNamespace.RADEVENT_DISPOSE]=RadEditorNamespace.RADEVENT_DISPOSE; RadEditorNamespace.HighLevelEvents[RadEditorNamespace.RADEVENT_SUBMIT]=RadEditorNamespace.RADEVENT_SUBMIT; RadEditorNamespace.BrowserEvents= {} ; RadEditorNamespace.BrowserEvents[RadEditorNamespace.RADEVENT_KEYDOWN]="\x6fnkeydo\x77\156"; RadEditorNamespace.BrowserEvents[RadEditorNamespace.RADEVENT_KEYUP]="onke\x79up"; RadEditorNamespace.BrowserEvents[RadEditorNamespace.RADEVENT_PASTE]="\x6fnpaste"; RadEditorNamespace.BrowserEvents[RadEditorNamespace.RADEVENT_RESIZE_START]="onres\x69zestart"; RadEditorNamespace.BrowserEvents[RadEditorNamespace.RADEVENT_RESIZE_END]="\x6fnres\x69\172\x65end"; RadEditorNamespace.BrowserEvents[RadEditorNamespace.RADEVENT_BEFORE_EDIT_FOCUS]="onbef\x6f\162\x65\145d\x69tfocus"; RadEditorNamespace.BrowserEvents[RadEditorNamespace.RADEVENT_DRAG_START]="\x6fnd\x72\x61gs\x74art"; RadEditorNamespace.BrowserEvents[RadEditorNamespace.RADEVENT_DRAG_END]="\x6fndra\x67\145\x6ed"; RadEditorNamespace.BrowserEvents[RadEditorNamespace.RADEVENT_DROP]="ondr\x6fp"; RadEditor.prototype.DetachBrowserEvents= function ( ){var srcElement=this.IsIE?this.Document.body: this.Document; if (null==srcElement)return; var handlers=this.ContentAreaEventHandlers; for (var eventName in handlers){if (typeof(handlers[eventName])=="f\x75nction"){RadEditorNamespace.Utils.DetachEventEx(srcElement,eventName,handlers[eventName]); }} this.ContentAreaEventHandlers=null; } ; RadEditor.prototype.AttachEventHandler= function (eventName,eventHandler){if (RadEditorNamespace.HighLevelEvents[eventName]){var radEvent=this.Events[eventName]; if (null==radEvent){ this.Events[eventName]=[ ]; radEvent=this.Events[eventName]; }if (null!=radEvent){if (null!=eventHandler && "funct\x69on"==typeof(eventHandler)){radEvent[radEvent.length]=eventHandler; }}}else {var evName=RadEditorNamespace.BrowserEvents[eventName]?RadEditorNamespace.BrowserEvents[eventName]:eventName; if (this.Document!=null){var srcElement=this.IsIE?this.Document.body: this.Document; this.ContentAreaEventHandlers[evName]=eventHandler; RadEditorNamespace.Utils.AttachEventEx(srcElement,evName,eventHandler); }}} ; RadEditor.prototype.DetachEventHandler= function (eventName,eventHandler){if (RadEditorNamespace.HighLevelEvents[eventName]){var radEvent=this.Events[eventName]; RadEditorNamespace.Utils.ArrayRemove(radEvent,eventHandler); }else {var srcElement=this.IsIE?this.Document.body: this.Document; var evName=RadEditorNamespace.BrowserEvents[eventName]?RadEditorNamespace.BrowserEvents[eventName]:eventName; RadEditorNamespace.Utils.DetachEventEx(srcElement,evName,eventHandler); }} ; RadEditor.prototype.FireEvent= function (eventName,e){var radEvent=this.Events[eventName]; if (null!=radEvent){for (var i=0; i<radEvent.length; i++){radEvent[i](this,e); }}} ; RadEditor.prototype.IsShortCutHit= function (e){return this.KeyboardManager.HitTest(e.keyCode,e.ctrlKey,(null!=e.ctrlLeft?e.ctrlLeft:e.ctrlKey),e.shiftKey,(null!=e.shiftLeft?e.shiftLeft:e.shiftKey),e.altKey,(null!=e.altLeft?e.altLeft:e.altKey)); } ; RadEditor.prototype.IsCursorMovingKey= function (keyCode){if (keyCode>=33 && keyCode<=40)return true; return false; } ; RadEditor.prototype.SaveTypedContent= function (retainCommand,debugInfo){if (this.PendingTextTypeCmd){ this.PendingTextTypeCmd.Update( ); }if ( true !=retainCommand){ this.PendingTextTypeCmd=null; }} ; RadEditor.prototype.InitRadEvents= function ( ){var oEditor=this ; var oFire=oEditor.Fire; oEditor.Fire= function (commandName,oTool){if (commandName!="Copy"){oEditor.SaveTypedContent( true ,"\x65dit\x6f\162\x2eFire "+commandName+"\x20executi\x6e\147"); }oFire.call(oEditor,commandName,oTool); try {if (commandName=="\x55ndo" && !oEditor.IsIE && RadEditorNamespace.Utils.Trim(oEditor.ContentArea.innerHTML.toLowerCase( ))=="\x3cb\x72\076"){oEditor.Document.body.innerHTML="\074\x62r>"; }}catch (e){} ; } ; oEditor.AttachEventHandler("\x6fnmou\x73\145\x64\157\x77\156", function ( ){oEditor.SaveTypedContent( false ,"Saving\x20typed co\x6etent on\x6dousedow\x6e"); } ); oEditor.AttachEventHandler("\157\x6e\143l\x69ck", function (e){oEditor.SaveTypedContent( false ,"Savin\x67 typed c\x6fntent b\x65cause o\x66 oclic\x6b\040\x28som\x65wher\x65 else\x29"); if (oEditor.GetSelectionHtml( )){oEditor.PendingTextTypeCmd=RadEditorNamespace.RadTextTypeCommand.New(oEditor.Localization['Typin\x67'],oEditor.ContentWindow); oEditor.ExecuteCommand(oEditor.PendingTextTypeCmd, false); }} ); this.AttachEventHandler(RadEditorNamespace.RADEVENT_SEL_CHANGED, function (oEditor,e){oEditor.OnSelectionChanged(e); } ); this.AttachEventHandler("onmouseu\x70", function (e){oEditor.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED,e); } ); this.AttachEventHandler("\157\x6e\143o\x6etextmen\x75", function (e){oEditor.FireEvent(RadEditorNamespace.RADEVENT_CONTEXTMENU,e); if (oEditor.IsIE && true ==e.cancelBubble)return false; } ); this.AttachEventHandler("o\x6edrop", function (e){oEditor.OnDrop(e); } ); this.AttachEventHandler("\x64ragdrop", function (e){oEditor.OnDrop(e); } ); RadEditorNamespace.Utils.AttachEventEx(document.body,"\157\x6edragend", function (e){oEditor.OnDocumentDragEnd(e); } ); if (!this.IsIE){oEditor.AttachEventHandler("onkeypre\x73s", function (e){if (oEditor.OnKeyPressed(e)){e.preventDefault( ); return false; }} ); oEditor.AttachEventHandler("o\x6eclick", function (e){if (!oEditor.IsEditingEnabled( ))return; if ("\x6fff"==oEditor.Document["design\x4d\157\x64e"]){window.setTimeout( function ( ){oEditor.SetEditable( true); oEditor.SetFocus( ); } ,100); }} ); } this.AttachEventHandler(RadEditorNamespace.RADEVENT_KEYDOWN, function (e){if (oEditor.IsOpera)return oEditor.OnKeyDown(e); else oEditor.OnKeyDown(e); } ); this.AttachEventHandler(RadEditorNamespace.RADEVENT_KEYUP, function (e){oEditor.OnKeyUp(e); } ); this.AttachEventHandler(RadEditorNamespace.RADEVENT_RESIZE_START, function (e){oEditor.OnResizeStart(e); } ); this.AttachEventHandler(RadEditorNamespace.RADEVENT_RESIZE_END, function (e){oEditor.OnResizeEnd(e); } ); this.AttachEventHandler(RadEditorNamespace.RADEVENT_BEFORE_EDIT_FOCUS, function (e){oEditor.OnBeforeEditFocus(e); } ); this.AttachEventHandler(RadEditorNamespace.RADEVENT_DRAG_START, function (e){oEditor.OnDragStart(e); } ); this.AttachEventHandler(RadEditorNamespace.RADEVENT_DRAG_END, function (e){oEditor.OnDragEnd(e); } ); if (!this.IsSafari){ this.AttachEventHandler("\x6fnpaste", function (e){return oEditor.OnPaste(e); } ); }} ; RadEditor.prototype.OnSelectionChanged= function (e){ this.SetToolState(this.Tools,e); } ; Ektron.RegExp.IsSingleWhitespaceCharacter=new RegExp("\x5e"+Ektron.RegExp.CharacterClass.s+"$"); Ektron.RegExp.StartsWithSingleWhitespace=new RegExp("\x5e"+Ektron.RegExp.CharacterClass.s); Ektron.RegExp.EndsWithSingleWhitespace=new RegExp(Ektron.RegExp.CharacterClass.s+"$"); RadEditor.prototype.OnKeyDown= function (e){ this.contentCache=null; var keyCode=e.keyCode; switch (keyCode){case RadEditorNamespace.KEY_DOWN:var $element=$ektron("\x74abl\x65\056\x52adE\x43ontextM\x65nu tab\x6ce.RadE\x54oolOff\x4fver\x20a",this.ContextMenu.Popup.PopupBody); var $elemDropDownMenu=$ektron("table\x20td.Ove\x72",this.ContextMenu.Popup.PopupBody); if ($element.length>0){var elementId=$element.attr("id"); var nextIndex=parseInt(elementId.replace(/\x45\x6b\x46\x6f\x63\x75\x73\x4c\x69\x6e\x6b/i,""))+1; var $nextMenu=$ektron("tab\x6ce.RadEC\x6fntextMen\x75 a#EkF\x6fcusLink"+nextIndex,this.ContextMenu.Popup.PopupBody); if (0==$nextMenu.length){nextIndex++; $nextMenu=$ektron("tabl\x65.RadECon\x74extMenu\x20\141\x23EkFocu\x73Link"+nextIndex,this.ContextMenu.Popup.PopupBody); }if ($nextMenu.length>0 && this.ContextMenu.Popup.IsVisible( )){var me=this ; setTimeout( function ( ){$ektron(".RadE\x54oolOffO\x76er",me.ContextMenu.Popup.PopupBody).removeClass("Ra\x64EToolOff\x4fver"); $nextMenu.focus( ); $nextMenu.closest("t\x61ble").removeClass("\x52adETool\x4f\146\x66").addClass("Rad\x45ToolOffO\x76er"); } ,10); return RadEditorNamespace.Utils.CancelEvent(e); }}else if ($elemDropDownMenu.length>0){ShiftFocusOnIEDropDownAtKeydownEvent(e,$elemDropDownMenu,this ); }else {$ektron("\x74able.Rad\x45ContextM\x65nu tab\x6c\145",this.ContextMenu.Popup.PopupBody).eq(0).removeClass("RadETool\x4fff").addClass("RadETo\x6f\154\x4fffOver"); }break; case RadEditorNamespace.KEY_UP:var $element=$ektron("t\x61ble.Rad\x45ContextM\x65nu tab\x6c\145\x2eRadET\x6folOffO\x76er \x61",this.ContextMenu.Popup.PopupBody); var $elemDropDownMenu=$ektron("\x74able td\x2e\117\x76er",this.ContextMenu.Popup.PopupBody); if ($element.length>0){var elementId=$element.attr("\x69d"); var nextIndex=parseInt(elementId.replace(/\x45\x6b\x46\x6f\x63\x75\x73\x4c\x69\x6e\x6b/i,""))-1; if (nextIndex<0){nextIndex=0; }var $nextMenu=$ektron("\x74a\x62\x6ce.\x52adECon\x74\145\x78tMen\x75\040\x61#EkFo\x63usLi\x6ek"+nextIndex,this.ContextMenu.Popup.PopupBody); if (0==$nextMenu.length){nextIndex--; $nextMenu=$ektron("ta\x62le.RadEC\x6fntextMe\x6e\165\x20a#EkF\x6f\143\x75\163\x4cink"+nextIndex,this.ContextMenu.Popup.PopupBody); }if ($nextMenu.length>0 && this.ContextMenu.Popup.IsVisible( )){var me=this ; setTimeout( function ( ){$ektron(".R\x61dEToolOf\x66\117\x76er",me.ContextMenu.Popup.PopupBody).removeClass("Rad\x45ToolOffO\x76\145\x72"); $nextMenu.focus( ); $nextMenu.closest("\x74abl\x65").removeClass("\x52adEToo\x6c\x4ff\x66").addClass("\x52adETool\x4f\x66fO\x76er"); } ,10); return RadEditorNamespace.Utils.CancelEvent(e); }}else if ($elemDropDownMenu.length>0){ShiftFocusOnIEDropDownAtKeydownEvent(e,$elemDropDownMenu,this ); }else {$ektron("tab\x6ce.RadECo\x6etextMenu\x20table",this.ContextMenu.Popup.PopupBody).eq(0).removeClass("Rad\x45ToolOff").addClass("\122\x61dEToolOf\x66Over"); }break; case RadEditorNamespace.KEY_RIGHT:var $elemDropDownMenu=$ektron("tabl\x65 td.Ove\x72",this.ContextMenu.Popup.PopupBody); if ($elemDropDownMenu.length>0){ShiftFocusOnIEDropDownAtKeydownEvent(e,$elemDropDownMenu,this ); }else {var $element=$ektron("tab\x6ce.RadETo\x6flOffOve\x72\040\x61",this.ContextMenu.Popup.PopupBody); if ($element.length>0 && this.ContextMenu.Popup.IsVisible( )){OpenNextPopupOnIEContextMenuKeydownEvent(e,$element); }}break; case RadEditorNamespace.KEY_LEFT:var $elemDropDownMenu=$ektron("t\x61ble td.O\x76\145\x72",this.ContextMenu.Popup.PopupBody); if ($elemDropDownMenu.length>0){ShiftFocusOnIEDropDownAtKeydownEvent(e,$elemDropDownMenu,this ); }break; case RadEditorNamespace.KEY_ENTER:var $elemDropDownMenu=$ektron("\x74able\x20\164\x64.Over",this.ContextMenu.Popup.PopupBody); if ($elemDropDownMenu.length>0 && this.ContextMenu.Popup.IsVisible( )){setTimeout( function ( ){$elemDropDownMenu.click( ); } ,1); $elemDropDownMenu.removeClass("\x4fve\x72"); return RadEditorNamespace.Utils.CancelEvent(e); }else {var $element=$ektron("\x74able.R\x61\x64ET\x6folOffOv\x65r a",this.ContextMenu.Popup.PopupBody); if ($element.length>0 && this.ContextMenu.Popup.IsVisible( )){OpenNextPopupOnIEContextMenuKeydownEvent(e,$element); }}break; case RadEditorNamespace.KEY_CONTEXT_MENU:if (this.IsSafari){if (this.EnableContextMenus && this.Mode==RadEditorNamespace.RADEDITOR_DESIGN_MODE){ this.ContextMenu.Show(e); }return RadEditorNamespace.Utils.CancelEvent(e); }break; case RadEditorNamespace.KEY_F12:case RadEditorNamespace.KEY_F10:if (!e.shiftKey && !e.ctrlKey && !e.altKey){window.focus( ); $ektron("bo\x64y",top.window.document).click( ).focus( ); $ektron("\x61").eq(0).focus( ); return RadEditorNamespace.Utils.CancelEvent(e); }else if (!e.shiftKey && e.ctrlKey && !e.altKey){var elem=(e.target?e.target:e.srcElement); var T=$ektron(elem); var currFieldId=""; var ca=null; if ("\x64a\x74\x61ent\x72y"==this.ekParameters.editMode){if (T.hasClass("\x64es\x69\147\x6e_richa\x72\145\x61")){currFieldId=T.attr("\x69d"); ca=this.ContentArea; }else if ("HTML"==elem.tagName){currFieldId=$ektron("\x62o\x64\x79",elem).attr("id"); ca=this.getContentElement( ); }}if (currFieldId!=""){var bCurrFound= false; $ektron("\x2a[e\x6b\x74de\x73\151\x67\156\x6es_name\x5d",ca).each( function (i,e){var J=$ektron(this ); if (currFieldId==J.attr("id")){bCurrFound= true; }else if ( true ==bCurrFound){bCurrFound= false; window.setTimeout( function ( ){ca.focus( ); J.focus( ); } ,1); return RadEditorNamespace.Utils.CancelEvent(e); }} ); if ( true ==bCurrFound){var curEditor=this ; window.setTimeout( function (e){curEditor.SetToolState(curEditor.Tools,null); $ektron("butt\x6fn#RadEDe\x73ignButt\x6f\156"+curEditor.Id).focus( ); } ,1); return RadEditorNamespace.Utils.CancelEvent(e); }}}break; case RadEditorNamespace.KEY_DELETE:if (this.IsOpera){ this.Document.execCommand("Dele\x74\145"); this.ContentArea.contentEditable= true; this.Document.designMode="on"; this.ContentArea.focus( ); return RadEditorNamespace.Utils.CancelEvent(e); }case RadEditorNamespace.KEY_BACK: this.ShortcutHit= false; if (this.GetSelectionHtml( )){ this.SaveTypedContent( false ,"Saving \x74yped co\x6etent bef\x6fre all\x6fwing de\x6cete to\x20pr\x6fceed.\x2e"); this.PendingTextTypeCmd=RadEditorNamespace.RadTextTypeCommand.New(this.Localization['Typing'],this.ContentWindow); this.HasDeleteExecuted= true; }if (this.IsIE){var editor=this ; var removeMedia= function ( ){var oElem=editor.GetSelectedElement( ); if (oElem && oElem.tagName=="EMBED"){oElem.setAttribute("hidden","\x74rue"); oElem.setAttribute("id","FileT\x6fDelete"); window.setTimeout( function ( ){var oElem=editor.Document.getElementById("\x46ileToDe\x6c\145\x74e"); if (oElem.parentNode && oElem.parentNode.removeChild){oElem.parentNode.removeChild(oElem); }} ,100); RadEditorNamespace.Utils.CancelEvent(e); return true; }} ; var oResult=removeMedia( ); if (oResult)return false; try {var range=editor.Document.selection.createRange( ); var newRange=null; if (range && range.duplicate)newRange=range.duplicate( ); if (RadEditorNamespace.KEY_BACK==e.keyCode)range.moveStart("\x63har\x61\143\x74er",-1); else range.moveEnd("\x63haract\x65\x72",1); if (range.parentElement( ).tagName=="\x45MBE\x44"){range.select( ); removeMedia( ); if (newRange && newRange.select){newRange.select( ); }}}catch (ex){ ; } ; if (this.Document.selection && this.Document.selection.createRange){var selRange=this.Document.selection.createRange( ); if (selRange.length>0){var ie8SavedRange=this.Document.parentWindow.ekSmartFormSelectedRange; if (parseInt($ektron.browser.version,10)>=8 && ie8SavedRange){var eSelectedElement=$ektron(".de\x73ign_sele\x63ted_fiel\x64",this.Document); if (1==eSelectedElement.length){eSelectedElement.remove( ); RadEditorNamespace.Utils.CancelEvent(e); }}else {var parentElement=selRange(0); var H=parentElement.tagName; var h=parentElement.type; if (H!="\111\x4ePUT" || ("\x49NPU\x54"==H && h!="text" && h!="\x62utton" && h!="reset" && h!="\163\x75\x62mit" && h!="")){selRange.execCommand(RadEditorNamespace.RADCOMMAND_DELETE); RadEditorNamespace.Utils.CancelEvent(e); }}}else {var eSelectedElement=$ektron("\x2edesign\x5f\163\x65lected\x5ffield",this.Document); if (1==eSelectedElement.length){eSelectedElement.remove( ); RadEditorNamespace.Utils.CancelEvent(e); }}}}else if (this.IsMozilla && "\x64at\x61\x65nt\x72\171"==this.ekParameters.editMode){var eField=$ektron(this.GetSelectedElement( )).closest("\056\x64esign_\x72icharea"); if (eField.length>0){ this.MozillaElementToUpdateOnDeleteKeyUp=eField; }return; }setTimeout( function ( ){return; } ,1000); }var srcElement=RadEditorNamespace.Utils.GetEventSource(e); var G=this.GetSelectedElement( ); if (G){var T=$ektron(G); if (0==T.children( ).length && ("P"==G.tagName || "\124\x44"==G.tagName || "LI"==G.tagName || "DIV"==G.tagName)){var strText=T.text( ); if (1==strText.length && Ektron.RegExp.IsSingleWhitespaceCharacter.test(strText) && keyCode!=RadEditorNamespace.KEY_SPACE && keyCode!=RadEditorNamespace.KEY_ENTER && !this.IsCursorMovingKey(keyCode)){ this.SelectedElementToTrimOnKeyUp=T; }}if (RadEditorNamespace.KEY_ENTER==keyCode && this.IsSafari){ this.SafariElementToUpdateOnEnterKeyUp=T; }if (RadEditorNamespace.KEY_ENTER==keyCode && this.IsIE){ this.IEElementToUpdateOnEnterKeyUp=T; }}if (!this.NewLineBr){if (RadEditorNamespace.KEY_ENTER==e.keyCode && (null==srcElement || srcElement.tagName!="TEX\x54AREA")){if (this.IsMozilla && e.preventDefault)e.preventDefault( ); }}if (this.KeyboardManager && srcElement && "\x49NPUT"!=srcElement.tagName && "\x54EXTAREA"!=srcElement.tagName && ("\x75ndef\x69\156\x65d"==typeof srcElement.isContentEditable || true ==srcElement.isContentEditable || (this.isMozilla && ("BODY"==srcElement.tagName || "HTML"==srcElement.tagName)))){var shortCut=this.IsShortCutHit(e); if (null!=shortCut && shortCut.Name==RadEditorNamespace.RADCOMMAND_COPY){ this.ShortcutHit= false; return; }if (this.ekParameters.editMode=="\x64ataen\x74\162\x79" && shortCut!=null){if (srcElement.tagName=="\x48T\x4d\x4c" && shortCut.Name==RadEditorNamespace.RADCOMMAND_TAB){RadEditorNamespace.Utils.CancelEvent(e); }} this.ShortcutHit=(null!=shortCut); if (this.ShortcutHit){ this.Fire(shortCut.Name); }else {if (this.IsCursorMovingKey(e.keyCode)){if (!this.HasCursorMoved){ this.SaveTypedContent( false ,"\123\x61ving ty\x70ed conte\x6et befo\x72e lett\x69ng the\x20\143\x75rs\x6fr \x6dove"); } this.HasCursorMoved= true; return; }if (RadEditorNamespace.KEY_SPACE==e.keyCode || RadEditorNamespace.KEY_ENTER==e.keyCode || !RadEditorNamespace.Utils.IsSystemKey(e.keyCode)){if (this.HasCursorMoved){ this.PendingTextTypeCmd=RadEditorNamespace.RadTextTypeCommand.New(this.Localization['\x54ypin\x67'],this.ContentWindow); this.ExecuteCommand(this.PendingTextTypeCmd, false); this.HasCursorMoved= false; return; }if (!this.PendingTextTypeCmd){ this.PendingTextTypeCmd=RadEditorNamespace.RadTextTypeCommand.New(this.Localization['Typing'],this.ContentWindow); this.ExecuteCommand(this.PendingTextTypeCmd, false); this.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED,e); }}}if (this.ShortcutHit){if (this.IsIE){if (shortCut.Name==RadEditorNamespace.RADCOMMAND_CUT || shortCut.Name==RadEditorNamespace.RADCOMMAND_PASTE){return; }try {e.keyCode=123; e.returnValue=!this.ShortcutHit; }catch (ex){}}}}if (this.ContextMenu.Popup.IsVisible( )){ this.ContextMenu.Popup.Hide( ); }function OpenNextPopupOnIEContextMenuKeydownEvent(e,$element){var posX=e.screenX; var posY=e.screenY; setTimeout( function ( ){$element.trigger("c\x6cic\x6b",[posX,posY]); } ,10); return RadEditorNamespace.Utils.CancelEvent(e); }function ShiftFocusOnIEDropDownAtKeydownEvent(e,$keydownElem,current){var $table=$keydownElem.closest("tab\x6ce"); var numInRow=1; if ($table.hasClass("Ra\x64EColorP\x69cker")){numInRow=6; }else if ($table.hasClass("Rad\x45SymbolPi\x63ker")){numInRow=10; }var tabIdx=$keydownElem.attr("\164\x61bIndex"); var nextIndex=GetNextIndex(e.keyCode,parseInt(tabIdx),numInRow); var $nextOpt=$ektron("\x74d[ta\x62\111\x6e\144\x65\x78=\x27"+nextIndex+"\x27]",current.ContextMenu.Popup.PopupBody); if (0==$nextOpt.length){nextIndex=GetNextIndex(e.keyCode,nextIndex,numInRow); $nextOpt=$ektron("\x74d[\x74\x61bI\x6e\144\x65x=\047"+nextIndex+"\047]",current.ContextMenu.Popup.PopupBody); }if ($nextOpt.length>0 && current.ContextMenu.Popup.IsVisible( )){var me=current; setTimeout( function ( ){$ektron("td.Ov\x65r",me.ContextMenu.Popup.PopupBody).removeClass("Over"); $nextOpt.focus( ); $nextOpt.addClass("O\x76er"); $nextOpt.get(0).scrollIntoView( false); } ,10); return RadEditorNamespace.Utils.CancelEvent(e); }}function GetNextIndex(keyCode,currentIndex,numInRow){var retIndex=currentIndex; switch (e.keyCode){case RadEditorNamespace.KEY_DOWN:retIndex=retIndex+numInRow; break; case RadEditorNamespace.KEY_UP:retIndex=retIndex-numInRow; break; case RadEditorNamespace.KEY_LEFT:retIndex=retIndex-1; break; case RadEditorNamespace.KEY_RIGHT:retIndex=retIndex+1; break; }return retIndex; }} ; RadEditor.prototype.OnKeyUp= function (e){if (this.SelectedElementToTrimOnKeyUp){var T=this.SelectedElementToTrimOnKeyUp; if (0==T.children( ).length){var strText=T.text( ); var eElemTag=T.get(0).tagName; strText=strText.replace(Ektron.RegExp.StartsWithSingleWhitespace,"").replace(Ektron.RegExp.EndsWithSingleWhitespace,""); if (strText.length>0){T.text(strText); this.contentCache=null; if (this.ContentWindow.getSelection){var sel=this.ContentWindow.getSelection( ); if (sel){sel.selectAllChildren(T.get(0)); sel.collapseToEnd( ); sel=null; }}}else if (""==strText && ("P"==eElemTag || "\x53PAN"==eElemTag)){T.remove( ); this.contentCache=null; }}else if (T.length>0){var eFirstP=$ektron("\x3afir\x73\164",T); var eFirstText=eFirstP.text( ).replace(Ektron.RegExp.StartsWithSingleWhitespace,""); var eFirstTag=eFirstP.get(0).tagName; if (""==eFirstText && ("\x50"==eFirstTag || "\123\x50AN"==eFirstTag)){eFirstP.remove( ); }var strHtml=T.html( ); T.html(strHtml.replace(/^(\s*[\x3c][^\x3e]*[\x3e])*\s*((\x26\x6e\x62\x73\x70\x3b)|(\x26\x23\x31\x36\x30\x3b))/i,"$1")); this.contentCache=null; if (strHtml.length>0){if (this.ContentWindow.getSelection){var sel=this.ContentWindow.getSelection( ); if (sel){sel.selectAllChildren(T.get(0)); sel.collapseToEnd( ); sel=null; }}}} this.SelectedElementToTrimOnKeyUp=null; }if (this.IsSafari && RadEditorNamespace.KEY_ENTER==e.keyCode){if (this.SafariElementToUpdateOnEnterKeyUp){var T=this.SafariElementToUpdateOnEnterKeyUp; var eElemByEnter=T.next("p"); if (0==eElemByEnter.length){eElemByEnter=$ektron(T).next("\x64iv"); if (eElemByEnter.length>0 && "\074\142r\x3e"==eElemByEnter.html( )){var replaceNode=this.Document.createElement("p"); replaceNode.innerHTML="&#160;"; T.after(replaceNode); eElemByEnter.remove( ); eElemByEnter=$ektron(replaceNode); }}else if (eElemByEnter.length>0 && "\x3cbr\x3e"==eElemByEnter.html( )){eElemByEnter.html("&\x23160;"); }if (this.ContentWindow.getSelection){var sel=this.ContentWindow.getSelection( ); if (sel){sel.selectAllChildren(eElemByEnter.get(0)); sel=null; }} this.SafariElementToUpdateOnEnterKeyUp=null; }}if (this.IEElementToUpdateOnEnterKeyUp){var T=this.IEElementToUpdateOnEnterKeyUp; this.IEElementToUpdateOnEnterKeyUp=null; if (T.length>0){if (""==T.html( ) && ekCanHaveChildren(T.get(0)))T.html("&#160\x3b"); var eNext=T.next( ); if (!eNext.hasClass("\x64e\x73\x69gn_dynl\x69st_cont\x61iner")){if (""==T.next( ).html( ))T.next( ).html("&#160\x3b"); }}}if (this.MozillaElementToUpdateOnDeleteKeyUp){var T=this.MozillaElementToUpdateOnDeleteKeyUp; if (ekCanHaveChildren(T.get(0))){var richhtml=T.html( ); var richtext=T.text( ); var IsBlankMozParagraph=new RegExp("\x5e\134s*(\074p>)*(\074\142\x72>|\074\x62r/>\x29*(\074\x5c/p>\x29*\134\x73*$","\x69"); if (IsBlankMozParagraph.test(richhtml) || Ektron.RegExp.IsBlankWhitespace.test(richtext)){T.html("&\x23160;"); }}} this.MozillaElementToUpdateOnDeleteKeyUp=null; if (this.HasDeleteExecuted){ this.ExecuteCommand(this.PendingTextTypeCmd); this.PendingTextTypeCmd=null; this.HasDeleteExecuted= false; return; }if (this.PendingTextTypeCmd){return; }if (this.PendingCommand){ this.ExecuteCommand(this.PendingCommand); this.PendingCommand=null; }if (this.ShortcutHit){ this.ShortcutHit= false; return false; } this.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED,e); } ; RadEditor.prototype.OnKeyPressed= function (e){ this.contentCache=null; if (this.PendingTextTypeCmd){}else { this.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED,e); }if (this.ShortcutHit && !this.PendingCommand){return true; }} ; RadEditorNamespace.InsertPastedContent= function (restorePoint,editor,dirtyText,oEvent,selectionExists){var cleanedText=dirtyText; var element=oEvent.srcElement?oEvent.srcElement:oEvent.target; var T=$ektron(element,editor.ContentWindow); if (restorePoint)restorePoint.Select( ); if (cleanedText){window.setTimeout( function ( ){if (selectionExists && restorePoint)restorePoint.Select( ); editor.PasteHtml(cleanedText); window.setTimeout( function ( ){editor.onContentPaste( ); if (null==editor.SelectedElementToTrimOnKeyUp){if (0==T.children( ).length){var strText=T.text( ); var eElemTag=T.get(0).tagName; strText=strText.replace(Ektron.RegExp.StartsWithSingleWhitespace,"").replace(Ektron.RegExp.EndsWithSingleWhitespace,""); if (strText.length>0){T.text(strText); editor.contentCache=null; editor.Document.parentWindow.ekSmartFormSelectedRange=null; }else if (""==strText && ("\x50"==eElemTag || "SPAN"==eElemTag)){T.remove( ); editor.contentCache=null; }}else if (T.length>0){var eFirstP=$ektron(":first",T); var eFirstText=eFirstP.text( ).replace(Ektron.RegExp.StartsWithSingleWhitespace,""); var eFirstTag=eFirstP.get(0).tagName; if (""==eFirstText && ("\x50"==eFirstTag || "SPAN"==eFirstTag)){eFirstP.remove( ); }var strHtml=T.html( ); T.html(strHtml.replace(/^(\s*[\x3c][^\x3e]*[\x3e])*\s*((\x26\x6e\x62\x73\x70\x3b)|(\x26\x23\x31\x36\x30\x3b))/i,"\x241")); editor.contentCache=null; editor.Document.parentWindow.ekSmartFormSelectedRange=null; }}} ,1); } ,5); return RadEditorNamespace.Utils.CancelEvent(oEvent); }return true; } ; RadEditor.prototype.OnPaste= function (oEvent){ this.contentCache=null; if (this.ClearPasteFormatting==RadEditorNamespace.CLEAR_PASTE_FORMATTING_NONE_SUPRESS_MESSAGE)return; var element=oEvent.srcElement?oEvent.srcElement:oEvent.target; if ("\x66\x75ncti\x6fn"==typeof this.GetSelectedElement){var oSelected=this.GetSelectedElement( ); if (oSelected){element=oSelected; }}if (element && ("INPUT"==element.tagName || "\x54EXT\x41\122\x45A"==element.tagName))return; var restorePoint=this.CreateRestorePoint( ); var selectionExists=this.GetSelectionHtml( )? true : false; var dirtyText=this.GetClipboardAsHtml( ); return RadEditorNamespace.InsertPastedContent(restorePoint,this,dirtyText,oEvent,selectionExists); } ; RadEditor.prototype.OnResizeStart= function (e){var targetElement=this.GetSelectedElement( ); if (targetElement==e.srcElement){ this.PendingResizeCmd=RadEditorNamespace.RadGenericCommand.New(this.Localization[RadEditorNamespace.RADCOMMAND_RESIZE],this.ContentWindow); }} ; RadEditor.prototype.OnResizeEnd= function (e){if (this.PendingResizeCmd){ this.ExecuteCommand(this.PendingResizeCmd); }} ; RadEditor.prototype.OnBeforeEditFocus= function (e){if (e && e.srcElement && "BODY"!=e.srcElement.tagName){if (null!=(this.TargetEditElement=this.GetSelectedElement( ))){ this.oldEditValue=this.TargetEditElement.value; } this.StartEditElementText=(null!=this.TargetEditElement && null!=this.oldEditValue); }else if (this.StartEditElementText){}} ; RadEditor.prototype.OnDragStart= function (e){ this.PendingMoveCommand=RadEditorNamespace.RadGenericCommand.New(this.Localization[RadEditorNamespace.RADCOMMAND_MOVE],this.ContentArea); this.startRange=null; try {if (!e.ctrlKey && !e.ctrlLeft){ this.startRange=this.ContentWindow.document.selection.createRange( ); if (this.startRange.length){var rng=this.ContentWindow.document.body.createTextRange( ); var elementToMove=this.startRange.item(0); if ("\x49MG"==elementToMove.tagName && "\101"==elementToMove.parentNode.tagName){elementToMove=elementToMove.parentNode; }rng.moveToElementText(elementToMove); this.startRange=rng; }}}catch (ex){}} ; RadEditor.prototype.OnDragEnd= function (e){ this.contentCache=null; if (this.PendingMoveCommand){if (this.startRange){try {var newPos=this.ContentWindow.document.selection.createRange( ); if (newPos.length){var rng=this.ContentWindow.document.body.createTextRange( ); rng.moveToElementText(newPos.item(0)); newPos=rng; }try {if (newPos.compareEndPoints && 0!=newPos.compareEndPoints("\x53tartToS\x74\141\x72t",this.startRange) && 0!=newPos.compareEndPoints("EndT\x6fEnd",this.startRange)){ this.startRange.execCommand("Del\x65te", false ,null); }}catch (e){ ; }}catch (ex){}} this.ExecuteCommand(this.PendingMoveCommand); this.PendingMoveCommand=null; this.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED,null); }} ; RadEditor.prototype.OnDrop= function (e){ this.contentCache=null; this.SaveTypedContent( false ,"\x6fn \x64\x72op\x20operat\x69\157\x6e ex\x65cuting"); var sTitle=this.Localization[RadEditorNamespace.RADEVENT_DROP] || "\x44rop ex\x74\145\x72\156\x61\x6c \x63ontent"; this.PendingDockCommand=RadEditorNamespace.RadGenericCommand.New(sTitle,this.ContentWindow); } ; RadEditor.prototype.OnDocumentDragEnd= function (e){ this.contentCache=null; if (!this.PendingDockCommand)return; this.ExecuteCommand(this.PendingDockCommand); this.PendingDockCommand=null; this.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED,null); } ;
RadEditorNamespace.RadEditorFiltersManager= {New:function ( ){var obj= {} ; RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.Filters=[ ]; obj.IsEnabled= true; return obj; } ,EnableDomFilters:function (enable){for (var i=0; i<this.Filters.length; i++){var filter=this.Filters[i]; if (filter.IsDom)filter.IsEnabled=enable; }} ,SetEnabled:function (toEnable){ this.IsEnabled=toEnable; } ,Clear:function ( ){ this.Filters=[ ]; } ,Add:function (filter){ this.Filters[this.Filters.length]=filter; } ,AddAt:function (filter,index){ this.Filters.splice(index,0,filter); } ,RemoveAt:function (index){return this.Filters.splice(index,1); } ,GetFilterAt:function (index){return this.Filters[index]; } ,GetDesignContent:function (initialContent){if (!this.IsEnabled)return initialContent; var content=initialContent; for (var i=0; i<this.Filters.length; i++){var filter=this.Filters[i]; if ((filter.IsEnabled!= false) && filter.GetDesignContent){content=filter.GetDesignContent(content); }}return content; } ,GetHtmlContent:function (initialContent){if (!this.IsEnabled)return initialContent; var content=initialContent; for (var i=0; i<this.Filters.length; i++){var filter=this.Filters[i]; if (( false !=filter.IsEnabled) && filter.GetHtmlContent){content=filter.GetHtmlContent(content); }}return content; } ,GetPreviewContent:function (initialContent){if (!this.IsEnabled)return initialContent; var content=initialContent; for (var i=0; i<this.Filters.length; i++){var filter=this.Filters[i]; if (( false !=filter.IsEnabled) && filter.GetPreviewContent){content=filter.GetPreviewContent(content); }}return content; }} ; RadEditorNamespace.RadEditorMozillaFlashStart= function (editor){ this.MaintainPathsPartOne= function (content){content=content.replace(new RegExp("\x3cembed(\x5c\x73(\x5b\136\x3e])\x2a?)?>","\151\x67"),"\074\x69mg is\x66lash=\042\164r\x75e\042\x20$1 \x2f>"); return content; } ; this.GetDesignContent= function (content){window.setTimeout( function ( ){if (!editor || !editor.ContentArea)return; var children=editor.ContentArea.getElementsByTagName("IMG"); for (var i=0; i<children.length; i++){var currentChild=children[i]; var originalAttribute=currentChild.getAttribute("isfl\x61sh"); if (originalAttribute!=null){currentChild.setAttribute("\x66lashS\x72\143",currentChild.getAttribute("s\x72c")); currentChild.setAttribute("\x73rc",editor.GetImageUrl("FlashM\x61nager.\x67if")); }}} ,10); return this.MaintainPathsPartOne(content); } ; };RadEditorNamespace.RadEditorMozillaFlashEnd= function (editor){ this.MaintainPathsPartTwo= function (content){if (!content)return null; var children=content.getElementsByTagName("\x49MG"); for (var i=0; i<children.length; i++){var currentChild=children[i]; var originalAttribute=currentChild.getAttribute("\x69sflas\x68"); if (originalAttribute!=null){var flashSrc=currentChild.getAttribute("flashSr\x63"); var outerHTML=RadEditorNamespace.Utils.GetOuterHtml(currentChild); outerHTML=outerHTML.replace("\074img","\074\x65m\x62\145\x64"); var oDiv=currentChild.ownerDocument.createElement("DIV"); oDiv.innerHTML=outerHTML; newNode=oDiv.firstChild; newNode.src=flashSrc; newNode.removeAttribute("flash\x53rc"); newNode.removeAttribute("isflash"); var parNode=currentChild.parentNode; parNode.insertBefore(newNode,currentChild); parNode.removeChild(currentChild); i--; }}return content; } ; this.GetHtmlContent= function (content){alert("Con\x74ent1 "+editor.GetHtml( false)); this.MaintainPathsPartTwo(editor.ContentArea); alert("\103\x6fntent2\x20"+editor.GetHtml( false)); return editor.GetHtml( false); } ; };RadEditorNamespace.RadMozillaContentFilter= function ( ){var m_reStrongTag=new RegExp("\074stron\x67(\134\x73([^>])*\x3f)?>","ig"); var m_reEmTag=new RegExp("\074\x65m(\x5c\x73([\x5e\076\x5d)*?)?>","\x69g"); var m_reBTag=new RegExp("\x3cb(\134\x73([^>\x5d)*?)?>","\x69g"); var m_reITag=new RegExp("\074i(\134\x73([^>])\x2a\077\x29?>","ig"); this.GetDesignContent= function (content){var newContent=content.replace(m_reStrongTag,"\074\x62$\x31\x3e").replace(/\x3c\x2f\x73\x74\x72\x6f\x6e\x67\x3e/gi,"\x3c/\x62\x3e"); newContent=newContent.replace(m_reEmTag,"\x3ci$1>").replace(/\x3c\x2f\x65\x6d\x3e/gi,"\074/i>"); return newContent; } ; this.GetHtmlContent= function (content){var newContent=content.replace(m_reBTag,"\074strong$1\x3e").replace(/\x3c\x2f\x62\x3e/gi,"\x3c/st\x72\157\x6eg>"); newContent=newContent.replace(m_reITag,"\x3cem$\x31\x3e").replace(/\x3c\x2f\x69\x3e/gi,"\x3c/e\x6d\076"); return newContent; } ; };function RadSafariStripFilter( ){ this.Name="RadS\x61fariStri\x70Filter"; this.GetDesignContent=null; this.GetPreviewContent=null; this.GetHtmlContent= function (initContent){var xhtml=initContent; var re=new RegExp(' clas\x73=\042khtml-b\x6cock-pla\x63eholde\x72\042',"ig"); xhtml=xhtml.replace(re,""); xhtml=xhtml.replace(new RegExp(' class\x3d\042\x6bhtm\x6c-block-\x70laceho\x6c\144\x65r\042',"ig"),""); xhtml=xhtml.replace(new RegExp(' class\x3d\042\x41p\x70\154\x65\055\x73tyle-s\x70an\042',"ig"),""); return xhtml; };}
; function RadStripPathFilter(tagName,pathToStrip){ this.Name="R\x61dStripPa\x74hFilter"; this.Description="This f\x69lter str\x69\160\x73\040\x61n ima\x67\145\x20or an \x61ncho\x72 path"; this.TagName=tagName; this.PathToStrip=pathToStrip; this.GetHtmlContent= function (initContent){if (!document.all)return initContent; else {var oContent=StripAbsolutePaths(initContent,this.TagName,this.PathToStrip); return oContent; }return initContent; } ; function StripAbsolutePaths(initContent,tagName,pathToStripString){var performStripping= function (content,tagName,attribName,pathToStrip){pathToStrip=RadEditorNamespace.Utils.EscapeRegexSpecialChars(pathToStrip); var reUrlReplacer=new RegExp("\x28\074"+tagName+"\x5b^\074>]*?("+attribName+")\134\x73*=\134\x73*[\047\x22])\x28"+pathToStrip+")([^\047\x22]*?\x5b\047\x22][^>]*\x3f\076\x29","\x69g"); return content.replace(reUrlReplacer,"$1$4"); } ; var stripper= function (initContent,tagName,pathToStrip){if (tagName=="\x41"){var basePageUrl=document.location.href; basePageUrl=RadEditorNamespace.Utils.EscapeRegexSpecialChars(basePageUrl); var re=new RegExp("(\074A[^\074>]*?(hr\x65f)\134\x73*=\134\163*\x5b\047\x22])("+basePageUrl+"\x29(\134\043\x5b^\047\x22]*?[\x27\042\x5d[^>]*?\x3e)","\x69g"); initContent=initContent.replace(re,"\x241$4"); }var oFinal=initContent; var attribName=(tagName=="\101"?"\x68ref": "\x73rc"); for (var i=0; i<pathToStrip.length; i++){if (pathToStrip[i])oFinal=performStripping(oFinal,tagName,attribName,pathToStrip[i]); }return oFinal; } ; var pathsArray=[ ]; if (pathToStripString){if (pathToStripString.indexOf(" ")>-1){pathsArray=pathToStripString.split("\x20"); }else pathsArray[0]=pathToStripString; }else {var Location=window.location; pathsArray[0]=Location.protocol+"//"+Location.host; }return stripper(initContent,tagName,pathsArray); } ; }function RadStripScriptsFilter( ){ this.Name="RadS\x74ripScri\x70tTagsFil\x74er"; this.Description="\123\x74\162i\x70s SCRIPT\x20tags i\x6e\040\x74he ed\x69\164\x6fr co\x6etent"; this.GetPreviewContent=null; this.PerformStripping= function (initContent){var re=new RegExp("\074(SCRIP\x54)([^>]*\x29/>","ig"); initContent=initContent.replace(re,""); re=new RegExp("\074(SCR\x49\120\x54\051\x28[^>]*)\x3e[\134\x73\134\x53]*?\074\057\x28SC\x52IPT)([\x5e>]*)>","ig"); initContent=initContent.replace(re,""); re=new RegExp("\x3c([^>]\x2a\051\x28run\x61\164\x5cs*=\134\x73*\042\077\x73erver\x22?)([\x5e>]*)>","\x69g"); var result=re.exec(initContent); initContent=initContent.replace(re,"&l\x74;"+RegExp.$1+RegExp.$2+RegExp.$3+"\x26gt;"); initContent=initContent.replace("\x3c"+"%","&l\x74\073\x25"); initContent=initContent.replace("%>","\x25&gt;"); return initContent; };this.GetHtmlContent= function (initContent){return this.PerformStripping(initContent); };this.GetDesignContent= function (initContent){return this.PerformStripping(initContent); };this.GetPreviewContent= function (initContent){return this.PerformStripping(initContent); };}function RadFont2SpanFilter( ){ this.IsDom= true; this.Name="RadFont2\x53panFilt\x65\162"; this.Description="\x43on\x76\x65rt\x73\040\x46ONTs t\x6f SPANs"; this.GetPreviewContent=null; this.FontSizes=["\x38pt","\x310pt","\x312pt","\x314pt","18pt","\x324pt","36pt"]; this.FontSizesRev=[ ]; for (var i=0; i<this.FontSizes.length; i++){ this.FontSizesRev[parseInt(this.FontSizes[i])]=i; } this.GetHtmlContent= function (initContent){var element=document.createElement("\x53P\x41\x4e"); RadEditorNamespace.SetElementInnerHTML(element,initContent); var span0=document.createElement("\x53PAN"); var span,font,parentNode; var fonts=element.getElementsByTagName("FONT"); while (fonts.length>0){font=fonts[0]; parentNode=font.parentNode; span=span0.cloneNode( false); span.style.cssText=font.style.cssText; if (font.className){span.className=font.className; }if (font.face){span.style.fontFamily=font.face; }var size=0; if (font.style.fontSize){span.style.fontSize=font.style.fontSize; }else if (!isNaN(size=parseInt(font.size))){try {span.style.fontSize=this.FontSizes[size-1]; }catch (ex){span.style.fontSize=this.FontSizes[3]; }}if (font.color){span.style.color=font.color; }if (document.all && font.innerHTML==' '){span.innerText=font.innerHTML; }else {RadEditorNamespace.SetElementInnerHTML(span,font.innerHTML); }parentNode.replaceChild(span,font); fonts=element.getElementsByTagName("F\x4fNT"); }return element.innerHTML; };this.GetDesignContent= function (initContent){var element=document.createElement("\x44IV"); RadEditorNamespace.SetElementInnerHTML(element,initContent); var font0=document.createElement("FONT"); var span,font,parentNode; var spans=element.getElementsByTagName("\x53PAN"); while (spans.length>0){span=spans[0]; parentNode=span.parentNode; font=font0.cloneNode( false); font.style.cssText=span.style.cssText; if (span.className){font.className=span.className; }if (span.style.fontFamily){font.face=span.style.fontFamily; if (document.all){font.style.removeAttribute('fon\x74Family'); }else {font.style.fontFamily=null; }}if (span.style.fontSize){var size=3; var _size=this.FontSizesRev[parseInt(span.style.fontSize)]; if (typeof(_size)!='\x75nde\x66\x69ne\x64'){font.size=_size+1; RadEditorNamespace.Utils.RemoveElementStyleAttribute(font,"\x66ontSize"); }}if (span.style.color){if (document.all){font.color=span.style.color; font.style.removeAttribute('c\x6flor'); }}if (document.all && span.innerHTML==' '){font.innerText=span.innerHTML; }else {RadEditorNamespace.SetElementInnerHTML(font,span.innerHTML); }parentNode.replaceChild(font,span); spans=element.getElementsByTagName("\123\x50AN"); }return element.innerHTML; };}
RadEditorNamespace.RadKeyboardManager= {New:function (eventDispatcher){var obj= {} ; obj.Shortcuts=[ ]; RadEditorNamespace.Utils.ExtendObject(obj,this ); return obj; } ,AddShortcut:function (shortcutName,shortcutString){var rs=RadEditorNamespace.RadShortcut.New(shortcutName,shortcutString); rs.HashValue=this.GetShortcutHashValue(rs); this.Shortcuts[rs.HashValue]=rs; } ,RemoveShortcut:function (shortcutName){var shortcut=this.FindByName(shortcutName); if (shortcut){ this.Shortcuts[shortcut.HashValue]=null; }} ,SetShortcut:function (shortcutName,shortcutString){ this.RemoveShortcut(shortcutName); this.AddShortcut(shortcutName,shortcutString); } ,HitTest:function (keyCode,ctrlKey,leftCtrlKey,shiftKey,leftShiftKey,altKey,leftAltKey){var hashValue=this.GetHashValue(keyCode,ctrlKey,leftCtrlKey,shiftKey,leftShiftKey,altKey,leftAltKey); return this.Shortcuts[hashValue]; } ,GetHashValue:function (keyCode,ctrlKey,leftCtrlKey,shiftKey,leftShiftKey,altKey,leftAltKey){var value=keyCode&65535; var flags=0; flags |= (ctrlKey?RadEditorNamespace.KF_CTRL: 0); flags |= (shiftKey?RadEditorNamespace.KF_SHIFT: 0); flags |= (altKey?RadEditorNamespace.KF_ALT: 0); value |= (flags<<16); return value; } ,GetShortcutHashValue:function (radShortcut){return this.GetHashValue(radShortcut.KeyCode,radShortcut.CtrlKey,radShortcut.LeftCtrlKey,radShortcut.ShiftKey,radShortcut.LeftShiftKey,radShortcut.AltKey,radShortcut.LeftAltKey); } ,FindByName:function (shortcutName){var shortcut; for (var shortcutKey in this.Shortcuts){shortcut=this.Shortcuts[shortcutKey]; if (null!=shortcut && shortcut.Name==shortcutName){return shortcut; }}return null; }} ; RadEditorNamespace.RadShortcut= {New:function (shortcutName,shortcutString){var obj= {} ; RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.Name=shortcutName; obj.SetShortcut(shortcutString); return obj; } ,CtrlKey: false ,LeftCtrlKey: false ,ShiftKey: false ,LeftShiftKey: false ,AltKey: false ,LeftAltKey: false ,KeyCode: 0,SetShortcut:function (shortcutString){ this.ParseShortcutString(shortcutString); } ,ParseShortcutString:function (shortcutString){if ("strin\x67"==typeof(shortcutString)){ this.CtrlKey= false; this.LeftCtrlKey= false; this.ShiftKey= false; this.LeftShiftKey= false; this.AltKey= false; this.LeftAltKey= false; this.KeyCode=0; shortcutString=shortcutString.replace(/\s*/gi,""); shortcutString=shortcutString.replace(/\x2b\x2b/gi,"\x2bPLUS"); var tokens=shortcutString.split("+"); var token=""; for (var i=0; i<tokens.length; i++){token=tokens[i].toUpperCase( ); switch (token){case "LC\x54RL": this.LeftCtrlKey= true; case "CTRL": this.CtrlKey= true; break; case "LSHI\x46T": this.LeftShiftKey= true; case "\x53HIFT": this.ShiftKey= true; break; case "\x4cALT": this.LeftAltKey= true; case "\x41LT": this.AltKey= true; break; case "F1": this.KeyCode=RadEditorNamespace.KEY_F1; break; case "\x462": this.KeyCode=RadEditorNamespace.KEY_F2; break; case "\x463": this.KeyCode=RadEditorNamespace.KEY_F3; break; case "\x464": this.KeyCode=RadEditorNamespace.KEY_F4; break; case "F\x35": this.KeyCode=RadEditorNamespace.KEY_F5; break; case "\x466": this.KeyCode=RadEditorNamespace.KEY_F6; break; case "\x467": this.KeyCode=RadEditorNamespace.KEY_F7; break; case "\x468": this.KeyCode=RadEditorNamespace.KEY_F8; break; case "F9": this.KeyCode=RadEditorNamespace.KEY_F9; break; case "\x4610": this.KeyCode=RadEditorNamespace.KEY_F10; break; case "\x4611": this.KeyCode=RadEditorNamespace.KEY_F11; break; case "\x4612": this.KeyCode=RadEditorNamespace.KEY_F12; break; case "ENTER": this.KeyCode=RadEditorNamespace.KEY_ENTER; break; case "\x48OM\x45": this.KeyCode=RadEditorNamespace.KEY_HOME; break; case "END": this.KeyCode=RadEditorNamespace.KEY_END; break; case "\x4cEFT": this.KeyCode=RadEditorNamespace.KEY_LEFT; break; case "\x52IGHT": this.KeyCode=RadEditorNamespace.KEY_RIGHT; break; case "UP": this.KeyCode=RadEditorNamespace.KEY_UP; break; case "\x44OWN": this.KeyCode=RadEditorNamespace.KEY_DOWN; break; case "\x50AGEUP": this.KeyCode=RadEditorNamespace.KEY_PAGEUP; break; case "\x50AGEDO\x57\116": this.KeyCode=RadEditorNamespace.KEY_PAGEDOWN; break; case "\x53PA\x43\x45": this.KeyCode=RadEditorNamespace.KEY_SPACE; break; case "\x54AB": this.KeyCode=RadEditorNamespace.KEY_TAB; break; case "B\x41CK": this.KeyCode=RadEditorNamespace.KEY_BACK; break; case "\x43ONTEXT": this.KeyCode=RadEditorNamespace.KEY_CONTEXT_MENU; break; case "\x45SCAPE":case "ESC": this.KeyCode=RadEditorNamespace.KEY_ESC; break; case "DEL\x45TE":case "\x44\105L": this.KeyCode=RadEditorNamespace.KEY_DELETE; break; case "INSERT":case "INS": this.KeyCode=RadEditorNamespace.KEY_INSERT; break; case "PLU\x53": this.KeyCode="\x2b".charCodeAt(0); break; default: this.KeyCode=token.charCodeAt(0); break; }}}else { throw {description: "\x49nval\x69\144\x20shortc\x75\164\x20str\x69ng" } ; }}};
RadEditorNamespace.RadEditorPopup= function ( ){ this.Window=window; this.IsIE=(document.all? true : false); this.IsSafari=TelerikNamespace.Utils.DetectBrowser("\x73\x61far\x69"); this.ContextMenuClass="Rad\x45ContextM\x65nu"; this.DropdownClass="\x52adEDro\x70\144\x6fwnMenu"; this.LastDropdownOwner=null; this.CurrentTopElement=null; this.Popup=null; this.PopupBody=null; this.Disposed= false; this.Create( ); };RadEditorNamespace.RadEditorPopup.prototype= {Dispose:function ( ){if (this.Disposed)return; if (this.Document.body)this.Document.body.innerHTML=""; this.Popup=null; this.PopupBody=null; this.Document=null; this.LastDropdownOwner=null; this.CurrentTopElement=null; this.Disposed= true; } ,GetDocument:function ( ){if (!this.Document){ this.Create( ); }return this.Document; } ,CreatePopup:function ( ){return this ; } ,SetClassName:function (className){ this.DropdownClass=className; } ,IsVisible:function ( ){if (this.Popup.isOpen!=null){return this.Popup.isOpen; }else {if (this.Popup && this.Popup.style)return (parseInt(this.Popup.style.width)>0); return false; }} ,CreateElement:function (tagName){return this.GetDocument( ).createElement(tagName); } ,SetTopElement:function (element){ this.CurrentTopElement=element; } ,AddStyleSheet:function (sStyleSheetUrl){TelerikNamespace.Utils.AddStyleSheet(sStyleSheetUrl,this.GetDocument( )); } ,ShowContextMenu:function (e,width,height,element){var x=this.IsIE?e.screenX:e.pageX; var y=this.IsIE?e.screenY:e.pageY; var element=(e.target?e.target:e.srcElement); element=element.ownerDocument.body; x+=10; y+=10; this.OnBeforeShow( false); if (this.Popup.show && this.Popup.tagName!="IFRAME"){if (isNaN(x) || isNaN(y)){x=e.posX+10; y=e.posY+10; }if ((y+height)>window.screen.height){y=window.screen.height-height; } this.Popup.show(x,y,width,height); }else {var oPos=this.GetElementPosition(element); x+=oPos.X; y+=oPos.Y; if ((y+height)>this.Window.innerHeight){y-=(y+height-this.Window.innerHeight+10); } this.ShowPopupMozilla(x,y,width,height, false); }if (e && e.preventDefault)e.preventDefault( ); var me=this ; window.setTimeout( function ( ){$ektron(".R\x61dEToolO\x66fOver",me.PopupBody).removeClass("\x52ad\x45\124\x6f\157\x6cOffOve\x72"); var win=$ektron("iframe.\x52adEMozi\x6claDropd\x6fwnIfram\x65").get(0); if (win){win.focus( ); var $elem=$ektron("\x74able.\x52\x61d\x45\103\x6fntextM\x65nu a",me.PopupBody); if ($elem.length>0){$elem.get(0).focus( ); $elem.eq(0).closest("\x74abl\x65").addClass("\x52\141\x64\105\x54oolOffO\x76\145\x72"); }$elem.keydown( function (e){switch (e.keyCode){case RadEditorNamespace.KEY_DOWN:var element=e.srcElement?e.srcElement:e.target; var elementId=element.getAttribute("id"); var nextIndex=parseInt(elementId.replace(/\x45\x6b\x46\x6f\x63\x75\x73\x4c\x69\x6e\x6b/i,""))+1; var $nextMenu=$ektron("\x74able\x2e\122\x61dEConte\x78\164\x4denu a#\x45\153\x46\157\x63usLi\x6ek"+nextIndex,me.PopupBody); if (0==$nextMenu.length){nextIndex++; $nextMenu=$ektron("\x74ab\x6c\x65.R\x61dEConte\x78\164\x4denu a#\x45kFocus\x4cink"+nextIndex,me.PopupBody); }if ($nextMenu.length>0 && me.IsVisible( )){$ektron("\056\x52adETo\x6f\154\x4f\146\x66Over",me.PopupBody).removeClass("RadEToo\x6c\117\x66\146\x4f\166e\x72"); $nextMenu.focus( ); $nextMenu.closest("t\x61\142\x6ce").addClass("\x52adETo\x6f\154\x4fffOver"); return RadEditorNamespace.Utils.CancelEvent(e); }break; case RadEditorNamespace.KEY_UP:var element=e.srcElement?e.srcElement:e.target; var elementId=element.getAttribute("id"); var nextIndex=nextIndex=parseInt(elementId.replace(/\x45\x6b\x46\x6f\x63\x75\x73\x4c\x69\x6e\x6b/i,""))-1; if (nextIndex<0){nextIndex=0; }var $nextMenu=$ektron("ta\x62le.RadEC\x6fntextMe\x6eu a#Ek\x46ocusLin\x6b"+nextIndex,me.PopupBody); if (0==$nextMenu.length){nextIndex--; $nextMenu=$ektron("\x74able.\x52\141\x64EContex\x74Menu a#\x45kFocus\x4c\151\x6ek"+nextIndex,me.PopupBody); }if ($nextMenu.length>0 && me.IsVisible( )){$ektron(".Ra\x64EToolOff\x4fver",me.PopupBody).removeClass("R\x61dEToolOf\x66\117\x76\145r"); $nextMenu.focus( ); $nextMenu.closest("\x74able").addClass("\x52adE\x54\x6fol\x4fffOver"); return RadEditorNamespace.Utils.CancelEvent(e); }break; case RadEditorNamespace.KEY_ENTER:case RadEditorNamespace.KEY_RIGHT:var $element=$ektron("\x74abl\x65\x2eRa\x64\105\x54oolO\x66fOver",me.PopupBody); if ($element.length>0 && me.IsVisible( )){setTimeout( function ( ){$element.click( ); } ,10); return RadEditorNamespace.Utils.CancelEvent(e); }break; case RadEditorNamespace.KEY_ESC:if (me.IsVisible( )){me.Hide( ); }break; }} ); }else {var $elem=$ektron("table\x2eRadECon\x74extMenu\x20\141",me.PopupBody); setTimeout( function ( ){me.Document.parentWindow.focus( ); $elem.eq(0).closest("ta\x62le").removeClass("\x52adEToo\x6c\x4ff\x66").addClass("\122\x61dEToolO\x66fOver").focus( ); } ,1); }} ,1); return false; } ,ShowDropdown:function (width,height,element,scrollable,automaticHeight){var x=0; var y=element?element.offsetHeight: 0; this.OnBeforeShow( true ,width,height); if (this.Popup.show && this.Popup.tagName!="IF\x52AME"){if (!scrollable){if (this.CurrentTopElement && this.CurrentTopElement.parentNode)this.CurrentTopElement.parentNode.style.overflow="\150\x69dde\x6e"; } this.Popup.show(x,y,width+2,height+2,element); }else {var oPos=$ektron(element).offset( ); x+=oPos.left; y+=oPos.top; var eSpellUI=$ektron("div.Rad\x45SpellU\x49\127\x72apper"); if (eSpellUI.length>0){var oSpellPos=eSpellUI.offset( ); x+=oSpellPos.left; y+=oSpellPos.top+eSpellUI[0].offsetHeight; } this.ShowPopupMozilla(x,y,width+2,height+3,scrollable); }var me=this ; window.setTimeout( function ( ){$ektron("\x74d.Ove\x72",me.PopupBody).removeClass("\117\x76er"); var win=$ektron("iframe.\x52adEMoz\x69\154\x6caDrop\x64ownIfra\x6de").get(0); if (win){win.focus( ); var $elem=$ektron("tab\x6ce td",me.PopupBody); if ($elem.length>0){$elem.get(0).focus( ); $elem.eq(0).closest("\x74d").addClass("\x4fver"); }$elem.keydown( function (e){var objDropDown=this.Parent; switch (e.keyCode){case RadEditorNamespace.KEY_DOWN:case RadEditorNamespace.KEY_UP:case RadEditorNamespace.KEY_LEFT:case RadEditorNamespace.KEY_RIGHT:me.ShiftFocusOnMozillaDropDownAtKeydownEvent(e,me); return RadEditorNamespace.Utils.CancelEvent(e); break; case RadEditorNamespace.KEY_ENTER:var $element=$ektron("td.O\x76er",me.PopupBody); if ($element.length>0 && me.IsVisible( )){setTimeout( function ( ){$element.click( ); } ,1); $element.removeClass("\x4fver"); return RadEditorNamespace.Utils.CancelEvent(e); }break; case RadEditorNamespace.KEY_ESC:if (me.IsVisible( )){me.Hide( ); }break; }} ); }else {var $elem=$ektron("\x74able \x74\144",me.PopupBody); setTimeout( function ( ){if ($elem.length>0){$elem.eq(0).addClass("\x4fver").focus( ); }} ,1); }} ,1); return false; } ,MozillaFindFixedParent:function (elem){if (!elem)return null; do {var style=document.defaultView.getComputedStyle(elem,null); if (style && "\x66ixed"==style.position)return elem; }while ((elem=elem.parentNode)!=null && elem.tagName!="B\x4fDY" && elem.tagName!="\x48\124M\x4c"); return null; } ,OnBeforeShow:function (isDropdown,width,height){var body=this.PopupBody; if (body && body.childNodes.length>0){var children=body.childNodes; for (var i=0; i<children.length; i++){body.removeChild(children[i]); }}var div=this.Document.createElement("DIV"); div.className="\x43ont\x65\156t\x45lement"; if (this.CurrentTopElement)div.appendChild(this.CurrentTopElement); if (isDropdown){body.className=this.DropdownClass; if (this.IsIE){div.style.height=height; div.style.width=width; div.style.overflow="\x61uto"; }}else {body.className=this.ContextMenuClass; div.style.overflow="h\x69dden"; }if (this.IsIE){body.style.border="1px sol\x69d #777\x37\0677"; }body.appendChild(div); } ,Create:function ( ){if (this.Window.createPopup){ this.Popup=this.Window.createPopup( ); this.Document=this.Popup.document; this.PopupBody=this.Document.body; }else { this.CreatePopupMozilla( ); }} ,CreatePopupMozilla:function ( ){var iframe=this.Window.document.createElement('\151\x66rame'); var oDiv=this.Window.document.createElement('\x64i\x76'); var topElement=null; {topElement=iframe; this.Window.document.body.appendChild(iframe); iframe.src='a\x62out:blan\x6b'; }iframe.frameBorder='0'; iframe.style.width="\x3100%"; iframe.style.height="100%"; topElement.style.position='\x61bsolu\x74\145'; topElement.style.zIndex=51200; topElement.style.width="\x30px"; topElement.style.height="0px"; topElement.className="\x52ad\x45\x4doz\x69llaDropd\x6fwnIfra\x6de"; var doc=iframe.contentWindow.document; doc.open( ); doc.writeln('\x3chead>\x3c\x73t\x79\154\x65>\074\057\x73tyle>\x3c\057\x68ead>\x3cbody\x3e\074\x2fbod\x79>'); doc.close( ); this.Popup=topElement; this.Document=iframe.contentWindow.document; this.ContentWindow=iframe.contentWindow; var oDoc=this.Document; if (!this.Document.body){oBody=oDoc.createElement("b\x6fdy"); oDoc.appendChild(oBody); this.PopupBody=this.Document.getElementsByTagName("bo\x64y")[0]; }else { this.PopupBody=this.Document.body; }if (oDoc.getElementsByTagName("hea\x64").length<1){var oHead=oDoc.createElement("head"); oHead.style.visibility="\x68idden"; this.PopupBody.parentNode.insertBefore(oHead,this.PopupBody); } this.PopupBody.style.margin='\x30px'; this.PopupBody.style.padding='\x30px'; } ,ShowPopupMozilla:function (x,y,width,height,scrollable){var visibleWidth=0; var visibleHeight=0; var canvas=document.body; var compatMode=!((RadControlsNamespace.Browser.IsMozilla || RadControlsNamespace.Browser.IsIE) && document.compatMode!="CSS1\x43ompat"); if (compatMode && !RadControlsNamespace.Browser.IsSafari){canvas=document.documentElement; }if (window.innerWidth){visibleWidth=window.innerWidth; visibleHeight=window.innerHeight; }else {visibleWidth=canvas.clientWidth; visibleHeight=canvas.clientHeight; }visibleWidth=innerWidth; visibleHeight=innerHeight; this.Popup.style.zIndex=51200; if (visibleWidth>x+width){ this.Popup.style.left=x+"px"; }else {var xpos=x-width; if (xpos<0)xpos=0; this.Popup.style.left=xpos+"px"; }if (visibleHeight>y+height){ this.Popup.style.top=y+"px"; }else {var ypos=y-17-height; if (ypos<0)ypos=0; this.Popup.style.top=ypos+"\x70x"; }width=parseInt(width)+"px"; height=parseInt(height)+"\160\x78"; this.Popup.width=width; this.Popup.height=height; this.Popup.style.width=width; this.Popup.style.height=height; borderWidth=( true ==this.ShownAlready)?1: 0; this.ShownAlready= true; this.Popup.style.border=borderWidth+"\x70x s\x6f\154i\x64 black"; if ( false ==scrollable){ this.Popup.style.overflow="\150\x69dden"; this.PopupBody.style.overflow="\x68id\x64\x65n"; var oWidth=this.PopupBody.firstChild.scrollWidth+"px"; if (parseInt(oWidth)>0){ this.Popup.width=oWidth; this.Popup.style.width=oWidth; }}else {var oParent=this ; var oFun= function ( ){oParent.Popup.style.overflow="hidd\x65n"; if (oParent.Popup.clientHeight>=oParent.PopupBody.scrollHeight){oParent.PopupBody.style.overflow="h\x69dden"; }else {oParent.Popup.style.overflow="\x61uto"; if (oParent.PopupBody.firstChild)oParent.PopupBody.firstChild.style.overflow="\x61ut\x6f"; }} ; oFun( ); if (!this.ResizeHandlerAttached && scrollable!= false){ this.PopupBody.addEventListener("\x6douse\x64\x6fw\x6e", function (e){window.setTimeout(oFun,100); } , true); this.ResizeHandlerAttached= true; }} this.PopupBody.focus( ); } ,Hide:function ( ){if (this.Popup.hide && this.Popup.tagName!="IF\x52AME"){ this.Popup.hide( ); }else { this.LastDropdownOwner=null; this.Popup.style.width="0px"; this.Popup.style.height="0px"; this.Popup.style.border="\x30px \x73\157\x6cid red"; this.PopupBody.innerHTML=""; }} ,IsMozillaPopupVisible:function (e){var popup=this.Popup; if (!popup)return false; try {if (0==parseInt(popup.style.width))return false; if ((e.pageX<parseInt(popup.style.left)) || (e.pageX>parseInt(popup.style.left)+parseInt(popup.style.width)) || (e.pageY<parseInt(popup.style.top)) || (e.pageY>parseInt(popup.style.top)+parseInt(popup.style.height))){ this.Hide( ); }}catch (ex){}} ,GetElementPosition:function (el){var origEl=el; var c= {X: 0,Y: 0 } ; while (el){c.X+=el.offsetLeft; c.Y+=el.offsetTop; if (el.offsetParent==null && el.ownerDocument.defaultView!=this.Window){c.X-=el.ownerDocument.defaultView.scrollX; c.Y-=el.ownerDocument.defaultView.scrollY; el=el.ownerDocument.defaultView.frameElement; }else {var $el=$ektron(el); if ("\111\x46RAME"==el.tagName && $el.hasClass("\x63ontented\x69table")){$cWin=$el.closest("div\x2edesign_m\x6fde_entr\x79"); if (1==$cWin.length){c.Y-=$cWin.scrollTop( ); }}c.X-=$el.scrollLeft( ); c.Y-=$el.scrollTop( ); el=el.offsetParent; }} ; if (window.opera)return c; try {}catch (e){} ; return c; } ,ShiftFocusOnMozillaDropDownAtKeydownEvent:function (e,current){var element=e.srcElement?e.srcElement:e.target; var $elem=$ektron(element); var $table=$elem.closest("tabl\x65"); var numInRow=1; if ($table.hasClass("\122\x61dECol\x6frPicker")){numInRow=6; }else if ($table.hasClass("R\x61dESymbo\x6cPicker")){numInRow=10; }var tabIdx=$elem.attr("\x74abInde\x78"); var nextIndex=GetNextIndex(e.keyCode,parseInt(tabIdx),numInRow); var $nextOpt=$ektron("td[\x74abIndex\x3d\047"+nextIndex+"\x27]",current.PopupBody); if (0==$nextOpt.length){nextIndex=GetNextIndex(e.keyCode,nextIndex,numInRow); $nextOpt=$ektron("td[tabIn\x64ex=\047"+nextIndex+"\x27]",current.PopupBody); }if ($nextOpt.length>0 && current.IsVisible( )){$ektron("\x74d.Over",current.PopupBody).removeClass("\x4fve\x72"); $nextOpt.focus( ); $nextOpt.addClass("\x4fver"); }function GetNextIndex(keyCode,currentIndex,numInRow){var retIndex=currentIndex; switch (e.keyCode){case RadEditorNamespace.KEY_DOWN:retIndex=retIndex+numInRow; break; case RadEditorNamespace.KEY_UP:retIndex=retIndex-numInRow; break; case RadEditorNamespace.KEY_LEFT:retIndex=retIndex-1; break; case RadEditorNamespace.KEY_RIGHT:retIndex=retIndex+1; break; }return retIndex; }} ,GetCoords:function (node){var coords=new Array(0,0); if (node.offsetParent){while (node.offsetParent){coords[0]+=node.offsetLeft; coords[1]+=node.offsetTop; node=node.offsetParent; if (node==document.body){coords[0]-=node.offsetLeft; coords[1]-=node.offsetTop; }}}return coords; }} ; Ektron.ready( function ( ){if (!window["\x52adEd\x69\164\x6frPopupI\x6estance"]){window["RadEdi\x74orPopup\x49\156\x73\164\x61nce"]=new RadEditorNamespace.RadEditorPopup( ); }if (window.addEventListener){var g= function (e){window["RadE\x64itorPop\x75pInstan\x63\145"].IsMozillaPopupVisible(e); } ; var attachedFrames=[ ]; function HasAttachedHandler(oWnd){for (var i=0; i<attachedFrames.length; i++){if (attachedFrames[i]==oWnd){return true; }}return false; }function mouseDownHandler( ){var windowFrames=window.frames; for (var i=0; i<windowFrames.length; i++){if (window["Rad\x45ditorPop\x75pInstan\x63\145"].ContentWindow==windowFrames[i]){continue; }else if (HasAttachedHandler(window["Rad\x45ditorPop\x75\160\x49nstan\x63e"].ContentWindow)){continue; }try {windowFrames[i].window.addEventListener("mousedo\x77n",g, true); }catch (ex){}attachedFrames[attachedFrames.length]=windowFrames[i].window; }if (window["RadE\x64itorPopu\x70Instance"].HasMozillaHandlerAttached)return; window["\x52adEdito\x72\x50o\x70\165\x70Instanc\x65"].HasMozillaHandlerAttached= true; window.document.addEventListener("\x6dousedow\x6e",g, false); }window.addEventListener("load",mouseDownHandler, false); mouseDownHandler( ); }} ); RadEditorNamespace.Utils.AttachEventEx(window,"u\x6eload", function ( ){var oWnd=window["\x52adEdito\x72\120\x6fpupIns\x74ance"]; if (oWnd && oWnd.Dispose)oWnd.Dispose( ); } );
RadEditorNamespace.RadCreateRestorePoint= function (oWindow){if (!oWindow)return null; if (!oWindow.document)return null; if (oWindow.document.all && !window.opera){return RadEditorNamespace.RadRestorePointIE.New(oWindow); }else {return RadEditorNamespace.RadRestorePointMoz.New(oWindow); }};RadEditorNamespace.RadRestorePointIE= {New:function (oWindow){var restorePoint= {} ; RadEditorNamespace.Utils.ExtendObject(restorePoint,this ); restorePoint.Document=oWindow.document; restorePoint.Update( ); return restorePoint; } ,Update:function ( ){if (null==this.Document)return; if (null==this.Document.body)return; this.HtmlText=this.Document.body.innerHTML; var selRange=ekCreateRange(this.Document.selection); if (selRange){if (selRange.length){ this.SourceIndex=selRange.item(0).sourceIndex; }else { this.StartBookmark=selRange.getBookmark( ); }}} ,Restore:function (collapseToEnd){RadEditorNamespace.SetElementInnerHTML(this.Document.body,this.HtmlText); this.Select(collapseToEnd); } ,Select:function (collapseToEnd){if (null==this.Document)return; if (null==this.Document.body)return; if (null!=this.SourceIndex){var selRange=this.Document.body.createControlRange( ); selRange.addElement(this.Document.all(this.SourceIndex)); try {selRange.select( ); }catch (ex){}}else if (null!=this.StartBookmark){var selRange=this.Document.body.createTextRange( ); selRange.moveToBookmark(this.StartBookmark); selRange.select( ); if ( true ==collapseToEnd && selRange.collapse)selRange.collapse( ); }}};RadEditorNamespace.RadRestorePointMoz= {New:function (oWindow){var restorePoint= {} ; RadEditorNamespace.Utils.ExtendObject(restorePoint,this ); restorePoint.Window=oWindow; restorePoint.Update( ); return restorePoint; } ,Restore:function ( ){ this.Window.document.body.innerHTML=this.HtmlText; this.Select( ); } ,Select:function ( ){try { this.Window.focus( ); this.MoveToBookmark(this.Window.getSelection( ),this.Bookmark); }catch (ex){}} ,BookmarkSelection:function (oSelection){return {anchorNodeBookmark:RadEditorNamespace.RadNodeBookmark.New(this.Window,oSelection.anchorNode),anchorOffset:oSelection.anchorOffset,focusNodeBookmark:RadEditorNamespace.RadNodeBookmark.New(this.Window,oSelection.focusNode),focusOffset:oSelection.focusOffset,isCollapsed:oSelection.isCollapsed } ; } ,MoveToBookmark:function (oSelection,oBookmark){var anchorNode=oBookmark.anchorNodeBookmark.Select( ); var focusNode=oBookmark.focusNodeBookmark.Select( ); oSelection.collapse(anchorNode,oBookmark.anchorOffset); if (!oBookmark.isCollapsed){oSelection.extend(focusNode,oBookmark.focusOffset); }} ,Update:function ( ){try { this.HtmlText=this.Window.document.body.innerHTML; this.Bookmark=this.BookmarkSelection(this.Window.getSelection( )); }catch (ex){}}};RadEditorNamespace.RadNodeBookmark= {New:function (window,node){var bookmark= {} ; RadEditorNamespace.Utils.ExtendObject(bookmark,this ); bookmark.Window=window; bookmark.NodePath=bookmark.FindNodePath(bookmark.Window.document.body,node); return bookmark; } ,Select:function ( ){var node=this.FindNode(this.Window.document.body,this.NodePath); try {RadEditorNamespace.Utils.SelectElement(this.Window,node); }catch (ex){}return node; } ,FindNodePath:function (parent,node){var n,res; for (var i=0; i<parent.childNodes.length; i++){n=parent.childNodes[i]; res=this.FindNodePath(n,node);if (""!=res){return ""+i+"\x2c"+res; }if (n==node)return ""+i; }return ""; } ,FindNode:function (parent,nodePath){var arr=nodePath.split(","); for (var i=0; i<arr.length; i++){parent=parent.childNodes[arr[i]]; }return parent; }};
RadEditorNamespace.RadSelection= {New:function (oWindow){var obj= {} ; RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.Window=oWindow; return obj; } ,GetRange:function ( ){if (typeof this.Window.getSelection!="\x75\x6edefine\x64"){var theSelection=this.Window.getSelection( ); if (!theSelection){return null; }var rng=null; if (theSelection.getRangeAt && theSelection.rangeCount>0){rng=theSelection.getRangeAt(0); }else {rng=this.Window.document.createRange( ); }return rng; }else if (this.Window.document.selection && !window.opera){return ekCreateRange(this.Window.document.selection); }} ,GetParentElement:function ( ){var rng=this.GetRange( ); if (!rng)return null; try {if (rng.commonAncestorContainer){var theSelection=this.Window.getSelection( ); var startContainer=rng.startContainer?rng.startContainer:theSelection.baseNode; var endContainer=rng.endContainer?rng.endContainer:theSelection.extentNode; var startOffset=rng.startOffset!=null?rng.startOffset:theSelection.baseOffset; var endOffset=rng.endOffset!=null?rng.endOffset:theSelection.extentOffset; if (startContainer==endContainer && (endOffset-startOffset)==1){var oNode=theSelection.anchorNode.childNodes[theSelection.anchorOffset]; if (!oNode)return theSelection.anchorNode; if (!oNode.tagName)return oNode.parentNode; return oNode; }else {var selElem=rng.commonAncestorContainer; var eSelCtlElem=$ektron(".desig\x6e_sel\x65cted_\x66ield",selElem); if (1==eSelCtlElem.length){return eSelCtlElem.get(0); }else {if (!rng.commonAncestorContainer.tagName){if (this.Window.document==rng.commonAncestorContainer && theSelection.baseNode){return theSelection.baseNode.parentNode; }return rng.commonAncestorContainer.parentNode; }else {return rng.commonAncestorContainer; }}}}else if (rng.length){return rng.item(0); }else if (rng.parentElement){return rng.parentElement( ); }else {return null; }}catch (ex){return null; }} ,IsControl:function ( ){if (this.Window.document.selection){return (this.Window.document.selection.type=='Con\x74rol');}else {var oSel=this.Window.getSelection( ); if (oSel.toString( )!=''){return false;}var oFocusNode=oSel.focusNode; if (oFocusNode.nodeType==1){return false; }return (oFocusNode.tagName=='\x49MG'); }} ,GetText:function ( ){if (this.Window.document.selection){var rng=this.Window.document.selection.createRange( ); if (rng.length){return ""; }else if (null!=rng.text){return rng.text; }}else if (this.Window.getSelection){return this.Window.getSelection( ).toString( ); }else {return ""; }} ,GetHtmlText:function ( ){if (this.Window.document.selection && !window.opera){var rng=this.Window.document.selection.createRange( ); if (rng.length){return Ektron.Xml.serializeXhtml(rng.item(0)); }else if (rng.htmlText){return Ektron.Xml.serializeXhtml($ektron("\x3cd\x69\166\x3e"+rng.htmlText+"\x3c/div\x3e").get(0).childNodes); }else {return ""; }}else if (this.Window.getSelection){var selection=this.Window.getSelection( ); var rng=null; if (selection.getRangeAt){if (selection.rangeCount>0){rng=selection.getRangeAt(0); }else {return ""; }var clonedFragment=rng.cloneContents( ); return Ektron.Xml.serializeXhtml(clonedFragment); }else {return selection; }}else {return ""; }} ,Collapse:function (toStart){toStart=(toStart== true); if (this.Window.document && this.Window.document.selection){var rng=this.Window.document.selection.createRange( ); if (rng.collapse){rng.collapse(toStart); rng.select( ); }}else if (this.Window.getSelection){var selection=this.Window.getSelection( ); if (selection && !selection.isCollapsed){if (toStart){selection.collapseToStart( ); }else {selection.collapseToEnd( ); }}}} ,F:function (oDocument){if ($ektron.browser.msie){try {var objEkContentArea=oDocument.getElementById("design_\x63ontent"); if (null==objEkContentArea){objEkContentArea=oDocument.body; }var oSelElem=null; if ("\x66uncti\x6f\156"==typeof getSelectionElement){oSelElem=getSelectionElement(oDocument); }if (null==oSelElem){oSelElem=oDocument.activeElement; }if (oSelElem!=null){if (!oSelElem.isContentEditable || !objEkContentArea.contains(oSelElem)){oSelElem=null; }}if (null==oSelElem){if (objEkContentArea.isContentEditable){oSelElem=objEkContentArea; oSelElem.setActive( ); }else {for (var i=0; i<objEkContentArea.all.length; i++){oSelElem=objEkContentArea.all[i]; if (oSelElem.isContentEditable){oSelElem.setActive( ); if (oSelElem==oDocument.activeElement){oSelElem.focus( ); break; }}}}}objEkContentArea=null; oSelElem=null; }catch (ex){Ektron.OnException(this,Ektron.ContentDesigner.onexception,ex,arguments); }}}} ;
RadEditorNamespace.ServerRenderingInitializer= function (editor,makeToolbarsDockable){editor.Tools=[ ]; editor.Toolbars=[ ]; editor.ToolbarsCreated= false; var fnCreateToolbarOriginal=editor.CreateEditorToolbar; var fnCreteToolOriginal=editor.CreateEditorTool; var currentToolbarTable=null; var currentToolCounter=0; var isRibbonToolbar= false; var nextToolCell=0; editor.CreateEditorToolbar= function (toolbarId,toolbarName,zoneId,isDockable,forElement,isRibbon){var oToolbar=fnCreateToolbarOriginal.call(editor,toolbarId,toolbarName,zoneId,isDockable,forElement); currentToolbarTable=document.getElementById(toolbarId); currentToolbarTable.setAttribute("\x75nselect\x61\142\x6ce","on"); currentToolbarTable.onselectstart=new Function("retu\x72n fals\x65;"); currentToolbarTable.ondragstart=new Function("return \x66alse;"); if (editor.IsSafari)currentToolbarTable.setAttribute("onm\x6fusedown","\x72etu\x72\156\x20false;"); currentToolbarTable.style.display=RadEditorNamespace.DockableObjectDisplay; nextToolCell=0; currentToolCounter=0; isRibbonToolbar=isRibbon; oToolbar.Create(currentToolbarTable); if (isRibbon || (editor.EnableDocking && isDockable && ( false !=makeToolbarsDockable))){oToolbar.IsRibbon=isRibbon; oToolbar.IsDockable=isRibbon? false :isDockable; var parentNode=currentToolbarTable.parentNode; var oWrapper=oToolbar.ConfigureToolbarWrapper( ); }return oToolbar; } ; var GetToolElement= function ( ){if (currentToolbarTable.rows.length==1){return currentToolbarTable.rows[0].cells[currentToolCounter].firstChild; }else if (isRibbonToolbar){var rowLength=currentToolbarTable.rows[0].cells.length; if (nextToolCell>rowLength-1){var oCell=currentToolbarTable.rows[1].cells[nextToolCell-rowLength]; oChild=oCell.firstChild; }else oChild=currentToolbarTable.rows[0].cells[nextToolCell].firstChild; nextToolCell++; return oChild; }else {return currentToolbarTable.rows[currentToolCounter].cells[0].firstChild; }} ; editor.CreateEditorTool= function (toolInfo){var oTool=null; var toolType=toolInfo[0]; var toolCommand=toolInfo[1]; if (toolType!="\x53"){var oTool=fnCreteToolOriginal.call(editor,toolInfo); var oToolElement=GetToolElement( ); if (oTool){oTool.Create(oToolElement); if (toolType!="\102"){if (oToolElement && oToolElement.rows && oToolElement.rows[0] && oToolElement.rows[0].cells){var oRow=oToolElement.rows[0]; if (oRow.cells[0]){var oCell1=oRow.cells[0]; var oFC=oCell1.firstChild; oTool.HeaderElement=oFC; oFC.setAttribute("unsel\x65ctable","o\x6e"); oTool.IconContainer=oCell1; oTool.IconContainer.onclick=RadEditorNamespace.OnComboHeaderClick; }if (oRow.cells[1]){var oCell2=oRow.cells[1]; oTool.ArrowElement=oCell2; oCell2.setAttribute("\165\x6eselecta\x62le","on"); oTool.ArrowElement.onclick=RadEditorNamespace.OnComboArrowClick; }}if (toolType==RadEditorNamespace.TOOL_CUSTOM && RadEditorToolInitializer && RadEditorToolInitializer[toolCommand]){var toolArgs= {} ; toolArgs.GetController= function ( ){return editor; } ; try {tool=RadEditorToolInitializer[toolCommand](toolArgs); var oNewElem=tool.Create( ); oToolElement.parentNode.replaceChild(oNewElem,oToolElement); }catch (e){ ; }}}else {oTool.Element.onclick=new Function("\x52adEdi\x74\157\x72Names\x70\141\x63e.On\x54oolCli\x63k.call\x28this\x29; re\x74urn f\x61lse;"); }}}currentToolCounter++; return oTool; } ; editor.CreateEditorToolbars(editor.ToolsArray); var oImages=editor.WrapperElement.getElementsByTagName("\x69mg"); for (var i=0; i<oImages.length; i++){var oImg=oImages[i]; oImg.setAttribute("unse\x6cectable","\x6fn"); oImg.ondragstart=new Function("retu\x72n fals\x65;"); }editor.CreateEditorToolbar=fnCreateToolbarOriginal; editor.CreateEditorTool=fnCreteToolOriginal; } ;
RadEditorNamespace.RadToolbar= {New:function (args){var obj= {} ; RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.Document=args.Document; obj.Id=args.Id; obj.Title=args.Title; obj.IsDockable=args.IsDockable!=null?args.IsDockable: false; obj.ZoneId=args.ZoneId!=null?args.ZoneId: ""; obj.Tools=[ ]; obj.IsRibbon=(args.IsRibbon== true); return obj; } ,Dispose:function ( ){ this.Document=null; this.Element=null; } ,WrapInRibbonContainer:function (oElem,oTitle){var doc=document; var oTable=doc.createElement("\164abl\x65"); oTable.border=0; oTable.cellSpacing=0; oTable.cellPadding=0; oTable.setAttribute("unsele\x63table","\x6fn"); oRow=oTable.insertRow(-1); oCell=oRow.insertCell(-1); oCell.appendChild(oElem); var oRow=oTable.insertRow(-1); var oCell=oRow.insertCell(-1); var oSpan=doc.createElement("\x73pan"); oSpan.className="RadAu\x74oDockBu\x74ton"; oSpan.innerHTML="&n\x62sp;&nbsp\x3b&nbsp;"; oCell.appendChild(oSpan); oCell.innerHTML+=(oTitle?"\x26nbsp;"+oTitle: ""); oCell.setAttribute("n\x6fWrap","\x74rue"); oCell.className="\x52adET\x69\x74l\x65Grip"; return oTable; } ,GetRibbonToolbarLength:function (oTools){var len=0; for (var i=0; i<oTools.length; i++){if (!oTools[i].Create)continue; len++; }len=Math.ceil(len/2); return len; } ,Create:function (newElement){if (this.IsRibbon){ this.IsVertical= false; this.IsDockable= false; }if (null==newElement && !this.Element){var oTable=RadEditorNamespace.Utils.GetPlainTable(this.Document); oTable.setAttribute("\x6fnm\x6f\165\x73edown","\x72eturn fa\x6c\163\x65;"); if (!this.IsVertical)oTable.insertRow(-1); var tools=this.Tools; var ribbonRowLength=this.GetRibbonToolbarLength(tools); var oCount=0; for (var i=0; i<tools.length; i++){var oCell=null; var oTool=tools[i]; if (this.IsRibbon && !oTool.Create){continue; }else oCount++; oCell=this.CreateToolCell(oTable); if (!oTool.Create){oCell.innerHTML="&n\x62sp;"; RadEditorNamespace.Utils.MakeSeparator(oCell,this.IsVertical); }else {var topElement=oTool.Create( ); oCell.appendChild(topElement); }if (this.IsRibbon && (oCount==ribbonRowLength)){oTable.insertRow(-1); }} this.Element=oTable; this.ConfigureToolbarWrapper( ); }else if (null!=newElement){ this.Element=newElement; }return this.Element; } ,GetTopElement:function ( ){ this.Create( ); return this.Element; } ,ConfigureToolbarWrapper:function ( ){var newTable=null; var clsName="Rad\x45Toolbar"; if (this.IsRibbon){ this.Element.className="RadETo\x6flbar"; newTable=this.WrapInRibbonContainer(this.Element,this.Title); clsName="\x52ad\x45\122i\x62bon"; }else if (this.IsDockable && RadEditorNamespace.Docking){newTable=RadEditorNamespace.Docking.WrapInDockingContainer;(this.Element,this.IsVertical,RadEditorNamespace.RadEditorToolbar_RenderHorizontal,RadEditorNamespace.RadEditorToolbar_RenderVertical,"\x52adE\x54\x6fol\x62ar","RadEToo\x6c\x62ar\x56\145\x72\164\x69cal",this.Title); this.Element.className=""; clsName=this.IsVertical?"R\x61dETool\x62\141\x72Ver\x74\151\x63al": "Ra\x64\105\x54\x6fol\x62ar"; } this.Element.removeAttribute("\x69d"); if (newTable)this.Element=newTable; if (clsName)this.Element.className=clsName; this.Element.style.display=RadEditorNamespace.DockableObjectDisplay; if (!document.all){ this.Element.setAttribute("\x73t\x79\154\x65","\x66\154o\x61\164\x3a\x6cef\x74"); } this.Element.setAttribute("i\x64",this.Id); this.Element.setAttribute("\x74itle",this.Title); return this.Element; } ,AddSeparator:function ( ){ this.Tools[this.Tools.length]="SEPARAT\x4fR"; } ,AddTool:function (oTool){ this.Tools[this.Tools.length]=oTool; } ,CreateToolCell:function (table){var oRow=this.IsVertical?table.insertRow(-1):table.rows[table.rows.length-1]; var oCell=oRow.insertCell(-1); oCell.setAttribute("\x75nsel\x65\143\x74able","on"); return oCell; }} ; RadEditorNamespace.RadEditorToolbar_RenderHorizontal= function ( ){var oTable=this.getElementsByTagName("\x54ABLE")[0]; var targetRow=oTable.rows[0]; while (oTable.rows.length>1){var row=oTable.rows[1]; var oCell=row.cells[0]; if (oCell.className=="RadESepa\x72atorHo\x72izontal")oCell.className="\x52adE\x53\145p\x61rator"; targetRow.appendChild(oCell); row.parentNode.removeChild(row); }oTable.VerticalRows=0; } ; RadEditorNamespace.RadEditorToolbar_RenderVertical= function ( ){var oTable=this.getElementsByTagName("TAB\x4cE")[0]; var cells=oTable.rows[0].cells; var oLength=cells.length-1; for (var i=0; i<oLength; i++){var row=oTable.insertRow(oTable.rows.length); var cell=cells[1]; cell.parentNode.removeChild(cell); if (cell.className=="\x52adESe\x70\x61r\x61\164\x6f\162")cell.className="\x52adE\x53\x65pa\x72atorHor\x69zontal"; row.appendChild(cell); }} ;
RadEditorNamespace.ToolbarModeBase= {Editor:null,GetToolbarManagerFn:null,New:function (radEditor){var flavorObj= {} ; RadEditorNamespace.Utils.ExtendObject(flavorObj,this ); flavorObj.Editor=radEditor; flavorObj.InitializeEditor( ); return flavorObj; } ,InitializeEditor:function ( ){var oFlavorObject=this ; var radEditor=this.Editor; var oManager=this.GetToolbarManagerFn( ); oManager.Add(this ); var setFocusFn= function ( ){var oManager=oFlavorObject.GetToolbarManagerFn( ); oManager.SetEditorFocus(oFlavorObject); };if (radEditor.IsIE){var oFun= function ( ){window.setTimeout( function ( ){radEditor.AttachEventHandler(RadEditorNamespace.RADEVENT_BEFORE_EDIT_FOCUS,setFocusFn); } ,0); window.setTimeout( function ( ){radEditor.AttachEventHandler(RadEditorNamespace.RADEVENT_BEFORE_EDIT_FOCUS,setFocusFn); } ,2000); } ; if (document.all && "c\x6f\x6dplete"!=document.readyState){RadEditorNamespace.Utils.AttachEventEx(window,"\x6fnload",oFun); }else {oFun( ); }}else {radEditor.AttachEventHandler(RadEditorNamespace.RADEVENT_SEL_CHANGED,setFocusFn); }radEditor.AttachEventHandler(RadEditorNamespace.RADEVENT_CALLBACK_STARTED, function ( ){var oManager=oFlavorObject.GetToolbarManagerFn( ); if (radEditor==oManager.CurrentEditor){oManager.ShowToolbarHolder( false); }} ); } ,GetToolbar:function ( ){if (!this.ToolbarHolderElement){var oTable=document.createElement("\x74able"); var oRow=oTable.insertRow(-1); var oCell=oRow.insertCell(-1); this.ToolbarHolderElement=oTable; if (this.Editor.ToolsWidth)this.Editor.SetToolbarHolderWidth(oCell); else oCell.style.width=parseInt(this.Editor.GetWidth( ))+"\160\x78"; var oToolbars=this.Editor.GetToolbars( ); for (var i=0; i<oToolbars.length; i++){oCell.appendChild(oToolbars[i].GetTopElement( )); }}return this.ToolbarHolderElement; }} ; RadEditorNamespace.ToolbarManagerBase= {ToolbarFlavors: [ ],CurrentEditor:null,ToolbarHolder: [ ],OverlayFrame: [ ],Add:function (toolbarFlavor){ this.ToolbarFlavors[this.ToolbarFlavors.length]=toolbarFlavor; } ,Dispose:function ( ){ this.ToolbarFlavors=null; } ,current:function ( ){if (!this.CurrentEditor){Ektron.ContentDesigner.onexception(new RangeError("\x55nexpecte\x64: Cu\x72rentE\x64itor \x69s "+this.CurrentEditor),arguments); return "\x6eon\x65"; }if (!this.CurrentEditor.Id){Ektron.ContentDesigner.onexception(new RangeError("U\x6eexpecte\x64: Curre\x6etEdito\x72\040\x49D \x69s "+this.CurrentEditor.Id),arguments); }return this.CurrentEditor.Id; } ,GetToolbarByEditor:function (editor){var ToolbarFlavors=this.ToolbarFlavors; for (var i=0; i<ToolbarFlavors.length; i++){if (editor==ToolbarFlavors[i].Editor){return ToolbarFlavors[i].GetToolbar( ); }}return null; } ,SetEditorTopMargin:function (toSet,editor){if (toSet){if (editor.NewMarginTop!=null){editor.WrapperElement.style.marginTop=editor.NewMarginTop; return; }var toolbarRect=RadEditorNamespace.Utils.GetRect(this.GetToolbarHolder( )); var editorRect=RadEditorNamespace.Utils.GetRect(editor.WrapperElement); if (toolbarRect.height>editorRect.top){editor.RealMarginTop=editor.WrapperElement.style.marginTop; var topMargin=toolbarRect.height; editor.NewMarginTop=topMargin+"\x70x"; editor.WrapperElement.style.marginTop=editor.NewMarginTop; }}else {if (editor && editor.RealMarginTop!=null){editor.WrapperElement.style.marginTop=editor.RealMarginTop; }}} ,ShowToolbarHolder:function (isVisible){if (this.GetToolbarHolder( ))this.GetToolbarHolder( ).style.display=isVisible?"": "\x6eone"; if (this.OverlayFrame[this.current( )])this.OverlayFrame[this.current( )].style.display=isVisible?"\x69nline": "no\x6ee"; if (!isVisible){ this.SetEditorTopMargin( false ,this.CurrentEditor); this.CurrentEditor=null; }} ,HideToolbarHolder:function (e){if (document.readyState && document.readyState!="comp\x6cete"){return; }if (!this.CurrentEditor)return; var oHolder=this.GetToolbarHolder( ); if (!oHolder || "\x6eone"==oHolder.style.display || !this.CurrentEditor)return; if (!RadEditorNamespace.Utils.IsMouseInElement(e,oHolder,this.CurrentEditor.WrapperElement)){ this.ShowToolbarHolder( false); }} ,GetToolbarHolder:function ( ){if (!this.ToolbarHolder[this.current( )]){var table=document.createElement("\x74able"); table.cellSpacing=0; table.cellPadding=0; table.style.display="no\x6ee"; table.className=this.HolderCss; row=table.insertRow(-1); cell=row.insertCell(-1); cell.setAttribute("\x68eight","\x3100%"); document.body.appendChild(table); this.ToolbarHolder[this.current( )]=table; }return this.ToolbarHolder[this.current( )]; } ,SetEditorFocus:function (oFlavorObject){var oList=this.ToolbarFlavors; var belongs= false; for (var i=0; i<oList.length; i++){if (oList[i]==oFlavorObject){belongs= true; break; }}if (!belongs){ this.Add(oFlavorObject); }var editor=oFlavorObject.Editor; if ( true ==editor.ToggleFullScreen){if (this.OverlayFrame[this.current( )])this.OverlayFrame[this.current( )].style.display="\x6eone"; return; }else if (editor==this.CurrentEditor){ this.SetEditorTopMargin( true ,this.CurrentEditor); return; }var oToolbar=this.GetToolbarByEditor(editor); if (oToolbar){ this.SetEditorTopMargin( false ,this.CurrentEditor); this.CurrentEditor=editor; this.ShowToolbarHolder( true); var contentCell=this.GetToolbarHolder( ).rows[0].cells[0]; if (contentCell.firstChild){contentCell.removeChild(contentCell.firstChild); }contentCell.appendChild(oToolbar); if (this.OnSetEditorFocus!=null && typeof(this.OnSetEditorFocus)=="fu\x6ection"){ this.OnSetEditorFocus( ); } this.SetOverlay(this.GetToolbarHolder( )); this.SetEditorTopMargin( true ,editor); }} ,SetOverlay:function (elem){if ("\143\x6fmplete"!=document.readyState && !document.all)return; if (!this.OverlayFrame[this.current( )]){var frm=document.createElement("I\x46RAME"); frm.src="\x6aava\x73\143\x72ipt:\047\047"; frm.className=this.HolderCss; frm.frameBorder=0; frm.scrolling="no"; frm.style.overflow="\x68idden"; frm.style.display="inline"; frm.style.position="\x61bsol\x75\164\x65"; this.OverlayFrame[this.current( )]=frm; elem.parentNode.insertBefore(frm,elem); }var frm=this.OverlayFrame[this.current( )]; try {var rect=RadEditorNamespace.Utils.GetRect(elem); frm.style.display="\x69nline"; frm.style.width=rect.width+'px'; frm.style.height=rect.height+'\160\x78'; frm.style.left=elem.style.left; frm.style.top=elem.style.top; frm.className=this.HolderCss; frm.style.borderWidth=0+'\x70x'; }catch (ex){}}} ; RadEditorNamespace.GetPageTopToolbarManager= function ( ){if (!RadEditorNamespace.PageTopToolbarManagerObject){var oManager=RadEditorNamespace.PageTopToolbarManager.New( ); RadEditorNamespace.Utils.AttachEventEx(window,"onun\x6coad", function ( ){oManager.Dispose( ); } ); RadEditorNamespace.Utils.AttachEventEx(document,"\x63lick", function (e){oManager.HideToolbarHolder(e); } ); RadEditorNamespace.PageTopToolbarManagerObject=oManager; }return RadEditorNamespace.PageTopToolbarManagerObject; } ; RadEditorNamespace.PageTopToolbarManager= {New:function ( ){var oManager= {} ; RadEditorNamespace.Utils.ExtendObject(oManager,RadEditorNamespace.ToolbarManagerBase); RadEditorNamespace.Utils.ExtendObject(oManager,this ); oManager.ToolbarFlavors=[ ]; oManager.HolderCss=(document.all)?"\x52ad\x45\x46ix\x65dToolba\x72Holder\x49E": "RadEFix\x65\144\x54oolbarH\x6flderMoz\x69lla"; return oManager; }} ; RadEditorNamespace.PageTopToolbarMode= {} ; RadEditorNamespace.Utils.ExtendObject(RadEditorNamespace.PageTopToolbarMode,RadEditorNamespace.ToolbarModeBase); RadEditorNamespace.PageTopToolbarMode.GetToolbarManagerFn=RadEditorNamespace.GetPageTopToolbarManager; RadEditorNamespace.GetShowOnFocusToolbarManager= function ( ){if (!RadEditorNamespace.ShowOnFocusToolbarManagerObject){var oManager=RadEditorNamespace.ShowOnFocusToolbarManager.New( ); RadEditorNamespace.Utils.AttachEventEx(window,"onunlo\x61d", function ( ){oManager.Dispose( ); } ); RadEditorNamespace.Utils.AttachEventEx(document,"click", function (e){oManager.HideToolbarHolder(e); } ); RadEditorNamespace.ShowOnFocusToolbarManagerObject=oManager; }return RadEditorNamespace.ShowOnFocusToolbarManagerObject; } ; RadEditorNamespace.ShowOnFocusToolbarManager= {New:function ( ){var oManager= {} ; RadEditorNamespace.Utils.ExtendObject(oManager,RadEditorNamespace.ToolbarManagerBase); RadEditorNamespace.Utils.ExtendObject(oManager,this ); oManager.HolderCss="R\x61dERelati\x76eToolba\x72\110\x6flder"; oManager.ToolbarFlavors=[ ]; $ektron(window).bind("re\x73\151\x7ae", function ( ){for (var i=0; i<oManager.ToolbarFlavors.length; i++){try {oManager.PositionToolbar(oManager.ToolbarFlavors[i].Editor); }catch (ex){oManager.ToolbarFlavors[i].Editor.destroyEditor( ); }}} ); return oManager; } ,ShowToolbarHolder:function (isVisible,editor){var id=""; var oHolder=null; if (editor){id=editor.Id; if (!id)return; oHolder=this.ToolbarHolder[id]; if (!oHolder)return; }else {editor=this.CurrentEditor; if (!editor && !isVisible)return; id=this.current( ); oHolder=this.GetToolbarHolder( ); }$ektron(oHolder).css("\x6fpacity",(isVisible?.10e1: .5)); oHolder.disabled=!isVisible; var f=["onclick","o\x6emousedo\x77n","onmou\x73\145o\x75t","on\x6d\157u\x73\145\x6f\166e\x72","\x6fnmou\x73\145\x75\160"]; $ektron("\x69mg",oHolder).each( function ( ){for (var i=0; i<f.length; i++){var name=f[i]; if (isVisible){if ("\x66uncti\x6f\156"==typeof this["inactiv\x65_"+name]){ this[name]=this["\x69nactive_"+name]; }}else {if ("f\x75\156c\x74\151\x6fn"==typeof this[name]){ this["\x69nactive\x5f"+name]=this[name]; this[name]=null; }}} ; } ); if (this.OverlayFrame[id])this.OverlayFrame[id].style.display=isVisible?"\x69nline": "none"; if (!isVisible){if (this.CurrentEditor==editor){ this.SetEditorTopMargin( false ,this.CurrentEditor); this.CurrentEditor=null; }}else {for (var i=0; i<this.ToolbarFlavors.length; i++){var D=this.ToolbarFlavors[i].Editor; var oHolder=this.ToolbarHolder[D.Id]; if (oHolder && !oHolder.disabled){if (editor!=D){ this.ShowToolbarHolder( false ,D); }}}}} ,HideToolbarHolder:function (e){if (document.readyState && document.readyState!="\x63omplete"){return; }for (var i=0; i<this.ToolbarFlavors.length; i++){var editor=this.ToolbarFlavors[i].Editor; var oHolder=this.ToolbarHolder[editor.Id]; if (oHolder && !oHolder.disabled){if (!RadEditorNamespace.Utils.IsMouseInElement(e,oHolder,editor.WrapperElement)){ this.ShowToolbarHolder( false ,editor); }}}} ,OnSetEditorFocus:function ( ){var editorRect=RadEditorNamespace.Utils.GetRect(this.CurrentEditor.WrapperElement); this.GetToolbarHolder( ).style.width=editorRect.width+'\x70x'; this.PositionToolbar( ); } ,PositionToolbar:function (editor){var id=""; var oHolder=null; if (editor){id=editor.Id; if (!id)return; oHolder=this.ToolbarHolder[id]; if (!oHolder)return; }else {editor=this.CurrentEditor; id=this.current( ); oHolder=this.GetToolbarHolder( ); }var ToolbarHolderRect=RadEditorNamespace.Utils.GetRect(oHolder); var EditorRect=RadEditorNamespace.Utils.GetRect(editor.WrapperElement); var offset=RadEditorNamespace.Utils.FindScrollPosY(editor.WrapperElement); var TopPosition=EditorRect.top-ToolbarHolderRect.height-offset; TopPosition=TopPosition<0?0:TopPosition; var LeftPosition=EditorRect.left; LeftPosition=LeftPosition<0?0:LeftPosition; oHolder.style.display=""; oHolder.style.position='abso\x6cute'; oHolder.style.left=LeftPosition+'\160\x78'; oHolder.style.top=TopPosition+'px'; if (this.OverlayFrame[id])this.OverlayFrame[id].style.left=LeftPosition+'\160\x78'; }} ; RadEditorNamespace.ShowOnFocusToolbarMode= {} ; RadEditorNamespace.Utils.ExtendObject(RadEditorNamespace.ShowOnFocusToolbarMode,RadEditorNamespace.ToolbarModeBase); RadEditorNamespace.ShowOnFocusToolbarMode.GetToolbarManagerFn=RadEditorNamespace.GetShowOnFocusToolbarManager; RadEditorNamespace.FloatingToolbarMode= {EditorMode:RadEditorNamespace.RADEDITOR_DESIGN_MODE,Editor:null,Localization:null,ToolbarImage:null,New:function (radEditor){var obj= {} ; RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.Editor=radEditor; obj.Localization=obj.Editor.Localization; obj.EditorMode=obj.Editor.Mode; var oImg=document.createElement("\x49MG"); oImg.src=obj.Editor.SkinBasePath+"Img/to\x6flbar.gi\x66"; oImg.style.border="\x31px sol\x69\144\x20\167\x68\151\x74e"; oImg.onmouseover=new Function("\x74his.s\x74\171\x6ce.bor\x64\145\x72 = \0471px ou\x74set\047\x3b"); oImg.onmouseout=new Function("\x74his.st\x79\154\x65.border\x20= \047\x31px \x73olid w\x68ite\047;"); var floatingToolbar=obj; oImg.Toolbar=obj; oImg.onclick= function ( ){ this.style.border='1p\x78 inset'; floatingToolbar.ToggleFloatingToolbar( ); } ; obj.Editor.DockingZones.TopZone.appendChild(oImg); obj.ToolbarImage=oImg; var modeChangedHandlerPtr= function ( ){floatingToolbar.OnModeChanged( ); } ; obj.Editor.AttachEventHandler(RadEditorNamespace.RADEVENT_MODE_CHANGED,modeChangedHandlerPtr); radEditor.AttachEventHandler(RadEditorNamespace.RADEVENT_CALLBACK_STARTED, function ( ){if (floatingToolbar.ToolbarWnd){floatingToolbar.ToolbarWnd.ShowWindow( false); }} ); radEditor.AttachEventHandler(RadEditorNamespace.RADEVENT_DISPOSE, function ( ){floatingToolbar.ToolbarHolderElement=null; floatingToolbar.Editor=null; if (floatingToolbar.ToolbarImage)floatingToolbar.ToolbarImage.onclick=null; floatingToolbar.ToolbarImage=null; if (floatingToolbar.ToolbarWnd)floatingToolbar.ToolbarWnd.OnClientClosing=null; floatingToolbar.ToolbarWnd=null; } ); return obj; } ,OnModeChanged:function ( ){var toShow=(this.Editor.Mode==RadEditorNamespace.RADEDITOR_DESIGN_MODE); this.ToolbarImage.style.display=toShow?"": "\x6eone"; if (this.EditorMode==RadEditorNamespace.RADEDITOR_DESIGN_MODE){ this.IsToolbarWndPrevVisible=this.ToolbarWnd?this.ToolbarWnd.IsVisible( ):null; }if (this.ToolbarWnd){ this.ToolbarWnd.ShowWindow(this.IsToolbarWndPrevVisible && toShow); } this.EditorMode=this.Editor.Mode; } ,ToggleFloatingToolbar:function (redockToolbar){var x,y; if (!this.ToolbarWnd){var oTable=document.createElement("\x74abl\x65"); var oRow=oTable.insertRow(0); var oCell=oRow.insertCell(0); this.ToolbarHolderElement=oTable; if (this.Editor.ToolsWidth)this.Editor.SetToolbarHolderWidth(oCell); else oCell.style.width=parseInt(this.Editor.GetWidth( ))+"px"; var oToolbars=this.Editor.GetToolbars( ); for (var i=0; i<oToolbars.length; i++){oCell.appendChild(oToolbars[i].GetTopElement( )); }var rwi=new RadWindowInfo( ); if (document.all){rwi.Url="javasc\x72ipt:\047\047"; rwi.Width=1; rwi.Height=1; }else {rwi.Url=""; rwi.InnerHtml=""; rwi.Width=this.Editor.ToolsWidth || "600px"; }rwi.Caption=this.Localization["MainToo\x6cbar"]; rwi.IsVisible= false; rwi.Argument=null; rwi.Movable= true; rwi.Resizable= true; rwi.UseClassicDialogs= false; this.ToolbarWnd=GetEditorRadWindowManager( ).ShowModallessWindow(rwi); this.ToolbarWnd.OnClientClosing= function (exitCode){ this.ShowWindow( false); return false; } ; this.ToolbarWnd.ContentWindow.innerHTML=""; this.ToolbarWnd.ContentWindow.appendChild(this.ToolbarHolderElement); var rc=RadEditorNamespace.Utils.GetRect(this.Editor.WrapperElement); x=rc.left; y=rc.top; }if (redockToolbar){var rc=RadEditorNamespace.Utils.GetRect(this.Editor.WrapperElement); x=rc.left; y=rc.top; } this.ToolbarWnd.ShowWindow(!this.ToolbarWnd.IsVisible( ),x,y); }} ;
if (typeof window.RadControlsNamespace=="u\x6e\x64ef\x69\x6ee\x64"){window.RadControlsNamespace= {} ; }if (typeof(window.RadControlsNamespace.Screen)=="\x75nde\x66\151\x6eed" || typeof(window.RadControlsNamespace.Screen.Version)==null || window.RadControlsNamespace.Screen.Version<.11e1){window.RadControlsNamespace.Screen= {Version: .11e1,GetViewPortSize:function ( ){var width=0; var height=0; var canvas=document.body; if (RadControlsNamespace.Browser.StandardsMode && !RadControlsNamespace.Browser.IsSafari){canvas=document.documentElement; }if (window.innerWidth){width=window.innerWidth; height=window.innerHeight; }else {width=canvas.clientWidth; height=canvas.clientHeight; }width+=canvas.scrollLeft; height+=canvas.scrollTop; return {width:width-6,height:height-6 } ; } ,GetElementPosition:function (el){var parent=null; var pos= {x: 0,y: 0 } ; var box; if (el.getBoundingClientRect){box=el.getBoundingClientRect( ); var scrollTop=document.documentElement.scrollTop || document.body.scrollTop; var scrollLeft=document.documentElement.scrollLeft || document.body.scrollLeft; pos.x=box.left+scrollLeft-2; pos.y=box.top+scrollTop-2; return pos; }else if (document.getBoxObjectFor){try {box=document.getBoxObjectFor(el); pos.x=box.x-2; pos.y=box.y-2; }catch (e){}}else {pos.x=el.offsetLeft; pos.y=el.offsetTop; parent=el.offsetParent; if (parent!=el){while (parent){pos.x+=parent.offsetLeft; pos.y+=parent.offsetTop; parent=parent.offsetParent; }}}if (window.opera){parent=el.offsetParent; while (parent && parent.tagName!='\102\x4fDY' && parent.tagName!='\x48TML'){pos.x-=parent.scrollLeft; pos.y-=parent.scrollTop; parent=parent.offsetParent; }}else {parent=el.parentNode; while (parent && parent.tagName!='\x42ODY' && parent.tagName!='\x48TM\x4c'){pos.x-=parent.scrollLeft; pos.y-=parent.scrollTop; parent=parent.parentNode; }}return pos; } ,ElementOverflowsTop:function (element){return this.GetElementPosition(element).y<0; } ,ElementOverflowsLeft:function (element){return this.GetElementPosition(element).x<0; } ,ElementOverflowsBottom:function (screenSize,element){var bottomEdge=this.GetElementPosition(element).y+RadControlsNamespace.Box.GetOuterHeight(element); return bottomEdge>screenSize.height; } ,ElementOverflowsRight:function (screenSize,element){var rightEdge=this.GetElementPosition(element).x+RadControlsNamespace.Box.GetOuterWidth(element); return rightEdge>screenSize.width; }};}
RadEditorNamespace.RadBrowserCommand= {New:function (sTitle,sCmdID,oWindow,value){var obj=RadEditorNamespace.RadCommandBase.New((sTitle || sCmdID),canUnexecute,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.CommandID=sCmdID; obj.Value=value; var canUnexecute= true; switch (obj.CommandID){case "C\x6fp\x79":case "Select\x41\154\x6c":case "\x50rint":canUnexecute= false; break; }return obj; } ,Clone:function ( ){return RadEditorNamespace.RadBrowserCommand.New(this.Title,this.CommandID,this.Window,this.Value); } ,GetState:function (oWindow){try {oWindow=oWindow || this.Window; var oDocument=oWindow.document; if (null==oDocument){return RadEditorNamespace.RADCOMMAND_STATE_DISABLED; }if (!window.opera && null!=oDocument.queryCommandEnabled && !oDocument.queryCommandEnabled(this.CommandID)){return RadEditorNamespace.RADCOMMAND_STATE_DISABLED; }return oDocument.queryCommandState(this.CommandID)?RadEditorNamespace.RADCOMMAND_STATE_ON:RadEditorNamespace.RADCOMMAND_STATE_OFF; }catch (ex){return RadEditorNamespace.RADCOMMAND_STATE_OFF; }} ,GetValue:function (oWindow){try {oWindow=oWindow || this.Window; return oWindow.document.queryCommandValue(this.CommandID); }catch (ex){}return null; } ,OnExecute:function ( ){if (!document.all){try { this.Window.document.execCommand('Us\x65\x43\x53S', false , true); }catch (ex){} ; }if (RadEditorNamespace.RADCOMMAND_ABSOLUTE_POSITION==this.CommandID){ this.Window.document.execCommand("2\x44-Positi\x6fn", false , true); }var useCss= true; if (this.CommandID==RadEditorNamespace.RADCOMMAND_BACKCOLOR && (window.opera || (!document.all && !document.body.outerHTML))){ this.CommandID="Hi\x6citeColo\x72"; useCss= false; }if (this.CommandID==RadEditorNamespace.RADCOMMAND_FONTSIZE && TelerikNamespace.Utils.DetectBrowser("\x73afar\x69")){var oVal=parseInt(this.Value); switch (oVal){case 1: this.Value="8pt"; break; case 2: this.Value="\x310pt"; break; case 3: this.Value="12pt"; break; case 4: this.Value="\x314pt"; break; case 5: this.Value="18pt"; break; case 6: this.Value="24pt"; break; case 7: this.Value="\x336pt"; break; }}if ( false ==useCss)this.Window.document.execCommand('\x55seC\x53\123', false , false); var v=null; var oRes= false; switch (this.CommandID){case RadEditorNamespace.RADCOMMAND_INDENT:v=new Ektron.SelectionRange( {window: this.Window } ); oRes=v.indent( ); break; case RadEditorNamespace.RADCOMMAND_OUTDENT:v=new Ektron.SelectionRange( {window: this.Window } ); oRes=v.outdent( ); break; case RadEditorNamespace.RADCOMMAND_INSERT_ORDERED_LIST:v=new Ektron.SelectionRange( {window: this.Window } ); oRes=v.orderedList( ); break; case RadEditorNamespace.RADCOMMAND_INSERT_UNORDERED_LIST:v=new Ektron.SelectionRange( {window: this.Window } ); oRes=v.unorderedList( ); break; default:oRes=this.Window.document.execCommand(this.CommandID, false ,this.Value); }v=null; if ( false ==useCss)this.Window.document.execCommand('U\x73eCSS', false , true); return oRes; }} ; RadEditorNamespace.RadGenericCommand= {New:function (sTitle,oWindow){var obj=RadEditorNamespace.RadCommandBase.New(sTitle, true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.RestorePoint1=RadEditorNamespace.RadCreateRestorePoint(obj.Window); return obj; } ,Execute:function ( ){if (null==this.RestorePoint2){ this.RestorePoint2=RadEditorNamespace.RadCreateRestorePoint(this.Window); }else { this.RestorePoint2.Restore( ); }return true; } ,Unexecute:function ( ){ this.RestorePoint1.Restore( true); }} ;
RadEditorNamespace.RadCommandBase= {New:function (sTitle,bCanUnexecute,oWindow){var obj= {} ; RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.IsSafari=TelerikNamespace.Utils.DetectBrowser("safari"); obj.Title=sTitle; obj.CanUnexecute=(bCanUnexecute!= false); obj.Window=oWindow; return obj; } ,GetState:function (oWindow){return RadEditorNamespace.RADCOMMAND_STATE_OFF; } ,GetValue:function (oWindow){return null; } ,Execute:function ( ){ this.IsExecuted= false; if (null==this.OnExecute || null==this.Window)return false; try {if (!this.RestorePoint1){ this.RestorePoint1=RadEditorNamespace.RadCreateRestorePoint(this.Window); }else { this.RestorePoint1.Select( ); }return (this.IsExecuted=this.OnExecute( )); }catch (ex){}return false; } ,OnExecute:function ( ){if (null!=document.selection && null!=this.OnExecuteIE && !window.opera){return this.OnExecuteIE( ); }else if (null!=window.getSelection && null!=this.OnExecuteMoz){return this.OnExecuteMoz( ); }return false; } ,Unexecute:function ( ){try {if (this.CanUnexecute && this.IsExecuted){ this.RestorePoint1.Restore( ); }}catch (ex){}}} ;
RadEditorNamespace.RadFormatBlockCommand= {New:function (sTitle,oWindow,sFormatValue){var obj=RadEditorNamespace.RadCommandBase.New((sTitle || "Form\x61\x74 Bloc\x6b"), true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.FormatValue=sFormatValue; return obj; } ,Clone:function ( ){return RadEditorNamespace.RadFormatBlockCommand.New(this.Title,this.Window,this.FormatValue); } ,GetValue:function (oWindow){try {oWindow=oWindow || this.Window; var value=oWindow.document.queryCommandValue(RadEditorNamespace.RADCOMMAND_FORMAT_BLOCK); if (!document.all){switch (value){case "x":case "":value="\x4eorma\x6c"; break; }}return value; }catch (ex){}return null; } ,OnExecuteIE:function ( ){var oDocument=this.Window.document; RadEditorNamespace.RadSelection.F(oDocument); if ("\x3cp>"==this.FormatValue.toLowerCase( )){return oDocument.execCommand(RadEditorNamespace.RADCOMMAND_FORMAT_BLOCK, false ,"\074\x70>") && oDocument.execCommand("\x52emoveFo\x72\x6da\x74"); }var range=oDocument.selection.createRange( ); var isFullParagraph= false; var rng=range.duplicate( ); var selText=RadEditorNamespace.Utils.Trim(rng.htmlText); var eSelNodes=""; if ("text"==oDocument.selection.type.toLowerCase( )){var parentElem=rng.parentElement( ); var parentHTML=parentElem.outerHTML; var eParentElem=$ektron(parentElem); if ("des\x69gn_con\x74ent"==eParentElem.attr("\x69d") && "DIV"==parentElem.tagName){parentHTML=parentElem.innerHTML; }if (selText.toLowerCase( )==RadEditorNamespace.Utils.Trim(parentHTML).toLowerCase( )){isFullParagraph= true; eParentElem.removeAttr("c\x6cass"); }else {eSelNodes=$ektron(selText); }}if (!isFullParagraph && ""!=rng.text){var tagName=this.FormatValue.substring(1,this.FormatValue.length-1); oDocument.execCommand(RadEditorNamespace.RADCOMMAND_FORMAT_BLOCK, false ,"\x3cp>");oDocument.execCommand("Re\x6doveForm\x61t"); if (eSelNodes.length<=1){var newNode=oDocument.createElement(tagName); newNode.innerHTML=range.htmlText; range.pasteHTML(newNode.outerHTML); }else {var newNodes=oDocument.createElement("\104\x49V"); ; for (var i=0; i<eSelNodes.length; i++){var newNode=oDocument.createElement(tagName); newNode.innerHTML=eSelNodes.eq(i).html( ); newNodes.appendChild(newNode); }range.pasteHTML(newNodes.innerHTML); }var newSelectedElem=getSelectionElement(oDocument); var ePrev=$ektron(newSelectedElem,oDocument).prev("\160"); if (""==ePrev.text( )){ePrev.remove( ); }return true; }else {return oDocument.execCommand(RadEditorNamespace.RADCOMMAND_FORMAT_BLOCK, false ,this.FormatValue); }} ,OnExecuteMoz:function ( ){var tagName=this.FormatValue.substring(1,this.FormatValue.length-1); var oDocument=this.Window.document; var oCommandName=RadEditorNamespace.RADCOMMAND_FORMAT_BLOCK; var normalize=("body"==this.FormatValue.toLowerCase( ) || "normal"==this.FormatValue.toLowerCase( )); if (this.IsSafari){if (normalize){}else {var newNode=oDocument.createElement(tagName); var oSel=RadEditorNamespace.RadSelection.New(this.Window); newNode.innerHTML=oSel.GetHtmlText( ); var oParent=RadEditorNamespace.RadSelection.New(this.Window).GetParentElement( ); if (isFormatBlockElement(oParent) || "\120"==oParent.tagName){oDocument.execCommand(RadEditorNamespace.RADCOMMAND_FORMAT_BLOCK, false ,this.FormatValue); }else {var oPaste=RadEditorNamespace.RadPasteHtmlCommand.New(this.Title,this.Window,newNode.outerHTML, true); oPaste.Execute( ); }}return; }if (normalize){return oDocument.execCommand(oCommandName, false ,"\x4eormal"); }var selection=this.Window.getSelection( ); if (selection.rangeCount<1)return false; var range=selection.getRangeAt(0); function isFormatBlockElement(elem){if (!elem || !elem.tagName)return false; var tagName=elem.tagName; if (tagName=="H1" || tagName=="\x482" || tagName=="\x483" || tagName=="H4" || tagName=="\x485" || tagName=="\x486" || tagName=="\x487" || tagName=="ADDRE\x53S" || tagName=="\x50RE"){return true; }}var parent=RadEditorNamespace.RadSelection.New(this.Window).GetParentElement( ); if (range.toString( )!=""){try {var objSelectionRange=new Ektron.SelectionRange( {window: this.Window } ); var oElem=objSelectionRange.getContainerElement( ); oElem.normalize( ); var rngContent=range.extractContents( ); var firstNode; var lastNode=null; var newNode; var bMultipleLine= false; while (rngContent.lastChild!=null){if ("P"==parent.tagName || isFormatBlockElement(parent) || ("SPAN"==parent.tagName && parent.className!="")){newNode=oDocument.createElement(tagName); newNode.appendChild(rngContent.lastChild); range.insertNode(newNode); $ektron(parent,this.Window).unwrapInner( ); if ("P"==newNode.parentNode.tagName && 1==newNode.parentNode.children.length){$ektron(newNode.parentNode,this.Window).unwrapInner( ); }firstNode=newNode.firstChild; }else {if (1==rngContent.lastChild.nodeType){newNode=oDocument.createElement(tagName); newNode.appendChild(rngContent.lastChild); range.insertNode(newNode); var newNodeFirstChild=newNode.firstChild; if ("P"==newNodeFirstChild.tagName || isFormatBlockElement(newNodeFirstChild)){bMultipleLine= true; $ektron(newNodeFirstChild,this.Window).unwrapInner( ); }if (null==lastNode){lastNode=newNode; }if (null==rngContent.lastChild){firstNode=newNode; }}else {$ektron(rngContent.lastChild).remove( ); }}}if ( true ==bMultipleLine){var ePrev=$ektron(firstNode).prev( ); var oPrev=ePrev.get(0); if (""==ePrev.text( ) && ("P"==oPrev.tagName || isFormatBlockElement(oPrev))){ePrev.remove( ); }if (lastNode){var eNext=$ektron(lastNode).next( ); var oNext=eNext.get(0);if (""==eNext.text( ) && ("P"==oNext.tagName || isFormatBlockElement(oNext))){eNext.remove( ); }}}objSelectionRange.moveToNode(firstNode); return true; }catch (ex){return false; }}else {return oDocument.execCommand(RadEditorNamespace.RADCOMMAND_FORMAT_BLOCK, false ,this.FormatValue); }return false; }} ;
RadEditorNamespace.RadFormatObjectCommand= {New:function (sTitle,oWindow,srcObject,targetObject){var obj=RadEditorNamespace.RadCommandBase.New(sTitle, true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.TargetObjectBookmark=RadEditorNamespace.RadNodeBookmark.New(oWindow,targetObject); obj.Diff(srcObject,targetObject); return obj; } ,Execute:function ( ){try {var target=this.TargetObjectBookmark.Select( ); this.IsExecuted=this.SourceValues.ApplyTo(target); }catch (ex){ this.IsExecuted= false; }return this.IsExecuted; } ,Unexecute:function ( ){var target=this.TargetObjectBookmark.Select( ); this.TargetValues.ApplyTo(target); } ,Diff:function (srcObject,targetObject){ this.SourceValues=new RadEditorNamespace.DiffObjectInfo( ); this.TargetValues=new RadEditorNamespace.DiffObjectInfo( ); var isChanged=this.DiffAttributes(srcObject,targetObject,this.SourceValues.Attributes,this.TargetValues.Attributes); if (srcObject.style.cssText!=targetObject.style.cssText){ this.SourceValues.Style=srcObject.style.cssText; this.TargetValues.Style=targetObject.style.cssText; isChanged= true; }if (srcObject.value!=targetObject.value){ this.SourceValues.Value=srcObject.value; this.TargetValues.Value=targetObject.value; isChanged= true; }if (srcObject.className!=targetObject.className){ this.SourceValues.ClassName=srcObject.className; this.TargetValues.ClassName=targetObject.className; isChanged= true; }if (srcObject.innerHTML!=targetObject.innerHTML){ this.SourceValues.InnerHtml=srcObject.innerHTML; this.TargetValues.InnerHtml=targetObject.innerHTML; this.TargetValues.InnerHtml=targetObject.innerHTML; isChanged= true; }return isChanged; } ,DiffAttributes:function (srcObject,targetObject,srcAttributes,targetAttributes){if (document.all && !window.opera){return this.DiffAttributesIE(srcObject,targetObject,srcAttributes,targetAttributes); }else {return this.DiffAttributesMoz(srcObject,targetObject,srcAttributes,targetAttributes); }} ,DiffAttributesIE:function (srcObject,targetObject,srcAttributes,targetAttributes){var attribName,srcAttrib,targetAttrib,srcValue,targetValue; for (var i=0; i<targetObject.attributes.length; i++){try {targetAttrib=targetObject.attributes[i]; attribName=targetAttrib.nodeName; switch (attribName.toLowerCase( )){case "style":case "val\x75\x65":case "\x63lassname":continue; case "\156\x61me":attribName="NA\x4dE"; break; }targetValue=targetAttrib.nodeValue; if ("\x6fn"==attribName.substring(0,2)){srcValue=srcObject.getAttributeNode(attribName).nodeValue; }else {srcValue=srcObject.getAttribute(attribName); }if (!targetValue){targetValue=""; }if (!srcValue){srcValue=""; }if (targetValue!=srcValue){srcAttributes[srcAttributes.length]= {Name:attribName,Value:srcValue } ; targetAttributes[targetAttributes.length]= {Name:attribName,Value:targetValue } ; }}catch (ex){}}if ("\x49MG"==targetObject.tagName){for (var i=0; i<srcObject.attributes.length; i++){try {srcAttrib=srcObject.attributes[i]; attribName=srcAttrib.nodeName; switch (attribName.toLowerCase( )){case "\x62orde\x72":case "hspac\x65":case "vspace":case "\x61lig\x6e":srcValue=(srcAttrib.nodeValue || ""); targetValue=(targetObject.getAttribute(attribName) || ""); if (targetValue!=srcValue){srcAttributes[srcAttributes.length]= {Name:attribName,Value:srcValue } ; targetAttributes[targetAttributes.length]= {Name:attribName,Value:targetValue } ; }break; default:break; }}catch (ex){}}}return (srcAttributes.length>0); } ,DiffAttributesMoz:function (srcObject,targetObject,srcAttributes,targetAttributes){var srcAttrib,targetAttrib,attribName; for (var i=0; i<srcObject.attributes.length; i++){try {srcAttrib=srcObject.attributes[i]; attribName=srcAttrib.nodeName; targetAttrib=targetObject.attributes[attribName]; if (null!=targetAttrib && srcAttrib.nodeValue==targetAttrib.nodeValue){continue; }else {srcAttributes[srcAttributes.length]= {Name:attribName,Value:srcAttrib.nodeValue } ; if (targetAttrib){targetAttributes[targetAttributes.length]= {Name:attribName,Value:targetAttrib.nodeValue } ; }else {targetAttributes[targetAttributes.length]= {Name:attribName,Value: "" } ; }}}catch (ex){}}return (srcAttributes.length>0); }};RadEditorNamespace.DiffObjectInfo= function ( ){ this.Attributes=[ ]; this.Style=null; this.Value=null; this.ClassName=null; this.InnerHtml=null; } ; RadEditorNamespace.DiffObjectInfo.prototype.ApplyTo= function (element){ this.ApplyAttributes(element); if (null!=this.Style){element.style.cssText=this.Style; }if (null!=this.Value){element.setAttribute("valu\x65",this.Value); }if (null!=this.ClassName){element.className=this.ClassName; }if (null!=this.InnerHtml){element.innerHTML=this.InnerHtml; }return true; } ; RadEditorNamespace.DiffObjectInfo.prototype.ApplyAttributes= function (element){if (this.Attributes){var attr=null; for (var i=0; i<this.Attributes.length; i++){attr=this.Attributes[i]; if (null==attr.Value || ""==attr.Value){element.removeAttribute(attr.Name); }else {if ("fu\x6ection"==typeof(attr.Value)){continue; }else element.setAttribute(attr.Name,attr.Value); }}}} ;
RadEditorNamespace.RadPasteHtmlCommand= {New:function (sTitle,oWindow,htmlText,bSelectText){var obj=RadEditorNamespace.RadCommandBase.New((sTitle || "\111nser\x74 Html"), true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.HtmlText=htmlText; obj.SelectText=( true ==bSelectText); obj.IsSafari=TelerikNamespace.Utils.DetectBrowser("\x73afar\x69"); return obj; } ,Clone:function ( ){return RadEditorNamespace.RadPasteHtmlCommand.New(this.Title,this.Window,this.HtmlText);} ,OnExecute:function ( ){var result; if (document.all && !window.opera){result=this.OnExecuteIE( ); }else {result=this.OnExecuteMoz( ); }Ektron.SelectionRange.ensureContentUsability(this.Window.document.body); return result; } ,OnExecuteIE:function ( ){var oDocument=this.Window.document; var d= false; var oSelected; if ("\x74ext"==oDocument.selection.type.toLowerCase( )){oSelected=getSelectionElement(oDocument); if (oSelected){if ("design_\x63ontent"==oSelected.firstChild.id){d= true; }else if (oSelected.className.indexOf("\144\x65sign\x5fmembran\x65")>-1){d= true; }}}else if ("\143\x6fntrol"==oDocument.selection.type.toLowerCase( )){d= true; }if ( false ==d){if (oDocument.selection.type.toLowerCase( )!="\x6eone"){oDocument.selection.createRange( ).execCommand("Dele\x74e"); }if (oDocument.selection.type.toLowerCase( )!="\x6eone"){oDocument.execCommand("\x44ele\x74\x65"); }}RadEditorNamespace.RadSelection.F(oDocument); var selRange; var ie8SavedRange=this.Window.ekSmartFormSelectedRange; if (parseInt($ektron.browser.version,10)>=8 && ie8SavedRange){selRange=ie8SavedRange; }else {selRange=oDocument.selection.createRange( ); }if ("none"==oDocument.selection.type.toLowerCase( ) && selRange && typeof selRange.parentElement!="un\x64efined"){var selParentElem=selRange.parentElement( ); var strText=selParentElem.innerText; if ("P"==selParentElem.tagName && Ektron.RegExp.IsSingleWhitespaceCharacter.test(strText)){selParentElem.innerHTML=""; }}if (selRange && selRange.length){var oElem=selRange.item(0); if (oElem && oElem.tagName=="\x42ODY"){var oForm=oElem.getElementsByTagName("FORM")[0]; if (oForm){oForm.innerHTML+=this.HtmlText; }}else if (oElem){$ektron(oElem).replaceWith(this.HtmlText); }}else if (oSelected && oSelected.className.indexOf("ekt\x64esignn\x73_choice\x73")>-1){$ektron(oSelected).replaceWith(this.HtmlText); }else if (oSelected && oSelected.className.indexOf("\x64es\x69\x67n_\x6d\145\x6dbrane")>-1){$ektron(oSelected).closest("[ektd\x65signns_\x6eame]").replaceWith(this.HtmlText); }else {var rngStart=selRange.duplicate( ); rngStart.collapse( true); selRange.pasteHTML(this.HtmlText); if (this.SelectText){rngStart.setEndPoint("EndTo\x45nd",selRange); rngStart.select( ); }else {rngStart.collapse( false); rngStart.select( ); }}return true; } ,OnExecuteMoz:function ( ){var v=new Ektron.SelectionRange( {window: this.Window } ); var oRng=v.getDomRange( ); var oElem=v.getContainerElement( ); if (oRng){oRng.deleteContents( ); if (typeof v.collapse!="\x75nde\x66\151\x6eed")v.collapse( ); var oFragNode=oRng.createContextualFragment(this.HtmlText); oRng.insertNode(oFragNode); var sel=this.Window.getSelection( ); if (sel){sel.selectAllChildren(oElem); sel.collapseToEnd( ); sel=null; }}oElem.normalize( ); return true; }} ;
RadEditorNamespace.RadSetAttributeCommand= {New:function (sTitle,oWindow,oElement,attribName,newValue){var obj=RadEditorNamespace.RadCommandBase.New(sTitle, true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); if (!oElement){var selection=RadEditorNamespace.RadSelection.New(obj.Window); oElement=selection.GetParentElement( ); }obj.NodeBookmark=RadEditorNamespace.RadNodeBookmark.New(obj.Window,oElement); obj.AttribName=attribName; obj.NewValue=newValue; return obj; } ,Clone:function ( ){return RadEditorNamespace.RadSetAttributeCommand.New(this.Title,this.Window,null,this.AttribName,this.NewValue); } ,Execute:function ( ){var element=this.NodeBookmark.Select( ); if (!element)return false; if (!this.IsExecuted){ this.OldValue=element.getAttribute(this.AttribName); }if (this.AttribName && this.AttribName.toLowerCase( )=="n\x61\x6de" && document.all){element.name=this.NewValue; element.removeAttribute("\x6eame"); element.removeAttribute("\116\x41ME"); }var newVal=RadEditorNamespace.Utils.Trim(this.NewValue); if (""==newVal){element.removeAttribute(this.AttribName,0); if ("cl\x61ssName"==this.AttribName){element.removeAttribute("\x63l\x61\x73s",0); }}else {element[this.AttribName]=this.NewValue; if (this.AttribName.toLowerCase( )=="\x6eowrap"){element.setAttribute(this.AttribName,this.NewValue); }} this.IsExecuted= true; return true; } ,Unexecute:function ( ){var element=this.NodeBookmark.Select( ); element[this.AttribName]=this.OldValue; }} ;
RadEditorNamespace.RadSetStyleRuleCommand= {New:function (sTitle,oWindow,oElement,styleAttributeName,newValue){var obj=RadEditorNamespace.RadCommandBase.New(sTitle, true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); if (!oElement){var selection=RadEditorNamespace.RadSelection.New(obj.Window); oElement=selection.GetParentElement( ); }obj.NodeBookmark=RadEditorNamespace.RadNodeBookmark.New(obj.Window,oElement); obj.StyleAttributeName=styleAttributeName; obj.NewValue=newValue; return obj; } ,Clone:function ( ){return RadEditorNamespace.RadSetStyleRuleCommand.New(this.Title,this.Window,null,this.StyleAttributeName,this.NewValue); } ,Execute:function ( ){var element=this.NodeBookmark.Select( ); if (!element)return false; if (!this.IsExecuted){ this.OldValue=element.style[this.StyleAttributeName]; }element.style[this.StyleAttributeName]=this.NewValue; this.IsExecuted= true; return true; } ,Unexecute:function ( ){var element=this.NodeBookmark.Select( ); element.style[this.StyleAttributeName]=this.OldValue; }};
RadEditorNamespace.RadStyleCommand= {New:function (sTitle,oWindow,className){var obj=RadEditorNamespace.RadCommandBase.New(sTitle, true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.ClassName=className; return obj; } ,Clone:function ( ){return RadEditorNamespace.RadStyleCommand.New(this.Title,this.Window,this.ClassName); } ,GetValue:function (oWindow){try {oWindow=oWindow || this.Window; var oDocument=oWindow.document; if (oDocument.all){return this.GetValueIE(oDocument); }else {return this.GetValueMoz(oWindow); }}catch (ex){return ""; }} ,GetValueIE:function (oDocument){var oSel=oDocument.selection; if (!oSel)return ""; var selRange=oSel.createRange( ); var parentElement=(selRange.length>0?selRange(0):selRange.parentElement( )); if ("\x42\x4fDY"==parentElement.tagName){return ""; }else {return (""==parentElement.className?"":parentElement.className); }} ,OnExecuteIE:function ( ){if (""==this.ClassName){return this.ClearStyleIE( ); }else {return this.ApplyStyleIE(this.ClassName); }} ,OnExecuteMoz:function ( ){if (""==this.ClassName){return this.ClearStyleMoz( ); }else {return this.ApplyStyleMoz(this.ClassName); }} ,ClearStyleIE:function ( ){var selection=RadEditorNamespace.RadSelection.New(this.Window); var parentNode=selection.GetParentElement( ); if (parentNode.tagName!="\x46ONT" && parentNode.tagName!="BO\x44Y"){parentNode.removeAttribute("c\x6cassname",0); var eParentNode=$ektron(parentNode); eParentNode.removeAttr("\x63lass\x4e\x61m\x65"); eParentNode.removeAttr("class"); if ("\x53PAN"==parentNode.tagName){var C=parentNode.outerHTML; if (/\x3c\x53\x50\x41\x4e\x3e/i.test(C)){eParentNode.unwrapInner( ); }}else {var spanChild=$ektron("\163pan",parentNode); spanChild.removeAttr("\x63las\x73\116a\x6de"); spanChild.removeAttr("\x63las\x73"); var C=spanChild.get(0).outerHTML; if (/\x3c\x53\x50\x41\x4e\x3e/i.test(C)){spanChild.unwrapInner( ); }}return true; }else {return this.Window.document.execCommand("Remov\x65Format"); }} ,ApplyStyleIE:function (sClassName){try {var selRange=this.Window.document.selection.createRange( ); var parentElement=(selRange.length>0?selRange(0):selRange.parentElement( )); if (parentElement.tagName=="LI"){var curText=selRange.htmlText; var matches=curText.match(/\x3c\x4c\x49\x2f?\x3e/gi); var itemCount=matches?matches.length: 0; if (itemCount>1){parentElement=parentElement.parentNode; }else if (itemCount==0 && (parentElement.innerHTML==selRange.htmlText) && parentElement.parentNode.childNodes.length==1){parentElement=parentElement.parentNode; }}if (selRange.length>0 || parentElement.tagName=="\117\x4c" || parentElement.tagName=="UL"){ this.SetElementClassName(parentElement,sClassName); }else if (""!=selRange.htmlText){var startRange=selRange.duplicate( ); var endRange=selRange.duplicate( ); startRange.collapse( true); endRange.collapse( false); var startElement=startRange.parentElement( ); var endElement=endRange.parentElement( ); if (startElement==endElement){var tmpRange=this.Window.document.body.createTextRange( ); tmpRange.moveToElementText(startElement); var tmpHtml=selRange.htmlText; var toContinue= false; var outerHTML=startElement.outerHTML.replace(/[\x0d\x0a\x09]/gi,""); var innerHTML=startElement.innerHTML.replace(/[\x0d\x0a\x09]/gi,""); var tmpHtml=tmpHtml.replace(/[\x0d\x0a\x09]/gi,""); if (outerHTML==tmpHtml || innerHTML==tmpHtml){toContinue= true; }if (toContinue || (0==tmpRange.compareEndPoints("\x53ta\x72\x74To\x53tart",selRange) && 0==tmpRange.compareEndPoints("EndTo\x45nd",selRange))){if ("\x42OD\x59"!=parentElement.tagName){ this.SetElementClassName(parentElement,sClassName); }else { this.ProcessTextSelection(sClassName,selRange); }}else { this.ProcessTextSelection(sClassName,selRange); }}else if (parentElement==endElement && parentElement.parentNode==startElement){ this.SetElementClassName(parentElement,sClassName); }else if (parentElement==endElement && parentElement==startElement.parentNode){ this.ProcessElementTextSelection(sClassName,selRange,startElement,endElement); }else if (parentElement==startElement && parentElement==endElement.parentNode){ this.ProcessTextElementSelection(sClassName,selRange,startElement,endElement); }else if (parentElement!=startElement && parentElement!=endElement){ this.ProcessElementElementSelection(sClassName,selRange,startElement,endElement); }}return true; }catch (ex){return false; }} ,GetFormatHtml:function (html,sClassName){var oFont=this.Window.document.createElement("\x73pan"); oFont.innerHTML=html; oFont.className=sClassName; return oFont.outerHTML; } ,SetElementClassName:function (oElement,sClassName){if (!oElement)return ""; if (""==RadEditorNamespace.Utils.IsNull(sClassName,"")){oElement.className=""; }else {var oldClassName=oElement.className; oElement.className=sClassName; return oldClassName; }} ,ProcessTextSelection:function (sClassName,selRange){var html=selRange.htmlText; selRange.pasteHTML(""); var tmpRange=selRange.duplicate( ); tmpRange.collapse( ); selRange.pasteHTML(this.GetFormatHtml(html,sClassName)); tmpRange.setEndPoint("\x45ndTo\x45\x6ed",selRange); } ,ProcessElementTextSelection:function (sClassName,selRange,startElement,endElement){var rngStartElement=selRange.duplicate( ); rngStartElement.moveToElementText(startElement); var tmpRange1=rngStartElement.duplicate( ); var isStartElementChanged=(0!=selRange.compareEndPoints("\x53ta\x72\164\x54oSt\x61rt",rngStartElement)); var tmpRange=selRange.duplicate( ); if (isStartElementChanged){tmpRange.setEndPoint("\x53ta\x72\164\x54oStart",rngStartElement); }var html=this.GetFormatHtml(selRange.htmlText,sClassName); selRange.pasteHTML(""); selRange.pasteHTML(html); tmpRange1.setEndPoint("En\x64ToEnd",selRange); } ,ProcessTextElementSelection:function (sClassName,selRange,startElement,endElement){var rngEndElement=selRange.duplicate( ); rngEndElement.moveToElementText(endElement); var isEndElementChanged=(0!=selRange.compareEndPoints("\105\x6ed\x54\x6fEn\x64",rngEndElement)); var tmpRange=selRange.duplicate( ); if (isEndElementChanged){tmpRange.setEndPoint("\x45n\x64\x54oE\x6e\144",rngEndElement); }rngEndElement.setEndPoint("\x45ndTo\x45\156\x64",selRange); var rngStartSel=selRange.duplicate( ); rngStartSel.setEndPoint("\x45ndTo\x53\x74a\x72\164",rngEndElement); var html=rngStartSel.htmlText+rngEndElement.htmlText; selRange.pasteHTML(""); selRange.moveEnd("\x63h\x61\162\x61cter",-1); selRange.moveStart("\x63harac\x74\145\x72",1); var tmpRange1=selRange.duplicate( ); tmpRange1.collapse( ); selRange.pasteHTML(this.GetFormatHtml(html,sClassName)); tmpRange1.setEndPoint("EndToE\x6ed",selRange); } ,ProcessElementElementSelection:function (sClassName,selRange,startElement,endElement){var rngStartElement=selRange.duplicate( ); rngStartElement.moveToElementText(startElement); var rngEndElement=selRange.duplicate( ); rngEndElement.moveToElementText(endElement); var isStartElementChanged=(0!=selRange.compareEndPoints("\x53tar\x74\x54oS\x74art",rngStartElement)); var isEndElementChanged=(0!=selRange.compareEndPoints("E\x6edToEnd",rngEndElement)); var tmpRange=selRange.duplicate( ); tmpRange.setEndPoint("StartToS\x74art",rngStartElement); tmpRange.setEndPoint("E\x6edToEnd",rngEndElement); if (!isStartElementChanged && !isEndElementChanged){var html=selRange.htmlText; selRange.pasteHTML(""); var tmpRange1=selRange.duplicate( ); tmpRange1.collapse( ); selRange.pasteHTML(this.GetFormatHtml(html,sClassName)); tmpRange.setEndPoint("\x45ndT\x6f\x45nd",selRange); }else {var selHtmlText=selRange.htmlText; selRange.pasteHTML(""); var tmpRange=selRange.duplicate( ); tmpRange.collapse( ); rngEndElement.setEndPoint("St\x61rtToStar\x74",selRange); var endHtmlText=rngEndElement.htmlText; rngEndElement.pasteHTML(""); selRange.pasteHTML(this.GetFormatHtml(selHtmlText,sClassName)+endHtmlText); tmpRange.setEndPoint("EndToEnd",selRange); }} ,ClearStyleMoz:function ( ){var v=new Ektron.SelectionRange( {window: this.Window } ); var oRng=v.getDomRange( ); var parentNode=v.getContainerElement( ); if (parentNode.tagName!="FONT"){parentNode.className=""; $ektron(parentNode).removeAttr("\x63las\x73"); if ("SPAN"==parentNode.tagName){if ( false ==parentNode.hasAttributes( )){$ektron(parentNode).unwrapInner( ); }}else {var spanChild=$ektron("\x73pa\x6e",parentNode); spanChild.removeAttr("\x63lass"); if ( false ==spanChild.get(0).hasAttributes( )){spanChild.unwrapInner( ); }}return true; }else {return this.Window.document.execCommand("Re\x6doveForm\x61t", false ,null); }} ,GetValueMoz:function (oWindow){if (!oWindow)return ""; var oSelection=oWindow.getSelection( ); if (!oSelection){return; }if (oSelection.rangeCount!=1)return ""; var startNode=(oSelection.focusNode.nodeType!=3?oSelection.focusNode:oSelection.focusNode.parentNode); var endNode=(oSelection.anchorNode.nodeType!=3?oSelection.anchorNode:oSelection.anchorNode.parentNode); if (startNode!=endNode)return ""; var radSel=RadEditorNamespace.RadSelection.New(oWindow); var className="",parent; if (null!=radSel && null!=(parent=radSel.GetParentElement( ))){className=parent.className; }return (""==className?"":className); } ,ApplyStyleSafari:function (sClassName){var oSelection=this.Window.getSelection( ); var range=RadEditorNamespace.RadSelection.New(this.Window).GetRange( ); var startContainer=oSelection.baseNode?oSelection.baseNode:range.startContainer; var endContainer=oSelection.extentNode?oSelection.extentNode:range.endContainer; if (startContainer.nodeType==3 || endContainer.nodeType==3){var html=RadEditorNamespace.RadSelection.New(this.Window).GetHtmlText( ); RadEditorNamespace.RadPasteHtmlCommand.New("",this.Window,"\074\x73pan\x20\143\x6c\141\x73s=\042"+sClassName+"\042\x3e"+html+"\x3c/s\x70\x61n>").OnExecute( ); }else {var radSel=RadEditorNamespace.RadSelection.New(this.Window); radSel.GetParentElement( ).className=sClassName; }return true; } ,ApplyStyleMoz:function (sClassName){try {if (TelerikNamespace.Utils.DetectBrowser("safari")){return this.ApplyStyleSafari(sClassName); } ; }catch (ex){}var oSelection=this.Window.getSelection( ); if (oSelection.rangeCount<1)return; var range=oSelection.getRangeAt(0); var ancestor=range.commonAncestorContainer.parentNode; var tempNode=this.Window.document.createElement("\x53PA\x4e"); tempNode.appendChild(range.cloneContents( )); var tempContent=tempNode.innerHTML; var toContinue= true; if (tempContent==ancestor.innerHTML){toContinue= false; }var directParent=range.commonAncestorContainer; if (directParent.tagName=="U\x4c" || directParent.tagName=="\x4fL"){var curText=directParent.innerHTML; var matches=curText.match(/\x3c\x4c\x49\x2f?\x3e/gi).length; var itemCount=matches?matches.length: 0; if (itemCount>1){RadEditorNamespace.Utils.SelectElement(this.Window,directParent); toContinue= false; }}else if (ancestor.tagName=="LI"){if (tempContent==ancestor.innerHTML && ancestor.parentNode.childNodes.length==1){RadEditorNamespace.Utils.SelectElement(this.Window,ancestor.parentNode); toContinue= false; }}if (toContinue && (range.startContainer.nodeType==3 || range.endContainer.nodeType==3)){var formatNode=this.Window.document.createElement("SP\x41N"); formatNode.className=sClassName; formatNode.appendChild(range.extractContents( )); range.insertNode(formatNode); }else {var radSel=RadEditorNamespace.RadSelection.New(this.Window); radSel.GetParentElement( ).className=sClassName; }return true; }} ;
RadEditorNamespace.RadTableCommandBase= {New:function (sTitle,canUnexecute,oWindow){var obj=RadEditorNamespace.RadCommandBase.New(sTitle,canUnexecute,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); return obj; } ,GetState:function (oWindow){return this.GetSelectedCell(oWindow)?RadEditorNamespace.RADCOMMAND_STATE_OFF:RadEditorNamespace.RADCOMMAND_STATE_DISABLED; } ,GetSelectedCell:function (oWindow){var selection=RadEditorNamespace.RadSelection.New(oWindow || this.Window); var parentElement; if (selection){parentElement=selection.GetParentElement( ); }while (null!=parentElement && parentElement.tagName!="TD" && parentElement.tagName!="T\x48" && parentElement.tagName!="B\x4f\104\x59"){parentElement=parentElement.parentNode; }if (!parentElement || !parentElement.tagName)return null; return (parentElement.tagName=="TD" || parentElement.tagName=="\x54H"?parentElement:null); } ,GetSelectedRow:function (oWindow){var selection=RadEditorNamespace.RadSelection.New(oWindow || this.Window); var parentElement; if (selection){parentElement=selection.GetParentElement( ); }if (!parentElement)return null; while (null!=parentElement && parentElement.tagName!="TR" && parentElement.tagName!="BODY"){parentElement=parentElement.parentNode; }return (parentElement && parentElement.tagName=="TR"?parentElement:null); } ,GetParentTable:function (oNode){if (!oNode)return null; while (null!=oNode && oNode.parentNode!=oNode && "\x54ABLE"!=oNode.tagName){oNode=oNode.parentNode; }return (oNode && oNode.tagName=="TABLE"?oNode:null); } ,GetNextSiblingCell:function (cell){if (!cell)return null; var row=cell.parentNode; var nextIndex=cell.cellIndex+1; if (0<=nextIndex && nextIndex<row.cells.length)return row.cells[nextIndex]; return null; } ,GetPreviouseSiblingCell:function (cell){if (!cell)return null; var row=cell.parentNode; var prevIndex=cell.cellIndex-1; if (0<=prevIndex && prevIndex<row.cells.length)return row.cells[prevIndex]; return null; }} ; RadEditorNamespace.RadTableInsertRow= {New:function (sTitle,oWindow,direction){var obj=RadEditorNamespace.RadTableCommandBase.New((sTitle || "Insert\x20row"), true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.Direction=direction || "above"; return obj; } ,Clone:function ( ){return RadEditorNamespace.RadTableInsertRow.New(this.Title,this.Window,this.Direction); } ,GetState:function (oWindow){return (this.GetSelectedRow(oWindow)?RadEditorNamespace.RADCOMMAND_STATE_OFF:RadEditorNamespace.RADCOMMAND_STATE_DISABLED); } ,OnExecute:function ( ){var cell=this.GetSelectedCell( ); if (!cell)return false; var row=cell.parentNode; var newRowIndex=row.rowIndex; if ("below"==this.Direction)newRowIndex++; var table=this.GetParentTable(row); if (!table)return false; var newRow=table.insertRow(newRowIndex); if (!newRow)return false; RadEditorNamespace.Utils.MergeElementAttributes(row,newRow); var newCell; for (var i=0; i<row.cells.length; i++){cell=row.cells[i]; if ("TH"==cell.tagName){newCell=this.Window.document.createElement("\x74h"); newRow.appendChild(newCell); }else {newCell=newRow.insertCell(newRow.cells.length); }newCell.colSpan=cell.colSpan; RadEditorNamespace.Utils.MergeElementAttributes(cell,newCell); newCell.innerHTML=document.all?"": "\046\x6ebsp;"; }return true; }} ; RadEditorNamespace.RadTableDeleteRow= {New:function (sTitle,oWindow){var obj=RadEditorNamespace.RadTableCommandBase.New(sTitle, true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); return obj; } ,Clone:function ( ){return RadEditorNamespace.RadTableDeleteRow.New(this.Title,this.Window); } ,GetState:function (oWindow){return (this.GetSelectedRow(oWindow)?RadEditorNamespace.RADCOMMAND_STATE_OFF:RadEditorNamespace.RADCOMMAND_STATE_DISABLED); } ,OnExecute:function ( ){var row=this.GetSelectedRow( ); if (!row)return false; row.parentNode.removeChild(row); return true; }} ; RadEditorNamespace.RadTableInsertColumn= {New:function (sTitle,oWindow,direction){var obj=RadEditorNamespace.RadTableCommandBase.New((sTitle || "Insert \x63olumn"), true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.Direction=direction || "\x6ceft"; return obj; } ,Clone:function ( ){return RadEditorNamespace.RadTableInsertColumn.New(this.Title,this.Window,this.Direction); } ,GetState:function (oWindow){return (this.GetSelectedCell(oWindow)?RadEditorNamespace.RADCOMMAND_STATE_OFF:RadEditorNamespace.RADCOMMAND_STATE_DISABLED); } ,OnExecute:function ( ){var cell=this.GetSelectedCell( ); if (!cell)return false; var newCellIndex=cell.cellIndex; if ("right"==this.Direction)newCellIndex++; var table=this.GetParentTable(cell); if (!table)return false; var rows=table.rows; var newCell; for (var i=0; i<rows.length; i++){if ("THE\x41D"==rows[i].parentNode.tagName){newCell=this.Window.document.createElement("\164\x68"); if (0==newCellIndex && "left"==this.Direction){$ektron(":\x6eth-chil\x64(1)",rows[i]).before(newCell); }else {$ektron(":nt\x68-child\x28"+newCellIndex+")",rows[i]).after(newCell); }}else {newCell=rows[i].insertCell(newCellIndex); }RadEditorNamespace.Utils.MergeElementAttributes(cell,newCell); newCell.innerHTML=document.all?"": "\046\x6ebsp;"; }return true; }} ; RadEditorNamespace.RadTableDeleteColumn= {New:function (sTitle,oWindow){var obj=RadEditorNamespace.RadTableCommandBase.New(sTitle, true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); return obj; } ,Clone:function ( ){return RadEditorNamespace.RadTableDeleteColumn.New(this.Title,this.Window); } ,GetState:function (oWindow){return (this.GetSelectedCell(oWindow)?RadEditorNamespace.RADCOMMAND_STATE_OFF:RadEditorNamespace.RADCOMMAND_STATE_DISABLED); } ,OnExecute:function ( ){var cell=this.GetSelectedCell( ); if (!cell)return false; var cellIndex=cell.cellIndex; var table=this.GetParentTable(cell); if (!table)return false; var rows=table.rows; for (var i=0; i<rows.length; i++){cell=rows[i].cells[cellIndex]; if (cell){cell.parentNode.removeChild(cell); }}return true; }} ; RadEditorNamespace.RadTableMergeRows= {New:function (sTitle,oWindow){var obj=RadEditorNamespace.RadTableCommandBase.New(sTitle, true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); return obj; } ,Clone:function ( ){return RadEditorNamespace.RadTableMergeRows.New(this.Title,this.Window); } ,GetState:function (oWindow){var cell=this.GetSelectedCell(oWindow); if (null!=cell && null!=this.GetLowerCell(cell) && 1==cell.colSpan){return RadEditorNamespace.RADCOMMAND_STATE_OFF; }else {return RadEditorNamespace.RADCOMMAND_STATE_DISABLED; }} ,OnExecute:function ( ){var cell=this.GetSelectedCell( ); if (!cell)return false; var lowerCell=this.GetLowerCell(cell); if (!lowerCell)return false; if (""!=lowerCell.innerHTML){if (""!=cell.innerHTML){cell.innerHTML+="\x3cbr>"; }cell.innerHTML+=lowerCell.innerHTML; }cell.rowSpan+=lowerCell.rowSpan; lowerCell.parentNode.removeChild(lowerCell); return true; } ,GetLowerCell:function (cell){if (!cell)return null; var table=this.GetParentTable(cell); var row=cell.parentNode; var nextRow=table.rows[row.rowIndex+cell.rowSpan]; if (!nextRow)return null; var lowerCell=nextRow.cells[cell.cellIndex]; return lowerCell; }} ; RadEditorNamespace.RadTableMergeColumns= {New:function (sTitle,oWindow){var obj=RadEditorNamespace.RadTableCommandBase.New(sTitle, true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); return obj; } ,Clone:function ( ){return RadEditorNamespace.RadTableMergeColumns.New(this.Title,this.Window); } ,GetState:function (oWindow){var cell=this.GetSelectedCell(oWindow); if (null!=cell && null!=this.GetNextSiblingCell(cell))return RadEditorNamespace.RADCOMMAND_STATE_OFF; else return RadEditorNamespace.RADCOMMAND_STATE_DISABLED; } ,OnExecute:function ( ){var cell=this.GetSelectedCell( ); if (null==cell)return false; var nextSibling=this.GetNextSiblingCell(cell); if (!nextSibling)return false; cell.colSpan+=nextSibling.colSpan; if (""!=nextSibling.innerHTML){if (""!=cell.innerHTML){cell.innerHTML+="\x3cbr>"; }cell.innerHTML+=nextSibling.innerHTML; }nextSibling.parentNode.removeChild(nextSibling); return true; }} ; RadEditorNamespace.RadTableSplitCell= {New:function (sTitle,oWindow){var obj=RadEditorNamespace.RadTableCommandBase.New(sTitle, true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.NewRows=2; obj.NewColumns=2; return obj; } ,Clone:function ( ){return RadEditorNamespace.RadTableSplitCell.New(this.Title,this.Window); } ,GetState:function (oWindow){var cell=this.GetSelectedCell(oWindow); if (!cell)return RadEditorNamespace.RADCOMMAND_STATE_DISABLED; return ((cell.colSpan>1 || cell.rowSpan>1)?RadEditorNamespace.RADCOMMAND_STATE_OFF:RadEditorNamespace.RADCOMMAND_STATE_DISABLED); } ,OnExecute:function ( ){var cell=this.GetSelectedCell( ); if (!cell)return false; var table=this.GetParentTable(cell); if (!table)return false; var row=cell.parentNode; var tagName=("\x54HEAD"==row.parentNode.tagName.toUpperCase( )?"\x54H": "\x54D"); if (cell.colSpan>1){for (i=1; i<this.NewColumns; i++){var newCell=this.Window.document.createElement(tagName); newCell.innerHTML=document.all?"": "&nbsp;"; RadEditorNamespace.Utils.MergeElementAttributes(cell,newCell); newCell.colSpan=1; if (cell.cellIndex+1<row.cells.length){row.insertBefore(newCell,row.cells[cell.cellIndex+1]); }else {row.appendChild(newCell); }cell.colSpan--; }}if (cell.rowSpan>1){for (i=1; i<this.NewRows; i++){var targetRow=table.rows[row.rowIndex+cell.rowSpan-1]; if (!targetRow || 0==targetRow.cells.length){break; }var newCell=this.Window.document.createElement(tagName); newCell.innerHTML=document.all?"": "&nbsp\x3b"; RadEditorNamespace.Utils.MergeElementAttributes(cell,newCell); newCell.rowSpan=1; if (cell.cellIndex+1<targetRow.cells.length){targetRow.insertBefore(newCell,targetRow.cells[cell.cellIndex+1]); }else {targetRow.appendChild(newCell); }cell.rowSpan--; }}return true; }} ; RadEditorNamespace.RadTableDeleteCell= {New:function (sTitle,oWindow){var obj=RadEditorNamespace.RadTableCommandBase.New(sTitle, true ,oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); return obj; } ,Clone:function ( ){return RadEditorNamespace.RadTableDeleteCell.New(this.Title,this.Window); } ,OnExecute:function ( ){var cell=this.GetSelectedCell( ); if (!cell)return false; cell.parentNode.removeChild(cell); return true; }} ;
RadEditorNamespace.RadTextTypeCommand= {New:function (sTitle,oWindow){var obj=RadEditorNamespace.RadGenericCommand.New((sTitle || "\x54\x79ping"),oWindow); RadEditorNamespace.Utils.ExtendObject(obj,this ); return obj; } ,Update:function ( ){if (this.RestorePoint2){ this.RestorePoint2.Update( ); }}} ;
RadEditorNamespace.UpdateCommandsArray= {} ; RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_INSERT_ORDERED_LIST]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_INSERT_ORDERED_LIST); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_INSERT_UNORDERED_LIST]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_INSERT_UNORDERED_LIST); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_UNLINK]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_UNLINK); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_BOLD]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_BOLD); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_ITALIC]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_ITALIC); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_UNDERLINE]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_UNDERLINE); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_FORECOLOR]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_FORECOLOR); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_BACKCOLOR]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_BACKCOLOR); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_FONTNAME]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_FONTNAME); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_FONTSIZE]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_FONTSIZE); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_REAL_FONTSIZE]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_REAL_FONTSIZE); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_PASTE]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_PASTE); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_CUT]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_CUT); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_COPY]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_COPY); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_JUSTIFY_LEFT]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_JUSTIFY_LEFT); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_JUSTIFY_RIGHT]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_JUSTIFY_RIGHT); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_JUSTIFY_CENTER]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_JUSTIFY_CENTER); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_JUSTIFY_NONE]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_JUSTIFY_NONE); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_INDENT]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_INDENT); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_OUTDENT]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_OUTDENT); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_UNLINK]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_UNLINK); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_FORMAT_BLOCK]=RadEditorNamespace.RadFormatBlockCommand.New(null,null,null); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_APPLY_CLASS]=RadEditorNamespace.RadStyleCommand.New( ); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_INSERT_ROW_ABOVE]=RadEditorNamespace.RadTableInsertRow.New(null,null,"above"); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_INSERT_ROW_BELOW]=RadEditorNamespace.RadTableInsertRow.New(null,null,"\x62\x65low"); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_INSERT_COLUMN_LEFT]=RadEditorNamespace.RadTableInsertColumn.New(null,null,"\x6c\145\x66t"); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_INSERT_COLUMN_RIGHT]=RadEditorNamespace.RadTableInsertColumn.New(null,null,"\x72i\x67\x68t"); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_DELETE_ROW]=RadEditorNamespace.RadTableDeleteRow.New(null,null); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_DELETE_COLUMN]=RadEditorNamespace.RadTableDeleteColumn.New(null,null); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_DELETE_CELL]=RadEditorNamespace.RadTableDeleteCell.New(null,null); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_MERGE_COLUMNS]=RadEditorNamespace.RadTableMergeColumns.New(null,null); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_MERGE_ROWS]=RadEditorNamespace.RadTableMergeRows.New(null,null); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_SPLIT_CELL]=RadEditorNamespace.RadTableSplitCell.New(null,null); if ("u\x6edefined"==typeof(RadEditorToolInitializer)){var RadEditorToolInitializer= {} ; }if ("\x75ndefin\x65\144"==typeof(RadEditorCommandList)){var RadEditorCommandList= {} ; }RadEditorCommandList["InsertAn\x63hor"]=RadEditorCommandList["Ins\x65rtEmailL\x69\156\x6b"]= function (commandName,editor,oTool){var oTool= {SelectedTab: ("Ins\x65rtAnchor"==commandName?1: 2)} ; editor.Fire("\x4cinkMa\x6e\141\x67er",oTool); } ; RadEditorCommandList["\x49ncrea\x73\145\x53\151\x7a\x65"]=RadEditorCommandList["Dec\x72easeSize"]= function (commandName,editor,oTool){if ( true ==editor.ToggleFullScreen)return; var oStep=70; var toIncrease=(commandName=="\x49ncreas\x65\123\x69\172\x65"); var oRect=RadEditorNamespace.Utils.GetRect(editor.WrapperElement); var width=oRect.width+(toIncrease?oStep: -oStep); var height=oRect.height+(toIncrease?oStep: -oStep); if (width<0 || height<0)return; editor.SetSize(width,height); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_TAB]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SHIFT_TAB]= function (commandName,editor,oTool){if (!editor.EnableTab)return; var bIndentOrOutdent= false; var objSel=new Ektron.SelectionRange( {window:editor.ContentWindow } ); var objElem=objSel.getContainerElement( ); var $li=$ektron(objElem).closest("\x6ci"); if ($li.length>0){var rng=objSel.getDomRange( ); objSel.moveToNode($li.get(0)); var rngComp=objSel.getDomRange( ); if (typeof rngComp.compareBoundaryPoints!="u\x6edefined"){var result=rngComp.compareBoundaryPoints(rng.START_TO_START,rng); if (0 === result){bIndentOrOutdent= true; }var sel=objSel.getDomSelection( ); sel.removeAllRanges( ); sel.addRange(rng); }else if (typeof rngComp.compareEndPoints!="\x75nde\x66\x69ne\x64"){var result=rngComp.compareEndPoints("\x53ta\x72\164\x54oStart",rng); if (0 === result){bIndentOrOutdent= true; }rng.select( ); }}if (bIndentOrOutdent){if (RadEditorNamespace.RADCOMMAND_TAB==commandName){editor.Fire(RadEditorNamespace.RADCOMMAND_INDENT); }else {editor.Fire(RadEditorNamespace.RADCOMMAND_OUTDENT); }}else if (RadEditorNamespace.RADCOMMAND_TAB==commandName){editor.PasteHtml(" &nbs\x70;&nbsp;\x26\156\x62sp;&n\x62sp;"); }return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_BOLD]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_ITALIC]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_UNDERLINE]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_JUSTIFY_LEFT]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_JUSTIFY_RIGHT]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_JUSTIFY_CENTER]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_JUSTIFY_NONE]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INDENT]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_OUTDENT]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SELECT_ALL]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_UNLINK]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_JUSTIFY_FULL]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_STRIKETHROUGH]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SUBSCRIPT]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SUPERSCRIPT]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_ABSOLUTE_POSITION]= function (commandName,editor,oTool){var bCanUnexecute=RadEditorNamespace.RADCOMMAND_SELECT_ALL!=commandName; editor.SetActive( ); if (commandName!=RadEditorNamespace.RADCOMMAND_SELECT_ALL){try {if (editor.Document.selection){var rng=editor.Document.selection.createRange( ); rng.select( ); }}catch (ex){}}editor.ExecuteBrowserCommand(commandName,bCanUnexecute,null); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_FORECOLOR]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_BACKCOLOR]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_FONTNAME]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_FONTSIZE]= function (commandName,editor,oTool){var value=oTool.GetSelectedValue( ); var element=editor.GetSelection( ).GetParentElement( ); if (commandName==RadEditorNamespace.RADCOMMAND_FONTSIZE && element && element.tagName=="\x46ONT"){RadEditorNamespace.Utils.RemoveElementStyleAttribute(element,"\x66ontSize"); }editor.ExecuteBrowserCommand(commandName, true ,value); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_REAL_FONTSIZE]= function (commandName,editor,oTool){var newFontSize=oTool.GetSelectedValue( ); var genericCmd=RadEditorNamespace.RadGenericCommand.New("\x53et\x20\x72ea\x6c\040\146o\x6et siz\x65",editor.ContentWindow); var retVal=RadEditorNamespace.MarkEditorSelection(editor); var elementsToModify=retVal.markedElements; var restorePoint=editor.CreateRestorePoint( ); var extraContent=""; var parElem=editor.GetSelection( ).GetParentElement( ); if (editor.IsIE && elementsToModify.length==0 && !editor.GetSelectionHtml( ) && (parElem.tagName=="FONT" || parElem.tagName=="SPAN")){editor.Document.execCommand("Remo\x76eFormat",null, false); }if (elementsToModify.length==0){editor.PasteHtml(extraContent+"\074\x66ont \x73\164\x79\154\x65=\047\x66ont-\x73ize:"+newFontSize+"\047\x20id=\047radERea\x6cFont\047\x3e&n\x62sp;\074\x2ffon\x74>"); var oFont=editor.Document.getElementById("\x72adE\x52\x65al\x46ont"); if (!oFont)return; oFont.removeAttribute("id"); if (editor.IsIE){editor.SelectElement(oFont); editor.GetSelection( ).Collapse( ); oFont.innerHTML=""; }else if (editor.ContentWindow.getSelection){var oSel=editor.ContentWindow.getSelection( ); var range=editor.GetSelection( ).GetRange( ); oSel.removeAllRanges( ); if (range && range.selectNodeContents)range.selectNodeContents(oFont); oSel.addRange(range); }return; }for (var i=0; i<elementsToModify.length; i++){var curElem=elementsToModify[i]; var _moz=null; if (!editor.IsIE){_moz=curElem.getAttribute("_m\x6fz_dirty"); }if ("\x73trin\x67"==typeof _moz && "\x26nbsp\x3b"==curElem.innerHTML){$ektron(curElem).unwrapInner( ); }else if (1==curElem.children.length && 1==$ektron("\x2econt\x65\x6et\x55\163\x61bili\x74\171",curElem).length){$ektron(curElem).unwrapInner( ); }else {if (0==curElem.children.length){curElem.style.fontSize=newFontSize; curElem.removeAttribute('\x73ize'); }else if ("\x46ONT"==curElem.tagName){$ektron(curElem).unwrapInner( ); }}}if (restorePoint)restorePoint.Select( ); editor.ExecuteCommand(genericCmd); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_CONVERT_TO_LOWER]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_CONVERT_TO_UPPER]= function (commandName,editor,oTool){var startR; var endR; if (document.all){if (editor.Document.selection.type.toLowerCase( )=='con\x74rol'){return; }var oRange=editor.Document.selection.createRange( ); startR=oRange.duplicate( ); endR=oRange.duplicate( ); startR.collapse( ); endR.collapse( false); }var retVal=RadEditorNamespace.MarkEditorSelection(editor); var undoString=(RadEditorNamespace.RADCOMMAND_CONVERT_TO_LOWER==commandName)?"\103\x6f\156v\x65rt to l\x6fwer": "\x43onvert t\x6f upper"; var genericCmd=RadEditorNamespace.RadGenericCommand.New(undoString,editor.ContentWindow); var elementsToModify=retVal.markedElements; var newElements=retVal.newElements; for (var i=0; i<elementsToModify.length; i++){changeChildNodesCase(elementsToModify[i]); }for (var i=0; i<newElements.length; i++){if (document.all){newElements[i].removeNode( false); }else {var range=document.createRange( ); range.selectNodeContents(newElements[i]); newElements[i].parentNode.replaceChild(range.extractContents( ),newElements[i]); }}if (document.all && !window.opera){var oNewRange=editor.Document.selection.createRange( ); oNewRange.setEndPoint("\x53ta\x72\164\x54oStart",startR); oNewRange.setEndPoint("\x45ndToEn\x64",endR); oNewRange.select( ); }else {var selection=editor.ContentWindow.getSelection( ); var rng=selection.getRangeAt(0); rng.collapse( true); }editor.ExecuteCommand(genericCmd); function changeChildNodesCase(domElement){var childs=domElement.childNodes; for (var i=0; i<childs.length; i++){if (childs[i].nodeType==3){childs[i].nodeValue=(RadEditorNamespace.RADCOMMAND_CONVERT_TO_LOWER==commandName)?childs[i].nodeValue.toLowerCase( ):childs[i].nodeValue.toUpperCase( ); }else if (childs[i].nodeType==1 && childs[i].tagName.toUpperCase( )!='F\x4fNT'){changeChildNodesCase(childs[i]); }}}} ; RadEditorNamespace.MarkEditorSelection= function (editor){var dummyFontName='\x41ZBY'; var customAttrMark='\x5fcm'; var keptFontElements=[ ]; var markedFontElements=[ ]; var newFontElements=[ ]; try {var oSel=editor.GetSelection( ); if (oSel.IsControl( )){var controlElement=oSel.GetParentElement( ); var fontElement=editor.Document.createElement('\x46ONT'); fontElement.appendChild(controlElement.cloneNode( true)); controlElement.parentNode.replaceChild(fontElement,controlElement); return {markedElements: [fontElement],newElements: [fontElement] };}var fontTag='\x66ont'; keepFontNames( ); var editorArea=editor.ContentArea; if (!document.all){editorArea.ownerDocument.execCommand("\x55seCS\x53", false , true); }editorArea.ownerDocument.execCommand("F\x6f\156\x74Name", false ,dummyFontName); var elementsToModify=editorArea.getElementsByTagName(fontTag); for (var i=0; i<elementsToModify.length; i++){var fontElement=elementsToModify[i]; if (fontElement.getAttribute('face')==dummyFontName || fontElement.style.fontFamily==dummyFontName){fontElement.removeAttribute('\x66ace'); if (fontElement.style.fontFamily==dummyFontName)fontElement.style.fontFamily=""; markedFontElements.push(fontElement); var arrChilds=fontElement.getElementsByTagName(fontTag); for (var j=0; j<arrChilds.length; j++){var _o=arrChilds[j]; if (_o.getAttribute('\x66ace')!=dummyFontName){markedFontElements.push(_o);}}if (!fontElement.getAttribute(customAttrMark)){newFontElements.push(fontElement); }}fontElement.removeAttribute(customAttrMark); }restoreFontNames( ); if (!document.all){editorArea.ownerDocument.execCommand("U\x73eCSS", false , false); }}catch (ex){markedFontElements=[ ]; newFontElements=[ ]; }function keepFontNames( ){var arrFonts=editor.ContentArea.getElementsByTagName(fontTag); for (var i=0; i<arrFonts.length; i++){var fontElement=arrFonts[i]; if (arrFonts[i].face){fontElement.setAttribute('\x5fface',fontElement.face); keptFontElements.push(fontElement); }fontElement.setAttribute(customAttrMark,1); }}function restoreFontNames( ){for (var i=0; i<keptFontElements.length; i++){keptFontElements[i].face=keptFontElements[i].getAttribute('\x5fface'); keptFontElements[i].removeAttribute('_\x66\141\x63\145'); }keptFontElements=[ ]; }return {markedElements:markedFontElements,newElements:newFontElements } ; };RadEditorCommandList[RadEditorNamespace.RADCOMMAND_COPY]= function (commandName,editor,oTool){if (null!=oTool){var isEnabled=window.opera? false : true; if (isEnabled){try {document.queryCommandEnabled(commandName); }catch (e){isEnabled= false; }}if (isEnabled){editor.Document.execCommand(commandName, false ,null); }else {if (ekIsMac( )){alert(editor.Localization["Use\x41ppleKey_\x43"]); }else {alert(editor.Localization["Us\x65Ctrl_C"]); }var v=new Ektron.SelectionRange( {window:editor.ContentWindow } ); var oRng=v.getDomRange( ); oRng.collapse( true); }}} ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_CUT]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_PASTE]= function (commandName,editor,oTool){if (null!=oTool){var isEnabled=(window.opera || editor.IsSafari)? false : true; if (isEnabled){try {editor.ToolsUpdate= true; document.queryCommandEnabled(commandName); editor.ToolsUpdate= false; }catch (e){isEnabled= false; }}if (commandName==RadEditorNamespace.RADCOMMAND_PASTE && isEnabled && editor.IsIE7 && editor.Document.createEventObject){editor.Document.body.fireEvent("onbefor\x65paste"); }if (isEnabled){var oCmd=RadEditorNamespace.RadGenericCommand.New(editor.Localization[commandName],editor.ContentWindow); editor.Document.execCommand(commandName, false ,null); editor.ExecuteCommand(oCmd); }else {var id=""; if (ekIsMac( )){id=(commandName==RadEditorNamespace.RADCOMMAND_CUT?"UseA\x70pleKey_X": "\x55se\x41\x70pl\x65\113\x65y_V"); }else {id=(commandName==RadEditorNamespace.RADCOMMAND_CUT?"UseCt\x72l_X": "UseC\x74rl_V"); }alert(editor.Localization[id]); var v=new Ektron.SelectionRange( {window:editor.ContentWindow } ); var oRng=v.getDomRange( ); oRng.collapse( true); }}else {editor.PendingCommand=RadEditorNamespace.RadGenericCommand.New(editor.Localization[commandName],editor.ContentWindow); if (!editor.IsIE && commandName==RadEditorNamespace.RADCOMMAND_PASTE){window.setTimeout( function ( ){editor.onContentPaste( ); } ,1); }}} ; Ektron.RegExp.WhitespaceOrEmpty=new RegExp("^"+Ektron.RegExp.CharacterClass.s+"\x2a$"); Ektron.RegExp.IsOnEnterParentTag=/^(\x70|\x6c\x69|\x64\x69\x76|\x68[\x31-\x36]|\x63\x65\x6e\x74\x65\x72|\x64\x74|\x64\x64|\x70\x72\x65|\x61\x64\x64\x72\x65\x73\x73)$/i; Ektron.RegExp.IsHeadingTag=/^\x68[\x31-\x36]$/i; RadEditorCommandList["\x45nter"]= function (commandName,editor,oTool){if (!editor.NewLineBr){if (editor.IsIE){editor.ShortcutHit= false; return false; }else if (!editor.IsSafari && !window.opera){var contentWindow=editor.ContentWindow; var oDoc=contentWindow.document; function checkParent(parent,parentPath){parentPath[parentPath.length]=parent; while (parent!=null && !Ektron.RegExp.IsOnEnterParentTag.test(parent.tagName)){if (Ektron.SelectionRange.isBlockTag(parent.tagName))return null; parent=parent.parentNode; if ($ektron(parent).hasClass("design\x5fmembran\x65"))return null; parentPath[parentPath.length]=parent; }return parent; }var selection=contentWindow.getSelection( ); if (0==selection.rangeCount){return false; }var range=selection.getRangeAt(0); var contentRange=range.cloneRange( ); range.deleteContents( ); var startPosition=range.startOffset; var container=range.startContainer; var content=""; var parentPath=[ ]; var inP=checkParent(container,parentPath); if (inP){if (inP.firstChild!=inP.lastChild && "BR"==inP.lastChild.tagName){inP.removeChild(inP.lastChild); }var strHtml=inP.innerHTML; var emptyParent=(""==strHtml || "\x3cbr>"==strHtml || "\x26nbsp;"==strHtml || " "==strHtml); if (emptyParent && "LI"==inP.tagName){var newCommand; if ("\x4fL"==inP.parentNode.tagName){newCommand=RadEditorNamespace.RADCOMMAND_INSERT_ORDERED_LIST; }else if ("\x55L"==inP.parentNode.tagName){newCommand=RadEditorNamespace.RADCOMMAND_INSERT_UNORDERED_LIST; }if (newCommand){var selection=contentWindow.getSelection( ); var range=oDoc.createRange( ); inP.innerHTML="\x3cp>\x26\043\x3160;\074\057\x70>"; range.setStart(inP.firstChild,0); range.setEnd(inP.firstChild,1); selection.removeAllRanges( ); selection.addRange(range); editor.Fire(newCommand); return false; }}var beginRange=range.cloneRange( ); beginRange.setStart(inP,0); beginRange.setEnd(container,startPosition); var beginFragment=beginRange.cloneContents( ); if (beginFragment){if (!beginFragment.hasChildNodes( )){beginFragment=null; }else if (1==beginFragment.childNodes.length && Ektron.RegExp.WhitespaceOrEmpty.test(beginFragment.textContent)){beginFragment=null; }}if (!emptyParent){var endRange=range.cloneRange( ); endRange.setStart(container,startPosition); if (inP.lastChild){endRange.setEndAfter(inP.lastChild); }else {endRange.setEnd(inP,0); }var endFragment=endRange.cloneContents( ); if (endFragment){if (!endFragment.hasChildNodes( )){endFragment=null; }else {if (1==endFragment.childNodes.length && Ektron.RegExp.WhitespaceOrEmpty.test(endFragment.textContent)){endFragment=null; }else if (2==endFragment.childNodes.length && Ektron.RegExp.WhitespaceOrEmpty.test(endFragment.firstChild.nodeValue) && ("BR"==endFragment.lastChild.nodeName || Ektron.RegExp.WhitespaceOrEmpty.test(endFragment.lastChild.nodeValue))){endFragment=null; }}}}try {range.selectNode(inP); }catch (ex){if (typeof console!="\x75nde\x66\151\x6eed")console.error("\x4cost sel\x65\x63t\x69\157\x6e. Error\x3a "+ex.message); return false; }selection.removeAllRanges( ); selection.addRange(range); inP=inP.cloneNode( true); inP.innerHTML="&#16\x30;"; var startPar=inP.cloneNode( true); if (emptyParent){startPar.innerHTML="&\x23\061\x360;"; }else {if (beginFragment){startPar.replaceChild(beginFragment,startPar.firstChild); }else {startPar=null; }}var endPar=null; if (!emptyParent && endFragment!=null){endPar=inP.cloneNode( true); endPar.replaceChild(endFragment,endPar.firstChild); endPar.insertBefore(oDoc.createTextNode("\xa0"),endPar.firstChild); }var newP=(Ektron.RegExp.IsHeadingTag.test(inP.tagName)?oDoc.createElement("p"):inP.cloneNode( true)); var curElement=newP; if (parentPath.length>0){for (var i=parentPath.length; i>0; i--){var curNode=parentPath[i]; var newNode=curNode && curNode.cloneNode?curNode.cloneNode( false):null; if (newNode && !Ektron.RegExp.IsOnEnterParentTag.test(newNode.tagName)){curElement.appendChild(newNode); curElement=newNode; }}}curElement.innerHTML="&#16\x30;"; curElement.setAttribute("\151\x64","\x72adE\x54\145m\x70Node"); var contentDiv=oDoc.createElement("\x64iv"); if (startPar!=null){contentDiv.appendChild(startPar); }if (!emptyParent && endPar!=null){if (0==startPosition){newP.removeAttribute("\x69d"); contentDiv.appendChild(newP); }endPar.setAttribute("\x69d","\x72adETemp\x4e\157\x64e"); contentDiv.appendChild(endPar); }else {contentDiv.appendChild(newP); }content=contentDiv.innerHTML; }else {content="\074p id=\042\x72a\x64\105\x54\x65m\x70Node\042\076\x26#160;\x3c/p>"; }RadEditorNamespace.RadPasteHtmlCommand.New("\x4eewLineB\x72",editor.ContentWindow,content, false).OnExecuteMoz( ); var oP=oDoc.getElementById("\162\x61dETemp\x4eode"); if (oP){if (null==inP){var oSibling=null; var bHasBeginPar= false; oP.parentNode.normalize( ); if (oP.previousSibling!=null){var contentText=oP.previousSibling.nodeValue; if (null==contentText)contentText=""; var strText=contentText; strText=strText.replace(Ektron.RegExp.StartsWithSingleWhitespace,"").replace(Ektron.RegExp.EndsWithSingleWhitespace,""); if (strText.length>0){bHasBeginPar= true; oSibling=oDoc.createElement("\x70"); oSibling.innerHTML=contentText; oP.parentNode.replaceChild(oSibling,oP.previousSibling); }else {oP.parentNode.removeChild(oP.previousSibling); }}contentText=(oP.nextSibling!=null?oP.nextSibling.nodeValue: ""); if (null==contentText)contentText=""; if (contentText.length>0){oSibling=oDoc.createElement("p"); oSibling.setAttribute("\x69d","radETe\x6d\160\x4eode"); oSibling.innerHTML=contentText; oP.parentNode.replaceChild(oSibling,oP.nextSibling); if (bHasBeginPar){oP.parentNode.removeChild(oP); }else {oP.removeAttribute("id"); }oP=oDoc.getElementById("radE\x54empNode"); }else {}}oP.removeAttribute("\x69d",0); var selection=contentWindow.getSelection( ); var range=oDoc.createRange( ); range.setStart(oP.firstChild,0); range.setEnd(oP.firstChild,1); selection.removeAllRanges( ); selection.addRange(range); }return false; }}else if (editor.IsIE){try {var selElem=editor.GetSelectedElement( ); if ("LI"==selElem.tagName || RadEditorNamespace.Utils.GetElementParentByTag(selElem,"\x4cI")!=null){editor.ShortcutHit= false; return false; }var genericCmd=RadEditorNamespace.RadGenericCommand.New("\x45nter\x20\120\x72essed",editor.ContentWindow); var range=editor.Document.selection.createRange( ); if (range.pasteHTML){range.pasteHTML("\074\x62r>"); range.select( ); range.moveEnd("char\x61\143\x74er",1); range.moveStart("characte\x72",1); range.collapse( false); }else {if (range(0))range.execCommand("Delet\x65"); }editor.ExecuteCommand(genericCmd); }catch (exc){alert(exc.message); }}} ; RadEditorCommandList["\x53hiftE\x6e\x74er"]= function (commandName,editor,oTool){if (!editor.NewLineBr || !document.all){var objSelectionRange=new Ektron.SelectionRange( {window:editor.ContentWindow } ); editor.PasteHtml("\x3cbr />\074span id\x3d\042\x65ktron\x54\145\x6dpNode\042>&#160\x3b\074\x2fsp\x61n>"); var eTempNode=$ektron("span#ek\x74\162\x6fnTempNo\x64\145",editor.ContentArea); var oSibling=eTempNode.get(0).nextSibling; if (3==oSibling.nodeType && !Ektron.RegExp.IsSingleWhitespaceCharacter.test(oSibling.data)){objSelectionRange.moveToNode(oSibling); eTempNode.remove( ); }else {objSelectionRange.moveToNode(eTempNode.get(0)); eTempNode.removeAttr("\x69d").unwrapInner( ); }editor.ShortcutHit= false; return false; }var selElem=editor.GetSelectedElement( ); if ("LI"==selElem.tagName || RadEditorNamespace.Utils.GetElementParentByTag(selElem,"LI")!=null){var genericCmd=RadEditorNamespace.RadGenericCommand.New("Ente\x72 Press\x65d",editor.ContentWindow); var range=editor.Document.selection.createRange( ); range.pasteHTML("\074\x62r>"); range.select( ); range.moveEnd("ch\x61racte\x72",1); range.moveStart("cha\x72acter",1); range.collapse( false); editor.ExecuteCommand(genericCmd); return false; }editor.ShortcutHit= false; return false; } ; RadEditorNamespace.RadExpandSelection= function (range,elemList,alowedElems){var brRange=range.duplicate( ); var startBrElem=null; var endBrElem=null; for (var i=elemList.length-1; i>=0; i--){brRange.moveToElementText(elemList[i]); var result=range.compareEndPoints("\x53tart\x54\x6fSt\x61rt",brRange);if (-1==result || 0==result){if (alowedElems[elemList[i].tagName]!=null){endBrElem=elemList[i]; }}else {if (alowedElems[elemList[i].tagName]!=null){startBrElem=elemList[i]; break; }}}if (startBrElem){brRange.moveToElementText(startBrElem); range.setEndPoint("\x53t\x61\162\x74ToEnd",brRange); }else {var parentElem=range.parentElement( ); brRange.moveToElementText(parentElem); range.setEndPoint("\x53tartTo\x53\164\x61rt",brRange); }if (endBrElem){brRange.moveToElementText(endBrElem); if ("\x42R"==endBrElem.tagName){range.setEndPoint("EndToEn\x64",brRange); }else {range.setEndPoint("End\x54oStart",brRange); }}else {var parentElem=range.parentElement( ); brRange.moveToElementText(parentElem); range.setEndPoint("EndToEn\x64",brRange); }range.select( ); } ; RadEditorNamespace.HandleEmptyListSelection= function (range,editor,realCommand){var parentElement=range.parentElement( ); var inParagraph=(parentElement && "\x50"==parentElement.tagName.toUpperCase( )); var brs=parentElement.getElementsByTagName("BR"); if (inParagraph && brs.length==0){RadEditorNamespace.RadEditorInsertList(realCommand,editor); return false; }else {var tagList= {} ; tagList["\102\x52"]=""; tagList["T\x44"]=""; tagList["OL"]=""; tagList["UL"]=""; tagList["T\x41BLE"]=""; tagList["\x44IV"]=""; tagList["IM\x47"]=""; tagList["\x4fBJECT"]=""; var elemList=range.parentElement( ).getElementsByTagName("*"); RadEditorNamespace.RadExpandSelection(range,elemList,tagList); if (range.htmlText){editor.Fire(realCommand); }}} ; RadEditorNamespace.RadEditorInsertList= function (commandName,editor,oTool){var bCanUnexecute= true; editor.SetActive( ); editor.ExecuteBrowserCommand(commandName,bCanUnexecute,null); if (editor.IsIE){$ektron("li > div\x3aonly-\x63hild",editor.Document).filter( function ( ){for (var i=0; i<this.attributes.length; i++){var attr=this.attributes[i]; if (attr.specified){return true; }}return false; } ).unwrapInner( ); }} ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_ORDERED_LIST]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_UNORDERED_LIST]= function (commandName,editor,oTool){editor.SetFocus( ); var realCommand=commandName; if (!editor.NewLineBr || !editor.IsIE){RadEditorNamespace.RadEditorInsertList(realCommand,editor); return false; }var selElem=editor.GetSelectedElement( ); var range=editor.Document.selection.createRange( ); if ("\117\x4c"==selElem.tagName || RadEditorNamespace.Utils.GetElementParentByTag(selElem,"\x4fL")!=null || "UL"==selElem.tagName || RadEditorNamespace.Utils.GetElementParentByTag(selElem,"UL")!=null){RadEditorNamespace.RadEditorInsertList(realCommand,editor); return false; }else if ("\x54D"==selElem.tagName || "\x54R"==selElem.tagName || "TBODY"==selElem.tagName || "T\x41BLE"==selElem.tagName){var range=editor.Document.selection.createRange( ); var elemList=range.parentElement( ).getElementsByTagName("\124\x44"); for (var i=elemList.length-1; i>=0; i--){brRange=range.duplicate( ); brRange.moveToElementText(elemList[i]); if (range.inRange(brRange) && elemList[i].innerHTML!=""){range.moveToElementText(elemList[i]); }}}editor.ContentArea.setActive( ); var oSel=document.selection; var tagText=(realCommand=="\x49nsert\x4f\162\x64eredLis\x74")?"\117\x4c": "UL"; if (oSel.type=='Contr\x6fl'){var tmpRange=editor.Document.body.createTextRange( ); tmpRange.moveToElementText(range(0)); if ((RadEditorNamespace.Utils.Trim(tmpRange.parentElement( ).tagName.toLowerCase( ))=="ta\x62\154\x65") || (RadEditorNamespace.Utils.Trim(tmpRange.parentElement( ).tagName.toLowerCase( ))=="\164\x62\157d\x79")){var innerText=tmpRange.parentElement( ).parentNode.outerHTML; tmpRange.parentElement( ).parentNode.outerHTML='\074'+tagText+'\x3e\074\x4cI>'+innerText+'\x3c/L\x49\x3e\074\057'+tagText+'\x3e'; }else {var innerText=tmpRange.htmlText; editor.PasteHtml('\074'+tagText+'\x3e\074\114I\x3e'+innerText+'\074\x2fLI>\074\x2f'+tagText+'\076'); }}else {var spanObject=editor.Document.createElement("SPAN"); spanObject.innerHTML=range.htmlText; if (range.htmlText==""){RadEditorNamespace.HandleEmptyListSelection(range,editor,realCommand); }else if (spanObject.getElementsByTagName("\x50").length>0){RadEditorNamespace.RadEditorInsertList(realCommand,editor); return false; }else {var listHolderElement; if (range.parentElement( ).tagName.toUpperCase( )=="LI"){listHolderElement=range.parentElement( ).parentNode; }else {listHolderElement=range.parentElement( ); }if (listHolderElement.tagName.toUpperCase( )=="\x4fL" || listHolderElement.tagName.toUpperCase( )=="UL"){var tagName=listHolderElement.tagName.toUpperCase( ); if (tagText==tagName){if (editor.NewLineBr){var originalRange=range.duplicate( ); var wholeRange=range.duplicate( ); wholeRange.moveToElementText(listHolderElement); var comparerRange=range.duplicate( ); var allLis=listHolderElement.getElementsByTagName("LI"); var beginningIndex=0; var endingIndex=allLis.length-1; var firstLiRange=range.duplicate( ); firstLiRange.moveToElementText(allLis[0]); var lastLiRange=range.duplicate( ); lastLiRange.moveToElementText(allLis[allLis.length-1]); comparerRange.setEndPoint("\105\x6edToEnd",lastLiRange); comparerRange.setEndPoint("StartTo\x53tart",firstLiRange); while ((beginningIndex<allLis.length) && (comparerRange.compareEndPoints("\x53tartT\x6f\x53t\x61\162\x74",originalRange)<=0)){comparerRange.moveToElementText(allLis[beginningIndex]); comparerRange.setEndPoint("EndToEnd",lastLiRange); beginningIndex++; }beginningIndex-=2; while ((endingIndex>0) && (comparerRange.compareEndPoints("\x45ndT\x6f\105\x6ed",originalRange)>=0)){comparerRange.moveToElementText(allLis[endingIndex]); comparerRange.setEndPoint("StartT\x6fStart",firstLiRange); endingIndex--; }endingIndex+=2; var beginSpecifierRange=range.duplicate( ); var endSpecifierRange=range.duplicate( ); beginSpecifierRange.moveToElementText(allLis[beginningIndex]); beginSpecifierRange.collapse( true); beginSpecifierRange.setEndPoint("S\x74artToSta\x72t",wholeRange); endSpecifierRange.moveToElementText(allLis[endingIndex]); endSpecifierRange.collapse( false); endSpecifierRange.setEndPoint("EndToE\x6ed",wholeRange); range.setEndPoint("S\x74artToEnd",beginSpecifierRange); range.setEndPoint("\x45ndToS\x74\141\x72t",endSpecifierRange); var htmlToPaste=""; var noBeginning= false; var noEnding= false; if (beginSpecifierRange.htmlText.replace(/\x3c(.*?)\x3e/)!=""){htmlToPaste+="\x3c"+tagName+">"+beginSpecifierRange.htmlText+"\074/"+tagName+">"; }else {noBeginning= true; }htmlToPaste+=range.htmlText.replace(/\x3c\x4c\x49\x2f?\x3e/gi,"\x3cBR>").replace(/\x3c\x2f\x4c\x49\x3e/gi,"").replace(/^\s*\x3c\x42\x52\x2f?\x3e/gi,'').replace(/\x3c\x42\x52\x2f?\x3e\s*$/gi,''); if (endSpecifierRange.htmlText.replace(/\x3c(.*?)\x3e/)!=""){htmlToPaste+="\x3c"+tagName+"\x3e"+endSpecifierRange.htmlText+"\x3c/"+tagName+">"; }else {noEnding= true; htmlToPaste+="\074\x42R>"; }if (noBeginning && noEnding){htmlToPaste=htmlToPaste.replace(new RegExp("\x3c/?"+tagName+"\x2f?>","g\x69"),'').replace(/^\s*\x3c\x42\x52\x2f?\x3e/gi,''); }if (listHolderElement.parentNode.childNodes[0]==listHolderElement){wholeRange.collapse( ); listHolderElement.parentNode.removeChild(listHolderElement,htmlToPaste); }else {wholeRange.moveStart('\x63h\x61\x72act\x65r',-1); }editor.PasteHtml(htmlToPaste); }else {RadEditorNamespace.RadEditorInsertList(realCommand,editor); return false; }}else {RadEditorNamespace.RadEditorInsertList(realCommand,editor); return false; }}else {var genericCmd=RadEditorNamespace.RadGenericCommand.New(commandName,editor.ContentWindow); var nextRange=range.duplicate( ); nextRange.collapse( false); nextRange.moveEnd("\x63har\x61\143\x74er",1); if (nextRange.htmlText.match(/\x3c\x42\x52\x2f?\x3e/gi)){range.moveEnd("char\x61cter",1); }var oText="\074"+tagText+">\074\x4cI>"+range.htmlText.replace(/(\x3c\x42\x52\s*\x3e\s*)*$/gi,'').replace(/\x3c\x42\x52\x2f?\x3e$/gi,'').replace(/\x3c\x42\x52\x2f?\x3e/gi,"\x3c/LI>\x3c\114\x49>")+"\074\x2fLI>\074\x2f"+tagText+"\x3e"; try {range.pasteHTML(oText); }catch (e){} ; editor.ExecuteCommand(genericCmd); }}}};RadEditorCommandList[RadEditorNamespace.RADCOMMAND_FORMAT_BLOCK]= function (commandName,editor,oTool){editor.ExecuteCommand(RadEditorNamespace.RadFormatBlockCommand.New(editor.Localization[commandName] || commandName,editor.ContentWindow,oTool.GetSelectedValue( ))); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_UNDO]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_REDO]= function (commandName,editor,oTool){var level=(oTool!=null && oTool.GetSelectedValue)?oTool.GetSelectedValue( ): 1; if (commandName==RadEditorNamespace.RADCOMMAND_REDO){editor.Redo(level); }else {editor.Undo(level); }} ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_APPLY_CLASS]= function (commandName,editor,oTool){var value=oTool.GetSelectedValue( ); editor.ExecuteApplyCssClassCommand(value,editor.Localization[oTool.Name]); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_TOGGLE_TABLE_BORDER]= function (commandName,editor,oTool){editor.ToggleEnhancedEdit( ); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_STRIP_FORMAT]= function (commandName,editor,oTool){var clearValue=oTool.GetSelectedValue( ); var htmlText=""; try {htmlText=editor.GetSelection( ).GetHtmlText( ); }catch (e){ ; }var oSel=editor.Document.selection?editor.Document.selection:editor.ContentWindow.getSelection( ); var isCollapsed=oSel.type?oSel.type.toLowerCase( )=="\x6eone":oSel.isCollapsed; if (isCollapsed || htmlText=="" || editor.GetHtml( )==htmlText){editor.SetHtml(RadEditorNamespace.StripFormatting(editor.GetHtml( ),clearValue),editor.Localization[commandName]+" "+clearValue); }else if (htmlText!=null){editor.PasteHtml(RadEditorNamespace.StripFormatting(htmlText,clearValue)); }} ; RadEditorCommandList["\x53trip\x41\x6cl"]=RadEditorCommandList["S\x74ripCss"]=RadEditorCommandList["Stri\x70\106\x6f\156\x74"]=RadEditorCommandList["StripSp\x61n"]=RadEditorCommandList["Strip\x57\157\x72\144"]= function (commandName,editor,oTool){var value=commandName.substring(5); value=value.toUpperCase( ); var oTool= {GetSelectedValue:function ( ){return value; }} ; editor.Fire(RadEditorNamespace.RADCOMMAND_STRIP_FORMAT,oTool); return false; } ; RadEditorNamespace.RadEditorCreateTable= function (editor,rowsCount,colsCount){var oTable=editor.CreateElement("TABLE"); for (var r=0; r<rowsCount; r++){oRow=oTable.insertRow(-1); for (var c=0; c<colsCount; c++){oCell=oRow.insertCell(-1); oCell.innerHTML="\x26nbsp;"; }}return oTable; } ; RadEditorNamespace.StripFormatting= function RadEditorNamespace_StripFormatting(textHtml,clearValue,options){switch (clearValue){case "\x41LL":textHtml=$ektron.removeTags(textHtml); break; case "\x57ORD":case "WORD_A\x4cL":case "WORD_\x4e\117_\x46ONTS":case "\x57ORDM\x4c":textHtml=RadEditorNamespace.StripWordFormatting(textHtml,clearValue,options); break; case "CSS":textHtml=textHtml.replace(/(\x3c[^\x3e]+)\s\x63\x6c\x61\x73\x73\x3d(?:\x22[^\x22]*\x22|[^\x20\x3e]+)([^\x3e]*\x3e)/gi,"$1$2"); case "\x53TYLE":textHtml=textHtml.replace(/(\x3c[^\x3e]+)\s\x73\x74\x79\x6c\x65\x3d\x22[^\x22]*\x22([^\x3e]*\x3e)/gi,"\x241$\x32"); break; case "FONT":textHtml=textHtml.replace(/\x3c\x2f?\x66\x6f\x6e\x74[^\x3e]*\x3e/gi,""); break; case "\x53PAN":textHtml=textHtml.replace(/\x3c\x2f?\x73\x70\x61\x6e[^\x3e]*\x3e/gi,""); break; default:break; }return textHtml; } ; RadEditorNamespace.ConvertText2Html= function (text){text=$ektron.htmlEncodeText(text); text=text.replace(/\x0a/g,"\074\x62r /\x3e"); return text; };RadEditorNamespace.fixMsoListSettings=[ {reList:/(\x3c\x70\s[^\x3e]*\x73\x74\x79\x6c\x65\x3d[^\x3e]*\x6d\x73\x6f\x2d\x6c\x69\x73\x74\x3a[^\x3b]*\s\x6c\x65\x76\x65\x6c[\x30-\x39]+\s[^\x3e]+\x3e[\w\W]+?\x3c\x2f\x70\x3e\s*)+/gi,reListItem:/\x3c\x70\s[^\x3e]*\x73\x74\x79\x6c\x65\x3d[^\x3e]*\x6d\x73\x6f\x2d\x6c\x69\x73\x74\x3a([^\x3b]*\s\x6c\x65\x76\x65\x6c[\x30-\x39]+\s[^\x3e]+)\x3e([\w\W]+?)\x3c\x2f\x70\x3e/gi,reListItemOrdinal:/\x3c\x73\x70\x61\x6e\s[^\x3e]*\x73\x74\x79\x6c\x65\x3d[^\x3e]*\x6d\x73\x6f\x2d\x6c\x69\x73\x74\x3a[^\x3e]+\x3e((?:(?:\x3c\w+[^\x3e]*\x3e)|(?:\x26\x6e\x62\x73\x70\x3b)|\xa0|(?:\s\x3c\x2f\x73\x70\x61\x6e\x3e))*)([^\x3c]+)/i,reIndentSpaces:/\x3e\s*((?:\x26\x6e\x62\x73\x70\x3b)|\xa0)+\s*\x3c/i,reLevel:/\s\x6c\x65\x76\x65\x6c([\x30-\x39]+)\s/i,fnGetLevel:function fnGetLevelMsoList(strLevel,curLevel,aryMargins,settings){var level=curLevel; var aryLevel=strLevel.match(settings.reLevel); if (aryLevel && aryLevel.length>1 && aryLevel[1]){level=parseInt(aryLevel[1],10); if (level<1)level=1; }return level; }} , {reList:/(\x3c\x70[^\x3e]*\x3e\s*\x3c\x21\x2d\x2d\x5b\x69\x66\x20\x21\x73\x75\x70\x70\x6f\x72\x74\x4c\x69\x73\x74\x73\x5d\x2d\x2d\x3e[\w\W]+?\x3c\x21\x2d\x2d\x5b\x65\x6e\x64\x69\x66\x5d\x2d\x2d\x3e[\w\W]+?\x3c\x2f\x70\x3e\s*)+/gi,reListItem:/\x3c\x70([^\x3e]*)\x3e\s*\x3c\x21\x2d\x2d\x5b\x69\x66\x20\x21\x73\x75\x70\x70\x6f\x72\x74\x4c\x69\x73\x74\x73\x5d\x2d\x2d\x3e[\w\W]+?\x3c\x21\x2d\x2d\x5b\x65\x6e\x64\x69\x66\x5d\x2d\x2d\x3e([\w\W]+?)\x3c\x2f\x70\x3e/gi,reListItemOrdinal:/\x3c\x21\x2d\x2d\x5b\x69\x66\x20\x21\x73\x75\x70\x70\x6f\x72\x74\x4c\x69\x73\x74\x73\x5d\x2d\x2d\x3e[\w\W]+?\x3e((?:(?:\x3c\w+[^\x3e]*\x3e)|(?:\x26\x6e\x62\x73\x70\x3b)|\xa0|(?:\s\x3c\x2f\x73\x70\x61\x6e\x3e))*)([\w\W]+?)\x3c\x21\x2d\x2d\x5b\x65\x6e\x64\x69\x66\x5d\x2d\x2d\x3e/i,reIndentSpaces:null,reLevel:/\b\x6d\x61\x72\x67\x69\x6e\x2d\x6c\x65\x66\x74\x3a\s*(\x2d?[\x30-\x39]+(?:\x2e[\x30-\x39]+)?)/i,fnGetLevel:function fnGetLevelSupportLists(strLevel,curLevel,aryMargins,settings){var level=curLevel; var aryLevel=strLevel.match(settings.reLevel); if (aryLevel && aryLevel.length>1 && aryLevel[1]){var margin=parseFloat(aryLevel[1]); if ("un\x64efined"==typeof aryMargins[curLevel]){aryMargins[curLevel]=margin; }else if (aryMargins[curLevel] !== margin){for (var i=0; i<aryMargins.length; i++){if (aryMargins[i] === margin){level=i; break; }}if (aryMargins[level] !== margin){level=aryMargins.length; aryMargins[level]=margin; }}}return level; }} ]; RadEditorNamespace.fixMsoListSettings.push( {reList:/(\x3c\x70\s[^\x3e]*\x63\x6c\x61\x73\x73[^\x3e]*\x3e(?:(?!\x3c\x2f\x70\x3e)[\w\W])*?\x3c\x73\x70\x61\x6e\s[^\x3e]*\x73\x74\x79\x6c\x65\x3d[^\x3e]*\x6d\x73\x6f\x2d\x6c\x69\x73\x74\x3a[^\x3e]+\x3e[\w\W]+?\x3c\x2f\x70\x3e\s*)+/gi,reListItem:/\x3c\x70\s[^\x3e]*\x63\x6c\x61\x73\x73([^\x3e]*)\x3e((?:(?!\x3c\x2f\x70\x3e)[\w\W])*?\x3c\x73\x70\x61\x6e\s[^\x3e]*\x73\x74\x79\x6c\x65\x3d[^\x3e]*\x6d\x73\x6f\x2d\x6c\x69\x73\x74\x3a[^\x3e]+\x3e[\w\W]+?)\x3c\x2f\x70\x3e/gi,reListItemOrdinal:RadEditorNamespace.fixMsoListSettings[0].reListItemOrdinal,reIndentSpaces:RadEditorNamespace.fixMsoListSettings[0].reIndentSpaces,fnGetLevel:function fnGetLevelMsoList(strLevel,curLevel,aryMargins,settings){return 1; }} ); RadEditorNamespace.appendListTypeAndStart= function RadEditorNamespace_appendListTypeAndStart(sb,aryListType){var sClosingListTag="\x3c/ol>"; if (aryListType && aryListType.length>2 && aryListType[2]){var strOrdinal=$ektron.removeTags(aryListType[2]); var aryOrdinal=strOrdinal.match(/^([\x30-\x39]+)|^([\x61\x69\x41\x49])/); if (!aryOrdinal || aryOrdinal.length<3){sb.appendLine("\x3cul>"); sClosingListTag="\x3c/ul>"; }else if ("1" === aryOrdinal[1]){sb.appendLine("\x3col>"); }else if (aryOrdinal[1] && aryOrdinal[1].length>0){sb.append("\x3co\x6c\x20sta\x72t=\042"); sb.append(aryOrdinal[1]); sb.appendLine("\042\x3e"); }else if (aryOrdinal[2] && 1==aryOrdinal[2].length){sb.append("\x3col type\x3d\x22"); sb.append(aryOrdinal[2]); sb.appendLine("\x22>"); }else {sb.appendLine("\x3cul>"); sClosingListTag="\074/ul>"; }}else {sb.appendLine("\074\x75l>"); sClosingListTag="\074\x2ful>"; }return sClosingListTag; } ; RadEditorNamespace.fixMsoLists= function RadEditorNamespace_fixMsoLists(html,settings){return html.replace(settings.reList, function fixEachMsoList($0_match){var sb=new Ektron.String( ); var aryListType=$0_match.match(settings.reListItemOrdinal); var strClosingTag=RadEditorNamespace.appendListTypeAndStart(sb,aryListType); var curLevel=1; var aryNestedList=[ ]; aryNestedList[curLevel]= {itemCount: 0,closingTag:strClosingTag } ; var aryMargins=[ ]; $0_match.replace(settings.reListItem, function fixMsoListItem($0_match,$1_level,$2_contents){var level=settings.fnGetLevel($1_level,curLevel,aryMargins,settings); if (curLevel<level){aryListType=$0_match.match(settings.reListItemOrdinal); while (curLevel<level){curLevel+=1; strClosingTag=RadEditorNamespace.appendListTypeAndStart(sb,aryListType); sb.append("\074\x6ci>"); aryNestedList[curLevel]= {itemCount: 0,closingTag:strClosingTag } ; }}else if (curLevel>level){while (curLevel>level){sb.appendLine("\x3c/li>"); sb.append(aryNestedList[curLevel].closingTag); curLevel-=1; }}if (aryNestedList[curLevel].itemCount>0){sb.appendLine("\x3c/li>"); }if (null==sb.toString( ).match(/[\x3c]\x6c\x69[^\x3e]*[\x3e]\s*$/i)){sb.append("\x3cli\x3e"); }if (settings.reIndentSpaces){var contents=$2_contents.replace(settings.reListItemOrdinal, function fixMsoListIndent($0_match,$1_ordinal){return "\074\x73pan\x3e"+$1_ordinal.replace(settings.reIndentSpaces,"\x3e\074"); } ); contents=contents.replace(settings.reIndentSpaces,"\x3e\074"); sb.append(contents); }else {sb.append($2_contents); }aryNestedList[curLevel].itemCount+=1; } ); while (curLevel>0){if (aryNestedList[curLevel].itemCount>0){sb.appendLine("\x3c\057\x6ci>"); }sb.append(aryNestedList[curLevel].closingTag); curLevel-=1; }return sb.toString( ); } ); } ; RadEditorNamespace.StripWordFormatting= function RadEditorNamespace_StripWordFormatting(html,clearValue,options){options=$ektron.extend( {preserveWordClasses: false ,preserveWordStyles: false } ,options); if ("\x57ORD_A\x4c\x4c"==clearValue || "\x57ORD"==clearValue || "W\x4f\122\x44\x5fN\x4f\137F\x4fNTS"==clearValue){for (var i=0; i<RadEditorNamespace.fixMsoListSettings.length; i++){html=RadEditorNamespace.fixMsoLists(html,RadEditorNamespace.fixMsoListSettings[i]); }}switch (clearValue){case "W\x4fRD_ALL":html=RadEditorNamespace.StripFormatting(html,"\x53PAN"); html=RadEditorNamespace.StripFormatting(html,"\x46\117\x4e\x54"); html=RadEditorNamespace.StripFormatting(html,"\103\x53\123"); case "\x57\117R\x44":case "W\x4f\x52D_\x4e\x4f_F\x4fNTS":html=html.replace(/\x3c\x2f?\x68\x74\x6d\x6c[^\x3e]*\x3e/gi,""); html=html.replace(/\x3c\x68\x65\x61\x64[^\x3e]*\x3e[\w\W]*?\x3c\x2f\x68\x65\x61\x64\x3e/gi,""); html=html.replace(/\x3c\x74\x69\x74\x6c\x65[^\x3e]*\x3e[\w\W]*?\x3c\x2f\x74\x69\x74\x6c\x65\x3e/gi,""); html=html.replace(/\x3c\x73\x74\x79\x6c\x65[^\x3e]*\x3e[\w\W]*?\x3c\x2f\x73\x74\x79\x6c\x65\x3e/gi,""); html=html.replace(/\x3c\x6d\x65\x74\x61[^\x3e]*\x3e/gi,""); html=html.replace(/\x3c\x6c\x69\x6e\x6b[^\x3e]*\x3e/gi,""); html=html.replace(/\x3c\x2f?\x62\x6f\x64\x79[^\x3e]*\x3e/gi,""); if ( false ==options.preserveWordClasses){html=html.replace(/(\x3c[^\x3e]+)\s\x63\x6c\x61\x73\x73\x3d(?:\x22\x4d\x73\x6f[^\x22]*\x22|\x4d\x73\x6f[^\x20\x3e]*)([^\x3e]*\x3e)/gi,"$1$2"); }if ( false ==options.preserveWordStyles){html=RadEditorNamespace.StripFormatting(html,"ST\x59LE"); }case "W\x4f\122\x44\x4dL":html=html.replace(/\x3c\x3f[^\x3e]+\x3e/g,""); html=html.replace(/\x3c\x21(?:\x2d\x2d)?\x5b\x69\x66\s*\x21\x76\x6d\x6c\x5d(?:\x2d\x2d)?\x3e([\w\W]*?)\x3c\x21(?:\x2d\x2d)?\x5b\x65\x6e\x64\x69\x66\x5d(?:\x2d\x2d)?\x3e/g,"$1"); html=html.replace(/\x3c\x21(?:\x2d\x2d)?\x5b\x69\x66[^\x5d]*\x5d(?:\x2d\x2d)?\x3e[\w\W]*?\x3c\x21(?:\x2d\x2d)?\x5b\x65\x6e\x64\x69\x66\x5d(?:\x2d\x2d)?\x3e/g,""); html=html.replace(/\s+(?!\x78\x6d\x6c\x3a)\w+\x3a\w+\x3d\x22[^\x22]*\x22(?=[^\x3c\x3e]*\x3e)/g,""); html=html.replace(/\x3c\x6f\x3a\x70\x3e(\x26\x6e\x62\x73\x70\x3b)?\xa0?\x3c\x2f\x6f\x3a\x70\x3e/gi,""); html=html.replace(/\x3c\x2f?\w+\x3a[^\x3e]+\x3e/g,""); html=html.replace(/\x3c(\x70|\x74\x64|\x74\x68)(\s[^\x3e]+)?\x3e\x3c\x2f\1\x3e/gi,"\074$1$2>\x26\043\x3160;\074/$1>"); default:break; }return html; } ; RadEditorNamespace.CheckHtmlTagExistance= function (Text){return Text.match(/[\x3c\x3e]/gi); } ; RadEditorNamespace.GetBaseUrl= function ( ){var toReturn=document.location.href; var objHead=document.getElementsByTagName('HE\x41D')[0]; for (var i=0; i<objHead.childNodes.length; i++){if (objHead.childNodes[i].nodeType==1 && objHead.childNodes[i].tagName.toLowerCase( )=='base'){toReturn=objHead.childNodes[i].getAttribute('hre\x66'); break; }}toReturn=toReturn.replace(/\x26/gi,"\x26amp;"); toReturn=toReturn.replace(/\x3f/gi,"\x3f"); return toReturn; } ; RadEditorNamespace.GetAnchorToCurrentPage= function (oLink,isIE){var url=oLink.getAttribute("da\x74a-ektron\x2durl"); if (url)return url; if (isIE){var currentHref=oLink.href; var theBaseUrl=RadEditorNamespace.GetBaseUrl( ); if (currentHref.indexOf(theBaseUrl)==0){var anchorIndex=currentHref.lastIndexOf("#"); currentHref=currentHref.substr(anchorIndex); }return currentHref; }else {return oLink.getAttribute("\x68ref"); }} ; RadEditorNamespace.GetSelectionLinkArgument= function (editor,selectedTab){editor.SetFocus( ); documentAnchors=editor.Document.getElementsByTagName("A"); var anchorsCollection=new Array( ); for (var i=0; i<documentAnchors.length; i++){if (documentAnchors[i].name){anchorsCollection[anchorsCollection.length]=documentAnchors[i]; }}var argument= {realLinkObject:null,href: "",className: "",text: "",target: "",name: "",title: "",showText: false ,documentAnchors:anchorsCollection,editor:editor,CssClasses: [ ] } ; if (null!=selectedTab)argument.SelectedTab=selectedTab; var parentElement=editor.GetSelectedElement( ); if (editor.isMozilla){parentElement=editor.sfInstance.getSelectedField( ); }while (parentElement!=null){try {if ((parentElement.tagName!=null) && ((parentElement.tagName.toLowerCase( )=="a") || (parentElement.tagName.toLowerCase( )=="\x69mg"))){break; }parentElement=parentElement.parentNode; }catch (exc){break; }}var sClassName=""; if (parentElement){sClassName=parentElement.className; }if (sClassName!=""){sClassName=sClassName.replace("\x64esign_s\x65\154\x65cted_fi\x65ld",""); }if (parentElement && parentElement.tagName=="\x41"){argument.realLinkObject=parentElement; argument.href=RadEditorNamespace.GetAnchorToCurrentPage(parentElement,editor.IsIE); argument.className=sClassName; argument.text=parentElement.innerHTML; argument.target=parentElement.target; argument.name=parentElement.name; argument.title=parentElement.title; editor.SelectElement(parentElement); }else if (parentElement && parentElement.tagName=="\x49MG"){if (parentElement.parentNode && parentElement.parentNode.tagName=="A"){var linkElement=parentElement.parentNode; argument.realLinkObject=linkElement; argument.href=RadEditorNamespace.GetAnchorToCurrentPage(linkElement,editor.IsIE); argument.className=sClassName; argument.text=parentElement.parentNode.innerHTML; argument.target=linkElement.target; argument.name=linkElement.name; argument.title=linkElement.title; editor.SelectElement(parentElement); }else {argument.text=RadEditorNamespace.Utils.GetOuterHtml(parentElement); if ($ektron(parentElement).hasClass("\x65ktron_th\x75mbnail")){argument.className="ektron\x5fthumbna\x69l"; }}}else {var text=editor.GetSelection( ).GetText( ); if (text)text=editor.GetSelectionHtml( ); argument.text=text; }argument.CssClasses=editor.GetCssClassesByTagName("A",editor.Document); if (!RadEditorNamespace.Utils.Trim(argument.text)){argument.text=""; }argument.showText=!RadEditorNamespace.Utils.HasHtmlContent(argument.text);return argument; };RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_ROW_ABOVE]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_ROW_BELOW]= function (commandName,editor,tool){editor.InsertRow(commandName==RadEditorNamespace.RADCOMMAND_INSERT_ROW_ABOVE?"abo\x76e": "be\x6c\x6fw"); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_COLUMN_LEFT]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_COLUMN_RIGHT]= function (commandName,editor,tool){editor.InsertColumn(commandName==RadEditorNamespace.RADCOMMAND_INSERT_COLUMN_LEFT?"\154\x65ft": "rig\x68\164"); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_DELETE_ROW]= function (commandName,editor,tool){editor.DeleteRow( ); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_DELETE_COLUMN]= function (commandName,editor,tool){editor.DeleteColumn( ); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_DELETE_CELL]= function (commandName,editor,tool){editor.DeleteCell( ); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_MERGE_COLUMNS]= function (commandName,editor,tool){editor.MergeColumns( ); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_MERGE_ROWS]= function (commandName,editor,tool){editor.MergeRows( ); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SPLIT_CELL]= function (commandName,editor,tool){editor.SplitCell( ); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_DELETE_TABLE]= function (commandName,editor,oTool){var oElem=oTool.GetSelectedValue( ); if (oElem && "\x54ABLE"!=oElem.tagName){oElem=RadEditorNamespace.Utils.GetElementParentByTag(oElem,"\x54AB\x4c\x45"); }if (oElem){editor.SelectElement(oElem); editor.ExecuteBrowserCommand(RadEditorNamespace.RADCOMMAND_DELETE); }} ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_TABLE]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_TABLE_WIZARD]= function (commandName,editor,oTool){if (RadEditorNamespace.RADCOMMAND_INSERT_TABLE==commandName){var oTable=null; var oTableInfo=oTool.GetSelectedValue( ); if (oTableInfo){oTable=RadEditorNamespace.RadEditorCreateTable(editor,oTableInfo.RowsCount,oTableInfo.ColumnsCount); if (oTable){editor.ExecuteInsertObjectCommand(oTable,editor.Localization[commandName]); }}}else if (RadEditorNamespace.RADCOMMAND_TABLE_WIZARD==commandName){var callBackFn=(oTool && "f\x75nction"==typeof(oTool)?oTool:RadEditorNamespace.radEditorInsertTable); var tableCssClasses=editor.GetCssClassesByTagName("\x54AB\x4c\x45",editor.Document); var cellCssClasses=editor.GetCssClassesByTagName("TD",editor.Document); var argument= {tableToModify:RadEditorNamespace.RadEditorCreateTable(editor,2,2),CssClasses:tableCssClasses,CellCssClasses:cellCssClasses,EditorObj:editor,InternalParameters:editor.GetDialogInternalParameters(commandName)};editor.ShowDialog(editor.GetDialogUrl(commandName),argument,470,300,callBackFn,null,editor.Localization[commandName]); return false; }} ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SET_TABLE_PROPERTIES]= function (commandName,editor,oTool){commandName=RadEditorNamespace.RADCOMMAND_TABLE_WIZARD; var oTable=null; if (!oTool.GetSelectedValue){oTable=editor.GetSelectedElement( ); }else oTable=oTool.GetSelectedValue( ); if (oTable && "\x54ABLE"!=oTable.tagName){oTable=RadEditorNamespace.Utils.GetElementParentByTag(oTable,"\x54ABLE"); }if (!oTable){alert(editor.Localization["Tabl\x65Warning"]); return; }var tableCssClasses=editor.GetCssClassesByTagName("\x54ABLE",editor.Document); var cellCssClasses=editor.GetCssClassesByTagName("\x54D",editor.Document); var argument= {tableToModify:oTable,EditorObj:editor,CssClasses:tableCssClasses,CellCssClasses:cellCssClasses,tableDocument:editor.Document,InternalParameters:editor.GetDialogInternalParameters(commandName)} ; editor.ShowDialog(editor.GetDialogUrl(commandName),argument,400,300,null,null,editor.Localization[commandName]); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SET_CELL_PROPERTIES]= function (commandName,editor,oTool){var oCell=null; if (!oTool.GetSelectedValue){oCell=editor.GetSelectedElement( ); }else oCell=oTool.GetSelectedValue( ); if (oCell && "TD"!=oCell.tagName && "\x54H"!=oCell.tagName){var tempCell=RadEditorNamespace.Utils.GetElementParentByTag(oCell,"TD"); if (!tempCell)tempCell=RadEditorNamespace.Utils.GetElementParentByTag(oCell,"T\x48"); oCell=tempCell; }if (!oCell){alert(editor.Localization["C\x65llWarnin\x67"]); return; }var cssClasses=editor.GetCssClassesByTagName(oCell.tagName,editor.Document); var argument= {cellToModify:oCell,EditorObj:editor,CssClasses:cssClasses,InternalParameters:editor.GetDialogInternalParameters(commandName)} ; editor.ShowDialog(editor.GetDialogUrl(commandName),argument,400,300,null,null,editor.Localization[commandName]); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SET_IMAGE_PROPERTIES]= function (commandName,editor,oTool){var oImg=oTool.GetSelectedValue( ); var joAnchor=$ektron(oImg).parent("A"); var oAnchor=null; if (1==joAnchor.length){oAnchor=joAnchor.get(0); }var cssClasses=editor.GetCssClassesByTagName("\x49M\x47",editor.Document); var argument= {imageToModify:oImg,EditorObj:editor,CssClasses:cssClasses,ThumbnailSuffix:editor.ThumbSuffix,InternalParameters:editor.GetDialogInternalParameters(commandName),folderId:editor.ekParameters.FolderId } ; var callBackParam= {CommandTitle:editor.Localization[commandName],OriginalImage:oImg,ThumbnailLink:oAnchor } ; editor.ShowDialog(editor.GetDialogUrl(commandName),argument,400,300,RadEditorNamespace.radEditorSetImageProperties,callBackParam,editor.Localization[commandName]); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_FORMAT_CODE_BLOCK_DIALOG]= function (commandName,editor,oTool){editor.ShowDialog(editor.GetDialogUrl(commandName),null,700,570,RadEditorNamespace.radEditorFormatCodeBlock,null,editor.Localization[commandName]); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SHOW_IMAGE_MAP_DIALOG]= function (commandName,editor,oTool){var argument= {} ; argument.InternalParameters=editor.GetDialogInternalParameters(commandName); argument.EditorObj=editor; var oSelElem=editor.GetSelectedElement( ); if (oSelElem && oSelElem.tagName=="IMG"){var Image=oSelElem; argument.ImageSrc=Image.src; argument.ImageWidth=(Image.style.width)?Image.style.width:Image.width; argument.ImageHeight=(Image.style.height)?Image.style.height:Image.height; if (document.all){var oRng=editor.Document.body.createTextRange( ); oRng.collapse( ); oRng.moveToElementText(Image); oRng.select( ); }if (Image.useMap){var MapName=Image.getAttribute('us\x65Map').substr(1); var MapHTML=''; var Map=RadEditorNamespace.GetImageMapByName(editor,MapName); if (Map!=null){MapHTML='\x3cm\x61\x70 n\x61me = \042'+MapName+'\042\x3e'+Map.innerHTML+'\074\x2fmap>'; }argument.ImageMapHTML=MapHTML; Image.style.width=argument.ImageWidth; Image.style.height=argument.ImageHeight; }}var DWidth=(document.all)?700: 730; var DHeight=(document.all)?450: 470; editor.ShowDialog(editor.GetDialogUrl(commandName),argument,DWidth,DHeight,RadEditorNamespace.radEditorSetImageMapProperties,null,editor.Localization[commandName]); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SHOW_EKTRON_IMAGE_MODIFICATION_TOOL]= function (commandName,editor,oTool){var oSelElem=editor.GetSelectedElement( ); if (oSelElem && oSelElem.tagName!="\x49MG"){var oSelImg=$ektron("\x69mg.des\x69\147\x6e_sele\x63ted_fi\x65ld",oSelElem).get(0); if (oSelImg && "\x49MG"==oSelImg.tagName){oSelElem=oSelImg; }}if (oSelElem && oSelElem.tagName!="\x49MG"){var eSelImg=$ektron("img",oSelElem); if (1==eSelImg.length){var oSelImg=eSelImg.get(0); if (oSelImg && "IMG"==oSelImg.tagName){oSelElem=oSelImg; }}}if (oSelElem && oSelElem.tagName=="\x49MG"){var oImg=oTool.GetSelectedValue( ); var oImgParent=oImg.parentElement; var cssClasses=editor.GetCssClassesByTagName("\111\x4dG",editor.Document); var thumbstring="\x74ry\x7b\x77in\x64ow.open(\x27"; var imgurl=oImg.src; var isThumbnail= false; if (oImgParent && (oImgParent.tagName=="A")){var onclickattr=oImgParent.getAttribute("ektr\x6fn35383_\x6fnclick"); if (onclickattr!=null){var clickinfo=onclickattr.toString( ); var startindex=clickinfo.indexOf(thumbstring); if (clickinfo.substring(startindex,startindex+thumbstring.length)==thumbstring){var imgstring=clickinfo.substring(startindex+thumbstring.length); if (imgstring.indexOf("\047")){imgurl=imgstring.substring(0,imgstring.indexOf("\047")); isThumbnail= true; }}}}var argument= {imageToModify:oImg,thumbnailedImage:oImgParent,popupImage:isThumbnail,EditorObj:editor,CssClasses:cssClasses,ThumbnailSuffix:editor.ThumbSuffix,InternalParameters:editor.GetDialogInternalParameters(commandName)} ; var callBackParam= {CommandTitle:editor.Localization[commandName],OriginalImage:oImg,OriginalImageParent:oImgParent,ThumbnailedImage:isThumbnail,ImagePath:imgurl } ; var url=''; if (editor.UseSession==RadEditorNamespace.DIALOG_PARAMETERS_MODE_SESSION){var relativeRadControlsDir=editor.RadControlsDir.substr(editor.ApplicationPath.length); url=editor.ApplicationPath+editor.SessionID1+relativeRadControlsDir; }else {url=editor.RadControlsDir; }url=url+"\x2e.\x2f\056\x2e/Image\x54\157\x6fl/Imag\x65\105\x64it.asp\x78?i="+encodeURIComponent(imgurl);editor.ShowDialog(url,argument,500,400,RadEditorNamespace.radEditorSetImageEdited,callBackParam,editor.Localization[commandName]); }else {alert("\x50leas\x65\040\x73elect\x20\141\x6e image\x20to edi\x74."); }return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SET_LINK_PROPERTIES]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SHOW_LINK_DIALOG]= function (commandName,editor,oTool){var selectedTab=null; if (oTool && oTool.SelectedTab)selectedTab=oTool.SelectedTab; var args=RadEditorNamespace.GetSelectionLinkArgument(editor,selectedTab); if ("\x65ktron\x5f\x74h\x75\155\x62nail"==args.className){return false; }var callBackFn=(null==args.realLinkObject?RadEditorNamespace.radEditorCreateLink:RadEditorNamespace.radEditorSetLinkProperties); if ("\x66\x75\x6ecti\x6fn"==typeof(oTool)){callBackFn=oTool; }editor.ShowDialog(editor.GetDialogUrl(RadEditorNamespace.RADCOMMAND_SHOW_LINK_DIALOG),args,400,300,callBackFn, {cmdName:editor.Localization[commandName] } ,editor.Localization[commandName]); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SHOW_IMAGE_DIALOG]= function (commandName,editor,oTool){var callBackFn=(oTool && "funct\x69on"==typeof(oTool)?oTool:RadEditorNamespace.radEditorCreateImage); var argument= {} ; argument.InternalParameters=editor.GetDialogInternalParameters(commandName); var dialogUrl=editor.GetDialogUrl(commandName); var selectedImage=editor.GetSelectedElement( ); if (selectedImage && selectedImage.tagName && selectedImage.tagName.toLowerCase( )=="img"){dialogUrl+="&select\x65dObject\x50ath="+RadEditorNamespace.Utils.RemoveProtocolNameAndServerName(selectedImage.src); }editor.ShowDialog(dialogUrl,argument,400,300,callBackFn,null,editor.Localization[commandName]); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SHOW_TEMPLATE_DIALOG]= function (commandName,editor,oTool){var callBackFn=(oTool && "\x66un\x63\x74io\x6e"==typeof(oTool)?oTool:RadEditorNamespace.radEditorInsertTemplate); var argument= {} ; argument.InternalParameters=editor.GetDialogInternalParameters(commandName); editor.ShowDialog(editor.GetDialogUrl(commandName),argument,400,300,callBackFn,null,editor.Localization[commandName]); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SHOW_ABOUT_DIALOG]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_HELP]= function (commandName,editor,oTool){var width=RadEditorNamespace.RADCOMMAND_SHOW_ABOUT_DIALOG==commandName?250: 570; var height=RadEditorNamespace.RADCOMMAND_SHOW_ABOUT_DIALOG==commandName?255: 400; editor.ShowDialog(editor.GetDialogUrl(commandName),null,width,height,null,null,editor.Localization[commandName]); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_PAGE_PROPERTIES]= function (commandName,editor,oTool){var argument= {CssClasses:editor.GetCssClassesByTagName("\x42ODY",editor.Document),EditorObj:editor } ; editor.ShowDialog(editor.GetDialogUrl(commandName),argument,659,393,null,null,editor.GetLocalizedString(commandName,commandName)); return false; } ; RadEditorNamespace.ShowCleanFormattingDialogMozilla= function (editor,commandName){var callBackParam= {commandName:commandName,CommandTitle:editor.Localization[commandName] } ; var args= {EditorObj:editor } ; switch (commandName){case RadEditorNamespace.RADCOMMAND_PASTE_FROM_WORD:args.contentType="rich"; args.getFilteredContent= function (content){return RadEditorNamespace.StripFormatting(content,"WORD"); } ; break; case RadEditorNamespace.RADCOMMAND_PASTE_FROM_WORD_ALL:args.contentType="rich"; args.getFilteredContent= function (content){return RadEditorNamespace.StripFormatting(content,"WORD\x5fALL"); } ; break; case RadEditorNamespace.RADCOMMAND_PASTE_AS_HTML:args.contentType="\x78html"; break; case RadEditorNamespace.RADCOMMAND_PASTE_PLAIN_TEXT:args.contentType="tex\x74"; args.getFilteredContent=RadEditorNamespace.ConvertText2Html; break; }editor.ShowDialog(editor.GetDialogUrl("\x4dozil\x6c\141\x50asteH\x65\154\x70erDlg"),args,700,550, function (content,params){if (content){content=editor.filter.GetDesignContent(content); if (RadEditorNamespace.RADCOMMAND_PASTE_PLAIN_TEXT==commandName){editor.PasteHtml(content); }else {var objSelectionRange=new Ektron.SelectionRange( {window:editor.ContentWindow } ); var focusElem=editor.GetSelectedElement( ); if (3==focusElem.nodeType){focusElem=focusElem.parentNode; }var selectedElementToTrimOnPaste=null; if (!IsValidFocusTag(focusElem.tagName)){var eFocusElem=$ektron(focusElem); if (1==focusElem.nodeType){if (0==eFocusElem.children( ).length){var strText=eFocusElem.text( ); if (1==strText.length && Ektron.RegExp.IsSingleWhitespaceCharacter.test(strText)){selectedElementToTrimOnPaste=eFocusElem; eFocusElem.after("\x3cdiv i\x64\075\x22ektron\x54empNod\x65\042\x3e&#160\x3b\074\x2fdi\x76>"); objSelectionRange.moveToNode(eFocusElem.siblings("div").get(0)); }}}}if (RadEditorNamespace.RADCOMMAND_PASTE_FROM_WORD_ALL==commandName){try {if (isNaN(this.editor.ekParameters.CurrentCharCount))this.editor.ekParameters.CurrentCharCount=0; this.editor.ekParameters.CurrentCharCount=this.editor.ekParameters.CurrentCharCount+content.length; if (Number(this.editor.ekParameters.CurrentCharCount)>Number(this.editor.ekParameters.WordPasteThreshold))this.editor.ekParameters.ShowPasteWarning= false; }catch (e){}}editor.PasteHtml(content); if (selectedElementToTrimOnPaste!=null){var strText=eFocusElem.text( ); if (1==strText.length && Ektron.RegExp.IsSingleWhitespaceCharacter.test(strText))eFocusElem.remove( ); var ePasteHTML=$ektron("div#ek\x74ronTe\x6dpNode",editor.ContentArea); var eNewContent=ePasteHTML.html(ePasteHTML.html( ).replace(/[\x26\x6e\x62\x73\x70\x3b]+$/,"")).unwrapInner( ); objSelectionRange.moveToNode(eNewContent.get(0)); }}}} ,callBackParam,editor.Localization[commandName]); return false; function IsValidFocusTag(focusTag){var bValid= true; switch (focusTag){case "\x50":case "H\x31":case "H2":case "\x483":case "\x484":case "\x485":case "\x486":bValid= false; break; default:bValid= true; break; }return bValid; }} ; RadEditorNamespace.radEditorCreateLink= function (retValue,params){if (!retValue)return; if ("\x64esign\x5f\x62o\x6f\153\x6d\141\x72k"==retValue.className){var containingElement=params.editor.sfInstance.getContentElement( ); var doc=containingElement.ownerDocument; var win=(doc.defaultView?doc.defaultView:doc.parentWindow); if ( false ==win.ektronHideShowElementState){retValue.className=""; }}params.editor.InsertLink(retValue.href,retValue.text,retValue); };RadEditorNamespace.radEditorSetLinkProperties= function (retValue,params){if (retValue){params.editor.SetLinkProperties(retValue); }};RadEditorNamespace.radEditorSetImageProperties= function (retValue,params){if (typeof retValue.ThumbParent!="\x75ndefi\x6e\145\x64"){var oAnchor=$ektron(retValue.ThumbParent).get(0); params.editor.ExecuteFormatObjectCommand(oAnchor,params.CommandTitle,params.ThumbnailLink); }else {params.editor.ExecuteFormatObjectCommand(retValue,params.CommandTitle,params.OriginalImage); }};RadEditorNamespace.radEditorSetImageEdited= function (retValue,params){if (retValue){if (params.ThumbnailedImage){var oldfilename=params.ImagePath; var newfilename=retValue.ImageURL; if (oldfilename.lastIndexOf(".")>0){oldfilename=oldfilename.substring(0,oldfilename.lastIndexOf(".")+1); }if (newfilename.lastIndexOf("\x2e")>0){newfilename=newfilename.substring(0,newfilename.lastIndexOf(".")+1); }var oldthumbnail=oldfilename.substring(0,oldfilename.lastIndexOf("\x2f")+1)+"thumb_"+oldfilename.substring(oldfilename.lastIndexOf("/")+1); var newthumbnail=newfilename.substring(0,newfilename.lastIndexOf("/")+1)+"thu\x6db_"+newfilename.substring(newfilename.lastIndexOf("/")+1); var modifynode=params.OriginalImageParent.parentElement; this.UpdatedParent=modifynode.cloneNode( true); this.UpdatedParent.innerHTML=this.UpdatedParent.innerHTML.replace(new RegExp(oldfilename,"g"),newfilename); this.UpdatedParent.innerHTML=this.UpdatedParent.innerHTML.replace(new RegExp(oldthumbnail,"g"),newthumbnail); params.editor.ExecuteFormatObjectCommand(this.UpdatedParent,params.CommandTitle,modifynode); params.editor.SelectElement(params.OriginalImage); }else { this.UpdatedImage=params.OriginalImage.cloneNode( true); this.UpdatedImage.setAttribute("src",retValue.ImageURL); this.UpdatedImage.setAttribute("data-ekt\x72on-ur\x6c",retValue.ImageURL); this.UpdatedImage.removeAttribute("\x77idth"); this.UpdatedImage.removeAttribute("\x68eight"); this.UpdatedImage.style.width=""; this.UpdatedImage.style.height=""; params.editor.ExecuteFormatObjectCommand(this.UpdatedImage,params.CommandTitle,params.OriginalImage); }}};RadEditorNamespace.radEditorCreateMedia= function (retValue,params){if (retValue){if (TelerikNamespace.Utils.DetectBrowser("\x73afar\x69")){window.setTimeout( function ( ){params.editor.PasteHtml(retValue); } ,0); return; }params.editor.PasteHtml(retValue); }};RadEditorNamespace.radEditorCreateFlash= function (retValue,params){if (retValue){params.editor.PasteHtml(retValue); var editor=params.editor; if (!editor.IsIE && !editor.IsOpera){var newContent=new RadEditorNamespace.RadEditorMozillaFlashStart(editor).GetDesignContent(editor.GetHtml( )); editor.ContentArea.innerHTML=newContent; }}};RadEditorNamespace.radEditorCreateImage= function (retValue,params){if (!retValue || !retValue.imagePath)return; var editor=params.editor; editor.InsertImage(retValue.imagePath,retValue); var theImage=editor.GetSelectedElement( ); if (theImage && theImage.tagName.toLowerCase( )=="img"){theImage.alt=retValue.imageAltText; theImage.setAttribute("alt",retValue.imageAltText); theImage.title=retValue.imageAltText; theImage.setAttribute("tit\x6ce",retValue.imageAltText); }if (retValue.linkImagePath){if (theImage.tagName.toUpperCase( )=="I\x4dG"){theImage.style.border="\x30"; }var linkInfo= {} ; if (retValue.targetToNew){linkInfo.text=editor.GetSelectionHtml( ); linkInfo.href=retValue.linkImagePath; linkInfo.target="_blank"; }editor.InsertLink(retValue.linkImagePath,null,linkInfo); }};RadEditorNamespace.radEditorInsertTable= function (retValue,params){if (retValue){params.editor.ExecuteInsertObjectCommand(retValue,"Insert\x20Table"); }} ; RadEditorNamespace.radEditorInsertTemplate= function (retValue,params){if (retValue){params.editor.PasteHtml(retValue); }} ; RadEditorNamespace.radEditorFormatCodeBlock= function (returnValue,params){if (!returnValue.formattedCode){return; }var editor=params.editor; var formattedCode=returnValue.formattedCode; if (formattedCode){editor.PasteHtml(formattedCode); }} ; RadEditorNamespace.radEditorSetImageMapProperties= function (MapProps,params){if (!MapProps){return; }var NewMapHtml=MapProps.MapHtml; var NewImageSrc=MapProps.ImageSrc; var editor=params.editor; var oSelElem=editor.GetSelectedElement( ); var Image; if (oSelElem && oSelElem.tagName=="\x49MG"){Image=oSelElem; if (NewImageSrc!=Image.src){Image.src=NewImageSrc; }}else {if (!NewImageSrc){return; }var Html='\x3cimg \x73\162\x63=\042'+NewImageSrc+'\x22 id =\x20\042\x5f_tmp__\x22\076'; editor.PasteHtml(Html); Image=editor.Document.getElementById('\x5f_tmp__'); Image.removeAttribute('\x69d'); if (document.all){var oRng=editor.Document.body.createTextRange( ); oRng.collapse( ); oRng.moveToElementText(Image); oRng.select( ); }}var _tmp=document.createElement('\x53PAN'); _tmp.innerHTML=NewMapHtml; var _tmp_maps=_tmp.getElementsByTagName('\x6dap'); if (_tmp_maps.length==0){return; }var MapAreasHtml=_tmp_maps[0].innerHTML; _tmp=null; if (MapAreasHtml){var MapName=''; var Map=null; var UseMapAttr=Image.getAttribute('useMa\x70'); if (UseMapAttr){MapName=UseMapAttr.substr(1); Map=RadEditorNamespace.GetImageMapByName(editor,MapName); }if (Map==null){var _cnt=0; var ImageMapPreffix='\x72ade\x5f\151\x6dg_map_'+editor.Id+'\x5f'; var ImageMapName=ImageMapPreffix+_cnt; while (RadEditorNamespace.GetImageMapByName(editor,ImageMapName)!=null){_cnt++; ImageMapName=ImageMapPreffix+_cnt; }Map=editor.Document.createElement('\x6dap'); Map.id=ImageMapName; Map.name=ImageMapName; MapName=ImageMapName; Map=editor.Document.body.appendChild(Map); Image.setAttribute('\x75seMap','\x23'+ImageMapName); Image.setAttribute('borde\x72','\x30'); }if (document.all){Map.outerHTML='\x3cmap id\x3d\x22'+MapName+'\042\x20nam\x65\x3d\042'+MapName+'\x22\x3e'+MapAreasHtml+'\074\x2fmap>'; }else {Map.innerHTML=MapAreasHtml; }}else {Image.removeAttribute('\x75seMap'); }} ; RadEditorNamespace.GetImageMapByName= function (editor,MapName){var arrMaps=editor.Document.getElementsByTagName('\x6da\x70'); if (editor.Document.getElementById(MapName)!=null){return editor.Document.getElementById(MapName); }for (var i=0; i<arrMaps.length; i++){if (arrMaps[i].getAttribute('name')==MapName){return arrMaps[i]; }}return null; } ;
RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_STRIKETHROUGH]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_STRIKETHROUGH); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_SUPERSCRIPT]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_SUPERSCRIPT); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_SUBSCRIPT]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_SUBSCRIPT); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_JUSTIFY_FULL]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_JUSTIFY_FULL); RadEditorNamespace.UpdateCommandsArray[RadEditorNamespace.RADCOMMAND_ABSOLUTE_POSITION]=RadEditorNamespace.RadBrowserCommand.New(null,RadEditorNamespace.RADCOMMAND_ABSOLUTE_POSITION); RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_FORM_ELEMENT]= function (commandName,editor,oTool){var value=oTool.GetSelectedValue( ); var element=null; var value=value.toLowerCase( ); switch (value){case "f\x6f\x72m":element=editor.CreateElement("\x66orm","1\x35\060\160x","150px"); element.innerHTML="\x26nbsp;"; break; case "textarea":element=editor.CreateElement("t\x65xtarea"); break; case "\x73elec\x74":element=editor.CreateElement("select","100px","\x322px"); break; case "che\x63kbox":case "radio":element=editor.CreateElement("inpu\x74"); element.setAttribute("\x74ype",value); break; case "button":case "\x72eset":case "submit":element=editor.CreateElement("\x69nput","\x350px","\x322px"); element.setAttribute("t\x79pe",value); break; case "hidde\x6e":case "\x70assword":case "\x74ext":element=editor.CreateElement("inpu\x74","1\x300px","22px"); element.setAttribute("type",value); break; }if (element)editor.ExecuteInsertObjectCommand(element,editor.Localization[commandName]); } ; RadEditorCommandList["Inse\x72tFormFor\x6d"]=RadEditorCommandList["Insert\x46ormButto\x6e"]=RadEditorCommandList["Inser\x74FormChec\x6bbox"]=RadEditorCommandList["I\x6esertForm\x48\151\x64den"]=RadEditorCommandList["\x49nser\x74\106\x6frmImage\x42utto\x6e"]=RadEditorCommandList["\x49nse\x72\x74Fo\x72\155\x50\141\x73sword"]=RadEditorCommandList["\x49nsertFo\x72\155\x52\141\x64\151\x6f"]=RadEditorCommandList["In\x73ertFormR\x65set"]=RadEditorCommandList["\111\x6esertFo\x72mSelect"]=RadEditorCommandList["Inser\x74FormSubm\x69t"]=RadEditorCommandList["\x49nsertFor\x6dTextarea"]=RadEditorCommandList["\x49ns\x65\x72tF\x6f\162\x6dText"]= function (commandName,editor,oTool){var value=commandName.substring(10); var oTool= {GetSelectedValue:function ( ){return value; }} ; editor.Fire(RadEditorNamespace.RADCOMMAND_INSERT_FORM_ELEMENT,oTool); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_PASTE_PLAIN_TEXT]= function (commandName,editor,oTool){return RadEditorNamespace.ShowCleanFormattingDialogMozilla(editor,commandName); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_PASTE_FROM_WORD]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_PASTE_FROM_WORD_ALL]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_PASTE_AS_HTML]= function (commandName,editor,oTool){return RadEditorNamespace.ShowCleanFormattingDialogMozilla(editor,commandName); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SHOW_FIND_DIALOG]= function (commandName,editor,oTool){var v=new Ektron.SelectionRange( {window:editor.ContentWindow } ); var oRange=v.getDomRange( ); var argument= {area: (editor.Mode==RadEditorNamespace.RADEDITOR_DESIGN_MODE?editor.ContentArea:editor.ContentTextarea),range:oRange } ; editor.ShowDialog(editor.GetDialogUrl(commandName),argument,400,300,null,null,editor.Localization[commandName]); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SHOW_DOCUMENT_DIALOG]= function (commandName,editor,oTool){var argument=RadEditorNamespace.GetSelectionLinkArgument(editor); argument.InternalParameters=editor.GetDialogInternalParameters(commandName); var callBackFn=(null==argument.realLinkObject?RadEditorNamespace.radEditorCreateLink:RadEditorNamespace.radEditorSetLinkProperties); if ("\x66uncti\x6f\156"==typeof(oTool)){callBackFn=oTool; }editor.ShowDialog(editor.GetDialogUrl(commandName),argument,400,300,callBackFn,null,editor.Localization[commandName]); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SHOW_MEDIA_DIALOG]= function (commandName,editor,oTool){editor.SetFocus( ); var argument= {} ; argument.InternalParameters=editor.GetDialogInternalParameters(commandName); var selectedMediaObject=editor.GetSelectedElement( ); argument.Media=selectedMediaObject; var selectedMediaObjectPath=null; if (selectedMediaObject && selectedMediaObject.tagName){selectedMediaObjectPath=(selectedMediaObject.tagName.toUpperCase( )=="\x4fBJ\x45\103\x54")?getParameterValue(selectedMediaObject,"\155\x6fvie"):selectedMediaObject.src; }argument.MediaPath=selectedMediaObjectPath; var callBackFn=(oTool && "\146\x75nction"==typeof(oTool)?oTool:RadEditorNamespace.radEditorCreateMedia); var dialogUrl=editor.GetDialogUrl(commandName); if (selectedMediaObjectPath){dialogUrl+="\x26selected\x4fbjectPat\x68="+selectedMediaObjectPath; }editor.ShowDialog(dialogUrl,argument,400,300,callBackFn,null,editor.Localization[commandName]); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SHOW_FLASH_DIALOG]= function (commandName,editor,oTool){editor.SetFocus( ); var argument= {} ; argument.StripAbsoluteImagesPaths=editor.StripAbsoluteImagesPaths; argument.InternalParameters=editor.GetDialogInternalParameters(commandName); var selectedFlashObject=editor.GetSelectedElement( ); argument.Flash=selectedFlashObject; var selectedFlashObjectPath=null; if (selectedFlashObject){selectedFlashObjectPath=(selectedFlashObject.tagName.toUpperCase( )=="\x4fBJECT")?getParameterValue(selectedFlashObject,"\x6dovie"):selectedFlashObject.src; }argument.FlashPath=selectedFlashObjectPath; var callBackFn=(oTool && "\x66unction"==typeof(oTool)?oTool:RadEditorNamespace.radEditorCreateFlash); var dialogUrl=editor.GetDialogUrl(commandName); if (selectedFlashObjectPath){dialogUrl+="&\x73electedO\x62\152\x65\143\x74Path="+selectedFlashObjectPath; }editor.ShowDialog(dialogUrl,argument,400,300,callBackFn,null,editor.Localization[commandName]); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_MANAGE_MODULE]= function (commandName,editor,oTool){var module=oTool.GetSelectedValue( ); if (module){var isEnabled=!module.IsEnabled; module.SetEnabled(isEnabled); if (!editor.IsIE && !isEnabled)editor.ResetSize( ); }} ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_TOGGLE_DOCKING]= function (commandName,editor,oTool){if (editor.IsToolbarModeEnabled(RadEditorNamespace.ToolbarModesEnum.PageTop)){var oManager=editor.FloatingToolbarManager; if (oManager){oManager.ToggleFloatingToolbar( ); oManager.ToggleFloatingToolbar( true); }}else {var toolbars=editor.GetHtmlToolbarElements( ); for (var i=0; i<toolbars.length; i++){var dockableObj=toolbars[i]; if (dockableObj && dockableObj.AutoDock)dockableObj.AutoDock( true); }var modules=editor.Modules; for (var i=0; i<modules.length; i++){var dockableObj=modules[i].GetTopElement( ); if (dockableObj && dockableObj.AutoDock)dockableObj.AutoDock( true); }}} ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_TOGGLE_SCREEN_MODE]= function (commandName,editor,oTool){var oWrapper=editor.WrapperElement; if (editor.ToggleFullScreen){if (editor.OnResizeHandler){RadEditorNamespace.Utils.DetachEventEx(window,"resize",editor.OnResizeHandler); editor.OnResizeHandler=null; }var topZone=editor.DockingZones.TopZone; topZone.style.width=editor.TopZoneWidth; editor.SetSize(editor.Width,editor.Height, false); document.body.scroll=''; document.documentElement.style.overflow=''; editor.ToggleFullScreen= false; try {document.body.style.margin=''; }catch (e){ ; }if ( true ==editor.IsToolbarModeEnabled(RadEditorNamespace.ToolbarModesEnum.PageTop) || true ==editor.IsToolbarModeEnabled(RadEditorNamespace.ToolbarModesEnum.ShowOnFocus)){var oManager=editor.IsToolbarModeEnabled(RadEditorNamespace.ToolbarModesEnum.PageTop)?RadEditorNamespace.GetPageTopToolbarManager( ):RadEditorNamespace.GetShowOnFocusToolbarManager( ); if (oManager){var oToolbar=oManager.GetToolbarByEditor(editor); if (oToolbar && oToolbar.parentNode)oToolbar.parentNode.removeChild(oToolbar); oManager.CurrentEditor=null; editor.SetFocus( ); }}}else {editor.Fire(RadEditorNamespace.RADCOMMAND_TOGGLE_DOCKING); if ( true ==editor.IsToolbarModeEnabled(RadEditorNamespace.ToolbarModesEnum.PageTop) || true ==editor.IsToolbarModeEnabled(RadEditorNamespace.ToolbarModesEnum.ShowOnFocus)){var oManager=editor.IsToolbarModeEnabled(RadEditorNamespace.ToolbarModesEnum.PageTop)?RadEditorNamespace.GetPageTopToolbarManager( ):RadEditorNamespace.GetShowOnFocusToolbarManager( ); if (oManager){var oToolbar=oManager.GetToolbarByEditor(editor); if (oToolbar){oManager.ShowToolbarHolder( false); oToolbar.parentNode.removeChild(oToolbar); editor.GetDockingZoneById("Top").appendChild(oToolbar); }}}document.body.scroll='\x6eo'; document.body.style.margin="\x30px"; if (document.documentElement)document.documentElement.style.overflow='\x68idden'; var topZone=editor.DockingZones.TopZone; editor.TopZoneWidth=topZone.offsetWidth; if (editor.IsIE && "\103\x53S1Compa\x74"==document.compatMode){editor.Height=oWrapper.clientHeight; oWrapper.style.width=document.documentElement.clientWidth; oWrapper.style.height=document.documentElement.clientHeight; var oRect=RadEditorNamespace.Utils.GetRect(oWrapper); var difference=oRect.height-parseInt(oWrapper.style.height); if (difference>0){oWrapper.style.height=(parseInt(oWrapper.style.height)-difference)+"px"; }}else {oWrapper.style.width=window.innerWidth?parseInt(window.innerWidth)+"p\x78":parseInt(document.body.clientWidth)+"px"; var oHeight=parseInt(document.body.clientHeight); oWrapper.style.height=window.innerHeight?parseInt(window.innerHeight)+"\x70x":oHeight+"\x70x"; }var oRect=RadEditorNamespace.Utils.GetRect(oWrapper); var left=oRect.left; var top=oRect.top; document.body.scrollTop=top; document.body.scrollLeft=left; document.documentElement.scrollTop=top; document.documentElement.scrollLeft=left; editor.ToggleFullScreen= true; if (!editor.OnResizeHandler){editor.OnResizeHandler= function ( ){editor.ToggleFullScreen= false; editor.Fire(RadEditorNamespace.RADCOMMAND_TOGGLE_SCREEN_MODE); } ; RadEditorNamespace.Utils.AttachEventEx(window,"\162\x65size",editor.OnResizeHandler); }}editor.SetEditable( true); editor.SetFocus( ); if (!oTool)oTool=editor.GetToolByName(commandName); if (oTool){oTool.SetState(editor.ToggleFullScreen?RadEditorNamespace.RADCOMMAND_STATE_ON:RadEditorNamespace.RADCOMMAND_STATE_OFF); }return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_ZOOM]= function (commandName,editor,oTool){var value=oTool.GetSelectedValue( ); oTool.HeaderElement.innerHTML=value; editor.ContentArea.style.zoom=value; return false; } ; RadEditorCommandList["\x49ns\x65\x72tH\x6f\162\x69\172\x6fntalR\x75\154\x65"]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_PARAGRAPH]= function (commandName,editor,oTool){if ("I\x6ese\x72\x74Ho\x72izontal\x52ule"==commandName){if (oTool){editor.ExecuteInsertObjectCommand(editor.CreateElement("HR"),editor.Localization[oTool.Name]); }else {editor.ExecuteInsertObjectCommand(editor.CreateElement("HR"),editor.Localization[commandName]); }}else {editor.ExecuteBrowserCommand("Insert\x50aragrap\x68", false); if (editor.IsIE){var oDoc=editor.Document; var oRange=oDoc.selection.createRange( ); var pList=oDoc.body.getElementsByTagName("P"); var oP=null; for (var i=pList.length-1; i>=0; i--){tempRange=oRange.duplicate( ); tempRange.moveToElementText(pList[i]); var iResult=oRange.compareEndPoints("\x53tar\x74\x54oEn\x64",tempRange); if (1==iResult){oP=pList[i]; break; }}if (oP){var genericCmd=RadEditorNamespace.RadGenericCommand.New(commandName,editor.ContentWindow); oRange.moveToElementText(oP); oRange.collapse( false); oRange.pasteHTML("&nbsp\x3b"); editor.ExecuteCommand(genericCmd); oRange.moveStart("\x63ha\x72\x61ct\x65\162",-1); oRange.moveToElementText(oP); oRange.moveStart("\x63haract\x65\x72",1); oRange.select( ); oRange.collapse( true); }}}} ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_PRINT]= function (commandName,editor,oTool){if (editor.IsIE){editor.ExecuteBrowserCommand(commandName, false ,null); }else if (editor.ContentWindow.print){editor.ContentWindow.print( ); }return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_REPEAT_LAST_COMMAND]= function (commandName,editor,oTool){editor.SetFocus( ); editor.CommandsManager.RepeatLastCommand( ); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_SNIPPET]= function (commandName,editor,oTool){var value=oTool.GetSelectedValue( ); var snippet=document.getElementById(value); var oContent=TelerikNamespace.Utils.DecodePostbackContent(snippet.innerHTML, false); if (snippet)editor.PasteHtml(oContent,editor.Localization[oTool.Name]); } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_CUSTOM_LINK]= function (commandName,editor,oTool){var value=oTool.GetSelectedValue( ); var theElement=editor.GetSelectedElement( ); var parentLink=RadEditorNamespace.Utils.GetElementParentByTag(theElement,"\x41"); var theText=''; if (!parentLink && editor.GetSelection( ).GetHtmlText( )==""){theText=value.Text; }var linkInfo= {href:value.Href,title:value.Title,target:value.Target,text:theText } ; editor.InsertLink(value.Href,theText,linkInfo); } ; RadEditorCommandList["InsertG\x72oupbox"]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_DATE]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_TIME]=RadEditorCommandList[RadEditorNamespace.RADCOMMAND_INSERT_SYMBOL]= function (commandName,editor,oTool){var value=""; switch (commandName){case RadEditorNamespace.RADCOMMAND_INSERT_SYMBOL:value=oTool.GetSelectedValue( ); break; case RadEditorNamespace.RADCOMMAND_INSERT_DATE:var now=new Date( ); value="\x26nbsp;"+now.toLocaleDateString( ); break; case RadEditorNamespace.RADCOMMAND_INSERT_TIME:var now=new Date( ); value="\x26nb\x73\x70;"+now.toLocaleTimeString( ); break; default:value="\074fields\x65t style\x3d\047\x57IDTH:\x20200px\x3b HEIGH\x54: 76\x70x\047\x3e \x3clegen\x64>Titl\x65\074\x2flege\x6ed>Con\x74ent.\x2e. \074\057\x66ield\x73et> "; }editor.PasteHtml(value,oTool!=null?editor.Localization[oTool.Name]: ""); } ; RadEditorCommandList["AjaxSpe\x6clCheck"]= function (commandName,editor,oTool){function AjaxSpellCheckController(editor){ this.Editor=editor; this.OriginalHtml=null; this.StartCheckMessage=editor.GetLocalizedString("Sp\x65llChec\x6b","Chec\x6b\040\x73pel\x6c\151\x6e\147"); this.FinalCheckMessage=editor.GetLocalizedString("\x53p\x65\154\x6cCheck\x45\156\x64","\x46in\x69\163h\x20spellch\x65\x63k\x69\156\x67"); this.CompleteMessage=editor.GetLocalizedString("SpellChe\x63kCompl\x65te","Spellche\x63\153\x69ng c\x6f\x6dp\x6c\145\x74\145\x21"); this.CancelMessage=editor.GetLocalizedString("\x43ancel","\x43ancel"); this.AddWordSuccessMessage=editor.GetLocalizedString("\x41ddC\x75\x73to\x6d\127\x6frdSu\x63cess"); this.SpellingInProgressMessage=editor.GetLocalizedString("Spelli\x6egInProg\x72ess"); this.SpellingModeMessage=editor.GetLocalizedString("\x53pe\x6c\x6cing\x4dode"); this.NoSpellingMistakesMessage=editor.GetLocalizedString("NoSpell\x69ngMista\x6b\145\x73","No mis\x74akes fou\x6e\144."); this.LoadingIcon=editor.GetImageUrl(".\x2e/Img/lo\x61dingspe\x6c\154\x2egif"); this.CreateUI( ); }AjaxSpellCheckController.prototype.GetSpellService= function ( ){var spellId=this.Editor.AjaxSpellId; if (typeof GetSpellCheckService!="f\x75nction"){alert("\107\x65tSpe\x6clCheckSe\x72vice is\x20"+typeof GetSpellCheckService); return null; }var spell=GetSpellCheckService(spellId); if (!spell){alert("\x47etS\x70\145\x6clCheckS\x65\162\x76ice(\047"+spellId+"\047\x29 retur\x6eed "+spell); return null; }var dictLang=null; if (oTool && oTool.GetSelectedValue){dictLang=oTool.GetSelectedValue( ); }else if (!spell.DictionaryLanguage){dictLang=editor.Language.replace(/\x5f/,"-"); }if (dictLang)spell.DictionaryLanguage=dictLang; return spell; } ; AjaxSpellCheckController.prototype.CreateUI= function ( ){var B=new Ektron.String( ); B.appendLine('\x3cdiv\x20\143\x6cass=\042RadES\x70ellUIW\x72apper\042>'); B.appendLine('\074\x64iv \x63\154\x61ss=\042\x52adE\x53pellUID\x65script\x69on\042>\074\x2fdi\x76>'); B.append('\074\x64iv\x20\x63la\x73s=\042\x52adE\x53\160\x65\154\x6c\125\x49Butt\x6fnsWr\x61pper\042>'); B.append('\074button \x63lass=\x22\122\x61dEXhtml\x42utton\042 oncli\x63\153\x3d\042\x74hi\x73.Pare\x6et.Fin\x69shSpe\x6clchec\x6b();re\x74urn \x66alse\x3b\042\x3e'); B.append(this.FinalCheckMessage); B.append('\x3c/button\x3e'); B.append('\074button c\x6cass=\042\x52adE\x58htmlBu\x74ton\042\x20onc\x6cick=\x22this\x2eParent\x2eCance\x6cSpell\x63heck()\x3bretur\x6e fal\x73e;\042\076'); B.append(this.CancelMessage); B.appendLine('\074/button>\x3c/div>'); B.appendLine('\074\x2fd\x69\166\x3e'); var o0=$ektron(B.toString( )); this.FinishButton=o0.find("bu\x74ton:fir\x73t-child").get(0); this.FinishButton.Parent=this ; this.CancelButton=o0.find("\x62utto\x6e\072\x6cast\x2d\143\x68ild").get(0); this.CancelButton.Parent=this ; this.TopElement=o0.get(0); } ; AjaxSpellCheckController.prototype.Dispose= function ( ){if (this.MultiDropdown && this.MultiDropdown.Dispose){ this.MultiDropdown.Dispose( ); }if (this.CancelButton){ this.CancelButton.Parent=null; this.CancelButton.onclick=null; } this.CancelButton=null; if (this.FinishButton){ this.FinishButton.Parent=null; this.FinishButton.onclick=null; } this.FinishButton=null; if (this.SpellEngineUI_Instance)this.SpellEngineUI_Instance.Dispose( ); this.Editor=null; this.TopElement=null; this.LoadingIcon=null; this.SpellIconHtml=null; } ; AjaxSpellCheckController.prototype.CancelSpellcheck= function ( ){ this.SetVisible( false); this.SpellEngineUI_Instance.Finalize( false); if (null!=this.OriginalHtml){var content=this.Editor.FiltersManager.GetDesignContent(this.OriginalHtml); this.Editor.SetContentAreaHtml(content); this.OriginalHtml=null; }var comMgr=this.Editor.CommandsManager; var commands=comMgr.Commands; comMgr.RemoveCommandAt(commands.length-1); this.Editor.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED); } ; AjaxSpellCheckController.prototype.FinishSpellcheck= function ( ){ this.SetVisible( false); this.SpellEngineUI_Instance.Finalize( ); this.OriginalHtml=null; } ; AjaxSpellCheckController.prototype.AddCustomWord= function (oWord){var spell=this.GetSpellService( ); var oThis=this ; var oSuccess=this.AddWordSuccessMessage; oThis.SpellEngineUI_Instance.ClearWrongWords(oWord,oWord); spell.AddCustomWord(oWord, function (sender,commandResult){alert(oWord+"\x20"+oSuccess); } ,null); } ; AjaxSpellCheckController.prototype.SetVisible= function (toShow){ this.TopElement.style.display=toShow?"": "\x6eone"; if ( false ==toShow){$ektron(".R\x61dEDocki\x6egZone > \x74\141\x62le").show( ); }else {$ektron(".RadED\x6fckingZo\x6e\145\x20> tabl\x65").hide( ); }} ; AjaxSpellCheckController.prototype.EnableButtons= function (toEnable){var buts=this.TopElement.getElementsByTagName("bu\x74ton"); for (var i=0; i<buts.length; i++){buts[i].disabled=!toEnable; }} ; AjaxSpellCheckController.prototype.SetLoadingIconVisible= function (toShow){var O0=new Ektron.String( ); if (toShow){O0.append('\x3clab\x65\154\x20class=\x22RadETo\x6f\154\x54ext\042\x3e'); O0.append(this.SpellingInProgressMessage); O0.append('\x3c/la\x62\x65l>'); O0.append('\074img sr\x63\x3d\042'); O0.append(this.LoadingIcon); O0.append('\042\x20alig\x6e\075\x22middle\042 />'); $ektron("\x2eRadE\x53\x70el\x6cUIDescri\x70tion",this.TopElement).html(O0.toString( )); }else {O0.append('\074\x6cab\x65\x6c c\x6c\141\x73s=\042\x52adE\x54\157\x6flText\042>'); O0.append(this.SpellingModeMessage); O0.append('\074\057\x6c\141\x62el>'); $ektron(".Ra\x64ESpellUI\x44escripti\x6fn",this.TopElement).html(O0.toString( )); }} ; AjaxSpellCheckController.prototype.BeginSpellcheck= function (spellCheckResult){ this.SetLoadingIconVisible( false); this.EnableButtons( true); if (spellCheckResult.BadWords.length==0){alert(this.NoSpellingMistakesMessage); this.FinishSpellcheck( ); }else { this.SpellEngineUI_Instance.Initialize(spellCheckResult,this.OriginalHtml); }} ; AjaxSpellCheckController.prototype.MakeSpellcheckRequest= function ( ){var oThis=this ; if (this.SpellEngineUI_Instance){var isComplete=this.SpellEngineUI_Instance.SpellcheckComplete; if (!isComplete){ this.FinishSpellcheck( ); }}else { this.SpellEngineUI_Instance=new EkRadEditorSpellEngineUI(this.Editor); this.SpellEngineUI_Instance.OnRaiseSpellcheckDone= function ( ){oThis.FinishSpellcheck( ); alert(oThis.CompleteMessage); } ; this.SpellEngineUI_Instance.OnRaiseAddCustomWord= function (oWord){oThis.AddCustomWord(oWord); } ; }var spell=this.GetSpellService( ); if (!spell){alert("Failed\x20to crea\x74\145\x20\163\x70ell ch\x65cker. \x69\144\x3d\047"+this.Editor.AjaxSpellId+"\x27"); this.SetVisible( false); return; } this.SetVisible( true); this.SetLoadingIconVisible( true); this.EnableButtons( false); this.OriginalHtml=this.Editor.getContent( ); var spellCheckServiceCallback= function (sender,commandResult){oThis.BeginSpellcheck(commandResult); };spell.SpellCheck(this.SpellEngineUI_Instance.EscapeNewLines(this.OriginalHtml),spellCheckServiceCallback,null); } ; if (!editor.AjaxSpellController_Instance){editor.AjaxSpellController_Instance=new AjaxSpellCheckController(editor); var topElement=editor.AjaxSpellController_Instance.TopElement; if (editor.IsIE){if (topElement.parentNode!=editor.DockingZones.TopZone){editor.DockingZones.TopZone.appendChild(topElement); $ektron(editor.DockingZones.TopZone).parent( ).show( ); }}else {if (topElement.parentNode!=editor.ContentAreaElement.parentNode){editor.ContentAreaElement.parentNode.insertBefore(topElement,editor.ContentAreaElement); }}}editor.AjaxSpellController_Instance.MakeSpellcheckRequest( ); return false; } ; RadEditorCommandList[RadEditorNamespace.RADCOMMAND_SPELLCHECK]= function (commandName,editor,oTool){var selection=editor.GetSelection( ); var selectedText=selection.GetText( ); var isSelectionEmpty=(""==selectedText || null==selectedText); var textSource= {restorePoint:editor.CreateRestorePoint( ),GetText:function ( ){return this.getText( ); } ,SetText:function (text){ this.setText(text); } ,getText:function ( ){if (isSelectionEmpty){return editor.GetPageHtml( ); }else {return selection.GetHtmlText( ); }} ,setText:function (text){if (isSelectionEmpty){editor.SetHtml(text,(editor.Localization["\x43o\x72\162\x65ctSpel\x6cing"] || "\x53\160\x65\x6cli\x6e\147 \x43hanges")); }else { this.restorePoint.Select( ); editor.PasteHtml(text,(editor.Localization["\x43o\x72\x72ect\x53pelling"] || "\x53pel\x6c\x69ng\x20\103\x68\141\x6eges")); }}} ; var hasMultipleLanguagesSelector=(oTool && oTool.GetSelectedValue); var language=hasMultipleLanguagesSelector?oTool.GetSelectedValue( ):editor.Language.replace(/\x5f/,"-"); var spellId=editor.SpellId; try {var spell=GetRadSpell(spellId); spell.Skin=editor.SkinBasePath; spell.UseClassicDialogs=editor.UseClassicDialogs; if (spell.Language=="\x52adEdito\x72\137\x44efault" || hasMultipleLanguagesSelector)spell.Language=language; if (spell.DictionaryLanguage=="\x52adEdi\x74\157\x72_Defaul\x74" || hasMultipleLanguagesSelector)spell.DictionaryLanguage=language; spell.SetTextSource(textSource); spell.StartSpellCheck( ); }catch (spellError){alert("The \x73pellchec\x6ber has \x6e\157\x74 been\x20found."+"\x0aPlease e\x6esure tha\x74 you ha\x76e a com\x70atible\x20EkRad\x53pell\x2edll as\x73embly\x20in you\x72 web \x61pplic\x61tion\047s b\x69n fol\x64er"+"\012\105r\x72\157\x72\040\x6dessage\x3a "+spellError.message); }return false; } ;
function RadEditorSpellEngineUI(editor){ this.Editor=editor; this.RadSpellData=null; this.SuggestionDropdown=null; this.WrongWordCounter=0; this.WrongWordsArray=null; this.SpanId="\122\x61dESpe\x6clErro\x72_"; this.SelectedEditorElement=null; this.SpellcheckComplete= true; this.AutomaticAdvance= true; this.LocalizedCommandName=this.Editor.GetLocalizedString("Spe\x6clCheck","C\x68\145\x63k spe\x6cling"); this.LocalizedName=this.Editor.GetLocalizedString("Spelling\x43hange","\x53pelling\x20\103\x68ange"); this.NoSuggestionsString=this.Editor.GetLocalizedString("\116\x6fSugg\x65\163\x74\151o\x6es","(\x6e\157\x20\x73ug\x67estions\x29"); this.ChangeWordString=this.Editor.GetLocalizedString("\103\x68angeW\x6frdString","C\x68\141\x6e\x67e"); this.IgnoreAllString=this.Editor.GetLocalizedString("\x49gnore\x41\154\x6cStri\x6e\147","Ignor\x65\040\x41ll"); this.IgnoreString=this.Editor.GetLocalizedString("Igno\x72eStrin\x67","Ig\x6e\157\x72e"); this.MoreThanOnceMessage=this.Editor.GetLocalizedString("\115\x6freTha\x6e\117\x6e\143e\x4dessage","\x54his w\x6f\x72d \x6fccurs mo\x72e than\x20once \x69\156\x20the\x20text.\x20Would\x20you li\x6be to \x72eplac\x65 all i\x6estan\x63es?"); this.UndoDisabledMessage=this.Editor.GetLocalizedString("\x55ndoDisa\x62\154\x65dMe\x73\163\x61ge","You c\x61\156\x6e\157\x74 undo f\x75rther w\x68ile in\x20\163\x70ell\x63heck \x6dode. P\x6cease \x66inish\x20spell\x63hecki\x6eg fi\x72st."); this.AddToDictionaryString=this.Editor.GetLocalizedString("AddToDi\x63tionar\x79","\x41dd to \x64\151\x63tionar\x79"); this.IgnoreIcon=this.Editor.GetImageUrl(".\x2e/Img/S\x70\x65l\x6c\111\x67nor\x65\056\x67if"); this.OkIcon=this.Editor.GetImageUrl("../Img/\x53pellCh\x61\156\x67e.gi\x66"); this.AddIcon=this.Editor.GetImageUrl("..\x2fImg/Spe\x6c\154\x44ictio\x6eary.gif"); this.SuggestionBox=null; this.OnRaiseAddCustomWord= function (oVal){} ; this.OnRaiseSpellcheckDone= function ( ){} ; this.Dispose= function ( ){ this.Editor=null; this.SearchEngine=null; this.RadSpellData=null; this.OnRaiseSpellcheckDone=null; if (this.SuggestionDropdown)this.SuggestionDropdown.Dispose( ); if (this.SuggestionBox)this.SuggestionBox.Dispose( ); this.SuggestionBox=null; } ; this.ConfigureUndo= function (enable){if (enable){ this.Editor.EnableEditing( true); var comMgr=this.Editor.CommandsManager; var commands=comMgr.Commands; var i=this.CurrentUndoIndex; while (i<commands.length){comMgr.RemoveCommandAt(commands.length-1); } this.Editor.ExecuteCommand(this.SaveStateCmd); this.Editor.OnClientCommandExecuting=this.OnClientCommandExecuting; this.OnClientCommandExecuting=null; }else {var oThis=this ; this.OnClientCommandExecuting=this.Editor.OnClientCommandExecuting; this.CurrentUndoIndex=this.Editor.CommandsManager.GetCommandsToUndo( ).length; this.Editor.OnClientCommandExecuting= function (editor,commandName,oTool){if (commandName=="\x55ndo" && oThis.CurrentUndoIndex>=editor.CommandsManager.GetCommandsToUndo( ).length){alert(oThis.UndoDisabledMessage); return false; }} ; this.Editor.EnableEditing( true , { "\x55ndo": true ,"\x52edo": true ,"\x41ja\x78\x53pe\x6clCheck": true } , false , true , false , false , false , false); }} ; this.Finalize= function (toClearWords){if ( true !=this.Initialized)return; if ( false !=toClearWords)this.ClearWrongWords( ); var oEditor=this.Editor; if (this.OnMouseHandler)oEditor.DetachEventHandler("click",this.OnMouseHandler); if (this.OnKeyDownHandler)oEditor.DetachEventHandler("\x6bey\x64\157\x77n",this.OnKeyDownHandler); if (this.OnContextMenu)oEditor.DetachEventHandler(RadEditorNamespace.RADEVENT_CONTEXTMENU,this.OnContextMenu); if (this.OnEditorSubmit)oEditor.DetachEventHandler(RadEditorNamespace.RADEVENT_SUBMIT,this.OnEditorSubmit); this.ConfigureUndo( true); oEditor.SetFocus( ); oEditor.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED); this.WrongWordsArray=null; this.SpellcheckComplete= true; if (this.SuggestionDropdown)this.SuggestionDropdown.Dispose( ); if (this.SuggestionBox)this.SuggestionBox.Dispose( ); this.SuggestionBox=null; this.Initialized= false; } ; this.Initialize= function (spellCheckResult,originalContent){ this.Initialized= true; this.WrongWordsArray=spellCheckResult.BadWords; this.WordOffsets=spellCheckResult.WordOffsets; var editor=this.Editor; this.SaveStateCmd=RadEditorNamespace.RadGenericCommand.New(this.LocalizedCommandName,editor.ContentWindow); this.MarkWrongWords(originalContent); this.SpellcheckComplete= false; this.WrongWordCounter=0; var oThis=this ; this.OnEditorSubmit= function ( ){oThis.Finalize( ); };this.Editor.AttachEventHandler(RadEditorNamespace.RADEVENT_SUBMIT,this.OnEditorSubmit); this.OnMouseHandler= function (e){oThis.ShowSuggestionDropdown( ); return RadEditorNamespace.Utils.CancelEvent(e); } ; var isIE=this.Editor.IsIE; this.OnKeyDownHandler= function (e){if (e.keyCode==9){oThis.MoveToNextWrongWord( ); return RadEditorNamespace.Utils.CancelEvent(e); }var cancelEvent= false; if (oThis.SuggestionDropdown){var oDown=oThis.SuggestionDropdown; var isVisible=(oThis.SuggestionDropdown.Popup && oThis.SuggestionDropdown.Popup.IsVisible( )); var keyCode=e.keyCode; if (isVisible){if (38==keyCode){oDown.SelectPreviousItem( ); cancelEvent= true; }else if (40==keyCode){oDown.SelectNextItem( ); cancelEvent= true; }else if (13==keyCode){oDown.ShowPopup( false); oThis.Fire("",oDown); try {e.keyCode=123; }catch (e){} ; cancelEvent= true; }else if (27==keyCode && !isIE){oDown.ShowPopup( false); }cancelEvent= true; }}if (cancelEvent){RadEditorNamespace.Utils.CancelEvent(e); return false; }} ; this.OnContextMenu= function (sender,e){if (isIE)oThis.OnMouseHandler(e); e.cancelBubble= true; if (isIE)return false; } ; window.setTimeout( function ( ){var ed=oThis.Editor; ed.AttachEventHandler("\x63lick",oThis.OnMouseHandler); ed.AttachEventHandler("\x6beydown",oThis.OnKeyDownHandler); ed.AttachEventHandler(RadEditorNamespace.RADEVENT_CONTEXTMENU,oThis.OnContextMenu); if (oThis.AutomaticAdvance){if (isIE)ed.SetFocus( ); oThis.MoveToNextWrongWord( ); }} ,250); this.ConfigureUndo( false); } ; this.MoveToNextWrongWord= function ( ){var dir=-1; var oSel=this.Editor.GetSelection( ); var oElem=oSel.GetParentElement( ); var oMatch=null; if (this.IsHighlightedWord(oElem) && !this.Editor.GetSelectionHtml( )){oMatch=oElem; }else {oSel.Collapse( ); var oDoc=this.Editor.Document; var oEditor=this.Editor; var isIE=this.Editor.IsIE; var oThis=this ; var oRange=null; function getWrongWord( ){var oSpans=oEditor.Document.getElementsByTagName("SPAN"); if (0==oSpans.length){return null; }var i=0; var oSpan=oSpans[i]; oRange=oEditor.GetSelection( ).GetRange( ); while (oSpan!=null){if (oThis.IsHighlightedWord(oSpan)){var result=null; if (isIE){if (oRange.duplicate)tempRange=oRange.duplicate( ); else tempRange=oEditor.ContentArea.createTextRange( ); try {if (tempRange.moveToElementText)tempRange.moveToElementText(oSpan); }catch (ex){}if (!oRange.compareEndPoints){break; }result=oRange.compareEndPoints("EndTo\x53tart",tempRange); if (0==result && oThis.SuggestionDropdown && oThis.SuggestionDropdown.Popup && !oThis.SuggestionDropdown.Popup.IsVisible( )){oMatch=oSpan; break; }}else if (oRange){tempRange=oRange.cloneRange( ); tempRange.selectNodeContents(oSpan); result=oRange.compareBoundaryPoints(Range.END_TO_START,tempRange); }if (dir==result){oMatch=oSpan; break; }}i++; oSpan=oSpans[i]; } ; return oSpan; } ; var oMatch=getWrongWord( ); if (!oMatch){var oArea=oEditor.ContentArea; if (oArea && oArea.createTextRange){var newRange=oArea.createTextRange( ); newRange.moveToElementText(oArea); newRange.collapse( true); newRange.select( ); }else {var firstSpan=oEditor.Document.getElementsByTagName("SPAN")[0]; if (firstSpan){oEditor.SelectElement(firstSpan); }}try {var oRange=oEditor.GetSelection( ).GetRange( ); if (oRange && oRange.moveStart){oRange.moveStart("\x63haract\x65\162",-1); oRange.select( ); }}catch (e){ ; }oEditor.GetSelection( ).Collapse( true); oMatch=getWrongWord( ); }}if (oMatch){ this.Editor.SelectElement(oMatch); var range=this.Editor.GetSelection( ).GetRange( ); if (range && range.scrollIntoView && range.select){range.scrollIntoView( true); range.select( ); }else if (oMatch.scrollIntoView)oMatch.scrollIntoView( false); this.ShowSuggestionDropdown( ); }return oMatch; } ; this.ClearWrongWords= function (wrongWord,correctWord){var oSpans=this.Editor.Document.getElementsByTagName("SPAN"); for (var i=0; i<oSpans.length; i++){var oSpan=oSpans[i]; if (this.IsHighlightedWord(oSpan)){if (wrongWord){if (oSpan.innerHTML==wrongWord){ this.ClearHighlightedElement(oSpan,correctWord); i--; }continue; }else { this.ClearHighlightedElement(oSpan); }i--; }}} ; this.IsHighlightedRemaining= function ( ){var oSpans=this.Editor.Document.getElementsByTagName("S\x50AN"); for (var i=0; i<oSpans.length; i++){var oSpan=oSpans[i]; if (this.IsHighlightedWord(oSpan)){return true; }}return false; } ; this.GetCurrentWrongWord= function ( ){var elem=this.SelectedEditorElement; var clean=$ektron.removeTags(elem.innerHTML); return clean; } ; this.IsHighlightedWord= function (oElem){if (!oElem || !oElem.getAttribute)return false; var id=oElem.getAttribute("id"); if (id && id.indexOf(this.SpanId)>-1){return true; }return false; } ; this.ClearHighlightedElement= function (oSpan,oCorrectWord){var text=oCorrectWord?oCorrectWord:$ektron.removeTags(oSpan.innerHTML); var addUndo=oCorrectWord? true : false; if (addUndo)this.Editor.SelectElement(oSpan); var genericCmd=RadEditorNamespace.RadGenericCommand.New(this.LocalizedName,this.Editor.ContentWindow); var textNode=this.Editor.Document.createTextNode(text); oSpan.parentNode.replaceChild(textNode,oSpan); if (addUndo){if (this.Editor.IsIE){range=this.Editor.Document.body.createTextRange( ); range.findText(textNode.data); try {range.select( ); }catch (ex){}}else this.Editor.SelectElement(textNode); this.Editor.GetSelection( ).Collapse( ); }if (addUndo)this.Editor.ExecuteCommand(genericCmd); this.SelectedEditorElement=null; } ; this.MarkWrongWords= function (originalContent){var WrongWordsMarker= function (badWords,wordOffsets,spanId,content){ this.BadWords=badWords; this.WordOffsets=wordOffsets; this.SpanId=spanId; this.Content=content; this.CurrentWordIndex=0; this.Result=null; } ; WrongWordsMarker.prototype= {GetSplitContent:function ( ){var splitText=new Array(this.BadWords.length*2+1); for (var i=0; i<this.BadWords.length; i++){var splitTextIndex=i*2; splitText[splitTextIndex]=this.GetBeforeText(i); splitText[splitTextIndex+1]=this.BadWords[i].wordString; }splitText[splitText.length-1]=this.GetLastText( ); return splitText; } ,GetMarkedSplitContent:function (splitContent){for (var i=1; i<splitContent.length; i+=2){splitContent[i]=this.GetMarkedWord(splitContent[i]); this.CurrentWordIndex++; }return splitContent; } ,GetBeforeText:function (badWordIndex){var startCharIndex=0; var endCharIndex=this.GetWordStartIndex(this.BadWords[badWordIndex]); if (badWordIndex!=0){badWordBefore=this.BadWords[badWordIndex-1]; startCharIndex=this.GetWordEndCharIndex(badWordBefore); }return this.Content.substring(startCharIndex,endCharIndex); } ,GetLastText:function ( ){var lastBadWord=this.BadWords[this.BadWords.length-1]; var startCharIndex=this.GetWordEndCharIndex(lastBadWord); var endCharIndex=this.Content.length; return this.GetSubContent(startCharIndex,endCharIndex);} ,GetWordEndCharIndex:function (badWord){return this.GetWordStartIndex(badWord)+badWord.wordString.length;} ,GetSubContent:function (startIndex,endIndex){return this.Content.substring(startIndex,endIndex); } ,GetWordStartIndex:function (badWord){return this.WordOffsets[badWord.textOffset]; } ,GetMarkedWord:function (badWordString){return "\x3cspan c\x6c\141\x73s=\x27RadEW\x72ongW\x6frd\047\x20id\x3d\047"+this.SpanId+this.CurrentWordIndex+"\x27>"+badWordString+"\074\x2fspa\x6e\x3e";} ,GetResult:function ( ){if (this.Result==null){ this.Result=this.GetMarkedSplitContent(this.GetSplitContent( )).join(''); } this.Result=this.Result.replace(/(\x3c\x74\x65\x78\x74\x61\x72\x65\x61[^\x3e]*\x3e)([\w\W\x0a]+?)(\x3c\x2f\x74\x65\x78\x74\x61\x72\x65\x61\x3e)/gi, function ($0_match,$1_openTag,$2_innerContent,$3_closeTag){return $1_openTag+$ektron.removeTags($2_innerContent)+$3_closeTag; } ); return this.Result; }} ; var wrongWordsMarker=new WrongWordsMarker(this.WrongWordsArray,this.WordOffsets,this.SpanId,this.EscapeNewLines(originalContent)); var content=this.UnEscapeNewLines(wrongWordsMarker.GetResult( )); content=content.replace(/(\x3c\w+)/,"\x241 xml:s\x70\x61c\x65=\042\x70r\x65serve\x22"); content=this.Editor.FiltersManager.GetDesignContent(content); content=content.replace(/\x20\x78\x6d\x6c\x3a\x73\x70\x61\x63\x65\x3d\x22\x70\x72\x65\x73\x65\x72\x76\x65\x22/,""); this.Editor.SetContentAreaHtml(content); } ; this.EscapeNewLines= function (text){var result=text.replace(/\x0a/gi,"&#10\x3b"); result=result.replace(/\x0d/gi,"&#13;"); return result; } ; this.UnEscapeNewLines= function (text){return text; } ; this.GetSuggestionsForWord= function (wrongWord){var array=this.WrongWordsArray; for (var i=0; i<array.length; i++){var word=array[i].wordString; if (word==wrongWord){var temp=array[i].suggestionsString; if (temp.length==0){return [["",this.NoSuggestionsString]]; }else {temp=temp.concat([ ]); for (var j=0; j<temp.length; j++){temp[j]=[temp[j],temp[j]]; }}return temp; }}return [ ]; } ; this.GetFooterItems= function (wrongWord){var temp=[ ]; if (this.Editor.SpellAllowAddCustom){temp.splice(0,0,["\x72\x61\x64e_\x61dd_to_di\x63tionar\x79",this.AddToDictionaryString,this.AddIcon]); }temp.splice(0,0,["ra\x64e_change",this.ChangeWordString,this.OkIcon]); if (this.OccursMoreThanOnce(wrongWord)){temp.splice(0,0,["ra\x64e_igno\x72e_all",this.IgnoreAllString,this.IgnoreIcon]); }temp.splice(0,0,["",this.IgnoreString,this.IgnoreIcon]); return temp; };this.OccursMoreThanOnce= function (wrongWord){var newHtml=this.Editor.GetText( ); var re=new RegExp('(\134b)'+wrongWord+'(\134\x62)',"g"); var res=newHtml.match(re); return (res && res.length>1); } ; this.Fire= function (name,dropdown){var selValue=dropdown.SelectedValue; var selectedHtml=this.SelectedEditorElement.innerHTML; if (selValue=="\x72ade\x5f\x61dd\x5fto_dict\x69onary"){ this.OnRaiseAddCustomWord(this.GetCurrentWrongWord( )); }else if (selValue=="r\x61de_ignor\x65_all"){ this.ClearWrongWords(selectedHtml,""); }else if (selValue=="rade_\x63hange"){ this.ShowSuggestionBox(this.SelectedEditorElement); return; }else {var executed= false; if (selValue){var isDuplicate=this.OccursMoreThanOnce(selectedHtml); if (isDuplicate){var action=confirm(this.MoreThanOnceMessage); if (action){ this.ClearWrongWords(selectedHtml,selValue); executed= true; }}}if (!executed)this.ClearHighlightedElement(this.SelectedEditorElement,selValue); } this.SuggestionDropdown.Dispose( ); this.SuggestionDropdown=null; var res=this.IsHighlightedRemaining( ); if (!res){ this.OnRaiseSpellcheckDone( ); return; } this.Editor.FireEvent(RadEditorNamespace.RADEVENT_SEL_CHANGED); if (this.AutomaticAdvance){ this.MoveToNextWrongWord( ); }} ; this.ShowSuggestionDropdown= function ( ){var oEditor=this.Editor; var selElem=oEditor.GetSelection( ).GetParentElement( ); if (!this.IsHighlightedWord(selElem))return; this.SelectedEditorElement=selElem; var popupWidth=160; var word=this.GetCurrentWrongWord( ); if (this.SuggestionDropdown)this.SuggestionDropdown.Dispose( ); var controller=this ; var toolArgs= {} ; toolArgs.IsPopupScrollable= false; toolArgs.GetController= function ( ){return controller; } ; toolArgs.Type=RadEditorNamespace.TOOL_COMBOBOX; toolArgs.PopupClassName="Rad\x45SpellC\x68ecker"; toolArgs.Name=this.LocalizedName; toolArgs.PopupWidth=popupWidth; toolArgs.WrongWordWrapper=selElem; toolArgs.GetDataFunction= function ( ){var word=controller.GetCurrentWrongWord( ); return controller.GetSuggestionsForWord(word); } ; toolArgs.FooterItems=this.GetFooterItems(word); var tool=RadEditorNamespace.RadEditorSpellSuggestionBox.New(toolArgs); this.SuggestionDropdown=tool; tool.ShowPopup( true); tool.SelectNextItem( ); if (oEditor.IsIE)oEditor.SetFocus( ); } ; this.ShowSuggestionBox= function (selElem){var oThis=this ; if (!this.SuggestionBox){ this.SuggestionBox=new RadEditorNamespace.RadEditorSuggestionTextBox(this.OkIcon,this.AddIcon); }var oBox=this.SuggestionBox; var oFramePos=RadEditorNamespace.Utils.GetRect(this.Editor.ContentAreaElement); var oPos=RadEditorNamespace.Utils.GetRect(selElem); var offsetBody; if (this.Editor.IsIE || this.Editor.IsSafari){offsetBody=$ektron("\x64iv\x23\x64es\x69gn_cont\x65\156\x74",this.Editor.ContentArea).scrollTop( ); }else {offsetBody=$ektron(this.Editor.ContentWindow).scrollTop( ); }var waFrameScroll; var editorId=this.Editor.Id; var oEditorDiv=$ektron("\x64iv#"+editorId+"\x5fwrapp\x65\x72").get(0); if (oEditorDiv){waFrameScroll=RadEditorNamespace.Utils.FindScrollPosY(oEditorDiv); }if (null==waFrameScroll)waFrameScroll=0; var word=this.GetCurrentWrongWord( ); oBox.ValueChanged= function (val){oThis.Editor.SetFocus( ); oThis.Fire("", {SelectedValue:val } ); } ; window.setTimeout( function ( ){oBox.SetValue(word); oBox.SetRect(oFramePos.left+oPos.left,oFramePos.top+oPos.top-offsetBody-waFrameScroll,oPos.width+20,oPos.height,selElem); } ,10); };}RadEditorNamespace.RadEditorSpellSuggestionBox= {New:function (toolArgs){var obj=RadEditorNamespace.RadEditorComboBox.New(toolArgs); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.SelectedValue=""; obj.SelectedIndex=-1; obj.WrongWordWrapper=toolArgs.WrongWordWrapper; obj.FooterItems=toolArgs.FooterItems; obj.MaxItemSize=5; return obj; } ,OnDispose:function ( ){ this.WrongWordWrapper=null; } ,GetPopupBodyElement:function ( ){var oBodyDiv=this.Popup.CreateElement("DIV"); oBodyDiv.className=this.PopupClassName; var oDiv=this.Popup.CreateElement("DIV"); oDiv.style.overflow="aut\x6f"; oBodyDiv.appendChild(oDiv); return oBodyDiv; } ,OnBeforeShowPopup:function ( ){ this.SelectedIndex=-1; this.Element=this.WrongWordWrapper; if (!this.IsCreated){var origBody=this.PopupBodyElement; var oContainer=this.GetDefaultPopupTable("\x53ug\x67\145\x73tionT\x61ble",this.CellSpacing,this.CellPadding,"\x3100%",""); this.PopupBodyElement=oContainer; this.CreateItems( ); var height=25; var items=this.ItemsArray.length>this.MaxItemSize?this.MaxItemSize: this.ItemsArray.length; var bodyHeight=items>1?(items*height): 25; var footerHeight=(this.FooterItems && this.FooterItems.length)?this.FooterItems.length*height: 0; var oContainer2=this.GetDefaultPopupTable("But\x74onTab\x6c\145",1,1,"\x3100%",""); this.PopupBodyElement=oContainer2; this.CreatePopupFooter( ); this.PopupBodyElement=origBody; var oDiv=this.PopupBodyElement.firstChild; oDiv.appendChild(oContainer); oDiv.style.height=bodyHeight+"px"; this.PopupBodyElement.appendChild(oContainer2); this.PopupHeight=bodyHeight+footerHeight; this.IsCreated= true; }} ,CreatePopupFooter:function ( ){var temp=this.FooterItems; var index=this.ItemsArray.length; for (var i=0; i<temp.length; i++){var oRow=this.AddRow( ); var oCell=this.AddCell(oRow); this.CreateCellContent(oCell,temp[i],index); this.ConfigureCell(oCell,this,index); index++; } this.ItemsArray=this.ItemsArray.concat(this.FooterItems); } ,OnCellClick:function (index){ this.SetSelectedItem(index); this.SelectUIItem( ); } ,SelectPreviousItem:function ( ){var index=this.SelectedIndex; if (index-1>=0){ this.SelectedIndex--; this.SetSelectedItem(this.SelectedIndex); this.SelectUIItem( ); }} ,SelectNextItem:function ( ){var index=this.SelectedIndex; if (index+1<this.ItemsArray.length){ this.SelectedIndex++; this.SetSelectedItem(this.SelectedIndex); this.SelectUIItem( ); }} ,SelectUIItem:function ( ){var cells=this.PopupBodyElement.getElementsByTagName("TD"); var len=cells.length; var selIndex=this.SelectedIndex; var selectedCell=null; for (var i=0; i<len; i++){var oCell=cells[i]; if (oCell.className==oCell.RadClassOver)oCell.className=oCell.RadClassOut; if (oCell.Index==selIndex){oCell.className=oCell.RadClassOver; selectedCell=oCell; } ; }if (selectedCell){if (selectedCell.scrollIntoView)selectedCell.scrollIntoView( false); }}} ; RadEditorNamespace.RadEditorSuggestionTextBox= function (okIcon){ this.Document=document; this.ClassName="RadET\x65xtBox"; this.ButtonClassName="\122\x61dEXhtml\x42utton"; this.OkIcon=okIcon; this.ValueChanged= function (oVal){} ; var oThis=this ; this.GlobalMouseHanlder= function (e){var srcElement=RadEditorNamespace.Utils.GetEventSource(e); if (srcElement && RadEditorNamespace.Utils.IsParentNode(oThis.Element,srcElement)){return; }oThis.SetVisible( false); } ; this.RegisterMouseHandlers= function (attach){var registerMouseHandlers= function (doAttach){var windowFrames=window.frames; for (var i=0; i<windowFrames.length; i++){var oElem=null; try {oElem=windowFrames[i].window.document; }catch (ex){continue; }if (doAttach)RadEditorNamespace.Utils.AttachEventEx(oElem,"mous\x65down",oThis.GlobalMouseHanlder); else RadEditorNamespace.Utils.DetachEventEx(oElem,"mous\x65down",oThis.GlobalMouseHanlder); }if (doAttach)RadEditorNamespace.Utils.AttachEventEx(window.document,"mousedow\x6e",oThis.GlobalMouseHanlder); else RadEditorNamespace.Utils.DetachEventEx(window.document,"\x6dousedow\x6e",oThis.GlobalMouseHanlder); };registerMouseHandlers(attach); } ; this.Dispose= function ( ){ this.RegisterMouseHandlers( false); this.SetVisible( false); if (null!=this.Element){ this.Element.onchange=null; this.Element.onkeypress=null; this.Element.onclick=null; this.Element.Parent=null; } this.ValueChanged=null; this.Element=null; } ; this.SetVisible= function (visible){if (this.Element){ this.Element.style.display=visible?"": "none"; if (this.Element.style.display!="n\x6fne"){ this.Element.style.zIndex=999999; }}} ; this.SetValue= function (value){if (this.TextElement)this.TextElement.value=value; } ; this.Fire= function ( ){ this.ValueChanged(this.TextElement.value); this.SetVisible( false); } ; this.SetRect= function (x,y,width,height,elem){if (!this.Element || !this.Element.style)return; var oSt=this.Element.style; oSt.position="\x61bsol\x75\164\x65"; oSt.left=parseInt(x)+"\160\x78"; oSt.top=parseInt(y)+"\x70x"; var elem=this.TextElement; elem.style.width=parseInt(width)+"\x70x"; elem.style.height=parseInt(height)+"px"; oSt.width=parseInt(width)+100+"p\x78"; oSt.height=elem.style.height; this.SetVisible( true); try {if (elem)elem.focus( ); if (elem && elem.setActive){elem.setActive( ); var range=document.selection.createRange( ); range.moveStart("w\x6frd",1); range.select( ); range.collapse( ); }}catch (e){} ; } ; this.Create= function ( ){ this.CreateTextBox( ); this.RegisterMouseHandlers( true); this.Document.body.appendChild(this.Element); };this.CreateTextBox= function ( ){var inputElement=this.Document.createElement("\x49NPUT"); inputElement.setAttribute("\x73ize","2\x30"); inputElement.className=this.ClassName; inputElement.Parent=this ; var executeFunction= function (e,elem,isSecondToExecute){if (isSecondToExecute){if (elem.Executed){elem.Executed= false; return RadEditorNamespace.Utils.CancelEvent(e); }}elem.Executed= true; elem.Parent.Fire( ); return RadEditorNamespace.Utils.CancelEvent(e); } ; inputElement.onclick=new Function("this\x2efocus();"); inputElement.onkeypress= function (e){if (!e)e=window.event; if (e && e.keyCode==13){return executeFunction(e,this ); }} ; this.TextElement=inputElement; var oElem=this.Document.createElement("\x64iv"); var oBut=this.Document.createElement("\142\x75tton"); oBut.style.height="22px"; oBut.style.width="22px"; oBut.className=this.ButtonClassName; oBut.onmousedown=new Function("\x65","\x72eturn fa\x6cse;"); oBut.onclick=new Function("e","thi\x73.parentN\x6fde.getE\x6cemen\x74sByTa\x67\116\x61me(\047inp\x75t\047\x29[0\x5d.Pare\x6et.Fir\x65();re\x74urn f\x61lse;"); oBut.innerHTML="\x3cimg \x61\154\x69gn=\042\x6did\x64\154\x65\042\x20src=\042"+this.OkIcon+"\x22\x20bor\x64\145\x72=\042\x30\042\x2f>"; oElem.appendChild(inputElement); oElem.appendChild(oBut); this.Element=oElem; return this.Element; } ; this.Create( ); } ;
RadEditorNamespace.OnToolClick= function (e){RadEditorNamespace.Utils.CancelEvent(e); this.Tool.OnElementClick( ); };RadEditorNamespace.RadToolBase= {New:function (toolArgs){var obj=new RadEditorNamespace.RadEditorButton( ); obj.GetController=toolArgs.GetController; obj.Name=toolArgs.Name; obj.Shortcut=toolArgs.Shortcut; obj.Type=toolArgs.Type; obj.IconUrl=toolArgs.IconUrl; obj.Title=toolArgs.Title; if (null!=toolArgs.ShowIcon)obj.ShowIcon=toolArgs.ShowIcon; if (null!=toolArgs.ShowText)obj.ShowText=toolArgs.ShowText; if (null!=toolArgs.TextPosition)obj.TextPosition=toolArgs.TextPosition; if (null!=toolArgs.Document)obj.Document=toolArgs.Document; if (null!=toolArgs.ButtonIndex)obj.ButtonIndex=toolArgs.ButtonIndex; return obj; }} ; RadEditorNamespace.RadEditorButton= function ( ){ this.Document=null; this.Name=null; this.State=null; this.Element=null; this.Document=document; this.Type="B"; this.ClassName="Ra\x64\x45Tool"; this.State=RadEditorNamespace.RADCOMMAND_STATE_OFF; this.ShowIcon= true; this.ShowText= false; this.TextPosition="\162ight"; } ; RadEditorNamespace.RadEditorButton.prototype.Dispose= function ( ){var oElem=this.Element; if (oElem){oElem.onclick=null; oElem.Tool=null; } ; this.Element=null; this.Document=null; } ; RadEditorNamespace.RadEditorButton.prototype.GetButtonTable= function (oDoc,clsName){var oTable=RadEditorNamespace.Utils.GetPlainTable(oDoc); if (clsName)oTable.className=clsName; return oTable; } ; RadEditorNamespace.RadEditorButton.prototype.GetDefaultDiv= function (oDoc,clsName,noWrap){var oDiv=oDoc.createElement("\104\x49V"); if (noWrap)oDiv.style.whiteSpace="now\x72ap"; oDiv.setAttribute("un\x73electab\x6ce","on"); var goodDiv=oDiv.cloneNode( true); return goodDiv; } ; RadEditorNamespace.RadEditorButton.prototype.GetDefaultImage= function (oDoc){return oDoc.createElement("\111\x4dG"); } ; RadEditorNamespace.RadEditorButton.prototype.GetToolButton= function ( ){var oHeader=null; if (this.ShowIcon){var oImage=this.GetDefaultImage(this.Document); oImage.src=this.IconUrl; oImage.align="midd\x6ce"; oImage.ondragstart=RadEditorNamespace.Utils.OnItemDragStart; oHeader=oImage; }if (this.ShowText && this.Title){var oTable=this.GetButtonTable(this.Document,""); oTable.setAttribute("al\x69gn","\x63enter"); oTable.style.width="1\x300%"; var oRow=oTable.insertRow(-1); if (oHeader){var cell=oRow.insertCell(-1); cell.appendChild(oImage); cell.align="\x63ent\x65\162"; cell.setAttribute("\x75nsele\x63\164\x61ble","\157\x6e"); }if ("\x62otto\x6d"==this.TextPosition){oRow=oTable.insertRow(-1); }var cell=oRow.insertCell(-1); if (this.TextPosition!="righ\x74")cell.align="cente\x72"; cell.setAttribute("\167\x69dth","\x3100%"); cell.noWrap= true; var html="\x3ca href=\x22\043\x22 tit\x6ce=\042"+$ektron.htmlEncode(this.Title)+"\x22 style=\042text-d\x65\143\x6fration\x3a none\042"; if (this.ButtonIndex!="\165\x6edefined"){var tabindex=parseInt(this.ButtonIndex)+1; html+="\x20id=\042\105k\x46ocusLi\x6e\153"+this.ButtonIndex+"\x22 tabInd\x65\170\x3d\042"+tabindex+"\x22"; }html+=" \x63\154\x61\x73s=\x22EkFocusL\x69nks"; if (RadEditorNamespace.TOOL_CUSTOM_DROP_BUTTON==this.Type){html+="\x20Group\x4d\x65nu"; }var displayTitle=this.Title; html+="\042>"+$ektron.htmlEncode(displayTitle)+"\x3c/a>"; cell.innerHTML=html; cell.className="\x52adETo\x6f\154\x54ext"; oHeader=oTable; }return oHeader; } ; RadEditorNamespace.RadEditorButton.prototype.Create= function (newElement){if (null==newElement && this.OnCreate){ this.OnCreate( ); }else this.Element=newElement; this.Element.Tool=this ; if (!this.Element.title)this.Element.title=this.Title+(this.Shortcut?"\x20("+this.Shortcut+")": ""); this.UpdateState( ); return this.Element; } ; RadEditorNamespace.RadEditorButton.prototype.OnCreate= function ( ){ this.Element=this.GetToolButton( ); if (this.Type!=RadEditorNamespace.TOOL_CUSTOM && this.Type!=RadEditorNamespace.TOOL_CUSTOM_DROP_BUTTON){ this.Element.onclick=new Function("\x52ad\x45\x64it\x6f\162\x4eames\x70ace.On\x54oolClic\x6b.call(\x74his)\x3b retu\x72n fal\x73e;"); }} ; RadEditorNamespace.RadEditorButton.prototype.GetTopElement= function ( ){return this.Element; } ; RadEditorNamespace.RadEditorButton.prototype.SetState= function (state,enforce){if (state==this.State && ( true !=enforce))return; this.State=state; this.UpdateState( ); } ; RadEditorNamespace.RadEditorButton.prototype.GetState= function (state){return this.State; } ; RadEditorNamespace.RadEditorButton.prototype.UpdateState= function ( ){var oElem=this.Element; var className=this.ClassName; if (RadEditorNamespace.RADCOMMAND_STATE_DISABLED==this.State){oElem.className=className+"\x44isabl\x65\144"; oElem.onmouseover=null; oElem.onmouseout=null; oElem.onmouseup=null; oElem.onmousedown=null; }else {oElem.classNameOut=oElem.className=className+(RadEditorNamespace.RADCOMMAND_STATE_OFF==this.State?"Off": "\x4fn"); oElem.classNameOver=oElem.className+"Over"; oElem.onmouseover=new Function("th\x69s.classN\x61me = th\x69s.class\x4eameOve\x72\073"); oElem.onmouseout=new Function("\x74his.c\x6c\141\x73sName\x20\075\x20this\x2e\143\x6cassNam\x65Out;"); if (RadEditorNamespace.TOOL_BUTTON==this.Type || RadEditorNamespace.TOOL_CUSTOM==this.Type){oElem.onmousedown=new Function("t\x68is.clas\x73NameUp =\x20this.cl\x61ssName\x3b\040\x74hi\x73.cla\x73\x73Name \x3d \047\x52adE\x54oolDo\x77n\047\x3b"); oElem.onmouseup=new Function("this.cla\x73sName\x20\075\x20thi\x73.classN\x61meUp;"); }}} ; RadEditorNamespace.RadEditorButton.prototype.GetIcon= function ( ){return this.GetTopElement( ); } ; RadEditorNamespace.RadEditorButton.prototype.OnElementClick= function ( ){if (RadEditorNamespace.RADCOMMAND_STATE_DISABLED==this.State)return; this.GetController( ).Fire(this.Name,this ); } ;
RadEditorNamespace.RadEditorButtonComboBox= {New:function (toolArgs){toolArgs.PopupClassName="Ra\x64E\x43\x6fnt\x65xtMenu"; toolArgs.CellSpacing=0; toolArgs.CellPadding=0; var obj=RadEditorNamespace.RadComboBoxBase.New(toolArgs); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.Tools=[ ]; obj.FireOnClose= false; return obj; } ,OnBeforeShowPopup:function ( ){if (!this.ItemsCreated){ this.CreateItems( ); this.ItemsCreated= true; }var oLength=this.ItemsArray.length; var oRows=oLength/this.ItemsPerRow+(oLength%this.ItemsPerRow?1: 0); this.PopupHeight=2+(oRows*24); this.GetController( ).SetToolState(this.Tools, true); } ,CreateCellContent:function (oCell,oItem,index){var oTool=oItem; var oDocument=this.Popup.GetDocument( ); var oButton=this.GetController( ).CreateButtonTool(oTool[1],null,oDocument,null,null, true); oCell.appendChild(oButton.GetTopElement( )); this.Tools[this.Tools.length]=oButton; }} ;
RadEditorNamespace.RadColorPicker= {New:function (toolArgs){toolArgs.ClassName="\x52\x61dETo\x6flLong"; toolArgs.PopupWidth=145; toolArgs.PopupHeight=120; toolArgs.CellSpacing=1; toolArgs.CellPadding=1; toolArgs.PopupClassName="\x52adECol\x6f\162\x50ic\x6b\145\x72"+"\x20"+toolArgs.Name; toolArgs.PopupTableWidth=""; var obj=RadEditorNamespace.RadComboBoxBase.New(toolArgs); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.AllowCustomColors=toolArgs.AllowCustomColors!=null?toolArgs.AllowCustomColors: true; obj.ItemsPerRow=6; obj.ImageX="x.gif"; obj.AddCustomColorLabel=toolArgs.AddCustomColor?toolArgs.AddCustomColor: "\x41dd\x20\103\x75stom C\x6flor"; obj.AddCustomHexColorLabel=toolArgs.AddCustomHexColor?toolArgs.AddCustomHexColor: "Ad\x64 Hex Co\x6c\157\x72"; obj.PromptColorMessage=toolArgs.PromptColor?toolArgs.PromptColor: "Hex\x20color:"; obj.CustomColorsRow=null; obj.IsPopupScrollable= false; return obj; } ,OnHeaderElementClick:function ( ){if (this.SelectedValue!=null){ this.OnPopupClick( ); return false; }} ,OnCustomColorAdded:function (color){ this.ItemsArray[this.ItemsArray.length]=color; this.SetValue(color); this.OnPopupClick( ); } ,OnCellClick:function (index){ this.SetValue(this.ItemsArray[index]); } ,SetValue:function (theValue){ this.SelectedValue=theValue; if (this.OnValueSet)this.OnValueSet( ); } ,OnValueSet:function ( ){if (""==this.SelectedValue || null==this.SelectedValue){ this.HeaderElement.style.borderBottom=""; }else { this.HeaderElement.style.borderBottom="3px sol\x69d "+this.SelectedValue; }} ,OnBeforeShowPopup:function ( ){if (!this.ItemsCreated){ this.CreateItems( ); this.CreatePopupFooter( ); this.ItemsCreated= true; }} ,CreatePopupFooter:function ( ){if (this.AllowCustomColors){ this.AddCustomColorButton( ); this.AddHexColorButton( ); }} ,AddEmptyCell:function (oRow){ this.AddCell(oRow); } ,AddColorCell:function (oRow,index){if (null==index)index=this.ItemsArray.length; var oCell=this.AddCell(oRow); this.ConfigureCell(oCell,this,index); return oCell; } ,AddCustomColorButton:function ( ){if (document.addEventListener)return; var oRow=this.AddRow( ); var oCell=this.AddTextCell(oRow,this.AddCustomColorLabel); this.CustomColorDlg=this.Popup.CreateElement("\x4fBJ\x45\x43T"); this.CustomColorDlg.classid="\x63lsid:30\x35\x30f\x3819-98b5\x2d11cf-b\x6282-00a\x6100bdce\x30b"; this.CustomColorDlg.style.width=0; this.CustomColorDlg.style.height=0; oCell.appendChild(this.CustomColorDlg); oCell.Parent=this ; oCell.onclick=new Function('\x74his.\x50\141\x72ent.O\x6eAddCus\x74\157\x6dColor(\x29'); } ,AddHexColorButton:function ( ){var oRow=this.AddRow( ); var oCell=this.AddTextCell(oRow,this.AddCustomHexColorLabel); oCell.Parent=this ; oCell.onclick=new Function('th\x69s.Paren\x74\056OnAddHe\x78Color()'); } ,CreateItems:function ( ){var oRow=null; var curRowItems=0; this.ItemsArray=this.GetDataFunction(this.Name); if (this.ItemsArray && this.ItemsArray.length)this.ItemsArray=this.ItemsArray.concat([ ]); for (var i=0; i<this.ItemsArray.length; i++){if (0==i%this.ItemsPerRow){oRow=this.AddRow( ); curRowItems=0; }curRowItems++; var oCell=this.AddColorCell(oRow,i); this.CreateCellContent(oCell,this.ItemsArray[i],i); }var cellsToAdd=this.ItemsPerRow-curRowItems-1; if (cellsToAdd>0){for (var i=0; i<=cellsToAdd; i++){ this.AddEmptyCell(oRow); }}} ,CreateCellContent:function (oCell,sColor,index){if (""==sColor){oCell.style.backgroundRepeat="\x6eo-repea\x74"; oCell.style.backgroundPosition="cente\x72"; }var oDiv=this.Popup.CreateElement("\x64iv"); oDiv.style.backgroundColor=sColor; if (TelerikNamespace.Utils.DetectBrowser("safari")){oDiv.style.innerHTML="&n\x62sp;"; oDiv.style.height="1\x34px"; oDiv.style.width="14\x70x"; }oCell.appendChild(oDiv); oCell.Value=sColor; oCell.setAttribute("t\x69tle",sColor); } ,AddTextCell:function (oRow,sText){var oCell=this.AddCell(this.AddRow( )); oCell.colSpan=this.ItemsPerRow; oCell.noWrap= true; oCell.innerHTML=sText; return oCell; } ,AddCustomColor:function (color){if (!this.CustomColorsRow || this.CustomColorsRow.cells.length==this.ItemsPerRow){ this.CustomColorsRow=this.AddRow( ); this.PopupHeight+=17; }var oCell=this.AddColorCell(this.CustomColorsRow); this.CreateCellContent(oCell,color); } ,OnAddCustomColor:function ( ){if (!this.CustomColorDlg)return; var color=this.CustomColorDlg.ChooseColorDlg( ); if (color){color=this.ConvertColor(color); this.AddCustomColor(color); this.OnCustomColorAdded(color); }} ,OnAddHexColor:function ( ){var color=prompt(this.PromptColorMessage,"\x23"); color=this.ValidateColor(color); if (""!=color){ this.AddCustomColor(color); this.OnCustomColorAdded(color); }} ,ConvertColor:function (color){color=parseInt(color); color=color.toString(16); if (color.length<6){var sTempString="\x3000000".substring(0,(6-color.length)); color="#"+sTempString.concat(color).toUpperCase( ); }else {color="\x23"+color.toUpperCase( ); }return color; } ,ValidateColor:function (color){if (null==color)return ""; if (color.charAt(0)!="#"){color="#"+color; }re=new RegExp("\x23[0-9a-\x66\x41-\x46\135\x7b6}","gi"); return re.exec(color)?color: ""; }} ;
RadEditorNamespace.RadEditorComboBox= {New:function (toolArgs){var obj=RadEditorNamespace.RadComboBoxBase.New(toolArgs); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.SelectedValue=""; obj.SelectedIndex=-1; return obj; } ,OnBeforeShowPopup:function ( ){ this.SelectedIndex=-1; if (!this.ItemsCreated){ this.CreateItems( ); this.ItemsCreated= true; }} ,SetSelectedItem:function (index){var oItem=this.ItemsArray[index]; if (oItem){ this.SelectedValue=oItem[0]; this.SelectedIndex=index; }} ,OnCellClick:function (index){ this.SetSelectedItem(index); } ,CreateCellContent:function (oCell,oItem,index){var popupDocument=this.Popup.GetDocument( ); var itemHolder=popupDocument.createElement("\x73\x70an"); if (oItem){var oText=oItem[1]; var oImageSrc=oItem[2]; if (oImageSrc){var oImage=popupDocument.createElement("\x69mg"); oImage.src=oImageSrc; oImage.style.marginRight="5p\x78"; oImage.setAttribute("\x61lign","midd\x6c\145"); itemHolder.appendChild(oImage); }if (oText){itemHolder.innerHTML+=oText; itemHolder.noWrap= true; }}oCell.appendChild(itemHolder); }} ;
RadEditorNamespace.OnItemMouseOver= function ( ){ this.className=this.RadClassOver; };RadEditorNamespace.OnItemMouseOut= function ( ){ this.className=this.RadClassOut; };RadEditorNamespace.OnComboHeaderClick= function ( ){var oParent=this ; var oTool=null; while (null==(oTool=oParent.Tool)){oParent=oParent.parentNode; }oTool.HeaderElementClick( ); return false; } ; RadEditorNamespace.OnComboArrowClick= function ( ){var oParent=this ; var oTool=null; while (null==(oTool=oParent.Tool)){oParent=oParent.parentNode; }oTool.OnArrowClick( ); return false; } ; RadEditorNamespace.RadComboBoxBase= {IsPopupScrollable: true ,RecreateBeforeShow: false ,HeaderElement:null,ArrowElement:null,PopupBodyElement:null,Popup:null,ClassName: "",PopupWidth: 0,PopupHeight: 0,ItemsPerRow: 1,SelectedValue:null,IconContainer:null,ArrowContainer:null,FireOnClose: true ,GetDataFunction:null,AutomaticHeight: false ,New:function (toolArgs){var obj=RadEditorNamespace.RadToolBase.New(toolArgs); RadEditorNamespace.Utils.ExtendObject(obj,this ); if (toolArgs.UpdateValue!=null)obj.UpdateValue=toolArgs.UpdateValue; obj.ClassName=toolArgs.ClassName?toolArgs.ClassName: "R\x61\x64EDropD\x6fwn"; obj.ItemsPerRow=toolArgs.ItemsPerRow?toolArgs.ItemsPerRow: 1; obj.ArrowUrl=toolArgs.ArrowUrl; obj.GetDataFunction=toolArgs.GetDataFunction?toolArgs.GetDataFunction:function ( ){return [ ]; } ; obj.PopupWidth=parseInt(toolArgs.PopupWidth); if (isNaN(obj.PopupWidth))obj.PopupWidth=100; obj.PopupHeight=parseInt(toolArgs.PopupHeight); if (isNaN(obj.PopupHeight))obj.PopupHeight=100; obj.Width=toolArgs.Width?toolArgs.Width: "30px"; obj.CellSpacing=toolArgs.CellSpacing!=null?toolArgs.CellSpacing: 2; obj.CellPadding=toolArgs.CellPadding!=null?toolArgs.CellPadding: 2; obj.PopupClassName=toolArgs.PopupClassName?toolArgs.PopupClassName: ""; obj.PopupTableWidth=toolArgs.PopupTableWidth; obj.IsPopupScrollable=(toolArgs.IsPopupScrollable!= false); obj.AutomaticHeight=(toolArgs.AutomaticHeight== true); obj.Popup=window["\x52ad\x45\144\x69torP\x6fpupIns\x74ance"]; return obj; } ,CreateItems:function ( ){ this.ItemsArray=this.GetDataFunction(this.Name); var itemsArray=this.ItemsArray; var oRow=null; for (var i=0; i<itemsArray.length; i++){if (0==(i%this.ItemsPerRow)){oRow=this.AddRow( ); }var oCell=this.AddCell(oRow); this.ConfigureCell(oCell,this,i); this.CreateCellContent(oCell,itemsArray[i],i); }} ,ConfigureCell:function (oCell,oParent,i){oCell.Index=i; oCell.Parent=oParent; oCell.setAttribute("\x74abInd\x65\x78",parseInt(i+1)); oCell.onclick= function ( ){if (this.Parent.OnCellClick){ this.Parent.OnCellClick(this.Index,this ); } this.className=this.RadClassOut; } ; } ,Dispose:function ( ){if (this.Element){ this.Element.onclick=null; this.Element.Tool=null; } this.Element=null; this.Popup=null; this.ArrowElement=null; if (this.IconContainer){ this.IconContainer.onclick=null; this.IconContainer=null; }if (this.ArrowContainer){ this.ArrowContainer.onclick=null; this.ArrowContainer=null; }if (this.OnDispose!=null && typeof(this.OnDispose)=="\146\x75nction"){try { this.OnDispose( ); }catch (e){} ; }if (this.PopupBodyElement!=null){try {}catch (e){}} this.PopupBodyElement=null; } ,OnCreate:function ( ){var oHeadTable=this.GetButtonTable(this.Document,"R\x61dEDropDo\x77nOff"); oHeadTable.setAttribute("\164\x69\164l\x65",this.Title); var oRow=oHeadTable.insertRow(-1); var oCell1=oRow.insertCell(-1); oCell1.setAttribute("unselec\x74able","on"); if (this.IconUrl){ this.ShowIcon= true; var oHeader=this.GetToolButton( ); oCell1.appendChild(oHeader); this.HeaderElement=oHeader; }else {var elem=this.CreateHeaderElement( ); if (null==elem){elem=this.GetDefaultDiv(this.Document); elem.innerHTML=this.Title; elem.style.whiteSpace="nowra\x70"; if (!document.all){elem.style.overflow="\x68idd\x65\x6e"; }elem.style.width=this.Width; } this.HeaderElement=elem; oCell1.appendChild(this.HeaderElement); var colgroup=this.Document.createElement("c\x6flgroup"); var col=this.Document.createElement("c\x6f\154"); col.setAttribute("wid\x74h",this.Width); colgroup.appendChild(col); col=this.Document.createElement("\x63ol"); col.setAttribute("\x77idt\x68","14\x70\x78"); colgroup.appendChild(col); oHeadTable.insertBefore(colgroup,oHeadTable.firstChild); oHeadTable.style.tableLayout="fixe\x64"; } this.IconContainer=oCell1; oCell1.onclick=RadEditorNamespace.OnComboHeaderClick; this.ArrowElement=this.CreateArrowElement( ); if (this.ArrowElement){var oCell2=oRow.insertCell(-1); oCell2.appendChild(this.ArrowElement); oCell2.onclick=RadEditorNamespace.OnComboArrowClick; this.ArrowContainer=oCell2; } this.Element=oHeadTable; } ,CreateArrowElement:function ( ){if (this.ArrowUrl){var oImage=this.GetDefaultImage(this.Document); oImage.src=this.ArrowUrl; oImage.ondragstart=RadEditorNamespace.Utils.OnItemDragStart; oImage.border=0; if (!document.all)oImage.setAttribute("align","\x61bsbott\x6f\x6d"); return oImage; }} ,ShowPopup:function (bShow){if (bShow){if (!this.PopupDocument){ this.PopupDocument=this.Popup.GetDocument( ); }if (!this.PopupBodyElement || this.RecreateBeforeShow){ this.PopupBodyElement=this.GetPopupBodyElement( ); } this.Popup.SetClassName(this.IsPopupScrollable?"\x52ad\x45\x44ro\x70downMen\x75": "RadEDr\x6f\160\x64ownMenu\x4eonScrol\x6cable"); this.OnBeforeShowPopup( ); var dropdown=this ; this.PopupBodyElement.onclick= function ( ){if (dropdown.OnPopupClick){dropdown.OnPopupClick( ); dropdown.SelectedValue=""; }} ; this.Popup.SetTopElement(this.PopupBodyElement); this.Popup.ShowDropdown(this.PopupWidth,this.PopupHeight,this.Element,this.IsPopupScrollable,this.AutomaticHeight); this.PopupDocument=null; }else { this.Popup.Hide( ); }} ,GetDefaultPopupTable:function (className,cellSpacing,cellPadding,width,height){var table=RadEditorNamespace.Utils.GetPlainTable(this.Popup.GetDocument( )); table.cellSpacing=cellSpacing?cellSpacing: 0; table.cellPadding=cellPadding?cellPadding: 0; table.className=className?className: ""; table.style.width=width!=null?width: "10\x30%"; table.style.height=height!=null?height: "\x3100%"; return table; } ,GetPopupBodyElement:function ( ){return this.GetDefaultPopupTable(this.PopupClassName?this.PopupClassName: "\x52adE\x44\x72op\x44ownTabl\x65",this.CellSpacing,this.CellPadding,this.PopupTableWidth,""); } ,AddRow:function ( ){return (this.PopupBodyElement.insertRow(-1)); } ,AddCell:function (oRow){var oCell=oRow.insertCell(-1); oCell.RadClassOut=""; oCell.RadClassOver="Ove\x72"; oCell.onmouseover=RadEditorNamespace.OnItemMouseOver; oCell.onmouseout=RadEditorNamespace.OnItemMouseOut; return oCell; } ,OnPopupClick:function ( ){if ( true ==this.CancelHide){return; } this.Popup.Hide( ); if (this.FireOnClose){ this.GetController( ).Fire(this.Name,this ); }} ,HeaderElementClick:function ( ){if (RadEditorNamespace.RADCOMMAND_STATE_DISABLED==this.State)return; var toShow= true; if (this.OnHeaderElementClick!=null)toShow=this.OnHeaderElementClick( ); if ( false !=toShow)this.ShowPopup( true); } ,OnArrowClick:function ( ){if (RadEditorNamespace.RADCOMMAND_STATE_DISABLED==this.State)return; this.ShowPopup(!this.Popup.IsVisible( )); } ,OnElementClick:function ( ){} ,GetSelectedValue:function ( ){return this.SelectedValue; } ,CreateHeaderElement:function ( ){return null; } ,OnBeforeShowPopup:function ( ){}} ;
RadEditorNamespace.RadCssCombo= {New:function (toolArgs){var obj=RadEditorNamespace.RadComboBoxBase.New(toolArgs); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.PopupIconPath=toolArgs.PopupIconPath; obj.ClearStyleString=toolArgs.ClearStyleString; return obj; } ,SetValue:function (oVal){ this.UpdateValue(oVal); } ,UpdateValue:function (oVal){try {var oController=this.GetController( ); if (!oVal || (oVal && "strin\x67"==typeof oVal && ("\x64es\x69\x67n_"==oVal.substr(0,7) || "e\x6b\x74ron_"==oVal.substr(0,7) || "aspn\x65thidden"==oVal.toLowerCase( ) || "ek\x74designns\x5f"==oVal.substr(0,12)))){ this.HeaderElement.innerHTML=this.Title; return; }else if (!document.all && oController.GetSelectedElement){var selElem=oController.GetSelectedElement( ); if (selElem && selElem.tagName=="BODY"){ this.HeaderElement.innerHTML=this.Title; return; }}var filtered=oController.GetNamedCssForSelectedElement(oVal); if (filtered)oVal=filtered; }catch (e){ ; } this.HeaderElement.innerHTML=oVal; } ,OnDispose:function ( ){ this.UniqueIndexer=null; this.CssArray=null; } ,OnCellClick:function (cssIndex){if (cssIndex<0)this.SelectedValue=""; else this.SelectedValue=this.CssArray[cssIndex].ClassName; } ,CreatePopupHeader:function ( ){oRow=this.AddRow(-1); oCell=this.AddCell(oRow); oCell.noWrap= true; oCell.innerHTML=this.ClearStyleString; this.ConfigureCell(oCell,this,-1); return true; } ,OnBeforeShowPopup:function ( ){if (!this.IsCreated){ this.UniqueIndexer=[ ]; this.CreatePopupHeader( ); this.CssArray=this.GetDataFunction(this.Name); this.CreateItems( ); this.IsCreated= true; }} ,CreateItems:function ( ){if (this.PopupBodyElement.rows.length>0){var oTable=this.PopupBodyElement; if (oTable.parentNode && oTable.parentNode.removeChild){oTable.parentNode.removeChild(oTable); } this.PopupBodyElement=this.GetPopupBodyElement( ); this.CreatePopupHeader( ); }var oCount=0; for (var i=0; i<this.CssArray.length; i++){var oRow=this.AddRow( ); var oCell=this.AddCell(oRow); oCell.noWrap= true; this.ConfigureCell(oCell,this,i); var toAdd=this.CreateCellContent(oCell,this.CssArray[i],i); if ( false ==toAdd){oCell.parentNode.removeChild(oCell); oRow.parentNode.removeChild(oRow); }else oCount++; }return oCount; } ,CreateCellContent:function (oCell,oItem,itemIndex){var radCssClass=oItem; var tag=radCssClass.Tag; var rule=radCssClass.Rule; var alias=radCssClass.Alias; if (!tag)return false; else tag=tag.toUpperCase( ); var isAdded= true; if (rule){if (this.UniqueIndexer[rule.selectorText]){oCell=this.UniqueIndexer[rule.selectorText]; oCell.innerHTML=""; isAdded= false; }else { this.UniqueIndexer[rule.selectorText]=oCell; }} this.FillCell(oCell,tag,rule,alias); return isAdded; } ,FillCell:function (oCell,tag,rule,alias){var oImg=this.GetCssClassIcon(tag); oCell.appendChild(oImg); var span=this.PopupDocument.createElement("\x53PA\x4e"); switch (tag){case "\x41":var anchor=this.PopupDocument.createElement("\x41"); anchor.href="#"; anchor.onmouseover="\x77in\x64\x6fw.\x73tatus =\x20\047\047\x3b retu\x72n fals\x65\073"; anchor.onclick=new Function("ret\x75rn fal\x73e;"); anchor.innerHTML=alias; this.ApplyRule(anchor,rule); anchor.style.cursor="default"; span.appendChild(anchor); break; default:span.innerHTML=alias; span.style.font="ico\x6e"; this.ApplyRule(span,rule); span.style.marginTop="\062\x70x"; break; }span.style.position=""; span.style.marginLeft="\x30px"; span.style.overflowX="\x68idden"; oCell.appendChild(span); oCell.setAttribute("\164\x69tle",(rule)?rule.selectorText:alias); } ,ApplyRule:function (element,rule){if (!element || !rule)return; element.style.cssText=rule.style.cssText; var bgColor=element.style.backgroundColor.toLowerCase( ); var color=element.style.color.toLowerCase( ); if ((""==bgColor || "\043\x66fffff"==bgColor || "wh\x69\164\x65"==bgColor) && ("#\x66fffff"==color || "white"==color)){element.style.backgroundColor="\x23aa\x61\x61aa"; }element.style.width=""; element.style.height=""; } ,GetCssClassIcon:function (tag){if (!this.__defaultImg){var oImage=this.PopupDocument.createElement("\x49MG"); oImage.style.marginRight="5p\x78"; oImage.style.width="\061\x32px"; oImage.style.height="13px"; oImage.setAttribute("\x61lign","m\x69ddle"); this.__defaultImg=oImage; }var oImg=this.__defaultImg.cloneNode( false); oImg.src=this.GetCssClassImageSrcByTag(tag); return oImg; } ,GetCssClassImageSrcByTag:function (tag){var imgName=""; switch (tag){case "\x41\x4c\x4c":case "\x41":case "\x49MG":case "TA\x42\114\x45":case "\x50":imgName=tag; break; default:imgName="C\x75stom"; break; }return this.PopupIconPath+"class"+imgName+".\x67if"; }} ;
RadEditorNamespace.RadInsertTableCombo= {New:function (toolArgs){var obj=RadEditorNamespace.RadComboBoxBase.New(toolArgs); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.Localization=toolArgs.Localization; obj.CancelLabel=toolArgs.CancelLabel?toolArgs.CancelLabel: "\x43an\x63el"; obj.TableWizardLabel=toolArgs.TableWizardLabel?toolArgs.TableWizardLabel: "\x54able \x57\151\172\x61\162d"; obj.TableLabel=toolArgs.TableLabel?toolArgs.TableLabel: "T\x61\x62le"; obj.IconBasePath=toolArgs.IconBasePath; obj.TableTools=[ ]; obj.SetCellPropsTool=null; obj.SetTablePropsTool=null; obj.IsPopupScrollable= false; obj.ItemsPerRow=6; return obj; } ,Fire:function (commandName,oTool){oTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_DISABLED); this.GetController( ).Fire(commandName,oTool);} ,GetPopupBodyElement:function ( ){ this.WizardTable=this.GetDefaultPopupTable("\122\x61d\x45\124\x61blePic\x6ber",this.CellSpacing,this.CellPadding,null,""); var oDiv=this.Popup.CreateElement("\x64iv"); oDiv.appendChild(this.WizardTable); var topTable=this.WizardTable; topTable.style.overflowY="\x68idde\x6e"; topTable.Parent=this ; topTable.onmouseout=new Function("this.Par\x65nt.On\x53ampleTa\x62leMouse\x4fut();"); return oDiv; } ,OnBeforeShowPopup:function ( ){ this.FireOnClose= false; if (!this.IsCreated){ this.CreateItems(this.WizardTable); this.IsCreated= true; this.CreatePopupFooter( ); } this.GetController( ).SetToolState(this.TableTools); if (this.SetCellPropsTool)this.SetCellPropsTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF); if (this.SetTablePropsTool)this.SetTablePropsTool.SetState(RadEditorNamespace.RADCOMMAND_STATE_OFF); this.UpdateSampleTable(0,0); } ,OnDispose:function ( ){ this.WizardTable=null; this.TableInfoLabel=null; var oTools=this.TableTools; if (oTools && oTools.length>0){for (var i=0; i<oTools.length; i++){if (oTools[i].Dispose)oTools[i].Dispose( ); }}oTools=null; this.TableTools=null; this.SetCellPropsTool=null; this.SetTablePropsTool=null; } ,CreateItems:function (topTable){for (var i=0; i<36; i++){if (0==i%this.ItemsPerRow){oRow=topTable.insertRow(-1); curRowItems=0; }oCell=oRow.insertCell(-1); oCell.width=10; oCell.height=10; oCell.innerHTML="&\x6ebsp;"; oCell.style.fontSize="\x35pt"; oCell.Parent=this ; oCell.onmouseover=new Function("\164\x68is.Par\x65nt.OnSa\x6d\160\x6ceTable\x43ellOve\x72\050\x74hi\x73);"); oCell.onclick=new Function("thi\x73.Paren\x74\056\x4fnCel\x6cClick(\x74\150\x69s);"); }} ,CreatePopupFooter:function ( ){var topTable=this.WizardTable; oRow=topTable.insertRow(-1); oCell=oRow.insertCell(-1); oCell.colSpan=this.ItemsPerRow; oCell.className="\x43ou\x6e\164\x65r"; oCell.innerHTML=this.CancelLabel; this.TableInfoLabel=oCell; oRow=topTable.insertRow(-1); oCell=oRow.insertCell(-1); oCell.colSpan=this.ItemsPerRow; oCell.className="\x57i\x7a\141\x72d"; oCell.Parent=this ; oCell.onmouseover=new Function("thi\x73.class\x4eame = \047Wi\x7aardOve\x72\047"); oCell.onmouseout=new Function("thi\x73.classN\x61me = \047Wizard\x27"); oCell.onclick=new Function("t\x68is.Pare\x6e\164\x2eStart\x54ableWiz\x61rd();t\x68\151\x73.cla\x73sNam\x65 = \047Wizard\x27;"); oCell.innerHTML=this.TableWizardLabel; this.CreateTableButtons( ); } ,CreateTableButtons:function ( ){var itemsPerRow=4; toolNamesArray=[RadEditorNamespace.RADCOMMAND_INSERT_ROW_ABOVE,RadEditorNamespace.RADCOMMAND_INSERT_ROW_BELOW,RadEditorNamespace.RADCOMMAND_DELETE_ROW,RadEditorNamespace.RADCOMMAND_INSERT_COLUMN_LEFT,RadEditorNamespace.RADCOMMAND_INSERT_COLUMN_RIGHT,RadEditorNamespace.RADCOMMAND_DELETE_COLUMN,RadEditorNamespace.RADCOMMAND_MERGE_COLUMNS,RadEditorNamespace.RADCOMMAND_MERGE_ROWS,RadEditorNamespace.RADCOMMAND_SPLIT_CELL,RadEditorNamespace.RADCOMMAND_DELETE_CELL,RadEditorNamespace.RADCOMMAND_SET_CELL_PROPERTIES,RadEditorNamespace.RADCOMMAND_SET_TABLE_PROPERTIES]; this.ToolsTable=this.GetDefaultPopupTable("\122\x61dETa\x62lePicke\x72\124\x6folTabl\x65",0,0,null,""); var oTable=this.ToolsTable; var row=oTable.insertRow(-1); var oDoc=this.Popup.GetDocument( ); for (var i=0; i<toolNamesArray.length; i++){var toolName=toolNamesArray[i]; var toolImageUrl=this.IconBasePath+toolName+"\x2egif"; var tool=this.GetController( ).CreateButtonTool(toolName,this,oDoc,toolImageUrl, true , false ,null); this.TableTools[this.TableTools.length]=tool; if (i%itemsPerRow==0){row=oTable.insertRow(-1); }var cell=row.insertCell(-1); cell.appendChild(tool.GetTopElement( )); } this.SetCellPropsTool=this.TableTools[this.TableTools.length-2]; this.SetTablePropsTool=this.TableTools[this.TableTools.length-1]; this.PopupBodyElement.appendChild(this.ToolsTable); oDoc=null; } ,OnSampleTableMouseOut:function ( ){if (!this.OnSampleTable){ this.UpdateSampleTable(0,0); } this.OnSampleTable= false; } ,OnSampleTableCellOver:function (oCell){ this.OnSampleTable= true; var selCol=RadEditorNamespace.Utils.GetCellIndex(oCell); var selRow=oCell?(oCell.parentNode.rowIndex+1): 0; this.UpdateSampleTable(selCol,selRow); } ,OnCellClick:function (oCell){var selCol=RadEditorNamespace.Utils.GetCellIndex(oCell); var selRow=oCell?(oCell.parentNode.rowIndex+1): 0; this.SelectedValue= {RowsCount:selRow,ColumnsCount:selCol } ; this.FireOnClose= true; } ,UpdateSampleTable:function (selCol,selRow){for (var i=0; i<this.ItemsPerRow; i++){var row=this.WizardTable.rows[i]; if (!row)return; for (var j=0; j<row.cells.length; j++){var cell=row.cells[j]; cell.className=(i<selRow && j<selCol)?"\x4fver": ""; }} this.UpdateTableInfoLable(selCol,selRow); } ,UpdateTableInfoLable:function (selCol,selRow){var text=this.CancelLabel; if (selCol>0 && selRow>0){text=RadEditorNamespace.Utils.Format("\x7b0} x\x20\173\x31} {2\x7d",selRow,selCol,this.TableLabel); } this.TableInfoLabel.innerHTML=text; } ,StartTableWizard:function ( ){ this.SelectedValue=null; var oController=this.GetController( );if (oController){oController.Fire(RadEditorNamespace.RADCOMMAND_TABLE_WIZARD,this ); }}} ;
RadEditorNamespace.RadInsertLinkCombo= {New:function (toolArgs){toolArgs.PopupClassName="\x52adELinks"; toolArgs.CellSpacing=0; toolArgs.CellPadding=0; var obj=RadEditorNamespace.RadComboBoxBase.New(toolArgs); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.BasePath=toolArgs.BasePath; return obj; } ,OnBeforeShowPopup:function ( ){if (!this.DropdownCreated){ this.CreateDropdown( ); this.DropdownCreated= true; }} ,CreateDropdown:function ( ){var linksArray=this.GetDataFunction(this.Name); this.LinkCounter=0; this.FlatLinksArray=[ ]; for (var i=0; i<linksArray.length; i++){var link=linksArray[i]; this.ParseLinkSubtree(link,this.PopupBodyElement); }} ,OnCellClick:function (index,oCell){var parent=this.FlatLinksArray[index]; if (parent.length>4){if (parent[1]=="")this.ExpandCategory(oCell); else this.InsertLink(oCell); }else { this.InsertLink(oCell); }} ,ParseLinkSubtree:function (parent,t){var index=this.LinkCounter++; this.FlatLinksArray[index]=parent; var tr=t.insertRow(-1); var tc=tr.insertCell(-1); tc.width=9; tc.noWrap= true; tc.Parent=this ; if (parent.length>4){tc.onclick= function ( ){ this.Parent.ExpandCategory(this ); } ; }tc.innerHTML=parent.length>4?"\x3cimg al\x69\147\x6e=\042middl\x65\042\x20src=\x22"+this.BasePath+"Img/\x6c\151n\x6bsPlus.g\x69\146\x22>": "&nbs\x70\073"; tc=tr.insertCell(tr.cells.length); tc.LinkItem=parent; tc.innerHTML=parent[0]; if (parent[1]!=""){tc.onmouseover=new Function("\164\x68is.\x63\154\x61ssN\x61\155\x65 = \x27\117\x76er\047"); tc.onmouseout=new Function("\x74his.\x63\154\x61ss\x4e\141m\x65 = \047\047"); }tc.width="\x310\x30\045"; this.ConfigureCell(tc,this,index); if (parent.length>4){tr=t.insertRow(-1); tc=tr.insertCell(-1); tc=tr.insertCell(-1); var table=this.Popup.GetDocument( ).createElement("TABL\x45"); table.cellPadding=0; table.cellSpacing=0; table.style.width="\x3100%"; tc.appendChild(table); var theLength=parent.length; if (theLength>4){for (var i=0; i<parent[4].length; i++){var link=parent[4][i]; this.ParseLinkSubtree(link,table); }}tr.style.display="none"; }} ,InsertLink:function (cell){cell.className=""; var parent=cell.LinkItem; if (!parent[1]){ this.CancelHide= true; return; } this.CancelHide= false; this.SelectedValue= {Text:parent[0],Href:parent[1],Target:parent[2],Title:parent[3] } ; } ,ExpandCategory:function (cell){ this.CancelHide= true; var nextRow=cell.parentNode.nextSibling; var displayRow=(nextRow.style.display=="\x6eone")?"": "none"; nextRow.style.display=displayRow; var imgs=cell.parentNode.getElementsByTagName("\x49MG"); var treeImage=imgs && imgs.length>0?imgs.item(0):null; if (!treeImage){return; }var re=new RegExp("\x6cinks(\x28\x50l\x75\163\x29|(Mi\x6eus))(1|\x32)?\134\x2egif\x24","ig"); re.exec(treeImage.src); treeImage.src=treeImage.src.replace(re,"li\x6eks"+((RegExp.$1=="Plus")?"\x4din\x75\163": "Pl\x75s")+RegExp.$4+".\x67if"); }} ;
RadEditorNamespace.RadModuleManagerCombo= {New:function (toolArgs){var obj=RadEditorNamespace.RadComboBoxBase.New(toolArgs); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.ItemsArray=[ ]; obj.RecreateBeforeShow= true; obj.SkinBasePath=toolArgs.SkinBasePath; return obj; } ,OnBeforeShowPopup:function ( ){ this.CreateItems( ); } ,OnCellClick:function (index){ this.SelectedValue=this.ItemsArray[index]; } ,CreateCellContent:function (oCell,oItem,itemIndex){if (oItem){var enabled=oItem.IsEnabled; var oImage=this.Popup.CreateElement("\151\x6d\x67"); oImage.src=this.SkinBasePath+(enabled?"Img/\x6doduleE\x6eabled.g\x69f": "\x49mg/modu\x6c\145\x44isabl\x65d.gif"); oImage.style.marginRight="5\x70x"; oImage.setAttribute("align","m\x69ddle"); oCell.appendChild(oImage); oCell.innerHTML+=oItem.Title; }} ,OnPopupClick:function ( ){ this.Popup.Hide( ); this.GetController( ).Fire(this.Name,this ); if (this.SelectedValue){var isEnabled=this.SelectedValue.IsEnabled; var modulesArray=this.ItemsArray; var showPopup= false; for (var i=0; i<modulesArray.length; i++){if (modulesArray[i].IsEnabled!=isEnabled){showPopup= true; break; }}if (showPopup)this.HeaderElementClick( ); }}} ;
RadEditorNamespace.RadUndoRedoCombo= {New:function (toolArgs){var obj=RadEditorNamespace.RadComboBoxBase.New(toolArgs); RadEditorNamespace.Utils.ExtendObject(obj,this ); obj.TopTable=null; return obj; } ,OnHeaderElementClick:function ( ){ this.SelectedValue=1; this.GetController( ).Fire(this.Name,this ); return false; } ,GetPopupBodyElement:function ( ){var oBodyDiv=this.Popup.CreateElement("\104IV"); var oDiv=this.Popup.CreateElement("DIV"); oDiv.style.height="107\x70x"; oDiv.style.overflow="auto"; oBodyDiv.appendChild(oDiv); return oBodyDiv; } ,OnBeforeShowPopup:function ( ){ this.SelectedValue=0; var oContainer=this.GetDefaultPopupTable("\x52adET\x61\142\x6cePic\x6ber",this.CellSpacing,this.CellPadding,"100%",""); this.TopTable=oContainer; var commandsArray=this.GetDataFunction(this.Name); this.CreateItems(oContainer,commandsArray); var oDiv=this.PopupBodyElement.firstChild; oDiv.innerHTML=""; oDiv.appendChild(oContainer); if (!this.IsCreated){ this.CreatePopupFooter( ); this.IsCreated= true; }} ,OnDispose:function ( ){ this.TopTable=null; this.TableInfoLabel=null; } ,CreateItems:function (oContainer,oArray){if (oArray.length>0){var oRow=null; var oCell=null; for (var i=0; i<oArray.length; i++){oRow=oContainer.insertRow(-1); oCell=oRow.insertCell(-1); oCell.onmouseover=new Function("thi\x73.Paren\x74.OnCellO\x76er(th\x69s);"); this.ConfigureCell(oCell,this,i); this.CreateCellContent(oCell,oArray[i],i); }}} ,CreateCellContent:function (oCell,oItem,index){oCell.innerHTML=oItem.Title; } ,CreatePopupFooter:function ( ){var footerTable=this.GetDefaultPopupTable("RadET\x61blePic\x6b\145\x72",1,1,"\x3100%",""); oRow=footerTable.insertRow(-1); oCell=oRow.insertCell(-1); oCell.innerHTML=this.Name; oCell.className="W\x69\x7aard"; oCell.onmouseover=new Function("\164\x68is.c\x6cassNa\x6de = \047Wiz\x61rdOve\x72\047"); oCell.onmouseout=new Function("\x74his.cl\x61\163\x73Name \x3d \047\x57iza\x72d\047"); oCell.onclick=new Function("return \x66alse;"); this.TableInfoLabel=oCell; this.PopupBodyElement.appendChild(footerTable); } ,OnCellClick:function (index){ this.SelectedValue=index+1; } ,OnCellOver:function (oCell){ this.NumRowsSelected=oCell?(oCell.parentNode.rowIndex+1): 0; this.UpdateSampleTable( ); } ,UpdateSampleTable:function ( ){if (this.TopTable){var oRows=this.TopTable.rows; for (var i=0; i<oRows.length; i++){cell=oRows[i].cells[0]; cell.className=(i<this.NumRowsSelected)?"Over": ""; } this.UpdateTableInfoLable( ); }} ,UpdateTableInfoLable:function ( ){var text=this.Name; if (RadEditorNamespace.Utils.IsNull(this.NumRowsSelected,0)>0){text=this.Name+RadEditorNamespace.Utils.Format("\x20{\x30\x7d",this.NumRowsSelected)+"\x20act\x69\x6fn\x73"; } this.TableInfoLabel.innerHTML=text; }} ;
