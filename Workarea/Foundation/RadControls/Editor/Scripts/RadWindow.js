function RadWindow(id){ this.IsIE=(null!=document.all) && (window.opera==null); this.IsQuirksMode=(document.all && !window.opera && "C\x53\x531Com\x70at"!=document.compatMode); this.Id=id; this.Width=0; this.Height=0; this.OnClientClosing=null; this.ContentWindow=null; this.ContentWrapperTable=null; this.Caption=null; this.X=0; this.Y=0; this.ShowContentWhenMoving= true; this.CanMove= true; this.CanResize= true; this.DragMode=""; this.IsModal= false; this.Container=null; this.Parent=null; this.Argument=null; this.ReturnValue=null; this.ExitCode=null; this.ZIndex=0; this.AdjustPosInterval=-1; this.CallbackFunc=null; this.OnLoadFunc=null; this.Param=null; this.ModalSetCapture= false; this.UseRadWindow= true; this.Window=null; this.InnerHTML=null; this._overImage=null; }RadWindow.prototype.OnLoad= function ( ){if (this.Window && ""!=this.Window.document.title){ this.SetCaption(this.Window.document.title); }if (this.OnLoadFunc){ this.OnLoadFunc( ); }};RadWindow.prototype.SetCapture= function (bContainerCapture){if (this.UseRadWindow){if (null!=bContainerCapture){ this.bContainerCapture=bContainerCapture; }else if (null!=this.bContainerCapture){bContainerCapture=this.bContainerCapture; }else {bContainerCapture= false; }if (this.ModalSetCapture && this.IsIE){ this.ContentWrapperTable.setCapture(bContainerCapture); }}};RadWindow.prototype.ReleaseCapture= function ( ){if (this.UseRadWindow){if (this.ModalSetCapture && this.IsIE){if (this.ContentWrapperTable)this.ContentWrapperTable.releaseCapture( ); }}};RadWindow.prototype.SetZIndex= function (zIndex){ this.ZIndex=zIndex; if (this.ContentWrapperTable){ this.ContentWrapperTable.style.zIndex=this.ZIndex; }};RadWindow.prototype.ToggleContent= function ( ){if (this.UseRadWindow && this.IsIE){var displayStyle=""; if (parseInt(this.Height)==parseInt(this.ContentWrapperTable.style.height)){ this.SetHeight(0); displayStyle="no\x6ee"; }else { this.SetHeight(this.Height); displayStyle="\x69nli\x6e\145"; }}};RadWindow.prototype.IsVisible= function ( ){if (this.ContentWrapperTable){return this.ContentWrapperTable.style.display==""; }return false; };RadWindow.prototype.ShowWindow= function (show,x,y){if (null==show){show= true; }var displayStyle=show?"": "\x6eone"; if (this.ContentWrapperTable){ this.ContentWrapperTable.style.display=displayStyle; }if (show){if (null!=x && null!=y){x+=10; if (this.ContentWrapperTable){ this.ContentWrapperTable.style.left=x+'p\x78'; this.ContentWrapperTable.style.top=y+'px'; }}}if (this.Parent){ this.Parent.OnShowWindow(this,show); }};RadWindow.prototype.Initialize2= function (contentElem,show,containerElem,modal,zIndex){ this.Initialize(contentElem,show); this.IsModal=modal; this.Container=containerElem; this.SetZIndex(zIndex); };RadWindow.prototype.Initialize= function (contentElem,show){if (this.Id){ this.ContentWrapperTable=document.getElementById("\x52adW\x69\x6edo\x77Content\x57rapp\x65r"+this.Id); this.ContentWindow=document.getElementById("\x52adWind\x6f\167\x43ontent\x57indow"+this.Id); this.Caption=document.getElementById("RadWi\x6edowCapt\x69on"+this.Id); if (null==show){var show= true; } this.ShowWindow(show); }else {alert("\x4eo wi\x6e\144\x6fw Id pr\x6fvided"); }} ; RadWindow.prototype.SetContentWindowSize= function (width,height){ this.Width=width; this.Height=height; } ; RadWindow.prototype.SetContentVisible= function (visible){if (this.ContentWindow){ this.ContentWindow.style.visibility=visible?"v\x69sible": "\x68idde\x6e"; }} ; RadWindow.prototype.Close= function (exitCode,dialogCallbackFunction,execCallBack){if (null!=this.OnClientClosing && (this.OnClientClosing(exitCode)== false)){return; } this.ShowWindow( false); this.ExitCode=exitCode; if (this.AdjustPosInterval>-1){window.clearInterval(this.AdjustPosInterval); this.AdjustPosInterval=-1; }if (this.IsModal)this.ReleaseCapture( ); try {if (this.CallbackFunc && false !=execCallBack)this.CallbackFunc(this.ReturnValue,this.Param); if (dialogCallbackFunction){dialogCallbackFunction(this.ReturnValue,this.Param); }}catch (ex){}if (this.Parent)this.Parent.DestroyWindow(this ); if (!this.UseRadWindow && this.Window)this.Window.close( ); } ; RadWindow.prototype.ToggleCanMove= function (oDiv){if (!this.UseRadWindow)return; this.CanMove=!this.CanMove; oDiv.className=this.CanMove?"\x52adERad\x57\x69n\x64owButto\x6ePinOff": "RadE\x52\141\x64Window\x42\165\x74tonPinO\x6e"; if (!this.CanMove){if (this.IsIE){ this.TopOffset=parseInt(this.ContentWrapperTable.style.top)-RadGetScrollTop(document); this.StartUpdatePosTimer(100); }else { this.ContentWrapperTable.style.position="fixed"; }}else {if (this.IsIE){window.clearInterval(this.AdjustPosInterval); this.TopOffset=null; }else { this.ContentWrapperTable.style.position="absolut\x65"; }}};RadWindow.prototype.StartUpdatePosTimer= function (iInterval){if (!this.UseRadWindow)return; this.AdjustPosInterval=window.setInterval("\x55pd\x61\x74eW\x69\156\x64owPos(\x27"+this.Id+"\x27)",iInterval); };function UpdateWindowPos(wndId){var wnd=GetEditorRadWindowManager( ).LookupWindow(wndId); if (wnd)wnd.SetPosition( ); }RadWindow.prototype.CanDrag= function ( ){if (!this.UseRadWindow)return true; return ("move"==this.DragMode && this.CanMove) || ("size"==this.DragMode && this.CanResize); };RadWindow.prototype.OnDragStart= function (e){ this.SetActive( true); if (!this.CanDrag( ))return; this.X=(e.offsetX==null)?e.layerX:e.offsetX; this.Y=(e.offsetY==null)?e.layerY:e.offsetY; MousePosX=e.clientX; MousePosY=e.clientY; this.SetContentVisible(this.ShowContentWhenMoving); RadWindowDragStart( ); } ; RadWindow.prototype.SetActive= function (activate){if (!this.UseRadWindow)return; if (activate){if (null!=RadWindowActiveWindow && RadWindowActiveWindow!=this )RadWindowActiveWindow.SetActive( false); RadWindowActiveWindow=this ; if (this.Parent)this.Parent.ActivateWindow(this ); }else {if (this ==RadWindowActiveWindow)RadWindowActiveWindow=null; }};RadWindow.prototype.HitTest= function (x,y){var left=parseInt(this.ContentWrapperTable.style.left); if (isNaN(left))return false; var top=parseInt(this.ContentWrapperTable.style.top); if (isNaN(top))return false; return left<=x && x<=(left+this.Width) && top<=y && y<=(top+this.Height); };RadWindow.prototype.SetPosition= function (left,top){if (!this.UseRadWindow){if (this.Window){ this.Window.dialogLeft=left; this.Window.dialogTop=top; }}else {if (!left)left=this.ContentWrapperTable.style.left; if (!top){if (this.TopOffset!=null)top=parseInt(this.TopOffset)+RadGetScrollTop(document); else top=this.ContentWrapperTable.style.top; }left=parseInt(left); top=parseInt(top); if (!isNaN(left) && !isNaN(top)){if (left<=0)left=0; if (top<=0)top=0; this.ContentWrapperTable.style.left=left+'\x70x'; this.ContentWrapperTable.style.top=top+'px'; }}};RadWindow.prototype.GetWidth= function ( ){var width=0; if (!this.UseRadWindow){if (this.Window)width=this.Window.dialogWidth; }else {if (this.IsIE){width=parseInt(this.ContentWrapperTable.clientWidth); }else {width=parseInt(this.ContentWrapperTable.scrollWidth); }if (isNaN(width))width=0; }return width; };RadWindow.prototype.SetWidth= function (width){width=parseInt(width); if (isNaN(width))return; if (!this.UseRadWindow){if (this.Window){if (this.Window.dialogWidth){ this.Window.dialogTop=this.Window.screenTop-30; this.Window.dialogLeft=this.Window.screenLeft-4; this.Window.dialogWidth=width+"\x70x"; }else { this.Window.outerWidth=width; }}}else {if (width)this.ContentWrapperTable.style.width=width+"\x70x"; }};RadWindow.prototype.GetHeight= function ( ){var height=0; if (!this.UseRadWindow){if (this.Window)height=this.Window.dialogHeight; }else {if (this.IsIE){height=parseInt(this.ContentWrapperTable.clientHeight); if (isNaN(height))height=0; }else {height=this.ContentWrapperTable.scrollHeight; }}return height; };RadWindow.prototype.SetHeight= function (height){height=parseInt(height); if (isNaN(height))return; if (!this.UseRadWindow){if (this.Window){if (this.Window.dialogWidth){ this.Window.dialogTop=this.Window.screenTop-30; this.Window.dialogLeft=this.Window.screenLeft-4; this.Window.dialogHeight=height+"px"; }else { this.Window.outerHeight=height; }}}else {var oTable=this.ContentWrapperTable; var oFirstTable=oTable.getElementsByTagName("TABL\x45")[0]; if (oFirstTable)oFirstTable.setAttribute("bord\x65r","\x31"); this.ContentWrapperTable.style.height=height+"\x70x"; this.FixIeHeight(this.ContentWrapperTable,height); oFirstTable.setAttribute("bor\x64er","\x30"); }};RadWindow.prototype.FixIeHeight= function (oElem,height){if (this.IsIE && "CS\x531Compat"==document.compatMode){var oHeight=oElem.offsetHeight; if (oHeight!=0 && oHeight!=height){var difference=(oHeight-height); var newHeight=(height-difference); if (newHeight>0){oElem.style.height=(newHeight+4)+"p\x78"; }}}} ; function RadWindowUnInitializeDrag(targetWindow){var oSpan=RadWindowActiveWindowSpan; targetWindow.SetPosition(oSpan.style.left,oSpan.style.top); var extra=targetWindow.IsQuirksMode?6: 0; extra+=targetWindow.IsIE?2: 0; extraHeight=extra; if (targetWindow.IsIE && !targetWindow.IsQuirksMode && extraHeight>0)extraHeight-=2; targetWindow.SetSize(extra+(oSpan.clientWidth?oSpan.clientWidth:oSpan.offsetWidth),extraHeight+(oSpan.clientHeight?oSpan.clientHeight:oSpan.offsetHeight)); if (RadWindowActiveWindowSpan)RadWindowActiveWindowSpan.style.visibility="hidden"; }RadWindow.prototype.SetSize= function (width,height){if (width>maxWidth)width=maxWidth; if (height>maxHeight)height=maxHeight; if (!this.UseRadWindow && !document.all && this.Window && this.Window.resizeTo){ this.Window.resizeTo(width,height); }else { this.SetWidth(width); this.SetHeight(height); }if (width>0)this.Width=width; if (height>0)this.Height=height; };RadWindow.prototype.SetCaption= function (caption){if (this.Caption){ this.Caption.innerHTML=caption; }};var RadWindowActiveWindow=null; var RadWindowActiveWindowSpan=null; var MousePosX=0; var MousePosY=0; function RadWindowDragStart( ){if (!RadWindowActiveWindow.CanDrag( ))return; if (document.all && document.body.attachEvent){document.body.setCapture( ); document.body.attachEvent("\x6fnmo\x75\163\x65move",RadWindowDrag); document.body.attachEvent("\157\x6emouseu\x70",RadWindowDragEnd); }else if (document.addEventListener){document.addEventListener("mousemo\x76e",RadWindowDrag, false); document.addEventListener("mouseup",RadWindowDragEnd, false); }RadWindowInitializeDrag(RadWindowActiveWindow); }function RadWindowDragEnd( ){if (document.all && document.body.detachEvent){document.body.detachEvent("onmousem\x6fve",RadWindowDrag); document.body.detachEvent("\x6fnmo\x75\x73eu\x70",RadWindowDragEnd); document.body.releaseCapture( ); }else if (document.removeEventListener){document.removeEventListener("mo\x75semove",RadWindowDrag, false); document.removeEventListener("mouseup",RadWindowDragEnd, false); }if (RadWindowActiveWindow.IsModal)RadWindowActiveWindow.SetCapture( ); RadWindowUnInitializeDrag(RadWindowActiveWindow); RadWindowActiveWindow.SetContentVisible( true); }function RadWindowDrag(e){if (RadWindowActiveWindow.CanDrag( )){switch (RadWindowActiveWindow.DragMode){case "m\x6fve":RadWindowMove(e); break; case "si\x7ae":RadWindowSize(e); break; }}e.cancelBubble= true; e.returnValue= false; if (e.preventDefault)e.preventDefault( ); MousePosX=e.clientX; MousePosY=e.clientY; return false; }function RadWindowInitializeDrag(targetWindow){if (!targetWindow)return; if (!RadWindowActiveWindowSpan){RadWindowActiveWindowSpan=document.createElement("\x44IV"); RadWindowActiveWindowSpan.className="\x52adE\x54\141\x62leWrapp\x65rRes\x69zeSpan"; RadWindowActiveWindowSpan.style.position="absolut\x65"; RadWindowActiveWindowSpan.style.zIndex=50000; document.body.appendChild(RadWindowActiveWindowSpan); }RadWindowActiveWindowSpan.style.visibility="\x76isible"; RadWindowActiveWindowSpan.style.top=targetWindow.ContentWrapperTable.style.top; RadWindowActiveWindowSpan.style.left=targetWindow.ContentWrapperTable.style.left; RadWindowActiveWindowSpan.style.width=parseInt(targetWindow.GetWidth( ))+"\160\x78"; RadWindowActiveWindowSpan.style.height=parseInt(targetWindow.GetHeight( ))+"px"; switch (targetWindow.DragMode){case "\x6dov\x65":RadWindowActiveWindowSpan.style.cursor="default"; break; case "\x73ize":RadWindowActiveWindowSpan.style.cursor="\163\x65-resize"; break; }}function RadWindowMove(e){var RadWindowX=RadWindowActiveWindow.X; var RadWindowY=RadWindowActiveWindow.Y; var el=RadWindowActiveWindowSpan; var left=0; var top=0; if (document.all){left=e.clientX*1+RadGetScrollLeft(document)-RadWindowX; top=e.clientY*1+RadGetScrollTop(document)-RadWindowY; }else {left=e.pageX*1-RadWindowX-RadGetScrollLeft(document); top=e.pageY*1-RadWindowY-RadGetScrollTop(document); }if (left<0){left=0; }if (top<0){top=0; }el.style.left=left+"\x70x"; el.style.top=top+"px"; }var minWidth=155; var minHeight=43; var maxWidth; var maxHeight; function RadWindowSize(e){var offsetX=e.clientX-MousePosX; var offsetY=e.clientY-MousePosY; var oSpan=RadWindowActiveWindowSpan; var width=oSpan.clientWidth?oSpan.clientWidth:oSpan.offsetWidth; var height=oSpan.clientHeight?oSpan.clientHeight:oSpan.offsetHeight; if (document.all && !window.opera && "CSS1\x43\157\x6dpat"!=document.compatMode){width=oSpan.offsetWidth; height=oSpan.offsetHeight; }width+=offsetX; height+=offsetY; if (width<minWidth)width=minWidth; if (height<minHeight)height=minHeight; RadWindowActiveWindowSpan.style.width=width+"\x70x"; RadWindowActiveWindowSpan.style.height=height+"px"; }function GetTopWindow( ){var topWindow=null; var argumentsContainParentWindow= false; try {if (window.dialogArguments.parentWindow && argumentsContainParentWindow){argumentsContainParentWindow= true; }}catch (ex){argumentsContainParentWindow= false; }if (window.dialogArguments!=null && argumentsContainParentWindow){topWindow=window.dialogArguments.parentWindow; }else if (window.opener && !document.all && window.isRadWindow){topWindow=opener; }else {topWindow=window; }var stopLoop= false; while (topWindow.parent && !stopLoop){try {topWindowTagName=topWindow.parent.tagName.toUpperCase( ); }catch (exception){topWindowTagName=""; }if (topWindow.parent==topWindow){break; }try {if (topWindow.parent.document.domain!=window.document.domain){break; }}catch (exc){stopLoop= true; continue; }try {if (topWindow.frameElement!=null && (topWindow.frameElement.tagName!="\x49FR\x41\x4dE" || topWindow.frameElement.name!="RadW\x69ndowCont\x65nt")){break; }}catch (exc){alert('\x69n t\x68\x65 E\x78ception\x21'); stopLoop= true; }topWindow=topWindow.parent; }return topWindow; }function Document_OnFocus(e){if (!e){e=window.event; }GetEditorRadWindowManager( ).ActivateWindow( ); }function Document_OnKeyDown(e){if (!e){e=window.event; }return GetEditorRadWindowManager( ).OnKeyDown(e); }function RadWindowInfo( ){ this.IsIE=(null!=document.all); this.ID=null; this.Url=""; this.InnerHtml=""; this.InnerObject=null; this.Width=300; this.Height=200; this.Caption=""; this.IsVisible= true; this.Argument=null; this.CallbackFunc=null; this.OnLoadFunc=null; this.Param=null; this.Resizable= true; this.Movable= true; this.CloseHide= false; this.UseClassicDialogs= true; }function GetEditorRadWindowManager( ){var topWindow=GetTopWindow( ); if (!topWindow.radWindowManager){topWindow.radWindowManager=new RadEditorWindowManager( ); }return topWindow.radWindowManager; }function RadEditorWindowManager( ){ this.ChildWindows=new Array( ); this.ActiveWindow=null; this.TopWindowZIndex=10001; this.ContainerPool=new Array( ); this.IsIE=(null!=document.all) && (window.opera==null); this._overImage=null; if (document.body!=null){document.body.onfocus=Document_OnFocus; if (this.IsIE && document.body.attachEvent){document.body.attachEvent("onkeyd\x6fwn",Document_OnKeyDown); }else if (document.body.addEventListener){document.body.addEventListener("\x6beyd\x6f\x77n",Document_OnKeyDown, false); }}}RadEditorWindowManager.prototype.ShowModalWindow= function (radWindowInfo){var wnd=this.CreateWindow( true ,radWindowInfo); return wnd; };RadEditorWindowManager.prototype.ShowModallessWindow= function (radWindowInfo){var wnd=this.CreateWindow( false ,radWindowInfo); return wnd; };RadEditorWindowManager.prototype.CreateWindow= function (bIsModal,radWindowInfo){if (!radWindowInfo)return null; if (window.opera)radWindowInfo.UseClassicDialogs= true; var id=""; if (!radWindowInfo.ID || radWindowInfo.ID==""){id=this.ChildWindows.length; }else {id=radWindowInfo.ID; }var caption=""; if (null==radWindowInfo.Caption){caption="["+id+"\x5d"; }else {caption=radWindowInfo.Caption; }var radWindow=this.GetWindow(id); radWindow.Argument=radWindowInfo.Argument; radWindow.Width=radWindowInfo.Width; radWindow.Height=radWindowInfo.Height; radWindow.CallbackFunc=radWindowInfo.CallbackFunc; radWindow.Param=radWindowInfo.Param; radWindow.CanResize=radWindowInfo.Resizable; radWindow.CanMove=radWindowInfo.Movable; radWindow.OnLoadFunc=radWindowInfo.OnLoadFunc; radWindow.UseRadWindow=!radWindowInfo.UseClassicDialogs; if (radWindowInfo.UseClassicDialogs && this.IsIE){var features="status\x3ano;"+"resiz\x61ble:yes;"+"\x63enter:\x79\145\x73;"+"\x68elp:no;"+"\x6dinimi\x7a\x65:n\x6f;"+"\x6daximi\x7a\x65:n\x6f\073"+"\x73croll:no\x3b"+"\x62order:t\x68\151\x6e\073"+"st\x61\x74usb\x61r:no;"+"dia\x6c\157g\x57idth:"+radWindowInfo.Width+"\x70x;"+"\x64ialogHei\x67ht:"+radWindowInfo.Height+"\x70\170"; if (radWindowInfo.InnerHtml && radWindowInfo.InnerHtml!=""){radWindow.InnerHTML=radWindowInfo.InnerHtml; }if (!radWindowInfo.Url || ""==radWindowInfo.Url)radWindowInfo.Url="\x6aavasc\x72\151\x70t:\047\x27"; var dialogArguments= {parentWindow:window,radWindow:radWindow,IsRadWindowArgs: true } ; window.showModalDialog(radWindowInfo.Url,dialogArguments,features); }else if (radWindowInfo.UseClassicDialogs && !this.IsIE){if (!radWindowInfo.Url || ""==radWindowInfo.Url)radWindowInfo.Url="javascr\x69pt:\047\047"; window.childRadWindow=radWindow; radWindow.Window=window.open(radWindowInfo.Url,"_bl\x61nk","\x73tatus=n\x6f\054\x74ool\x62\141\x72=no,lo\x63ation=\x6eo,resi\x7aabl\x65\075\x79es,me\x6eubar=\x6eo,wid\x74h="+radWindowInfo.Width+"\x2cheight="+radWindowInfo.Height+",modal=\x79es"); }else if (!radWindowInfo.UseClassicDialogs){var container=null; if (this.ContainerPool.length>0){container=this.ContainerPool.pop( ); }else {container=document.createElement("SPAN"); document.body.appendChild(container); }var oHtml=this.BuildWrapperTableHtml(id,radWindowInfo.Width,radWindowInfo.Height,caption,bIsModal,radWindowInfo.CloseHide); container.innerHTML=oHtml; var contentElem=(null!=radWindowInfo.InnerObject)?radWindowInfo.InnerObject:document.getElementById("RadWind\x6fwConte\x6etFrame"+id); radWindow.Initialize2(contentElem, true ,container,bIsModal, ++this.TopWindowZIndex); var frm=document.getElementById("\x52adWindow\x43ontentFr\x61me"+id); radWindow.Window=null!=frm?frm.contentWindow:null; radWindow.Iframe=frm; if (radWindowInfo.InnerHtml && radWindowInfo.InnerHtml!=""){var doc=frm.contentWindow.document; doc.open( ); doc.write(radWindowInfo.InnerHtml); doc.close( ); }else if (radWindowInfo.Url && radWindowInfo.Url!=""){frm.src=radWindowInfo.Url; }if (bIsModal){ this.SetCapture(radWindow, false); }if (null==radWindowInfo.IsVisible){radWindowInfo.IsVisible= false; }var windowStartPosition=this.GetWindowStartPosition(radWindowInfo); radWindow.SetSize(radWindowInfo.Width,radWindowInfo.Height); radWindow.ShowWindow(radWindowInfo.IsVisible,windowStartPosition.horizontal,windowStartPosition.vertical); }return radWindow; };RadEditorWindowManager.prototype.GetWindowStartPosition= function (radWindowInfo){var vcenterDeclination=parseInt(radWindowInfo.Height)/2; var hcenterDeclination=parseInt(radWindowInfo.Width)/2; var documentCenterPositions=this.GetDocumentVisibleCenter( ); var top=documentCenterPositions.vertical-vcenterDeclination; if (top<0)top=0; var left=documentCenterPositions.horizontal-hcenterDeclination; if (left<0)left=0; return {horizontal:left,vertical:top } ; } ; RadEditorWindowManager.prototype.GetDocumentVisibleCenter= function ( ){var innerWidth=0; var innerHeight=0; var canvas=document.body; var compatMode=!((RadControlsNamespace.Browser.IsMozilla || RadControlsNamespace.Browser.IsIE) && document.compatMode!="CSS\x31Compat"); if (compatMode && !RadControlsNamespace.Browser.IsSafari){canvas=document.documentElement; }if (window.innerWidth){innerWidth=window.innerWidth; innerHeight=window.innerHeight; }else {innerWidth=canvas.clientWidth; innerHeight=canvas.clientHeight; }maxWidth=innerWidth; maxHeight=innerHeight; var documentVisibleCenterX=this.GetVisibleCenterCoordinate(canvas.scrollLeft,innerWidth); var documentVisibleCenterY=this.GetVisibleCenterCoordinate(canvas.scrollTop,innerHeight); return {horizontal:documentVisibleCenterX,vertical:documentVisibleCenterY } ; } ; RadEditorWindowManager.prototype.GetVisibleCenterCoordinate= function (documentStartDeclination,visibleSize){var visibleAreaMiddle=parseInt(visibleSize)/2; return parseInt(documentStartDeclination)+visibleAreaMiddle; } ; RadEditorWindowManager.prototype.DestroyWindow= function (childWindow){var nextWndToActivate=this.GetPrevWindow(childWindow.Id); this.UnregisterChild(childWindow); if (nextWndToActivate!=childWindow){ this.ActivateWindow(nextWndToActivate); }if (childWindow.Iframe){childWindow.Iframe.src="\x6aavascr\x69\x70\x74\072\x27\047\x3b"; }eval(this.GetWindowVarName(childWindow.Id)+"\040\x3d null;"); if (childWindow.Container){ this.ContainerPool.push(childWindow.Container); }};RadEditorWindowManager.prototype.GetPrevWindow= function (id){var bNeedPrev= false; var retWnd=null; for (var i=this.ChildWindows.length-1; i>=0; i--){var wnd=this.ChildWindows[i]; if (wnd && wnd.Id==id){bNeedPrev= true; }else if (wnd && bNeedPrev){return wnd; }else if (null==retWnd){retWnd=wnd; }}return retWnd; };RadEditorWindowManager.prototype.CloseWindow= function (id){var wnd=this.LookupWindow(id); if (wnd){wnd.Close( ); }};RadEditorWindowManager.prototype.ActivateWindow= function (radWindow){if (!radWindow){radWindow=this.ActiveWindow; }if (radWindow){if (radWindow.IsModal){ this.SetCapture(radWindow, false); }if (radWindow!=this.ActiveWindow){if (this.ActiveWindow){ this.ActiveWindow.SetZIndex(this.TopWindowZIndex-1); }radWindow.SetZIndex(this.TopWindowZIndex); this.ActiveWindow=radWindow; }if (radWindow.IsModal){ this.ShowOverImage(radWindow, true); }}};RadEditorWindowManager.prototype.RegisterChild= function (childWindow){ this.ChildWindows[this.ChildWindows.length]=childWindow; };RadEditorWindowManager.prototype.UnregisterChild= function (childWindow){for (var i=0; i<this.ChildWindows.length; i++){var wnd=this.ChildWindows[i]; if (wnd==childWindow){ this.ChildWindows[i]=null; return; }}};RadEditorWindowManager.prototype.SetCapture= function (childWindow,bContainerCapture){try {if (childWindow){childWindow.SetCapture(bContainerCapture); }}catch (ex){}};RadEditorWindowManager.prototype.LookupWindow= function (id){for (var i=0; i<this.ChildWindows.length; i++){var wnd=this.ChildWindows[i]; if (wnd && id==wnd.Id){return wnd; }}return null; };RadEditorWindowManager.prototype.LookupRadWindowByBrowserWindowRef= function (browserWindow){for (var i=0; i<this.ChildWindows.length; i++){var radWindow=this.ChildWindows[i]; if (null!=radWindow && browserWindow==radWindow.Window){return radWindow; }}return null; };RadEditorWindowManager.prototype.GetCurrentRadWindow= function (browserWindow){if (browserWindow.dialogArguments && ( true ==browserWindow.dialogArguments.IsRadWindowArgs)){return browserWindow.dialogArguments.radWindow; }else if (browserWindow.opener!=null && browserWindow.opener.childRadWindow!=null){return browserWindow.opener.childRadWindow; }else {var oLast=this.LookupRadWindowByBrowserWindowRef(browserWindow); return oLast; }};RadEditorWindowManager.prototype.GetWindow= function (id){var wnd=this.LookupWindow(id); if (!wnd){var varName=this.GetWindowVarName(id); eval(varName+"\x20= n\x65\167\x20RadWind\x6fw(\047"+id+"\047\x29;"); wnd=eval(varName); wnd.Parent=this ; this.RegisterChild(wnd); }return wnd; };RadEditorWindowManager.prototype.GetWindowVarName= function (id){return "\x77indow.r\x61\x64W\x69\156\x64ow_"+id; };RadEditorWindowManager.prototype.GetWindowFromPos= function (x,y){var wnd=null; for (var i=0; i<this.ChildWindows; i++){var childWnd=this.ChildWindows[i]; if (childWnd && childWnd.HitText(x,y)){if (!wnd || wnd.ZIndex<childWnd.ZIndex){wnd=childWnd; }}}return wnd; };RadEditorWindowManager.prototype.OnShowWindow= function (childWindow,visible){if (visible){ this.ActiveWindow=childWindow; }else {if (this.ActiveWindow==childWindow){ this.ActiveWindow=null; }}if (childWindow.IsModal){ this.ShowOverImage(childWindow,visible); }};RadEditorWindowManager.prototype.OnKeyDown= function (evt){switch (evt.keyCode){case 115:if (evt.altKey && this.ActiveWindow){}else if (evt.ctrlKey && this.ActiveWindow){}evt.keyCode=8; break; case 27:if (this.ActiveWindow){ this.ActiveWindow.Close( ); }break; default:return; }evt.cancelBubble= true; evt.returnValue= false; };RadEditorWindowManager.prototype.BuildWrapperTableHtml= function (id,width,height,caption,bIsModal,bHide){var url=document.all?"\x6aava\x73\x63ri\x70t:\047\x27;": ""; var closeFunc=bHide?"\x53howW\x69\156\x64ow(f\x61\x6cs\x65)": "\x43lose()"; var html=""; html+="\011\x09\074\x74ab\x6ce bord\x65r=\047\x30\047\x20id\x3d\047\x52adW\x69ndow\x43ontent\x57rappe\x72"+id+"\x27 class\x3d\x27Ra\x64ETableW\x72apper\047\040\x73tyle=\x27\167\x69dth\x3a "+width+";height\x3a"+height+";z\x2dindex:10\x30\060\x3b posit\x69on:abs\x6f\154\x75\164\x65\073\x27 ce\x6clspaci\x6eg=\047\x30\047 cell\x70addin\x67=\047\x30\047\040\x3e\012"+"\x09\011\x09\074\x74r  s\x74\171\x6ce=\047\x68eigh\x74:1px;\047>\012"+"\011\x09\011\x09\074\x74d wid\x74h=\047\x31\047\x20cla\x73s=\047\122\x61dETa\x62\154\x65Wrapp\x65rHead\x65rLeft\x27 nowr\x61p>\074\x2ft\x64>\012"+"\x09\011\x09\011\x3ctd w\x69dth=\047\061\x300%\047\x20cla\x73s=\047\122\x61dETab\x6ceWrap\x70erHea\x64erCen\x74er\047\x20no\x77rap=\x27true\x27 onmo\x75sedow\x6e=\047\x72a\x64Windo\x77_"+id+".DragM\x6f\144\x65\075\x22move\042\073\x20return\x20radWin\x64\157\x77_"+id+"\056\x4fnDragSta\x72t(event\x29\073\x27 onsel\x65ctstar\x74\075\x27ret\x75rn fa\x6cse;\047\076\x0a"+"\x09\011\x09\011\x09\074\x73pan i\x64=\047\x52adWi\x6edowCap\x74ion"+id+"\x27 on\x73\145l\x65ctstart\x3d\047\x72eturn \x66alse;\047 clas\x73=\047\122\x61dERadW\x69ndowH\x65ader\x27\076"+caption+"\x3c/span\x3e\x0a"+"\x09\011\x09\011\x3c/td>\012"; if (!bIsModal){html+="\011\011\x3ctd wi\x64th=\047\x31\047\x20cl\x61ss=\047\x52ad\x45Tabl\x65Wrap\x70\145\x72Heade\x72Cente\x72\047\x20now\x72ap>\012"+"\x09\011\x09\011\x09\074\163\x70an clas\x73=\047\x52adER\x61dWind\x6fwBut\x74onPin\x4fff\047\x20id\x3d\047\x42utt\x6fnPin\047 onc\x6cick=\x27radWi\x6edow_"+id+".\x54\157g\x67\154\x65CanMove\x28this)\047>&nbsp;\x3c/span>"+"\011\x09\011\x3c/td>\x0a"; }var scrolling="\x61uto"; if (this.GetWindow(id)!=null && this.GetWindow(id).Argument!=null){var customizedScrolling=this.GetWindow(id).Argument.scrolling; if (customizedScrolling){switch (customizedScrolling){case "yes":case "\x6eo":case "\x61\165\x74\x6f":scrolling=customizedScrolling; break; default:break; }}}html+="\011\011\x09\011\x3ctd\x20width=\x27\061\x27 class\x3d\047\x52adET\x61bleW\x72apperH\x65aderC\x65nter\x27\040\x6eowra\x70>\012"+"\x09\011\x09\074\x73pan c\x6c\141\x73s=\047\x52adE\x52adWind\x6fwBut\x74onClo\x73e\047\x20id=\x27Butto\x6eClos\x65\047\x20oncl\x69ck=\x27\162\x61dWin\x64ow_"+id+"\056"+closeFunc+"\047\x3e&nbs\x70\073\x3c/span>\x0a"+"\011\x09\011\x09\074\057\x74d>\012"+"\011\x09\011\x09\074\x74d wid\x74h=\047\x31\047\x20cl\x61ss=\047RadETa\x62leWra\x70perHe\x61\144\x65rRig\x68t\047\x20no\x77rap>\074/td>\x0a"+"\011\x09\011\x3c/tr\x3e\012"+"\x09\011\x09\074\164r\x20style=\047height\x3a100%\047\040\x3e\012"+"\x09\011\x09\011\x3c\x74d st\x79le=\047\x68ei\x67ht:100%\x3b\047\x20c\x6flspan=\x275\047\x3e\012"+"\x09\011\x09\011\x09\074\x74able\x20height\x3d\047\x3100%\047\x20\x73tyle=\x27height\x3a100%\x27\040\x62orde\x72=\047\x30\047\040\x77idt\x68=\047\x3100%\x27  cel\x6cspac\x69ng=\0470\047\x20ce\x6clpad\x64ing=\x270\047\x3e\012"+"\011\x09\011\x09\011\x09\074tr sty\x6c\145\x3d\047\x68eight\x3a100%\x27>\012"+"\x09\011\x09\011\x09\011\011\x3ctd widt\x68=\047\x31\047\x20cla\x73s=\047RadETa\x62leWrap\x70erBod\x79Left\x27\040\x6eowra\x70>\074\x2ft\x64>\012"+"\x09\011\x09\011\x09\011\x09\074\164\x64 id=\047\x52ad\x57indowC\x6fnte\x6etWindo\x77"+id+"\047\x20 styl\x65\075\x27height:\x3100%;bor\x64er:0px \x73olid b\x6cue;\x27 heigh\x74=\047\x3100%\x27 widt\x68=\047\x3100\x25\047\x20cla\x73s=\047\x52a\x64ETabl\x65Wrapp\x65rBody\x43enter\x27 ali\x67n=\047left\047 val\x69gn=\047top\047 ons\x65lects\x74art=\047\x72e\x74urn \x66alse\x3b\047\x3e\012"+"\x09\011\x09\011\x09\011\x09\011\x3cifra\x6de name\x3d\047\x52adWi\x6edowC\x6fntent\x27\040\x66rameb\x6frder\x3d\047\x30px\047 styl\x65=\047\x68ei\x67ht:10\x30%;wid\x74h:10\x30%;bor\x64er:0p\x78 sol\x69d gre\x65n\047\x20i\x64=\047\x52a\x64Windo\x77Cont\x65ntF\x72ame"+id+"\x27 sr\x63\x3d\047"+url+"\x27 scroll\x69\x6eg=\x27"+scrolling+"\x27 bor\x64\145\x72\075\x27\156\x6f\047\x20>\074\x2fifr\x61me>\012"+"\x09\011\x09\011\x09\011\x09\074/td>\012"+"\x09\011\x09\011\x09\011\011\x3ctd widt\x68=\047\x31\047\x20cla\x73s=\047RadET\x61bleWr\x61pperB\x6fdyRig\x68t\047\x20now\x72ap>\x3c\057\x74d>\012"+"\011\x09\011\x09\011\011\x3c/tr>\012"+"\x09\011\x09\011\x09\074\x2fta\x62le>\012"+"\x09\011\x09\011\x3c/td>\012"+"\x09\011\x09\074\x2ftr>\x0a"+"\011\x09\011\x3ctr styl\x65\075\x27height\x3a1px;\047\076\x0a"+"\011\x09\011\x09\074\x74d \x63\157\x6cspan=\0475\047\x20widt\x68=\047\x310\x30%\047\x20sty\x6ce=\047\x68ei\x67ht:1p\x78;\047\x20>\012"+"\x09\011\x09\011\x09\074\x74able\x20border\x3d\047\x30\047\x20wid\x74h=\047\x310\x30\045\x27 hei\x67ht=\0471\047\x20cel\x6cspaci\x6eg=\047\060\x27 cel\x6cpaddi\x6eg=\047\060\x27>\012"+"\x09\011\x09\011\x09\011\x3ctr>\x0a"+"\011\x09\011\x09\011\x09\011\x3ctd \x77\151\x64\164\x68\075\x271\047 clas\x73=\047\x52adET\x61bleWr\x61pperF\x6foterL\x65ft\047\x20n\x6fwrap\x3e&nbsp\x3b\074\x2ftd>\x0a"+"\011\x09\011\x09\011\011\x09\074\x74d col\x73pan=\047\063\x27 id=\x27Bord\x65rBotto\x6d\047\x20widt\x68=\047\x3100%\x27 clas\x73=\047\x52ad\x45Tabl\x65Wrapp\x65rFoot\x65rCent\x65r\047\x20no\x77rap>\x26nbsp\x3b\074\x2ftd>\x09\011\x0a"+"\011\x09\011\x09\011\x09\011\x3ctd \x77idth=\x27\x31\047 id=\047Corne\x72Botto\x6dRight\x27 class\x3d\047\x52adE\x54ableW\x72appe\x72Foote\x72Right\x27 onmo\x75sedo\x77n=\047\x72a\x64Windo\x77_"+id+".DragMod\x65=\042\x73ize\042\x3b \x72\145\x74\165\x72\156\x20radW\x69ndow\x5f"+id+"\056\x4fnDragSta\x72t(event\x29;\047\x20onse\x6c\145\x63tstart\x3d\047\x72et\x75rn fa\x6cse;\047\040\x6eowra\x70>&nbs\x70;\074\x2ftd\x3e\012"+"\x09\011\x09\011\x09\011\x3c/tr\x3e\012"+"\011\x09\011\x09\011\x3c/ta\x62le>\012"+"\x09\011\x09\011\074\x2ftd>\012"+"\x09\011\x09\074\x2ftr>\012"+"\x09\011\x3c/tab\x6ce>\012"; return html; };RadEditorWindowManager.prototype.SetOverImage= function (imageId){ this._overImage=document.getElementById(imageId); };RadEditorWindowManager.prototype.GetOverImage= function ( ){if (!this._overImage){ this._overImage=document.getElementById("OVER_IM\x47"); }return this._overImage; };RadEditorWindowManager.prototype.ShowOverImage= function (wnd,visible){var overImage=this.GetOverImage( ); if (overImage){if (wnd && visible){var viewPortSize=RadControlsNamespace.Screen.GetViewPortSize( ); overImage.style.position="\x61bsolut\x65"; overImage.style.left=0; overImage.style.top=0; overImage.style.width=viewPortSize.width+"\160\x78"; overImage.style.height=viewPortSize.height+"px"; overImage.style.zIndex=wnd.ZIndex; overImage.style.display=""; }else {overImage.style.display="\x6eone"; }}};function RadGetScrollTop(oDocument){if (oDocument.documentElement && oDocument.documentElement.scrollTop){return oDocument.documentElement.scrollTop; }else {return oDocument.body.scrollTop; }}function RadGetScrollLeft(oDocument){if (oDocument.documentElement && oDocument.documentElement.scrollLeft){return oDocument.documentElement.scrollLeft; }else {return oDocument.body.scrollLeft; }}function CloseDlg(returnValue,callbackFunction,execCallBack){if (window.radWindow){window.radWindow.ReturnValue=returnValue; window.radWindow.Close(null,callbackFunction,execCallBack); }}function InitializeRadWindow(editorID){window["GetDia\x6cogArgum\x65nts"]= function (isInSpell){if (window["\x72adWi\x6e\144\x6fw"]){if (isInSpell){return window["\x72a\x64\127\x69ndow"].Argument.CustomArguments; }else {return window["\x72adWin\x64\x6fw"].Argument; }}else {return null; }};window["\x69sRadW\x69\x6edo\x77"]= true; window["radWind\x6fw"]=GetEditorRadWindowManager( ).GetCurrentRadWindow(window); if (window["ra\x64Window"]){if (window.dialogArguments){window["\x72adWind\x6f\167"].Window=window; }window["\x72adWind\x6f\167"].OnLoad( ); }var dialogArguments=GetDialogArguments( ); if (dialogArguments){if (dialogArguments.HideEditorStatusBar){dialogArguments.HideEditorStatusBar(editorID); }}if (document.addEventListener){document.onclick= function (e){var eventTarget=e.target; if (eventTarget && (eventTarget.tagName=="\x42\x55\x54TO\x4e" || (eventTarget.tagName=="INPUT" && eventTarget.type.toLowerCase( )=="but\x74on"))){e.cancelBuble= true; e.returnValue= false; if (e.preventDefault)e.preventDefault( ); return false; }} ; }window["BindOn\x52adWindo\x77KeyDown"]= function ( ){$ektron(document).keydown( function (event){event=(event?event:window.event); if (27==event.keyCode){$ektron("span.Ra\x64ERadWi\x6e\144\x6f\167\x42uttonC\x6cose",window.radWindow.ContentWrapperTable).click( ); event.stopImmediatePropagation( ); return false; }} ); };}
