function RadWindow(id){ this.IsIE=(null!=document.all) && (window.opera==null); this.IsQuirksMode=(document.all && !window.opera && "C\x53\x531Com\x70at"!=document.compatMode); this.Id=id; this.Width=0; this.Height=0; this.OnClientClosing=null; this.ContentWindow=null; this.ContentWrapperTable=null; this.Caption=null; this.X=0; this.Y=0; this.ShowContentWhenMoving= true; this.CanMove= true; this.CanResize= true; this.DragMode=""; this.IsModal= false; this.Container=null; this.Parent=null; this.Argument=null; this.ReturnValue=null; this.ExitCode=null; this.ZIndex=0; this.AdjustPosInterval=-1; this.CallbackFunc=null; this.OnLoadFunc=null; this.Param=null; this.ModalSetCapture= false; this.UseRadWindow= true; this.Window=null; this.InnerHTML=null; this._overImage=null; }RadWindow.prototype.OnLoad= function ( ){if (this.Window && ""!=this.Window.document.title){ this.SetCaption(this.Window.document.title); }if (this.OnLoadFunc){ this.OnLoadFunc( ); }};RadWindow.prototype.SetCapture= function (bContainerCapture){if (this.UseRadWindow){if (null!=bContainerCapture){ this.bContainerCapture=bContainerCapture; }else if (null!=this.bContainerCapture){bContainerCapture=this.bContainerCapture; }else {bContainerCapture= false; }if (this.ModalSetCapture && this.IsIE){ this.ContentWrapperTable.setCapture(bContainerCapture); }}};RadWindow.prototype.ReleaseCapture= function ( ){if (this.UseRadWindow){if (this.ModalSetCapture && this.IsIE){if (this.ContentWrapperTable)this.ContentWrapperTable.releaseCapture( ); }}};RadWindow.prototype.SetZIndex= function (zIndex){ this.ZIndex=zIndex; if (this.ContentWrapperTable){ this.ContentWrapperTable.style.zIndex=this.ZIndex; }};RadWindow.prototype.ToggleContent= function ( ){if (this.UseRadWindow && this.IsIE){var displayStyle=""; if (parseInt(this.Height)==parseInt(this.ContentWrapperTable.style.height)){ this.SetHeight(0); displayStyle="none"; }else { this.SetHeight(this.Height); displayStyle="inline"; }}};RadWindow.prototype.IsVisible= function ( ){if (this.ContentWrapperTable){return this.ContentWrapperTable.style.display==""; }return false; };RadWindow.prototype.ShowWindow= function (show,x,y){if (null==show){show= true; }var displayStyle=show?"": "\x6eone"; if (this.ContentWrapperTable){ this.ContentWrapperTable.style.display=displayStyle; }if (show){if (null!=x && null!=y){x+=10; if (this.ContentWrapperTable){ this.ContentWrapperTable.style.left=x+'\160\x78'; this.ContentWrapperTable.style.top=y+'px'; }}}if (this.Parent){ this.Parent.OnShowWindow(this,show); }};RadWindow.prototype.Initialize2= function (contentElem,show,containerElem,modal,zIndex){ this.Initialize(contentElem,show); this.IsModal=modal; this.Container=containerElem; this.SetZIndex(zIndex); };RadWindow.prototype.Initialize= function (contentElem,show){if (this.Id){ this.ContentWrapperTable=document.getElementById("RadWind\x6fwCont\x65ntWrapp\x65r"+this.Id); this.ContentWindow=document.getElementById("\x52adWin\x64\157\x77Conte\x6etWindow"+this.Id); this.Caption=document.getElementById("RadWi\x6edowCapt\x69on"+this.Id); if (null==show){var show= true; } this.ShowWindow(show); }else {alert("No w\x69ndow Id \x70rovided"); }} ; RadWindow.prototype.SetContentWindowSize= function (width,height){ this.Width=width; this.Height=height; } ; RadWindow.prototype.SetContentVisible= function (visible){if (this.ContentWindow){ this.ContentWindow.style.visibility=visible?"visi\x62le": "hi\x64den"; }} ; RadWindow.prototype.Close= function (exitCode,dialogCallbackFunction,execCallBack){if (null!=this.OnClientClosing && (this.OnClientClosing(exitCode)== false)){return; } this.ShowWindow( false); this.ExitCode=exitCode; if (this.AdjustPosInterval>-1){window.clearInterval(this.AdjustPosInterval); this.AdjustPosInterval=-1; }if (this.IsModal)this.ReleaseCapture( ); try {if (this.CallbackFunc && false !=execCallBack)this.CallbackFunc(this.ReturnValue,this.Param); if (dialogCallbackFunction){dialogCallbackFunction(this.ReturnValue,this.Param); }}catch (ex){}if (this.Parent)this.Parent.DestroyWindow(this ); if (!this.UseRadWindow && this.Window)this.Window.close( ); } ; RadWindow.prototype.ToggleCanMove= function (oDiv){if (!this.UseRadWindow)return; this.CanMove=!this.CanMove; oDiv.className=this.CanMove?"\x52adERa\x64\127\x69ndowBu\x74\164\x6fnPinO\x66f": "\x52adERa\x64\127\x69\156d\x6fwButton\x50inOn"; if (!this.CanMove){if (this.IsIE){ this.TopOffset=parseInt(this.ContentWrapperTable.style.top)-RadGetScrollTop(document); this.StartUpdatePosTimer(100); }else { this.ContentWrapperTable.style.position="fix\x65d"; }}else {if (this.IsIE){window.clearInterval(this.AdjustPosInterval); this.TopOffset=null; }else { this.ContentWrapperTable.style.position="abs\x6flute"; }}};RadWindow.prototype.StartUpdatePosTimer= function (iInterval){if (!this.UseRadWindow)return; this.AdjustPosInterval=window.setInterval("\x55pdat\x65\127\x69ndowPo\x73\050\x27"+this.Id+"\047\x29",iInterval); };function UpdateWindowPos(wndId){var wnd=GetEditorRadWindowManager( ).LookupWindow(wndId); if (wnd)wnd.SetPosition( ); }RadWindow.prototype.CanDrag= function ( ){if (!this.UseRadWindow)return true; return ("move"==this.DragMode && this.CanMove) || ("size"==this.DragMode && this.CanResize); };RadWindow.prototype.OnDragStart= function (e){ this.SetActive( true); if (!this.CanDrag( ))return; this.X=(e.offsetX==null)?e.layerX:e.offsetX; this.Y=(e.offsetY==null)?e.layerY:e.offsetY; MousePosX=e.clientX; MousePosY=e.clientY; this.SetContentVisible(this.ShowContentWhenMoving); RadWindowDragStart( ); } ; RadWindow.prototype.SetActive= function (activate){if (!this.UseRadWindow)return; if (activate){if (null!=RadWindowActiveWindow && RadWindowActiveWindow!=this )RadWindowActiveWindow.SetActive( false); RadWindowActiveWindow=this ; if (this.Parent)this.Parent.ActivateWindow(this ); }else {if (this ==RadWindowActiveWindow)RadWindowActiveWindow=null; }};RadWindow.prototype.HitTest= function (x,y){var left=parseInt(this.ContentWrapperTable.style.left); if (isNaN(left))return false; var top=parseInt(this.ContentWrapperTable.style.top); if (isNaN(top))return false; return left<=x && x<=(left+this.Width) && top<=y && y<=(top+this.Height); };RadWindow.prototype.SetPosition= function (left,top){if (!this.UseRadWindow){if (this.Window){ this.Window.dialogLeft=left; this.Window.dialogTop=top; }}else {if (!left)left=this.ContentWrapperTable.style.left; if (!top){if (this.TopOffset!=null)top=parseInt(this.TopOffset)+RadGetScrollTop(document); else top=this.ContentWrapperTable.style.top; }left=parseInt(left); top=parseInt(top); if (!isNaN(left) && !isNaN(top)){if (left<=0)left=0; if (top<=0)top=0; this.ContentWrapperTable.style.left=left+'px'; this.ContentWrapperTable.style.top=top+'\x70x'; }}};RadWindow.prototype.GetWidth= function ( ){var width=0; if (!this.UseRadWindow){if (this.Window)width=this.Window.dialogWidth; }else {if (this.IsIE){width=parseInt(this.ContentWrapperTable.clientWidth); }else {width=parseInt(this.ContentWrapperTable.scrollWidth); }if (isNaN(width))width=0; }return width; };RadWindow.prototype.SetWidth= function (width){width=parseInt(width); if (isNaN(width))return; if (!this.UseRadWindow){if (this.Window){if (this.Window.dialogWidth){ this.Window.dialogTop=this.Window.screenTop-30; this.Window.dialogLeft=this.Window.screenLeft-4; this.Window.dialogWidth=width+"\x70x"; }else { this.Window.outerWidth=width; }}}else {if (width)this.ContentWrapperTable.style.width=width+"\x70x"; }};RadWindow.prototype.GetHeight= function ( ){var height=0; if (!this.UseRadWindow){if (this.Window)height=this.Window.dialogHeight; }else {if (this.IsIE){height=parseInt(this.ContentWrapperTable.clientHeight); if (isNaN(height))height=0; }else {height=this.ContentWrapperTable.scrollHeight; }}return height; };RadWindow.prototype.SetHeight= function (height){height=parseInt(height); if (isNaN(height))return; if (!this.UseRadWindow){if (this.Window){if (this.Window.dialogWidth){ this.Window.dialogTop=this.Window.screenTop-30; this.Window.dialogLeft=this.Window.screenLeft-4; this.Window.dialogHeight=height+"\x70x"; }else { this.Window.outerHeight=height; }}}else {var oTable=this.ContentWrapperTable; var oFirstTable=oTable.getElementsByTagName("\x54A\x42\114\x45")[0]; if (oFirstTable)oFirstTable.setAttribute("\x62ord\x65\x72","1"); this.ContentWrapperTable.style.height=height+"\x70x"; this.FixIeHeight(this.ContentWrapperTable,height); oFirstTable.setAttribute("\x62order","0"); }};RadWindow.prototype.FixIeHeight= function (oElem,height){if (this.IsIE && "\x43SS1Comp\x61\164"==document.compatMode){var oHeight=oElem.offsetHeight; if (oHeight!=0 && oHeight!=height){var difference=(oHeight-height); var newHeight=(height-difference); if (newHeight>0){oElem.style.height=(newHeight+4)+"\x70x"; }}}} ; function RadWindowUnInitializeDrag(targetWindow){var oSpan=RadWindowActiveWindowSpan; targetWindow.SetPosition(oSpan.style.left,oSpan.style.top); var extra=targetWindow.IsQuirksMode?6: 0; extra+=targetWindow.IsIE?2: 0; extraHeight=extra; if (targetWindow.IsIE && !targetWindow.IsQuirksMode && extraHeight>0)extraHeight-=2; targetWindow.SetSize(extra+(oSpan.clientWidth?oSpan.clientWidth:oSpan.offsetWidth),extraHeight+(oSpan.clientHeight?oSpan.clientHeight:oSpan.offsetHeight)); if (RadWindowActiveWindowSpan)RadWindowActiveWindowSpan.style.visibility="hi\x64den"; }RadWindow.prototype.SetSize= function (width,height){if (width>maxWidth)width=maxWidth; if (height>maxHeight)height=maxHeight; if (!this.UseRadWindow && !document.all && this.Window && this.Window.resizeTo){ this.Window.resizeTo(width,height); }else { this.SetWidth(width); this.SetHeight(height); }if (width>0)this.Width=width; if (height>0)this.Height=height; };RadWindow.prototype.SetCaption= function (caption){if (this.Caption){ this.Caption.innerHTML=caption; }};var RadWindowActiveWindow=null; var RadWindowActiveWindowSpan=null; var MousePosX=0; var MousePosY=0; function RadWindowDragStart( ){if (!RadWindowActiveWindow.CanDrag( ))return; if (document.all && document.body.attachEvent){document.body.setCapture( ); document.body.attachEvent("\x6fnmou\x73\145\x6dove",RadWindowDrag); document.body.attachEvent("\x6fnmou\x73\x65u\x70",RadWindowDragEnd); }else if (document.addEventListener){document.addEventListener("\155\x6fusemo\x76e",RadWindowDrag, false); document.addEventListener("\x6do\x75\x73eup",RadWindowDragEnd, false); }RadWindowInitializeDrag(RadWindowActiveWindow); }function RadWindowDragEnd( ){if (document.all && document.body.detachEvent){document.body.detachEvent("\x6fnmo\x75\163\x65move",RadWindowDrag); document.body.detachEvent("\x6fn\x6d\x6fuse\x75p",RadWindowDragEnd); document.body.releaseCapture( ); }else if (document.removeEventListener){document.removeEventListener("\x6douse\x6d\x6fve",RadWindowDrag, false); document.removeEventListener("\x6dous\x65\x75p",RadWindowDragEnd, false); }if (RadWindowActiveWindow.IsModal)RadWindowActiveWindow.SetCapture( ); RadWindowUnInitializeDrag(RadWindowActiveWindow); RadWindowActiveWindow.SetContentVisible( true); }function RadWindowDrag(e){if (RadWindowActiveWindow.CanDrag( )){switch (RadWindowActiveWindow.DragMode){case "move":RadWindowMove(e); break; case "\x73ize":RadWindowSize(e); break; }}e.cancelBubble= true; e.returnValue= false; if (e.preventDefault)e.preventDefault( ); MousePosX=e.clientX; MousePosY=e.clientY; return false; }function RadWindowInitializeDrag(targetWindow){if (!targetWindow)return; if (!RadWindowActiveWindowSpan){RadWindowActiveWindowSpan=document.createElement("\104\x49V"); RadWindowActiveWindowSpan.className="\122\x61dETableW\x72apperRe\x73izeSp\x61n"; RadWindowActiveWindowSpan.style.position="a\x62solute"; RadWindowActiveWindowSpan.style.zIndex=50000; document.body.appendChild(RadWindowActiveWindowSpan); }RadWindowActiveWindowSpan.style.visibility="visible"; RadWindowActiveWindowSpan.style.top=targetWindow.ContentWrapperTable.style.top; RadWindowActiveWindowSpan.style.left=targetWindow.ContentWrapperTable.style.left; RadWindowActiveWindowSpan.style.width=parseInt(targetWindow.GetWidth( ))+"px"; RadWindowActiveWindowSpan.style.height=parseInt(targetWindow.GetHeight( ))+"\x70x"; switch (targetWindow.DragMode){case "move":RadWindowActiveWindowSpan.style.cursor="d\x65fault"; break; case "size":RadWindowActiveWindowSpan.style.cursor="\x73e-\x72\145\x73ize"; break; }}function RadWindowMove(e){var RadWindowX=RadWindowActiveWindow.X; var RadWindowY=RadWindowActiveWindow.Y; var el=RadWindowActiveWindowSpan; var left=0; var top=0; if (document.all){left=e.clientX*1+RadGetScrollLeft(document)-RadWindowX; top=e.clientY*1+RadGetScrollTop(document)-RadWindowY; }else {left=e.pageX*1-RadWindowX-RadGetScrollLeft(document); top=e.pageY*1-RadWindowY-RadGetScrollTop(document); }if (left<0){left=0; }if (top<0){top=0; }el.style.left=left+"\x70x"; el.style.top=top+"px"; }var minWidth=155; var minHeight=43; var maxWidth; var maxHeight; function RadWindowSize(e){var offsetX=e.clientX-MousePosX; var offsetY=e.clientY-MousePosY; var oSpan=RadWindowActiveWindowSpan; var width=oSpan.clientWidth?oSpan.clientWidth:oSpan.offsetWidth; var height=oSpan.clientHeight?oSpan.clientHeight:oSpan.offsetHeight; if (document.all && !window.opera && "\x43SS1Comp\x61\x74"!=document.compatMode){width=oSpan.offsetWidth; height=oSpan.offsetHeight; }width+=offsetX; height+=offsetY; if (width<minWidth)width=minWidth; if (height<minHeight)height=minHeight; RadWindowActiveWindowSpan.style.width=width+"\x70x"; RadWindowActiveWindowSpan.style.height=height+"\x70x"; }function GetTopWindow( ){var topWindow=null; var argumentsContainParentWindow= false; try {if (window.dialogArguments.parentWindow && argumentsContainParentWindow){argumentsContainParentWindow= true; }}catch (ex){argumentsContainParentWindow= false; }if (window.dialogArguments!=null && argumentsContainParentWindow){topWindow=window.dialogArguments.parentWindow; }else if (window.opener && !document.all && window.isRadWindow){topWindow=opener; }else {topWindow=window; }var stopLoop= false; while (topWindow.parent && !stopLoop){try {topWindowTagName=topWindow.parent.tagName.toUpperCase( ); }catch (exception){topWindowTagName=""; }if (topWindow.parent==topWindow){break; }try {if (topWindow.parent.document.domain!=window.document.domain){break; }}catch (exc){stopLoop= true; continue; }try {if (topWindow.frameElement!=null && (topWindow.frameElement.tagName!="I\x46RAME" || topWindow.frameElement.name!="\x52adWindowC\x6fntent")){break; }}catch (exc){alert('in the\x20Excepti\x6fn!'); stopLoop= true; }topWindow=topWindow.parent; }return topWindow; }function Document_OnFocus(e){if (!e){e=window.event; }GetEditorRadWindowManager( ).ActivateWindow( ); }function Document_OnKeyDown(e){if (!e){e=window.event; }return GetEditorRadWindowManager( ).OnKeyDown(e); }function RadWindowInfo( ){ this.IsIE=(null!=document.all); this.ID=null; this.Url=""; this.InnerHtml=""; this.InnerObject=null; this.Width=300; this.Height=200; this.Caption=""; this.IsVisible= true; this.Argument=null; this.CallbackFunc=null; this.OnLoadFunc=null; this.Param=null; this.Resizable= true; this.Movable= true; this.CloseHide= false; this.UseClassicDialogs= true; }function GetEditorRadWindowManager( ){var topWindow=GetTopWindow( ); if (!topWindow.radWindowManager){topWindow.radWindowManager=new RadEditorWindowManager( ); }return topWindow.radWindowManager; }function RadEditorWindowManager( ){ this.ChildWindows=new Array( ); this.ActiveWindow=null; this.TopWindowZIndex=10001; this.ContainerPool=new Array( ); this.IsIE=(null!=document.all) && (window.opera==null); this._overImage=null; if (document.body!=null){document.body.onfocus=Document_OnFocus; if (this.IsIE && document.body.attachEvent){document.body.attachEvent("onk\x65ydown",Document_OnKeyDown); }else if (document.body.addEventListener){document.body.addEventListener("keydo\x77n",Document_OnKeyDown, false); }}}RadEditorWindowManager.prototype.ShowModalWindow= function (radWindowInfo){var wnd=this.CreateWindow( true ,radWindowInfo); return wnd; };RadEditorWindowManager.prototype.ShowModallessWindow= function (radWindowInfo){var wnd=this.CreateWindow( false ,radWindowInfo); return wnd; };RadEditorWindowManager.prototype.CreateWindow= function (bIsModal,radWindowInfo){if (!radWindowInfo)return null; if (window.opera)radWindowInfo.UseClassicDialogs= true; var id=""; if (!radWindowInfo.ID || radWindowInfo.ID==""){id=this.ChildWindows.length; }else {id=radWindowInfo.ID; }var caption=""; if (null==radWindowInfo.Caption){caption="["+id+"\x5d"; }else {caption=radWindowInfo.Caption; }var radWindow=this.GetWindow(id); radWindow.Argument=radWindowInfo.Argument; radWindow.Width=radWindowInfo.Width; radWindow.Height=radWindowInfo.Height; radWindow.CallbackFunc=radWindowInfo.CallbackFunc; radWindow.Param=radWindowInfo.Param; radWindow.CanResize=radWindowInfo.Resizable; radWindow.CanMove=radWindowInfo.Movable; radWindow.OnLoadFunc=radWindowInfo.OnLoadFunc; radWindow.UseRadWindow=!radWindowInfo.UseClassicDialogs; if (radWindowInfo.UseClassicDialogs && this.IsIE){var features="\x73ta\x74\x75s:\x6e\157\x3b"+"\x72esizab\x6c\x65:y\x65s;"+"\x63\145n\x74\145\x72\072\x79es;"+"\x68elp:no;"+"mini\x6d\151z\x65:no;"+"m\x61\x78imi\x7ae:no;"+"\x73croll:n\x6f\x3b"+"b\x6f\162d\x65\162\x3a\164h\x69n;"+"\x73tatus\x62\x61r:\x6e\157\x3b"+"\x64ialogW\x69\x64th\x3a"+radWindowInfo.Width+"px\x3b"+"d\x69\141l\x6f\147\x48\145i\x67ht:"+radWindowInfo.Height+"px"; if (radWindowInfo.InnerHtml && radWindowInfo.InnerHtml!=""){radWindow.InnerHTML=radWindowInfo.InnerHtml; }if (!radWindowInfo.Url || ""==radWindowInfo.Url)radWindowInfo.Url="\x6aavasc\x72\151\x70t:\047\x27"; var dialogArguments= {parentWindow:window,radWindow:radWindow,IsRadWindowArgs: true } ; window.showModalDialog(radWindowInfo.Url,dialogArguments,features); }else if (radWindowInfo.UseClassicDialogs && !this.IsIE){if (!radWindowInfo.Url || ""==radWindowInfo.Url)radWindowInfo.Url="javas\x63ript:\047\047"; window.childRadWindow=radWindow; radWindow.Window=window.open(radWindowInfo.Url,"\x5fblan\x6b","\x73tat\x75\163\x3dno,too\x6cbar=no\x2clocat\x69on=no,r\x65sizab\x6ce=ye\x73,menu\x62ar=no\x2cwidth\x3d"+radWindowInfo.Width+",heigh\x74="+radWindowInfo.Height+"\x2cmoda\x6c\075\x79es"); }else if (!radWindowInfo.UseClassicDialogs){var container=null; if (this.ContainerPool.length>0){container=this.ContainerPool.pop( ); }else {container=document.createElement("\123\x50AN"); document.body.appendChild(container); }var oHtml=this.BuildWrapperTableHtml(id,radWindowInfo.Width,radWindowInfo.Height,caption,bIsModal,radWindowInfo.CloseHide); container.innerHTML=oHtml; var contentElem=(null!=radWindowInfo.InnerObject)?radWindowInfo.InnerObject:document.getElementById("\x52adWindo\x77\103\x6fntent\x46rame"+id); radWindow.Initialize2(contentElem, true ,container,bIsModal, ++this.TopWindowZIndex); var frm=document.getElementById("\x52adWi\x6e\x64o\x77\103\x6fntentF\x72ame"+id); radWindow.Window=null!=frm?frm.contentWindow:null; radWindow.Iframe=frm; if (radWindowInfo.InnerHtml && radWindowInfo.InnerHtml!=""){var doc=frm.contentWindow.document; doc.open( ); doc.write(radWindowInfo.InnerHtml); doc.close( ); }else if (radWindowInfo.Url && radWindowInfo.Url!=""){frm.src=radWindowInfo.Url; }if (bIsModal){ this.SetCapture(radWindow, false); }if (null==radWindowInfo.IsVisible){radWindowInfo.IsVisible= false; }var windowStartPosition=this.GetWindowStartPosition(radWindowInfo); radWindow.SetSize(radWindowInfo.Width,radWindowInfo.Height); radWindow.ShowWindow(radWindowInfo.IsVisible,windowStartPosition.horizontal,windowStartPosition.vertical); }return radWindow; };RadEditorWindowManager.prototype.GetWindowStartPosition= function (radWindowInfo){var vcenterDeclination=parseInt(radWindowInfo.Height)/2; var hcenterDeclination=parseInt(radWindowInfo.Width)/2; var documentCenterPositions=this.GetDocumentVisibleCenter( ); var top=documentCenterPositions.vertical-vcenterDeclination; if (top<0)top=0; var left=documentCenterPositions.horizontal-hcenterDeclination; if (left<0)left=0; return {horizontal:left,vertical:top } ; } ; RadEditorWindowManager.prototype.GetDocumentVisibleCenter= function ( ){var innerWidth=0; var innerHeight=0; var canvas=document.body; var compatMode=!((RadControlsNamespace.Browser.IsMozilla || RadControlsNamespace.Browser.IsIE) && document.compatMode!="\x43SS1C\x6f\x6dpa\x74"); if (compatMode && !RadControlsNamespace.Browser.IsSafari){canvas=document.documentElement; }if (window.innerWidth){innerWidth=window.innerWidth; innerHeight=window.innerHeight; }else {innerWidth=canvas.clientWidth; innerHeight=canvas.clientHeight; }maxWidth=innerWidth; maxHeight=innerHeight; var documentVisibleCenterX=this.GetVisibleCenterCoordinate(canvas.scrollLeft,innerWidth); var documentVisibleCenterY=this.GetVisibleCenterCoordinate(canvas.scrollTop,innerHeight); return {horizontal:documentVisibleCenterX,vertical:documentVisibleCenterY } ; } ; RadEditorWindowManager.prototype.GetVisibleCenterCoordinate= function (documentStartDeclination,visibleSize){var visibleAreaMiddle=parseInt(visibleSize)/2; return parseInt(documentStartDeclination)+visibleAreaMiddle; } ; RadEditorWindowManager.prototype.DestroyWindow= function (childWindow){var nextWndToActivate=this.GetPrevWindow(childWindow.Id); this.UnregisterChild(childWindow); if (nextWndToActivate!=childWindow){ this.ActivateWindow(nextWndToActivate); }if (childWindow.Iframe){childWindow.Iframe.src="javascr\x69pt:\047\047\x3b"; }eval(this.GetWindowVarName(childWindow.Id)+"\x20= n\x75\x6cl;"); if (childWindow.Container){ this.ContainerPool.push(childWindow.Container); }};RadEditorWindowManager.prototype.GetPrevWindow= function (id){var bNeedPrev= false; var retWnd=null; for (var i=this.ChildWindows.length-1; i>=0; i--){var wnd=this.ChildWindows[i]; if (wnd && wnd.Id==id){bNeedPrev= true; }else if (wnd && bNeedPrev){return wnd; }else if (null==retWnd){retWnd=wnd; }}return retWnd; };RadEditorWindowManager.prototype.CloseWindow= function (id){var wnd=this.LookupWindow(id); if (wnd){wnd.Close( ); }};RadEditorWindowManager.prototype.ActivateWindow= function (radWindow){if (!radWindow){radWindow=this.ActiveWindow; }if (radWindow){if (radWindow.IsModal){ this.SetCapture(radWindow, false); }if (radWindow!=this.ActiveWindow){if (this.ActiveWindow){ this.ActiveWindow.SetZIndex(this.TopWindowZIndex-1); }radWindow.SetZIndex(this.TopWindowZIndex); this.ActiveWindow=radWindow; }if (radWindow.IsModal){ this.ShowOverImage(radWindow, true); }}};RadEditorWindowManager.prototype.RegisterChild= function (childWindow){ this.ChildWindows[this.ChildWindows.length]=childWindow; };RadEditorWindowManager.prototype.UnregisterChild= function (childWindow){for (var i=0; i<this.ChildWindows.length; i++){var wnd=this.ChildWindows[i]; if (wnd==childWindow){ this.ChildWindows[i]=null; return; }}};RadEditorWindowManager.prototype.SetCapture= function (childWindow,bContainerCapture){try {if (childWindow){childWindow.SetCapture(bContainerCapture); }}catch (ex){}};RadEditorWindowManager.prototype.LookupWindow= function (id){for (var i=0; i<this.ChildWindows.length; i++){var wnd=this.ChildWindows[i]; if (wnd && id==wnd.Id){return wnd; }}return null; };RadEditorWindowManager.prototype.LookupRadWindowByBrowserWindowRef= function (browserWindow){for (var i=0; i<this.ChildWindows.length; i++){var radWindow=this.ChildWindows[i]; if (null!=radWindow && browserWindow==radWindow.Window){return radWindow; }}return null; };RadEditorWindowManager.prototype.GetCurrentRadWindow= function (browserWindow){if (browserWindow.dialogArguments && ( true ==browserWindow.dialogArguments.IsRadWindowArgs)){return browserWindow.dialogArguments.radWindow; }else if (browserWindow.opener!=null && browserWindow.opener.childRadWindow!=null){return browserWindow.opener.childRadWindow; }else {var oLast=this.LookupRadWindowByBrowserWindowRef(browserWindow); return oLast; }};RadEditorWindowManager.prototype.GetWindow= function (id){var wnd=this.LookupWindow(id); if (!wnd){var varName=this.GetWindowVarName(id); eval(varName+" = new\x20RadWin\x64ow(\047"+id+"\047\x29;"); wnd=eval(varName); wnd.Parent=this ; this.RegisterChild(wnd); }return wnd; };RadEditorWindowManager.prototype.GetWindowVarName= function (id){return "w\x69ndow.ra\x64Window_"+id; };RadEditorWindowManager.prototype.GetWindowFromPos= function (x,y){var wnd=null; for (var i=0; i<this.ChildWindows; i++){var childWnd=this.ChildWindows[i]; if (childWnd && childWnd.HitText(x,y)){if (!wnd || wnd.ZIndex<childWnd.ZIndex){wnd=childWnd; }}}return wnd; };RadEditorWindowManager.prototype.OnShowWindow= function (childWindow,visible){if (visible){ this.ActiveWindow=childWindow; }else {if (this.ActiveWindow==childWindow){ this.ActiveWindow=null; }}if (childWindow.IsModal){ this.ShowOverImage(childWindow,visible); }};RadEditorWindowManager.prototype.OnKeyDown= function (evt){switch (evt.keyCode){case 115:if (evt.altKey && this.ActiveWindow){}else if (evt.ctrlKey && this.ActiveWindow){}evt.keyCode=8; break; case 27:if (this.ActiveWindow){ this.ActiveWindow.Close( ); }break; default:return; }evt.cancelBubble= true; evt.returnValue= false; };RadEditorWindowManager.prototype.BuildWrapperTableHtml= function (id,width,height,caption,bIsModal,bHide){var url=document.all?"\152\x61vasc\x72ipt:\047\x27;": ""; var closeFunc=bHide?"\x53how\x57\x69nd\x6fw(false\x29": "C\x6cose\x28)"; var html=""; html+="\011\011\x3ctable \x62order=\0470\047\x20id=\x27\122\x61dWindo\x77Cont\x65ntWra\x70per"+id+"\047\x20cla\x73\x73=\x27\x52ad\x45TableWr\x61pper\047\040\x73tyle\x3d\047\x77idt\x68: "+width+"\x3bheigh\x74\072"+height+"\x3bz-inde\x78\072\x31000; po\x73ition:\x61\142\x73olute;\x27 cel\x6cspaci\x6eg=\047\x30\047\040\x63ellp\x61dding\x3d\047\x30\047\x20>\x0a"+"\x09\011\x09\074\x74r  sty\x6ce=\047\x68eig\x68t:1px;\x27\076\x0a"+"\011\x09\011\x09\074\x74d \x77idth=\0471\047\x20class\x3d\047\x52adE\x54ableW\x72apper\x48\145\x61derL\x65ft\047\x20no\x77rap>\x3c/td>\012"+"\011\x09\011\011\x3ctd widt\x68=\047\x3100%\047 class\x3d\047\x52adE\x54ableW\x72apperH\x65aderC\x65nter\047 nowr\x61p=\047\x74r\x75e\047\x20on\x6doused\x6fwn=\047radWi\x6edow_"+id+"\x2eDra\x67\x4dod\x65=\042\x6dove\x22\x3b r\x65turn r\x61dWindo\x77_"+id+".OnD\x72\141g\x53tart(ev\x65nt);\047\040\x6fnselec\x74start=\x27retu\x72n fa\x6cse;\047\076\x0a"+"\x09\011\x09\011\x09\074\x73pa\x6e id=\047\x52ad\x57indowC\x61ptio\x6e"+id+"\047\x20onse\x6cectstar\x74\075\x27return\x20false;\x27 class\x3d\047\x52ad\x45RadWi\x6e\144\x6fwHead\x65r\047\x3e"+caption+"\074\x2fspan>\x0a"+"\x09\011\x09\011\x3c/td>\012"; if (!bIsModal){html+="\011\011\x3ctd wi\x64\164\x68\x3d\0471\047\x20clas\x73\075\x27Rad\x45Tabl\x65\127\x72apper\x48eader\x43enter\x27 nowra\x70>\012"+"\x09\011\x09\011\x09\074\x73pan \x63lass=\x27\122\x61\144\x45RadW\x69ndow\x42uttonP\x69nOff\x27\040\x69d=\047Button\x50in\047\x20o\x6ecli\x63k=\047\x72ad\x57indo\x77_"+id+".Tog\x67leCanMov\x65(this)\047>&nbsp\x3b\074\x2fspan>"+"\011\x09\011\x3c/td>\x0a"; }var scrolling="a\x75to"; if (this.GetWindow(id)!=null && this.GetWindow(id).Argument!=null){var customizedScrolling=this.GetWindow(id).Argument.scrolling; if (customizedScrolling){switch (customizedScrolling){case "ye\x73":case "no":case "a\x75to":scrolling=customizedScrolling; break; default:break; }}}html+="\011\011\x09\011\x3ctd w\x69dth=\047\061\x27 class\x3d\047\x52adE\x54ableW\x72apper\x48\145\x61derCe\x6eter\047 nowr\x61p>\012"+"\011\x09\011\x3cspa\x6e class=\x27RadERad\x57indowB\x75ttonCl\x6fse\047 id=\x27\102\x75ttonC\x6cose\047\040\x6fncli\x63k=\047\x72a\x64Wind\x6fw_"+id+"."+closeFunc+"\047\x3e&nb\x73\160\x3b\074\x2fspan>\x0a"+"\x09\011\x09\011\x3c/td\x3e\012"+"\011\x09\011\x09\074\x74d wi\x64th=\047\x31\047\040\x63lass=\x27RadE\x54able\x57rapper\x48eader\x52ight\x27\040\x6eowra\x70>\074\x2ftd\x3e\012"+"\x09\011\x09\074\x2ftr>\x0a"+"\011\011\x09\074\x74r style\x3d\047\x68eigh\x74:100%\047 >\012"+"\x09\011\x09\011\x3ctd \x73\164\x79le=\047\x68ei\x67ht:100\x25;\047\x20c\x6flspan\x3d\047\x35\047\x3e\012"+"\011\x09\011\x09\011\x3ctab\x6ce heig\x68t=\047\x3100%\x27\040\x73tyl\x65=\047\x68ei\x67ht:100\x25\047\x20bor\x64er=\047\060\x27 wi\x64th=\047\061\x300%\047  cel\x6cspac\x69ng=\0470\047\x20ce\x6clpad\x64ing=\0470\047\x3e\012"+"\011\x09\011\x09\011\x09\074\164\x72 style\x3d\047\x68eight\x3a100%\x27>\012"+"\011\011\x09\011\x09\011\x09\074\x74d w\x69dth=\047\x31\047 clas\x73=\047\x52ad\x45TableW\x72apper\x42odyL\x65ft\047\x20no\x77rap>\x3c/td>\x0a"+"\011\x09\011\x09\011\x09\011\x3ctd\x20id=\047\x52ad\x57indowC\x6fnten\x74Windo\x77"+id+"\047\x20 style=\x27\150\x65ight:10\x30%;borde\x72:0px s\x6f\154\x69d bl\x75e;\047\x20he\x69ght=\x27\061\x300%\047\040\x77idth\x3d\047\x3100%\x27 clas\x73=\047\x52ad\x45Table\x57rappe\x72Body\x43enter\x27 ali\x67n=\047\154\x65ft\047 val\x69gn=\047top\047 on\x73e\x6cect\x73tart\x3d\047\x72et\x75rn \x66alse\x3b\047\x3e\012"+"\011\x09\011\x09\011\x09\011\x09\074ifram\x65\040\x6eame=\047RadWi\x6edowC\x6fntent\x27 frame\x62order\x3d\047\x30px\x27\040\x73tyle\x3d\047\x68eig\x68t:100\x25;widt\x68:100\x25;bord\x65r:0p\x78 soli\x64 gre\x65n\047\x20id\x3d\047\x52ad\x57indo\x77Cont\x65ntF\x72ame"+id+"\x27 src=\047"+url+"\x27 scrol\x6c\151\x6e\147\x3d\x27"+scrolling+"\x27 border=\x27no\047\x20>\074\x2fif\x72\141\x6d\145\x3e\012"+"\011\x09\011\x09\011\x09\011\074\x2ftd>\012"+"\011\011\x09\011\x09\011\x09\074\x74d wi\x64th=\047\x31\047\040\x63lass\x3d\047\x52ad\x45TableW\x72apper\x42odyRi\x67ht\047\x20no\x77rap>\x3c/td>\x0a"+"\x09\011\x09\011\x09\011\x3c/tr\x3e\012"+"\x09\011\x09\011\x09\074\x2ftable\x3e\012"+"\x09\011\x09\011\x3c/t\x64>\012"+"\x09\011\x09\074\x2ftr\x3e\012"+"\x09\011\x09\074\x74r style\x3d\047\x68eight\x3a1px;\047\076\x0a"+"\x09\011\x09\011\x3ctd\x20\143\x6flspan=\x27\x35\047 width\x3d\047\x3100\x25\047\x20styl\x65=\047\x68ei\x67ht:1px\x3b\047\x20>\012"+"\011\x09\011\x09\011\074\x74able b\x6f\162\x64\145\x72\075\x270\047\x20w\x69dth=\047100%\047 heigh\x74=\047\x31\047\040\x63ells\x70acing\x3d\047\x30\047\x20ce\x6clpad\x64ing=\x270\047\x3e\012"+"\x09\011\x09\011\x09\011\x3ctr\x3e\012"+"\x09\011\x09\011\x09\011\011\x3ctd wid\x74h=\047\x31\047\x20cl\x61ss=\x27RadET\x61bleWra\x70perFo\x6fterLe\x66t\047\x20now\x72ap>&\x6ebsp;\x3c\057\x74d>\012"+"\x09\011\x09\011\x09\011\x09\074\x74d \x63olspan\x3d\047\x33\047\040\x69d=\047\102\x6frderB\x6fttom\x27\040\x77idth\x3d\047\x3100%\x27 clas\x73=\047\x52ad\x45Table\x57rapp\x65rFoot\x65rCen\x74er\047\040\x6eowra\x70>&nb\x73p;\074\057\x74d>\x09\011\x0a"+"\x09\011\x09\011\x09\011\011\x3ctd wid\x74h=\047\x31\047\x20id\x3d\047\x43or\x6eerBot\x74omRigh\x74\047\x20cla\x73s=\047\x52ad\x45Table\x57rappe\x72Foot\x65rRigh\x74\047\x20onm\x6fused\x6fwn=\047radWi\x6edow_"+id+"\x2eDra\x67\115o\x64e=\042\x73ize\x22\073\x20retur\x6e\040\x72adWi\x6edow_"+id+"\x2eOnDrag\x53\x74a\x72\164\x28\145\x76ent);\047 onsel\x65ctstar\x74=\047\162\x65turn \x66alse;\x27 nowr\x61p>&nbs\x70;\074\x2ftd\x3e\012"+"\x09\011\x09\011\x09\011\x3c/t\x72>\012"+"\011\x09\011\x09\011\x3c/table\x3e\012"+"\011\x09\011\x09\074\x2ftd>\x0a"+"\011\011\x09\074\x2ftr>\012"+"\x09\011\x3c/tab\x6ce>\012"; return html; };RadEditorWindowManager.prototype.SetOverImage= function (imageId){ this._overImage=document.getElementById(imageId); };RadEditorWindowManager.prototype.GetOverImage= function ( ){if (!this._overImage){ this._overImage=document.getElementById("\117\x56ER_IMG"); }return this._overImage; };RadEditorWindowManager.prototype.ShowOverImage= function (wnd,visible){var overImage=this.GetOverImage( ); if (overImage){if (wnd && visible){var viewPortSize=RadControlsNamespace.Screen.GetViewPortSize( ); overImage.style.position="a\x62solute"; overImage.style.left=0; overImage.style.top=0; overImage.style.width=viewPortSize.width+"\x70x"; overImage.style.height=viewPortSize.height+"\x70x"; overImage.style.zIndex=wnd.ZIndex; overImage.style.display=""; }else {overImage.style.display="\x6eone"; }}};function RadGetScrollTop(oDocument){if (oDocument.documentElement && oDocument.documentElement.scrollTop){return oDocument.documentElement.scrollTop; }else {return oDocument.body.scrollTop; }}function RadGetScrollLeft(oDocument){if (oDocument.documentElement && oDocument.documentElement.scrollLeft){return oDocument.documentElement.scrollLeft; }else {return oDocument.body.scrollLeft; }}function CloseDlg(returnValue,callbackFunction,execCallBack){if (window.radWindow){window.radWindow.ReturnValue=returnValue; window.radWindow.Close(null,callbackFunction,execCallBack); }}function InitializeRadWindow(editorID){window["\x47etDia\x6c\x6fg\x41\162\x67umen\x74s"]= function (isInSpell){if (window["radWindo\x77"]){if (isInSpell){return window["\x72adWin\x64\x6fw"].Argument.CustomArguments; }else {return window["radWin\x64ow"].Argument; }}else {return null; }};window["isRa\x64Window"]= true; window["radWi\x6edow"]=GetEditorRadWindowManager( ).GetCurrentRadWindow(window); if (window["\x72ad\x57\151\x6edow"]){if (window.dialogArguments){window["\x72adWind\x6f\167"].Window=window; }window["\x72adWindow"].OnLoad( ); }var dialogArguments=GetDialogArguments( ); if (dialogArguments){if (dialogArguments.HideEditorStatusBar){dialogArguments.HideEditorStatusBar(editorID); }}if (document.addEventListener){document.onclick= function (e){var eventTarget=e.target; if (eventTarget && (eventTarget.tagName=="\x42UTTON" || (eventTarget.tagName=="\x49NPUT" && eventTarget.type.toLowerCase( )=="\x62utton"))){e.cancelBuble= true; e.returnValue= false; if (e.preventDefault)e.preventDefault( ); return false; }} ; }window["Bi\x6edOnRadWi\x6edowKeyDo\x77n"]= function ( ){$ektron(document).keydown( function (event){event=(event?event:window.event); if (27==event.keyCode){$ektron("span\x2eRadERadW\x69ndowBut\x74onClose",window.radWindow.ContentWrapperTable).click( ); event.stopImmediatePropagation( ); return false; }} ); };}
